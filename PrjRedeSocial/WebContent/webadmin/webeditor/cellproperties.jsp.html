<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Generator" content="Asbru Web Content Editor">
<meta http-equiv="Copyright" content="(C) 2002-2014 - Asbru Ltd. - www.asbrusoft.com">
<script type="text/javascript" src="webeditor.properties.js"></script>
<title>Asbru Web Content Editor</title>
<link rel="stylesheet" href="dtree.css" type="text/css">
<link rel="stylesheet" type="text/css" href="webeditor.css">
<script type="text/javascript">

document.title = HtmlDecode(Text('cellproperties_title'));

function requestParameter(name) {
	var value = "";
	if (start = request.indexOf("?"+name+"=")+1) {
		value = request.substring(start+name.length+1);
	} else if (start = request.indexOf("&"+name+"=")+1) {
		value = request.substring(start+name.length+1);
	}
	if (value.indexOf("&")+1) {
		value = value.substring(0, value.indexOf("&"));
	}
	value = unescape(decodeURI(value));
	return value;
}

window.focus();
var request = "" + window.location;
editor = requestParameter("editor");
if ((typeof(webeditor) == "undefined") && editor && window.parent.opener && window.parent.opener[editor]) webeditor = window.parent.opener[editor];
if ((typeof(webeditor) == "undefined") && editor && window.opener && window.opener[editor]) webeditor = window.opener[editor];
if ((typeof(webeditor) == "undefined") && editor && top.opener && top.opener[editor]) webeditor = top.opener[editor];
if ((typeof(webeditor) == "undefined") && editor && top && top[editor]) webeditor = top[editor];
if ((typeof(webeditor) == "undefined") && editor && parent && parent[editor]) webeditor = parent[editor];

function initform() {
	document.forms[0].width.value = requestParameter("width");
	document.forms[0].height.value = requestParameter("height");
	document.forms[0].colspan.value = requestParameter("colspan");
	document.forms[0].rowspan.value = requestParameter("rowspan");
	document.forms[0].bgcolor.value = requestParameter("bgcolor");
	document.forms[0].bordercolor.value = requestParameter("bordercolor");
	document.forms[0].background.value = requestParameter("background");
	document.forms[0].background.options[0].text = requestParameter("background");
	document.forms[0].background.options[0].value = requestParameter("background");
	document.forms[0].align.value = requestParameter("align");
	document.forms[0].valign.value = requestParameter("valign");
	document.forms[0].htmlclass.value = requestParameter("htmlclass");
	document.forms[0].htmlid.value = requestParameter("htmlid");
	if (document.getElementById && document.getElementById("bgcolor_preview")) document.getElementById("bgcolor_preview").style.backgroundColor = document.forms[0].bgcolor.value;
	if (document.getElementById && document.getElementById("bordercolor_preview")) document.getElementById("bordercolor_preview").style.backgroundColor = document.forms[0].bordercolor.value;
}

function updatecell(form) {
	webeditor.updateCell(form);
	webeditor.window_close(window);
}

function selectcolor(attribute) {
	if (document.getElementById) {
		webeditor.window_open(webeditor.rootpath+'colour.html?editor=table&attribute='+attribute, 'colour_window', 400, 325, 'width=400,height=325,scrollbars=yes,resizable=yes,status=yes', true);
	}
}

var table = new Object();
table.window_close = webeditor.window_close;
webeditor.window_proxy['table'] = table;

</script>
<script type="text/javascript" language="Javascript1.4">

if (! table.bgcolor) {
	table.bgcolor = function (color) {
		try {
			document.forms[0].bgcolor.value = color;
			if (document.getElementById("bgcolor_preview")) document.getElementById("bgcolor_preview").style.backgroundColor = color;
		} catch(e) {
		}
	}
}

if (! table.bordercolor) {
	table.bordercolor = function (color) {
		try {
			document.forms[0].bordercolor.value = color;
			if (document.getElementById("bordercolor_preview")) document.getElementById("bordercolor_preview").style.backgroundColor = color;
		} catch(e) {
		}
	}
}

</script>
<!--[if GTE IE 5]>
<script Language="Javascript">

if (! table.bgcolor) {
	table.bgcolor = function (color) {
		try {
			document.forms[0].bgcolor.value = color;
			if (document.getElementById("bgcolor_preview")) document.getElementById("bgcolor_preview").style.backgroundColor = color;
		} catch(e) {
		}
	}
}

if (! table.bordercolor) {
	table.bordercolor = function (color) {
		try {
			document.forms[0].bordercolor.value = color;
			if (document.getElementById("bordercolor_preview")) document.getElementById("bordercolor_preview").style.backgroundColor = color;
		} catch(e) {
		}
	}
}

</script>
<![endif]-->
<script type="text/javascript">

if (! table.bgcolor) {
	table.bgcolor = function (color) {
		document.forms[0].bgcolor.value = color;
	}
}

if (! table.bordercolor) {
	table.bordercolor = function (color) {
		document.forms[0].bordercolor.value = color;
	}
}

</script>
</head>
<body onload="initform();">
<form action="#" onSubmit="javascript:updatecell(this); return false;">
<table summary="" width="100%" border="0" class="dtree">
	<tr align="left" valign="top"> 
		<td colspan="4" class="webeditor_window_title"><script type="text/javascript">document.write(Text('cellproperties_title'));</script></td>
	</tr>
	<tr align="left" valign="top"> 
		<td colspan="2" width="50%">
			<fieldset>
			<legend class="webeditor_window_heading"><script type="text/javascript">document.write(Text('cellproperties_size'));</script></legend>
				<table summary="" width="100%">
					<tr>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('cellproperties_size_width'));</script></td>
						<td class="webeditor_window_value"> 
							<input type="text" name="width" size="5" value="">
						</td>
					</tr>
					<tr>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('cellproperties_size_height'));</script></td>
						<td class="webeditor_window_value"> 
							<input type="text" name="height" size="5" value="">
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
		<td colspan="2" width="50%">
			<fieldset>
			<legend class="webeditor_window_heading"><script type="text/javascript">document.write(Text('cellproperties_span'));</script></legend>
				<table summary="" width="100%">
					<tr>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('cellproperties_span_rows'));</script></td>
						<td class="webeditor_window_value"> 
							<input type="text" name="rowspan" size="5" value="">
						</td>
					</tr>
					<tr>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('cellproperties_span_columns'));</script></td>
						<td class="webeditor_window_value"> 
							<input type="text" name="colspan" size="5" value="">
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
	</tr>
	<tr align="left" valign="top"> 
		<td colspan="4" width="100%">
			<fieldset>
			<legend class="webeditor_window_heading"><script type="text/javascript">document.write(Text('cellproperties_alignment'));</script></legend>
				<table summary="" width="100%">
					<tr>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('cellproperties_alignment_horizontal'));</script></td>
						<td class="webeditor_window_value"> 
							<select name="align">
								<script type="text/javascript">
								document.write('<option value="">' + Text('cellproperties_alignment_horizontal_default'));
								document.write('<option value="left">' + Text('cellproperties_alignment_horizontal_left'));
								document.write('<option value="center">' + Text('cellproperties_alignment_horizontal_center'));
								document.write('<option value="right">' + Text('cellproperties_alignment_horizontal_right'));
								</script>
							</select>
						</td>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('cellproperties_alignment_vertical'));</script></td>
						<td class="webeditor_window_value"> 
							<select name="valign">
								<script type="text/javascript">
								document.write('<option value="">' + Text('cellproperties_alignment_vertical_default'));
								document.write('<option value="top">' + Text('cellproperties_alignment_vertical_top'));
								document.write('<option value="middle">' + Text('cellproperties_alignment_vertical_middle'));
								document.write('<option value="bottom">' + Text('cellproperties_alignment_vertical_bottom'));
								document.write('<option value="baseline">' + Text('cellproperties_alignment_vertical_baseline'));
								</script>
							</select>
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
	</tr>
	<tr align="left" valign="top"> 
		<td colspan="2" width="50%">
			<fieldset>
			<legend class="webeditor_window_heading"><script type="text/javascript">document.write(Text('cellproperties_border'));</script></legend>
				<table summary="" width="100%">
					<tr>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('cellproperties_border_color'));</script></td>
						<td class="webeditor_window_value">
							<span style="white-space: nowrap;"><input type="text" name="bordercolor" size="8" value="" onChange="javascript:table.bordercolor(this.value);"><a target="_blank" onClick="javascript:selectcolor('bordercolor');"><script type="text/javascript">document.write('<img alt="" id="bordercolor_preview" style="border: 1px outset; background-color: white; width: 21px; height: 20px; vertical-align: top" src="' + webeditor.rootpath + 'spacer.gif">');</script><script type="text/javascript">document.write('<img alt="" style="border: 1px outset; background-color: #C0C0C0; vertical-align: top" src="' + webeditor.skinpath + 'forecolor.gif">');</script></a></span>
						</td>
					</tr>
					<tr>
						<td class="webeditor_window_attribute">&nbsp;</td>
						<td class="webeditor_window_value">
							<div style="height: 22px;">&nbsp;</div>
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
		<td colspan="2" width="50%">
			<fieldset>
			<legend class="webeditor_window_heading"><script type="text/javascript">document.write(Text('cellproperties_background'));</script></legend>
				<table summary="" width="100%">
					<tr>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('cellproperties_background_color'));</script></td>
						<td class="webeditor_window_value"> 
							<span style="white-space: nowrap;"><input type="text" name="bgcolor" size="8" value="" onChange="javascript:table.bgcolor(this.value);"><a target="_blank" onClick="javascript:selectcolor('bgcolor');"><script type="text/javascript">document.write('<img alt="" id="bgcolor_preview" style="border: 1px outset; background-color: white; width: 21px; height: 20px; vertical-align: top" src="' + webeditor.rootpath + 'spacer.gif">');</script><script type="text/javascript">document.write('<img alt="" style="border: 1px outset; background-color: #C0C0C0; vertical-align: top" src="' + webeditor.skinpath + 'backcolor.gif">');</script></a></span>
						</td>
					</tr>
					<tr>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('cellproperties_background_image'));</script></td>
						<td class="webeditor_window_value">
<script type="text/javascript">
<!--
							document.writeln('<select name="background" style="width: 145px;">');
							document.writeln('<option value=" ">&nbsp;');
							document.writeln('<option value="">' + Text('cellproperties_background_image_none'));
// -->
</script>
<% if (myconfig.get(db, "hardcore_image_hrefs").equals("direct")) { %>
							<%= content.select_options_prefix_server_filename(db, "image", "", myconfig.get(db, "URLrootpath")) %>
<% } else { %>
							<%= content.select_options_prefix(db, "image", "", "/image.jsp?id=", "") %>
<% } %>
<script type="text/javascript">
<!--
							document.writeln('<\/select>');
// -->
</script>
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
	</tr>
	<tr align="left" valign="top"> 
		<td colspan="4">
			<fieldset>
			<legend class="webeditor_window_heading"><script type="text/javascript">document.write(Text('class_id'));</script></legend>
				<table summary="" width="100%">
					<tr>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('htmlclass'));</script></td>
						<td class="webeditor_window_value"> 
							<input type="text" name="htmlclass" size="20" value="">
						</td>
						<td></td>
						<td class="webeditor_window_attribute"><script type="text/javascript">document.write(Text('htmlid'));</script></td>
						<td class="webeditor_window_value"> 
							<input type="text" name="htmlid" size="20" value="">
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
	</tr>
</table>
<br>
<div align="center">
<script type="text/javascript">document.write('<input type="submit" value="' + Text('ok') + '">');</script>
<script type="text/javascript">document.write('<input type="button" value="' + Text('cancel') + '" onClick="webeditor.window_close(window);">');</script>
</div>
</form>
</body>
</html>
