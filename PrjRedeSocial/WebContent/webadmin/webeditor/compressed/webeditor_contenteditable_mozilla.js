webeditor.useCSSfontsize=false;function webeditor_empty_content_fix(A){if(A==""){A="<br>"}return A}function webeditor_supported(A){return true}function webeditor_select_init(A){A.ondeactivate=webeditor_select_deactivate;A.onblur=webeditor_select_blur;A.onfocus=webeditor_select_focus}function webeditor_select_focus(A){if(A&&A.target&&A.target.id){webeditor.select_focused[A.target.id]=true}return true}function contenteditable_onload(A){window.addEventListener("load",A,true);WebEditorSkin()}function contenteditable_onload_remove(A){window.removeEventListener("load",A,true)}function contenteditable_attach_event_handler(C,B,A){C.addEventListener(B,A,true)}function contenteditable_detach_event_handler(C,B,A){C.removeEventListener(B,A,true)}function contenteditable_reinit(){for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);try{if(B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document&&B.contentWindow.document.body){if(((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled"))){try{B.contentWindow.document.removeEventListener("focus",contenteditable_onfocus[A],true)}catch(C){}try{B.contentWindow.document.removeEventListener("blur",contenteditable_onblur[A],true)}catch(C){}}}}catch(C){}}contenteditable_inited=new Array();contenteditable_onfocus=new Array();contenteditable_onblur=new Array();for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);try{if(B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document&&B.contentWindow.document.body){if(((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled"))&&(!contenteditable_inited[B.id])){try{if(!contenteditable_onfocus[A]){contenteditable_onfocus[A]=new Function("event","contenteditable_focused="+A+";WebEditorActivate();webeditor_onfocus();webeditor_refreshToolbar(true);")}if(!contenteditable_onblur[A]){contenteditable_onblur[A]=new Function("event","webeditor_onblur();webeditor_refreshToolbar(true);")}B.contentWindow.document.addEventListener("focus",contenteditable_onfocus[A],true);B.contentWindow.document.addEventListener("blur",contenteditable_onblur[A],true)}catch(C){}contenteditable_inited[B.id]=true}}}catch(C){}}}function contenteditable_init(){var E=true;for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);if(((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled"))&&(!contenteditable_inited[B.id])){try{if(contenteditable_stylesheet[B.id]&&B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document.getElementById("stylesheet")&&(!contenteditable_inited_stylesheet[B.id])){B.contentWindow.document.getElementById("stylesheet").href=contenteditable_stylesheet[B.id];contenteditable_inited_stylesheet[B.id]=true}else{if(B.src&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document.location){if(B.contentWindow.document.location.href!=B.src){B.contentWindow.document.location.href=B.src;setTimeout(contenteditable_init,webeditor.initTimeout);webeditor.initTimeout=webeditor.initTimeout*webeditor.initTimeoutMultiplier;return }else{if(!contenteditable_inited_document[B.id]){contenteditable_inited_document[B.id]=true;setTimeout(contenteditable_init,webeditor.initTimeout);webeditor.initTimeout=webeditor.initTimeout*webeditor.initTimeoutMultiplier;return }else{}}}else{setTimeout(contenteditable_init,webeditor.initTimeout);webeditor.initTimeout=webeditor.initTimeout*webeditor.initTimeoutMultiplier;return }if(B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document.body){}else{setTimeout(contenteditable_init,webeditor.initTimeout);return }}}catch(D){}}}for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);if(((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled"))&&(!contenteditable_inited[B.id])){try{if(webeditor.direction){B.contentWindow.document.dir=webeditor.direction}try{B.contentWindow.document.designMode="on";B.contentWindow.document.execCommand("redo",false,null)}catch(D){}try{B.contentWindow.document.body.innerHTML=contenteditable_contents[B.id]}catch(D){setTimeout(contenteditable_init,webeditor.initTimeout);return }contenteditable_setBody(B.contentWindow.document.body,B.id);if(!contenteditable_onfocus[A]){contenteditable_onfocus[A]=new Function("event","contenteditable_focused="+A+";WebEditorActivate();webeditor_onfocus();webeditor_refreshToolbar(true);")}if(!contenteditable_onblur[A]){contenteditable_onblur[A]=new Function("event","webeditor_onblur();webeditor_refreshToolbar(true);")}B.contentWindow.document.addEventListener("focus",contenteditable_onfocus[A],true);B.contentWindow.document.addEventListener("blur",contenteditable_onblur[A],true);B.contentWindow.document.addEventListener("keydown",contenteditable_event,true);B.contentWindow.document.addEventListener("keyup",contenteditable_event,true);B.contentWindow.document.addEventListener("keypress",contenteditable_event,true);B.contentWindow.document.addEventListener("mousedown",contenteditable_event,true);B.contentWindow.document.addEventListener("mouseup",contenteditable_event,true);B.contentWindow.document.addEventListener("drag",contenteditable_event,true);if(webeditor.contextmenus){B.contentWindow.document.addEventListener("contextmenu",contenteditable_contextmenu,true)}var C=B;while((C.tagName!="FORM")&&(C.tagName!="HTML")){C=C.parentNode}if(C.tagName!="HTML"){C.addEventListener("submit",contenteditable_onSubmit,true);C[B.id].value=contenteditable_contents[B.id]}}catch(D){}if(!contenteditable_inited[B.id]){webeditor.inited+=1}contenteditable_inited[B.id]=true;if(E){E=false;contenteditable_focused=A}try{}catch(D){}}}if(webeditor.scrollContentToTop){var B=document.getElementsByTagName("iframe").item(contenteditable_focused);try{}catch(D){}webeditor_onfocus();webeditor_refreshToolbar(true);if(document.location.href.indexOf("#")<0){window.scrollTo(0,0)}}webeditor.refreshToolbar=true}function contenteditable_enable(D){for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);if(((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled"))&&(contenteditable_inited[B.id])){if((B.id==D)||(!D)){try{if(B.className!="webeditor_contenteditable"){B.className="webeditor_contenteditable"}if(B.contentWindow.document.designMode!="on"){B.contentWindow.document.designMode="on"}if(webeditor.direction&&(B.contentWindow.document.dir!=webeditor.direction)){B.contentWindow.document.dir=webeditor.direction}}catch(C){}try{if(!contenteditable_onfocus[A]){contenteditable_onfocus[A]=new Function("event","contenteditable_focused="+A+";WebEditorActivate();webeditor_onfocus();webeditor_refreshToolbar(true);")}if(!contenteditable_onblur[A]){contenteditable_onblur[A]=new Function("event","webeditor_onblur();webeditor_refreshToolbar(true);")}B.contentWindow.document.addEventListener("focus",contenteditable_onfocus[A],true);B.contentWindow.document.addEventListener("blur",contenteditable_onblur[A],true)}catch(C){}contenteditable_inited[B.id]=true}}}}function contenteditable_disable(D){for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);if((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled")){if((B.id==D)||(!D)){try{if(B.className!="webeditor_contenteditable_disabled"){B.className="webeditor_contenteditable_disabled"}if(B.contentWindow.document.designMode!="off"){B.contentWindow.document.designMode="off"}if(webeditor.direction&&(B.contentWindow.document.dir!=webeditor.direction)){B.contentWindow.document.dir=webeditor.direction}}catch(C){}try{B.contentWindow.document.removeEventListener("focus",contenteditable_onfocus[A],true)}catch(C){}try{B.contentWindow.document.removeEventListener("blur",contenteditable_onblur[A],true)}catch(C){}}}}}function contenteditable_toolbar(A){if(webeditor.toolbar&&webeditor.toolbar.contentDocument&&webeditor.toolbar.contentDocument.body){return webeditor.toolbar.contentDocument}else{if(A&&contenteditable_focused_iframe()&&contenteditable_focused_iframe().id&&document.getElementById("webeditor_toolbar_"+contenteditable_focused_iframe().id)){return document.getElementById("webeditor_toolbar_"+contenteditable_focused_iframe().id)}else{return document}}}function contenteditable_document_stylesheets_cssrules(A){return A.cssRules}function contenteditable_selection_fix(){}function contenteditable_event(A){webeditor_refreshToolbar(webeditor.refreshtoolbarOnAnyEvent);return webeditor_event(A)}function contenteditable_event_stop(A){A.preventDefault();A.stopPropagation()}function contenteditable_event_ctrlkey(A){if(A.ctrlKey&&(A.type=="keypress")){return true}else{return false}}function contenteditable_event_key(A){if(A.type=="keypress"){return String.fromCharCode(A.charCode).toLowerCase()}else{return false}}function contenteditable_event_delete(B){if(B&&B.keyCode&&((B.keyCode==webeditor_keyCode_backspace)||(B.keyCode==webeditor_keyCode_delete))){if((B.type=="keydown")||(B.type=="keypress")){if(contenteditable_selection_text()){var A=contenteditable_selection_range();if((A.startContainer==A.endContainer)&&(A.startContainer.nodeName=="#text")){}else{contenteditable_event_stop(B);contenteditable_pasteContent("")}if(contenteditable_focused_document().body.innerHTML==""){contenteditable_event_stop(B);contenteditable_focused_document().body.innerHTML="<br>"}return }}}}function contenteditable_event_enter_p(B){contenteditable_event_stop(B);if(B.type!="keydown"){return }var F=contenteditable_selection_range();if((F.startContainer==F.endContainer)&&(F.startContainer.nodeName=="#text")){var I=F.startContainer.nodeValue.substring(0,F.startOffset)||"";var E=F.startContainer.nodeValue.substring(F.endOffset)||"";var C=F.startContainer;var A=C.parentNode;if(A.nodeName=="P"){if(A.firstChild==A.lastChild){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=I||"&nbsp;";if(E){C.nodeValue=E}else{A.innerHTML="&nbsp;"}A.parentNode.insertBefore(D,A);F=contenteditable_focused_contentwindow().document.createRange();F.selectNodeContents(A);F.collapse(true);var G=contenteditable_focused_contentwindow().getSelection();G.removeAllRanges();G.addRange(F)}else{if(C==A.lastChild){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=E||"&nbsp;";C.nodeValue=I;if(A.nextSibling){A.parentNode.insertBefore(D,A.nextSibling)}else{A.parentNode.appendChild(D)}F=contenteditable_focused_contentwindow().document.createRange();F.selectNodeContents(D);F.collapse(true);var G=contenteditable_focused_contentwindow().getSelection();G.removeAllRanges();G.addRange(F)}else{if(C==A.firstChild){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=I||"&nbsp;";C.nodeValue=E;A.parentNode.insertBefore(D,A);F=contenteditable_focused_contentwindow().document.createRange();F.selectNodeContents(C);F.collapse(true);var G=contenteditable_focused_contentwindow().getSelection();G.removeAllRanges();G.addRange(F)}else{var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=E||"&nbsp;";C.nodeValue=I;while(C.nextSibling){nextSibling=C.nextSibling;A.removeChild(nextSibling);D.appendChild(nextSibling)}if(A.nextSibling){A.parentNode.insertBefore(D,A.nextSibling)}else{A.parentNode.appendChild(D)}F=contenteditable_focused_contentwindow().document.createRange();F.selectNodeContents(D);F.collapse(true);var G=contenteditable_focused_contentwindow().getSelection();G.removeAllRanges();G.addRange(F)}}}}else{if(A.nodeName=="BODY"){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=I||"&nbsp;";var H=contenteditable_focused_contentwindow().document.createElement("P");H.innerHTML=E||"&nbsp;";A.insertBefore(D,C);A.insertBefore(H,C);A.removeChild(C);F=contenteditable_focused_contentwindow().document.createRange();F.selectNodeContents(H);F.collapse(true);var G=contenteditable_focused_contentwindow().getSelection();G.removeAllRanges();G.addRange(F)}else{var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=E||"&nbsp;";C.nodeValue=I;while(C.nextSibling){nextSibling=C.nextSibling;A.removeChild(nextSibling);D.appendChild(nextSibling)}while(A.nextSibling&&(A.nextSibling.nodeName!="P")){nextSibling=A.nextSibling;A.parentNode.removeChild(nextSibling);D.appendChild(nextSibling)}if(A.nextSibling){A.parentNode.insertBefore(D,A.nextSibling)}else{A.parentNode.appendChild(D)}F=contenteditable_focused_contentwindow().document.createRange();F.selectNodeContents(D);F.collapse(true);var G=contenteditable_focused_contentwindow().getSelection();G.removeAllRanges();G.addRange(F)}}}else{if((F.startContainer.nodeName=="BODY")&&(F.startContainer.nodeName=="BODY")){contenteditable_pasteContent("<p>");var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=E||"&nbsp;";F.startContainer.insertBefore(D,F.startContainer.firstChild);F=contenteditable_focused_contentwindow().document.createRange();F.selectNodeContents(D.nextSibling);F.collapse(true);var G=contenteditable_focused_contentwindow().getSelection();G.removeAllRanges();G.addRange(F)}else{contenteditable_pasteContent("<p>")}}}function contenteditable_event_enter_fix(A){}function contenteditable_event_dragdrop(A){if((A.type=="mousedown")&&(A.target.nodeName=="IMG")){webeditor.dragdropNode=A.target;webeditor.dragdropNodeURL=A.target.src}else{if(A.type=="mousedown"){webeditor.dragdropNode=A.target}else{if(webeditor.dragdropNode&&(A.type!="mousemove")&&(A.type!="mouseover")&&(A.type!="mouseout")){contenteditable_dragdrop_fix();if((A.type=="mousedown")||(A.type=="mouseup")||(A.type=="keydown")||(A.type=="keypress")){webeditor.dragdropNode=false;webeditor.dragdropNodeURL=false}}}}}function contenteditable_selection(A){if(!A){A=contenteditable_focused_contentwindow()}try{if(A&&A.getSelection){return A.getSelection()}}catch(B){}}function contenteditable_selection_text(A){if(!A){A=contenteditable_selection()}return getRangeHTML(contenteditable_selection_range(A),false)}function contenteditable_selection_range_control(A){}function contenteditable_selection_range_parentNode(B){if(!B){B=contenteditable_selection_range()}if(B){try{if(B.commonAncestorContainer&&(B.commonAncestorContainer.nodeName=="#text")){return B.commonAncestorContainer.parentNode}else{return B.commonAncestorContainer}}catch(A){}}}function contenteditable_selection_range_startNode(A){if(!A){A=contenteditable_selection_range()}if(A){return A.startContainer}}function contenteditable_selection_range_endNode(A){if(!A){A=contenteditable_selection_range()}if(A){return A.endContainer}}function contenteditable_selection_range_contains(E,B,I){const G=0;const A=1;const F=2;const D=3;var C=false;var H=contenteditable_createrange();H.selectNode(B);if(E&&(E.compareBoundaryPoints(G,H)==-1)&&(E.compareBoundaryPoints(A,H)==1)&&(E.compareBoundaryPoints(D,H)==-1)&&(E.compareBoundaryPoints(F,H)==1)){C=true}else{if(I&&E&&(E.compareBoundaryPoints(A,H)==1)&&(E.compareBoundaryPoints(D,H)==-1)){C=true}}return C}function contenteditable_selection_contains(E){var B=contenteditable_selection_range();var C=contenteditable_selection_range_parentNode(B);var A=C.getElementsByTagName(E);for(var D=0;D<A.length;D++){if(contenteditable_selection_range_contains(B,A[D],true)){return true}}return false}function contenteditable_selection_range(C){if(!C){C=contenteditable_selection()}if(C&&(!C.rangeCount)){try{var A=contenteditable_createrange();A.selectNodeContents(contenteditable_focused_document().body);A.collapse(true);C=contenteditable_selection();if(C){C.removeAllRanges()}if(C){C.addRange(A)}C=contenteditable_selection()}catch(B){return false}}if(C&&C.rangeCount){try{return C.getRangeAt(0)}catch(B){}}}function contenteditable_createrange(){return contenteditable_focused_contentwindow().document.createRange()}var contenteditable_selection_container_cache=new Array();var contenteditable_selection_container_cache_range_startContainer=false;var contenteditable_selection_container_cache_range_endContainer=false;var contenteditable_selection_container_cache_range_startOffset=false;var contenteditable_selection_container_cache_range_endOffset=false;function contenteditable_selection_container(B,Q){try{const K=0;const O=1;const P=2;const H=3;var L;var G=contenteditable_selection_range();if((!Q)&&G&&(contenteditable_selection_container_cache_range_startContainer==G.startContainer)&&(contenteditable_selection_container_cache_range_endContainer==G.endContainer)&&(contenteditable_selection_container_cache_range_startOffset==G.startOffset)&&(contenteditable_selection_container_cache_range_endOffset==G.endOffset)&&(typeof (contenteditable_selection_container_cache[B])!="undefined")){return contenteditable_selection_container_cache[B]}var F;var J=false;if(G&&(G.startContainer==G.endContainer)&&(!G.startContainer.tagName)){F=contenteditable_selection_range_parentNode();if(F&&(!F.tagName)){F=F.parentNode}}else{if(G&&(G.startContainer==G.endContainer)&&(G.startContainer.tagName=="BODY")&&(G.startOffset==0)&&(G.endOffset==G.startContainer.childNodes.length)){F=contenteditable_selection_range_parentNode();if(F&&(!F.tagName)){F=F.parentNode}if(B&&F.firstChild&&(F.firstChild.tagName==B.toUpperCase())&&(F.firstChild==F.lastChild)){F=F.firstChild}}else{var I;var N=false;var R=false;var S;if(false&&G&&(G.startContainer==G.endContainer)&&(G.startOffset==0)&&(G.endOffset==G.startContainer.childNodes.length)){}else{if(true&&G&&(G.startContainer==G.endContainer)&&(G.startOffset==G.endOffset-1)){I=G.startContainer.childNodes[G.startOffset];S=I}else{if(true&&G&&(G.startContainer==G.endContainer)&&(G.startOffset==G.endOffset)){I=G.startContainer.childNodes[G.startOffset];S=I}else{if(true&&G&&G.startContainer.tagName&&G.endContainer.tagName){I=contenteditable_selection_range_parentNode();N=G.startContainer.childNodes[G.startOffset];R=G.endContainer.childNodes[G.endOffset];S=N}else{if(true&&G&&(G.startContainer.tagName||G.endContainer.tagName)){I=contenteditable_selection_range_parentNode();S=I}else{I=contenteditable_selection_range_parentNode();S=I;if(I&&I.lastChild){S=I.lastChild}}}}}}J=false;F=I;if(F&&(!F.tagName)){F=F.parentNode}var D=false;var C=0;while(S=contenteditable_nextnode(I,S,D)){var A=contenteditable_createrange();if(A.selectNode){A.selectNode(S);if(S.tagName&&G&&(G.compareBoundaryPoints(K,A)==0)&&(G.compareBoundaryPoints(P,A)==0)){J=S;if(J.nodeName==webeditor.selection_node){break}if(S.tagName=="TABLE"){D=true}else{D=false}}else{if(S.tagName&&G&&(G.compareBoundaryPoints(H,A)<=0)&&(G.compareBoundaryPoints(O,A)>=0)){if(F==S.parentNode){C=1}else{C++}F=S;if(S.tagName=="TABLE"){D=true}else{D=false}}else{D=true}}}if(S==R){break}}if(C>1){F=I}}}if(webeditor.selection_node&&F){var E=F;while(E&&(webeditor.selection_node!=E.nodeName)){E=E.parentNode}if(E){F=E}}if(B){var E=J||F||false;while(E&&(B.toUpperCase()!=E.tagName)){E=E.parentNode}L=E}else{if(contenteditable_focused_document()){L=J||F||contenteditable_focused_document().body}else{L=J||F}}if(G){if((contenteditable_selection_container_cache_range_startContainer!=G.startContainer)||(contenteditable_selection_container_cache_range_endContainer!=G.endContainer)||(contenteditable_selection_container_cache_range_startOffset!=G.startOffset)||(contenteditable_selection_container_cache_range_endOffset!=G.endOffset)){contenteditable_selection_container_cache=new Array();contenteditable_selection_container_cache_range_startContainer=G.startContainer;contenteditable_selection_container_cache_range_endContainer=G.endContainer;contenteditable_selection_container_cache_range_startOffset=G.startOffset;contenteditable_selection_container_cache_range_endOffset=G.endOffset}contenteditable_selection_container_cache[B]=L}return L}catch(M){}}function contenteditable_selection_all(){contenteditable_selection_node(contenteditable_focused_document().body)}function contenteditable_selection_node(E,B,A,D){webeditor.selection_node=E.nodeName;var C=contenteditable_selection_range()||contenteditable_createrange();if(E&&E.nodeName=="BODY"){try{C.selectNodeContents(E)}catch(G){}}else{if(E){try{C.selectNode(E)}catch(G){}}}if(B){try{C.setStart(E,A);C.setEnd(B,D)}catch(G){}}var F=contenteditable_selection();if(F){F.removeAllRanges()}if(F){F.addRange(C)}}function contenteditable_selection_cells(B){if(!B){B=contenteditable_selection()}var G=new Array();var I=new Array();var H;for(var D=0;D<B.rangeCount;D++){var E=B.getRangeAt(D);var A=E.startContainer.childNodes[E.startOffset];if(A&&(A.tagName=="TD")){var F=I.length;for(var C=0;C<I.length;C++){if(I[C]==A.parentNode){F=C}}I[F]=A.parentNode;if(!G[F]){G[F]=new Array()}G[F].push(A)}}if(G.length){return G}}function contenteditable_selection_bookmark(E){if(E){var I=contenteditable_focused_document().body;var F=E.startNode;var G=E.startOffset;var B=E.endNode;var H=E.endOffset;var A=contenteditable_selection_bookmark_path_node(I,E.startNodePath);var D=contenteditable_selection_bookmark_path_node(I,E.endNodePath);contenteditable_selection_node(A,D,G,H);if(contenteditable_selection_container().scrollIntoView){contenteditable_selection_container().scrollIntoView()}contenteditable_focused_contentwindow().focus()}else{var C;if(C=contenteditable_selection_range()){E=new Object();E.startNode=0;E.startOffset=C.startOffset;E.endNode=0;E.endOffset=C.endOffset;E.startNodePath=contenteditable_selection_bookmark_path(C.startContainer);E.endNodePath=contenteditable_selection_bookmark_path(C.endContainer)}}return E}function contenteditable_selection_bookmark_path(D){var C="";var A=1;var E=D.nodeName;var B=D;while(B=B.previousSibling){if(B.nodeName==E){A++}}C=A+"."+E;while((D=D.parentNode)&&(D.nodeName!="BODY")&&(D.nodeName!="HTML")&&(D.nodeName!="#document")){var A=1;var E=D.nodeName;var B=D;while(B=B.previousSibling){if(B.nodeName==E){A++}}C=A+"."+E+" "+C}return C}function contenteditable_selection_bookmark_path_node(F,D){var E=D.split(" ");for(var C=0;C<E.length;C++){var G=E[C].split(".");var A=parseInt(G[0]);var H=G[1];var B=F.firstChild;if(B.nodeName==H){A--}while(A&&(B=B.nextSibling)){if(B.nodeName==H){A--}}if(B){F=B}else{}}return F}function contenteditable_setContent_body(B,C,A){if(A&&A.contentWindow&&A.contentWindow.document&&A.contentWindow.document.body){A.contentWindow.document.body.innerHTML="";A.contentWindow.document.body.innerHTML=B;contenteditable_setBody(A.contentWindow.document.body,A.id)}}function contenteditable_insertNodeAtSelection(I,E,B){var F=E;var O=contenteditable_selection(I);var H;try{H=O.getRangeAt(0)}catch(L){H=contenteditable_createrange();H.selectNodeContents(contenteditable_focused_document().body);H.collapse(1)}if(O){O.removeAllRanges()}H.deleteContents();var A=H.startContainer;var N=H.startOffset;H=document.createRange();if((A.nodeType==3)&&(E.nodeType==3)){A.insertData(N,E.nodeValue);H.setEnd(A,N+E.length);H.setStart(A,N+E.length);F=A}else{var C;if(A.nodeType==3){var D=A;A=D.parentNode;var P=D.nodeValue;var K=P.substr(0,N);var J=P.substr(N);var M=document.createTextNode(K);var C=document.createTextNode(J);A.insertBefore(C,D);A.insertBefore(E,C);A.insertBefore(M,E);A.removeChild(D);F=E}else{C=A.childNodes[N];if(C){A.insertBefore(E,C);F=E}else{try{A.appendChild(E);F=E}catch(L){var G=A.parentNode;G.replaceChild(E,A);F=E}}}if(H&&H.setEnd&&C){if((A.nodeName=="BODY")&&(C.nodeName=="BR")&&(N==0)){H.setEnd(A,1)}else{H.setEnd(C,0)}}if(H&&H.setStart&&C){if((A.nodeName=="BODY")&&(C.nodeName=="BR")&&(N==0)){H.setStart(A,1)}else{H.setStart(C,0)}}}try{O.addRange(H)}catch(L){}return F}function contenteditable_useCSS(){try{contenteditable_focused_document().execCommand("styleWithCSS",0,true)}catch(A){try{contenteditable_focused_document().execCommand("useCSS",false,false)}catch(A){}}}function contenteditable_notCSS(){try{contenteditable_focused_document().execCommand("styleWithCSS",0,false)}catch(A){try{contenteditable_focused_document().execCommand("useCSS",false,true)}catch(A){}}}function contenteditable_BlockDirLTR(A){webeditor.direction="ltr";contenteditable_focused_contentwindow().document.dir="ltr"}function contenteditable_BlockDirRTL(A){webeditor.direction="rtl";contenteditable_focused_contentwindow().document.dir="rtl"}function contenteditable_formatblock_query(){var B;var A;var C;if((B=(""+contenteditable_focused_document().queryCommandValue("formatblock")).toLowerCase())&&(B!="p")){return B}else{if((C=contenteditable_selection_container_listitem())&&(C.nodeName!="LI")){return C.nodeName.toLowerCase()}else{if(A=contenteditable_selection_container_list()){return A.nodeName.toLowerCase()}}}return"p"}function contenteditable_selection_container_list(){var A;if(A=contenteditable_selection_container("ul")){}else{if(A=contenteditable_selection_container("ol")){}else{if(A=contenteditable_selection_container("dir")){}else{if(A=contenteditable_selection_container("menu")){}else{if(A=contenteditable_selection_container("dl")){}}}}}return A}function contenteditable_selection_container_listitem(){var A;if(A=contenteditable_selection_container("li")){}else{if(A=contenteditable_selection_container("dt")){}else{if(A=contenteditable_selection_container("dd")){}}}return A}function contenteditable_formatblock(C,B){if(B=="<ol>"){var A=contenteditable_formatblock_list("ol");contenteditable_formatblock_listitems(A,"li")}else{if(B=="<ul>"){var A=contenteditable_formatblock_list("ul");contenteditable_formatblock_listitems(A,"li")}else{if(B=="<dir>"){var A=contenteditable_formatblock_list("dir");contenteditable_formatblock_listitems(A,"li")}else{if(B=="<menu>"){var A=contenteditable_formatblock_list("menu");contenteditable_formatblock_listitems(A,"li")}else{if(B=="<dt>"){var A=contenteditable_selection_container_list();if(A&&A.nodeName=="dl"){contenteditable_formatblock_listitem("dt")}else{A=contenteditable_formatblock_list("dl");contenteditable_formatblock_listitems(A,"dt")}}else{if(B=="<dd>"){var A=contenteditable_selection_container_list();if(A&&A.nodeName=="dl"){contenteditable_formatblock_listitem("dd")}else{A=contenteditable_formatblock_list("dl");contenteditable_formatblock_listitems(A,"dd")}}else{if(B=="<p>"){var A=contenteditable_selection_container_list();if(A){A=contenteditable_formatblock_list("")}else{contenteditable_execcommand(C,B)}}else{contenteditable_execcommand(C,B)}}}}}}}}function contenteditable_formatblock_list(G){var F=contenteditable_selection_container_list();if(!F){contenteditable_execcommand("insertunorderedlist");F=contenteditable_selection_container("ul",true)}if(F&&G){var A=contenteditable_focused_contentwindow().document.createElement(G);for(var D=F.firstChild;D;D=D.nextSibling){var C=D.cloneNode(true);A.appendChild(C)}F.parentNode.replaceChild(A,F);return A}else{if(F){var A=contenteditable_focused_contentwindow().document.createElement("p");for(var D=F.firstChild;D;D=D.nextSibling){for(var B=D.firstChild;B;B=B.nextSibling){var E=B.cloneNode(true);A.appendChild(E)}A.appendChild(contenteditable_focused_contentwindow().document.createElement("br"));A.appendChild(contenteditable_focused_contentwindow().document.createTextNode("\r\n"))}F.parentNode.replaceChild(A,F);return A}}}function contenteditable_formatblock_listitem(D){var E=contenteditable_selection_container_listitem();if(E){var C=contenteditable_focused_contentwindow().document.createElement(D);for(var B=E.firstChild;B;B=B.nextSibling){var A=B.cloneNode(true);C.appendChild(A)}E.parentNode.replaceChild(C,E);return C}}function contenteditable_formatblock_listitems(E,D){if(E){for(var F=E.firstChild;F;F=F.nextSibling){if((F.nodeName=="LI")||(F.nodeName=="DT")||(F.nodeName=="DD")){var C=contenteditable_focused_contentwindow().document.createElement(D);for(var B=F.firstChild;B;B=B.nextSibling){var A=B.cloneNode(true);C.appendChild(A)}E.replaceChild(C,F);F=C}}}}function contenteditable_formatclass(D,L){var E=contenteditable_selection();for(var H=0;H<E.rangeCount;H++){var I=E.getRangeAt(H);var B=I.startContainer;var M=I.endContainer;var G=I.startOffset;var K=I.endOffset;if(M.nodeName=="BODY"){if(K>0){M=M.childNodes[K-1];if(M.nodeType==3){K=M.nodeValue.length}else{K=M.childNodes.length}}else{M=M.childNodes[K];K=0}}if((B==M)&&(G!=K)&&(B.nodeType==3)){if((G==0)&&(K==B.nodeValue.length)&&(B.parentNode.nodeName=="SPAN")&&(B.parentNode.childNodes.length==1)){contenteditable_formatclass_attribute(B.parentNode,L)}else{var C=document.createElement("span");contenteditable_formatclass_attribute(C,L);C.appendChild(document.createTextNode(B.nodeValue.substring(G,K)));contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),C)}}else{if(B!=M){var C=B;if(B.nodeType==3){if(G<B.nodeValue.length){B=B.parentNode}else{B=B.nextSibling}}var M=M;if(M.nodeType==3){if(K>0){M=M.parentNode}else{M=M.previousSibling}}for(var C=B;C!=null;C=C.nextSibling){contenteditable_formatclass_attribute(C,L);if(C==M){break}}}else{if(B.nodeName=="BODY"){var C;if((B.firstChild!=B.lastChild)||(B.firstChild.nodeType!=3)||(M.firstChild.nodeType!=3)){C=document.createElement("div")}else{C=document.createElement("span")}contenteditable_formatclass_attribute(C,L);var A=new Array();for(var F=G;F<K;F++){var J=B.childNodes[F];A[A.length]=J}for(var F=0;F<A.length;F++){C.appendChild(A[F])}contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),C)}else{if(G!=K){for(var F=G;F<K;F++){var C=B.childNodes[G];if(C.nodeType==3){C=C.parentNode}contenteditable_formatclass_attribute(C,L)}}else{var C=I.commonAncestorContainer;while((C!=null)&&(C.nodeType==3)){C=C.parentNode}contenteditable_formatclass_attribute(C,L)}}}}}}function contenteditable_execcommand(E,B){try{if(E=="backcolor"){contenteditable_focused_document().execCommand("useCSS",false,false);contenteditable_focused_document().execCommand("hilitecolor",false,contenteditable_execcommand_value(E,B));contenteditable_focused_document().execCommand("useCSS",false,webeditor.useCSS)}else{if(webeditor.boldAsStrong&&(E=="bold")){var A=contenteditable_selection_container("strong");if(A){contenteditable_remove_parentnode(A)}else{var D=contenteditable_selection_text()||"&nbsp;";contenteditable_event_paste_do_pre();contenteditable_pasteContent("<strong>"+D+"</strong>");contenteditable_event_paste_do_post();contenteditable_event_paste_fix();contenteditable_nobr_fix()}}else{if(webeditor.italicAsEm&&(E=="italic")){var A=contenteditable_selection_container("em");if(A){contenteditable_remove_parentnode(A)}else{var D=contenteditable_selection_text()||"&nbsp;";contenteditable_event_paste_do_pre();contenteditable_pasteContent("<em>"+D+"</em>");contenteditable_event_paste_do_post();contenteditable_event_paste_fix();contenteditable_nobr_fix()}}else{if(webeditor.striketroughAsStrike&&(E=="strikethrough")){var A=contenteditable_selection_container("strike");if(A){contenteditable_remove_parentnode(A)}else{var D=contenteditable_selection_text()||"&nbsp;";contenteditable_event_paste_do_pre();contenteditable_pasteContent("<strike>"+D+"</strike>");contenteditable_event_paste_do_post();contenteditable_event_paste_fix();contenteditable_nobr_fix()}}else{if(webeditor.inserthorizontalruleUnstyled&&(E=="inserthorizontalrule")){contenteditable_event_paste_do_pre();contenteditable_pasteContent("<hr>");contenteditable_event_paste_do_post();contenteditable_event_paste_fix()}else{if(E=="justifyleft"){var A=contenteditable_selection_container("p");if(!A){contenteditable_selection_container("div")}if(A){contenteditable_selection_node(A)}if(webeditor.useCSS){contenteditable_useCSS()}return contenteditable_focused_document().execCommand(E,false,contenteditable_execcommand_value(E,B))}else{if(E=="justifycenter"){var A=contenteditable_selection_container("p");if(!A){contenteditable_selection_container("div")}if(A){contenteditable_selection_node(A)}if(webeditor.useCSS){contenteditable_useCSS()}return contenteditable_focused_document().execCommand(E,false,contenteditable_execcommand_value(E,B))}else{if(E=="justifyright"){var A=contenteditable_selection_container("p");if(!A){contenteditable_selection_container("div")}if(A){contenteditable_selection_node(A)}if(webeditor.useCSS){contenteditable_useCSS()}return contenteditable_focused_document().execCommand(E,false,contenteditable_execcommand_value(E,B))}else{if(E=="justifyfull"){var A=contenteditable_selection_container("p");if(!A){contenteditable_selection_container("div")}if(A){contenteditable_selection_node(A)}if(webeditor.useCSS){contenteditable_useCSS()}return contenteditable_focused_document().execCommand(E,false,contenteditable_execcommand_value(E,B))}else{if(E=="fontsize"){if(webeditor.useCSS&&webeditor.useCSSfontsize){contenteditable_useCSS()}else{contenteditable_notCSS()}return contenteditable_focused_document().execCommand(E,false,contenteditable_execcommand_value(E,B))}else{if(webeditor.useCSS){contenteditable_useCSS()}return contenteditable_focused_document().execCommand(E,false,contenteditable_execcommand_value(E,B))}}}}}}}}}}}catch(C){return false}return true}function contenteditable_execcommand_value(B,A){if((B=="forecolor")&&((A=="")||(A=="inherit"))){return"inherit"}else{if((B=="backcolor")&&((A=="")||(A=="inherit"))){return"inherit"}}return A}function contenteditable_querycommand_value(B,A){return A}function contenteditable_find(A){if(!contenteditable_focused_contentwindow().nsFindInstData){contenteditable_focused_contentwindow().nsFindInstData=new Function()}if(contenteditable_viewsource_status[contenteditable_focused]){contenteditable_focused_textarea().find()}else{contenteditable_focused_contentwindow().find()}return true}function contenteditable_print(A){contenteditable_focused_contentwindow().print();return true}function contenteditable_specialcharacter(E){var B=contenteditable_focused_contentwindow();if(E){var A=B.document.createTextNode(E);var D=contenteditable_selection();var C=contenteditable_selection_range(D);contenteditable_insertNodeAtSelection(B,A)}}function contenteditable_position(B){var A=contenteditable_positionable();if(B){}else{if(A){if(A.style.position=="absolute"){A.style.position="";A.style.top="";A.style.left="";A.style.zIndex=""}else{var D=contenteditable_position_offsetTop(A);var C=contenteditable_position_offsetLeft(A);A.style.position="absolute";if(D){A.style.top=D+"px"}if(C){A.style.left=C+"px"}A.style.zIndex=1}if(A.getAttribute("STYLE")==""){A.removeAttribute("STYLE",0)}}}}function contenteditable_forwards(){var A=contenteditable_positionable();if(A){if(A.style&&A.style.zIndex&&(A.style.zIndex<1000000)){A.style.zIndex=parseInt(A.style.zIndex)+1}else{A.style.zIndex=1}}}function contenteditable_backwards(){var A=contenteditable_positionable();if(A){if(A.style&&A.style.zIndex&&(A.style.zIndex>0)){A.style.zIndex=parseInt(A.style.zIndex)-1}else{A.style.zIndex=0}}}function contenteditable_front(){var A=contenteditable_positionable();if(A){zIndex=contenteditable_positionable_front_max();if(zIndex<1000000){zIndex++}else{zIndex=1000000}A.style.zIndex=zIndex}}function contenteditable_back(){var A=contenteditable_positionable();if(A){zIndex=contenteditable_positionable_back_min();if(zIndex>0){zIndex--}else{zIndex=0}A.style.zIndex=zIndex}}function contenteditable_abovetext(){var A=contenteditable_positionable();if(A&&A.style){if(A.style.zIndex<0){A.style.zIndex=-A.style.zIndex}else{if(A.style.zIndex==0){A.style.zIndex=1}}}}function contenteditable_belowtext(){}function contenteditable_viewsource_onfocus(A){A.removeEventListener("focus",contenteditable_onfocus[contenteditable_focused],true);A.addEventListener("focus",contenteditable_onfocus[contenteditable_focused],true);A.removeEventListener("blur",contenteditable_onblur[contenteditable_focused],true);A.addEventListener("blur",contenteditable_onblur[contenteditable_focused],true)}function contenteditable_viewsource_textarea2html(A,B){var C=A.value;C=contenteditable_split_content(B.id,C);try{if(webeditor_custom_encode){C=webeditor_custom_encode(C)}}catch(D){}try{if(webeditor_custom_initialize){C=webeditor_custom_initialize(C)}}catch(D){}C=contenteditable_encodeScriptTags(C);C=webeditor_empty_content_fix(C);B.contentWindow.document.body.innerHTML=C;contenteditable_setBody(B.contentWindow.document.body,B.id);B.contentWindow.document.removeEventListener("focus",contenteditable_onfocus[contenteditable_focused],true);B.contentWindow.document.addEventListener("focus",contenteditable_onfocus[contenteditable_focused],true);B.contentWindow.document.removeEventListener("blur",contenteditable_onblur[contenteditable_focused],true);B.contentWindow.document.addEventListener("blur",contenteditable_onblur[contenteditable_focused],true)}function contenteditable_viewsource_show(){var A=document.createTextNode(document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document.body.innerHTML);document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document.body.innerHTML="";document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document.body.appendChild(A)}function contenteditable_viewsource_hide(){var A=document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document.body.ownerDocument.createRange();A.selectNodeContents(document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document.body);document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document.body.innerHTML=A.toString()}function contenteditable_iframe_hide(A){A.style.display="none"}function contenteditable_iframe_show(A){A.style.display="block"}function contenteditable_dropdown_hide(A){A.style.display="none"}function contenteditable_dropdown_show(A){A.style.display="block"}function contenteditable_dropdown_hidden(A){return(A.style.display=="none")}function contenteditable_setAttribute(B,A,C){if(A.toLowerCase()=="src"){C=C.replace(new RegExp("^//"),"/")}B.setAttribute(A,C)}function contenteditable_removeAttribute(B,A){B.removeAttribute(A)}function contenteditable_getAttribute(F,E){var H="";if(typeof (F)=="string"){var B=F;RegExp.global=true;RegExp.multiline=true;var D=new RegExp("^[^>]*[ \t\r\n]"+E+'="([^"]*)"',"gi");var A=new RegExp("^[^>]*[ \t\r\n]"+E+"=([^ >]*)","gi");var C=new RegExp("^[^>]*[ \t\r\n]("+E+")[ \t\r\n>]","gi");var G;if(G=D.exec(B)){H=G[1]||""}else{if(G=A.exec(B)){H=G[1]||""}else{if(G=C.exec(B)){H=G[1]||""}}}}else{if(F){H=F.getAttribute(E)||""}else{H=""}}if(E.toLowerCase()=="src"){H=H.replace(new RegExp("^//"),"/")}return H}function contenteditable_cellRowSpan(A){return A.rowSpan}function contenteditable_cellColSpan(A){return A.colSpan}function contenteditable_cellIndex(A){return A.cellIndex}function contenteditable_insertimage_fix(A,D,E,B,J,C,K,G,H,M,L,I,F){}function contenteditable_insertmap_fix(C,A,E,F,D,G,B){}function contenteditable_insertlink_fix(C,A,E,G,D,H,B,F){}function contenteditable_insertiframe_fix(B,A,F,D,G,C,E){}function contenteditable_execcommand_fix(B,A){}function contenteditable_formatclass_fix(B,A){}function contenteditable_nobr_fix(){}function contenteditable_box_fix(){contenteditable_focused_contentwindow().document.body.innerHTML=contenteditable_focused_contentwindow().document.body.innerHTML}function contenteditable_mailto_fix(){contenteditable_focused_contentwindow().document.body.innerHTML=contenteditable_focused_contentwindow().document.body.innerHTML}function contenteditable_anchor_fix(){contenteditable_focused_contentwindow().document.body.innerHTML=contenteditable_focused_contentwindow().document.body.innerHTML}function contenteditable_cleanContent_fix(){}function contenteditable_formatContent_fix(A){if(!A){return A}A=contenteditable_event_paste_fix_sub("A","href",A);A=contenteditable_event_paste_fix_sub("IMG","src",A);A=A.replace(/ background="\/"/g,"");A=A.replace(/(<a[^>]*) href="\/"( name=[^>]*>)/gi,"$1$2");A=A.replace(/(<a[^>]*) href=\/( name=[^>]*>)/gi,"$1$2");A=A.replace(/(<a[^>]*)( name=[^>]*) href="\/"([^>]*>)/gi,"$1$2$3");A=A.replace(/(<a[^>]*)( name=[^>]*) href=\/([^>]*>)/gi,"$1$2$3");return A}function contenteditable_node_attributes_fix(A,B){return A}var contenteditable_preview_window;var contenteditable_preview_head;var contenteditable_preview_body;var contenteditable_preview_content;var contenteditable_preview_direction;function contenteditable_preview_fix(D,B,C,A){contenteditable_preview_window=D;contenteditable_preview_head=B;contenteditable_preview_body=C;contenteditable_preview_content=A;contenteditable_preview_direction=webeditor.direction;D.document.location.href=webeditor.rootpath+"preview.html"}function contenteditable_pasteContent_node(){return contenteditable_focused_contentwindow().document.createElement("div")}function contenteditable_paste_fix_prepare(){contenteditable_event_paste_pre=contenteditable_focused_document().body.cloneNode(true);contenteditable_event_paste_parentNode=contenteditable_selection_range_parentNode();contenteditable_event_paste_previousNode=new Array();var C=contenteditable_selection_range_startNode();if(C){for(var B=0;C&&C.nodeName!="BODY";B++){C=contenteditable_previousnode(contenteditable_focused_document().body,C);contenteditable_event_paste_previousNode[B]=C}}contenteditable_event_paste_nextNode=new Array();var A=contenteditable_selection_range_endNode();if(A){for(var B=0;A&&A.nodeName!="BODY";B++){A=contenteditable_nextnode(contenteditable_focused_document().body,A);contenteditable_event_paste_nextNode[B]=A}}}function contenteditable_paste_fix(){if(webeditor.clipboard){return }var C=contenteditable_event_paste_parentNode;var H=contenteditable_selection_range();if(H.startContainer.nodeName=="BODY"){C=H.startContainer}else{if(H.startContainer.nodeName!="#text"){C=H.startContainer;while(!C.previousSibling){C=C.parentNode}C=C.previousSibling.parentNode}else{if(H.startContainer.nodeName=="#text"){C=H.startContainer;while(!C.previousSibling){C=C.parentNode}C=C.previousSibling.parentNode}}}H=contenteditable_createrange();var K=contenteditable_event_paste_previousNode[0];var D=contenteditable_event_paste_nextNode[0];var E;E=contenteditable_focused_document().body.firstChild;for(var G=contenteditable_event_paste_previousNode.length-2;G>=0;G--){if(contenteditable_event_paste_previousNode[G]==E){K=E;E=contenteditable_nextnode(contenteditable_focused_document().body,E)}else{break}}E=contenteditable_previousnode(contenteditable_focused_document().body,contenteditable_focused_document().body);for(var G=contenteditable_event_paste_nextNode.length-2;G>=0;G--){if(contenteditable_event_paste_nextNode[G]==E){D=E;E=contenteditable_previousnode(contenteditable_focused_document().body,E)}else{break}}if(C.nodeName=="BODY"){H.selectNode(C)}else{if(K&&D){H=contenteditable_createrange();try{H.setStartBefore(K);H.setEndAfter(D)}catch(I){H.selectNode(C)}}else{H.selectNode(C)}}var J="";var B="";if(contenteditable_focused_document().location.pathname){J=contenteditable_focused_document().location.pathname.substring(0,contenteditable_focused_document().location.pathname.lastIndexOf("/")+1)}B=webeditor.baseHref;webeditor.images=contenteditable_focused_document().getElementsByTagName("IMG");if(!webeditor.imagesFix){webeditor.imagesFix=new Object}for(var G=0;G<webeditor.images.length;G++){if(H.isPointInRange(webeditor.images[G],0)){if((webeditor.images[G].src!=contenteditable_getAttribute(webeditor.images[G],"src"))&&(webeditor.images[G].src==webeditor.baseHref+contenteditable_getAttribute(webeditor.images[G],"src"))){contenteditable_setAttribute(webeditor.images[G],"src",contenteditable_getAttribute(webeditor.images[G],"src"))}else{if(contenteditable_getAttribute(webeditor.images[G],"src").substring(0,3)=="/.."){var M=contenteditable_getAttribute(webeditor.images[G],"src");var A=B;while(M.substring(0,3)=="/.."){M=M.substring(3);A=A.substring(0,A.length-1);A=A.substring(0,A.lastIndexOf("/")+1)}if(A=="http:/"){A=""}if(A=="http://"){A=""}if(webeditor.baseHrefPathRelative==("/"+M).substring(0,webeditor.baseHrefPathRelative.length)){A="/"}if((A=="/")&&(M.startsWith("/"))){A=""}contenteditable_setAttribute(webeditor.images[G],"src",A+M);if((webeditor.images[G].src!=contenteditable_getAttribute(webeditor.images[G],"src"))&&(webeditor.images[G].src==webeditor.baseHref+contenteditable_getAttribute(webeditor.images[G],"src"))){contenteditable_setAttribute(webeditor.images[G],"src",contenteditable_getAttribute(webeditor.images[G],"src"))}}else{if(contenteditable_getAttribute(webeditor.images[G],"src").substring(0,3)=="../"){var M=contenteditable_getAttribute(webeditor.images[G],"src");var A=B;while(M.substring(0,3)=="../"){M=M.substring(3);A=A.substring(0,A.length-1);A=A.substring(0,A.lastIndexOf("/")+1)}if(A=="http:/"){A=""}if(A=="http://"){A=""}if(webeditor.baseHrefPathRelative==("/"+M).substring(0,webeditor.baseHrefPathRelative.length)){A="/"}if((webeditor.baseHrefPathRelative.length>1)&&(A=="")){A="/"}if((A=="/")&&(M.startsWith("/"))){A=""}contenteditable_setAttribute(webeditor.images[G],"src",A+M);if((webeditor.images[G].src!=contenteditable_getAttribute(webeditor.images[G],"src"))&&(webeditor.images[G].src==webeditor.baseHref+contenteditable_getAttribute(webeditor.images[G],"src"))){contenteditable_setAttribute(webeditor.images[G],"src",contenteditable_getAttribute(webeditor.images[G],"src"))}}else{if(contenteditable_getAttribute(webeditor.images[G],"src").substring(0,17+webeditor.language.length)=="empty."+webeditor.language+"?basehref=#"){contenteditable_setAttribute(webeditor.images[G],"src",contenteditable_getAttribute(webeditor.images[G],"src").substring(16+webeditor.language.length))}}}}for(var F=0;F<webeditor.images.length;F++){if(webeditor.baseHrefPathRelative+contenteditable_getAttribute(webeditor.images[G],"src")==contenteditable_getAttribute(webeditor.images[F],"src")){contenteditable_setAttribute(webeditor.images[G],"src",contenteditable_getAttribute(webeditor.images[F],"src"))}if(webeditor.baseHrefRelative+contenteditable_getAttribute(webeditor.images[G],"src")==contenteditable_getAttribute(webeditor.images[F],"src")){contenteditable_setAttribute(webeditor.images[G],"src",contenteditable_getAttribute(webeditor.images[F],"src"))}}}}webeditor.links=contenteditable_focused_document().getElementsByTagName("A");if(!webeditor.linksFix){webeditor.linksFix=new Object}for(var G=0;G<webeditor.links.length;G++){if(H.isPointInRange(webeditor.links[G],0)){if((webeditor.links[G].href!=contenteditable_getAttribute(webeditor.links[G],"href"))&&(webeditor.links[G].href==webeditor.baseHref+contenteditable_getAttribute(webeditor.links[G],"href"))){contenteditable_setAttribute(webeditor.links[G],"href",contenteditable_getAttribute(webeditor.links[G],"href"))}else{if(contenteditable_getAttribute(webeditor.links[G],"href").substring(0,3)=="../"){var L=contenteditable_getAttribute(webeditor.links[G],"href");var A=B;while(L.substring(0,3)=="../"){L=L.substring(3);A=A.substring(0,A.length-1);A=A.substring(0,A.lastIndexOf("/")+1)}if(A=="http:/"){A=""}if(A=="http://"){A=""}contenteditable_setAttribute(webeditor.links[G],"href",A+L);if((webeditor.links[G].href!=contenteditable_getAttribute(webeditor.links[G],"href"))&&(webeditor.links[G].href==webeditor.baseHref+contenteditable_getAttribute(webeditor.links[G],"href"))){contenteditable_setAttribute(webeditor.links[G],"href",contenteditable_getAttribute(webeditor.links[G],"href"))}}else{if(contenteditable_getAttribute(webeditor.links[G],"href").substring(0,17+webeditor.language.length)=="empty."+webeditor.language+"?basehref=#"){contenteditable_setAttribute(webeditor.links[G],"href",contenteditable_getAttribute(webeditor.links[G],"href").substring(16+webeditor.language.length))}}}for(var F=0;F<webeditor.links.length;F++){if(webeditor.baseHrefPathRelative+contenteditable_getAttribute(webeditor.links[G],"href")==contenteditable_getAttribute(webeditor.links[F],"href")){contenteditable_setAttribute(webeditor.links[G],"href",contenteditable_getAttribute(webeditor.links[F],"href"))}if(webeditor.baseHrefRelative+contenteditable_getAttribute(webeditor.links[G],"href")==contenteditable_getAttribute(webeditor.links[F],"href")){contenteditable_setAttribute(webeditor.links[G],"href",contenteditable_getAttribute(webeditor.links[F],"href"))}}}}}function contenteditable_dragdrop_fix(D){if(webeditor.dragdropNode&&webeditor.dragdropNodeURL){var I;if(D){I=D.getElementsByTagName("IMG");if(D.nodeName=="IMG"){I[I.length]=D}if(!I.length){I=contenteditable_focused_document().getElementsByTagName("IMG")}}else{I=contenteditable_focused_document().getElementsByTagName("IMG")}for(var E=0;E<I.length;E++){var G=contenteditable_getAttribute(I[E],"src");var B=G.replace(/^[\.\/]*([^\.\/].*)/,"$1");var F=contenteditable_getAttribute(I[E],"src");if(webeditor.dragdropNode&&webeditor.dragdropNodeURL){if(webeditor.dragdropNodeURL.match(new RegExp("/"+B+"$"))){contenteditable_setAttribute(I[E],"src",webeditor.dragdropNodeURL);contenteditable_event_paste_fix_sub("IMG","src",I[E])}}}}if(D&&webeditor.dragdropNode){I=D.getElementsByTagName("IMG");if(D.nodeName=="IMG"){I[I.length]=D}if((!I.length)&&D.parentNode){I=D.parentNode.getElementsByTagName("IMG")}for(var E=0;E<I.length;E++){if(contenteditable_getAttribute(I[E],"src").substring(0,9)=="../../../"){var C="";if(contenteditable_focused_document().location.pathname){C=contenteditable_focused_document().location.pathname.substring(0,contenteditable_focused_document().location.pathname.lastIndexOf("/")+1)}var J=contenteditable_getAttribute(I[E],"src");var A=C;while(J.substring(0,3)=="../"){if(J.substring(0,6)=="../../"){J=J.substring(3)}else{J=J.substring(2)}A=A.substring(0,A.length-1);A=A.substring(0,A.lastIndexOf("/")+1)}if(A=="http:/"){A=""}if(A=="http://"){A=""}contenteditable_setAttribute(I[E],"src",A+J);if((I[E].src!=contenteditable_getAttribute(I[E],"src"))&&(I[E].src==webeditor.baseHref+contenteditable_getAttribute(I[E],"src"))){contenteditable_setAttribute(I[E],"src",contenteditable_getAttribute(I[E],"src"));contenteditable_event_paste_fix_sub("IMG","src",I[E])}}}}if(D&&webeditor.dragdropNode){I=D.getElementsByTagName("A");if(D.nodeName=="A"){I[I.length]=D}if((!I.length)&&D.parentNode){I=D.parentNode.getElementsByTagName("A")}for(var E=0;E<I.length;E++){if(contenteditable_getAttribute(I[E],"href").substring(0,9)=="../../../"){var C="";if(contenteditable_focused_document().location.pathname){C=contenteditable_focused_document().location.pathname.substring(0,contenteditable_focused_document().location.pathname.lastIndexOf("/")+1)}var H=contenteditable_getAttribute(I[E],"href");var A=C;while(H.substring(0,3)=="../"){if(H.substring(0,6)=="../../"){H=H.substring(3)}else{H=H.substring(2)}A=A.substring(0,A.length-1);A=A.substring(0,A.lastIndexOf("/")+1)}if(A=="http:/"){A=""}if(A=="http://"){A=""}contenteditable_setAttribute(I[E],"href",A+H);if((I[E].href!=contenteditable_getAttribute(I[E],"href"))&&(I[E].href==webeditor.baseHref+contenteditable_getAttribute(I[E],"href"))){contenteditable_setAttribute(I[E],"href",contenteditable_getAttribute(I[E],"href"));contenteditable_event_paste_fix_sub("A","href",I[E])}}}}}function contenteditable_formatContentNodeHTML_fix(A){return""}function contenteditable_formatContentNodeXHTML_fix(A){return""}function getRangeHTML(A){var C="";var B;if((!A)||((A.commonAncestorContainer.nodeName=="BODY")&&(!A.commonAncestorContainer.firstChild))){}else{if(B=A.commonAncestorContainer.firstChild){while(B){C+=getNodeHTML(B,A);B=B.nextSibling}}else{C+=getNodeHTML(A.startContainer,A)}}return C}function getNodeHTML(C,A){if(A&&(!nodeInRange(C,A))){return""}switch(C.nodeType){case 1:var E="";if((C!=A.startContainer)||(A.startOffset==0)){E+="<"+C.nodeName;for(var B=0;B<C.attributes.length;B++){if(C.attributes.item(B).specified){E+=" "+C.attributes.item(B).name+'="'+C.attributes.item(B).value+'"'}}E+=">"}if(C.hasChildNodes()||(C.tagName=="TEXTAREA")){var D=C.firstChild;while(D){E+=getNodeHTML(D,A);D=D.nextSibling}if((C!=A.startContainer)||(A.startOffset==0)){E+="</"+C.nodeName+">"}}return E;case 2:var E="";if(C.specified&&(C.nodeName=="type")&&(C.nodeValue=="_moz")){}else{if(C.specified&&(C.nodeName.substr(0,4)=="_moz")){}else{if(C.specified){E+=C.nodeName+'="'+C.nodeValue+'"'}}}return E;case 3:var E=C.data;if(A){if(C==A.endContainer){E=E.substring(0,A.endOffset)}if(C==A.startContainer){E=E.substring(A.startOffset,E.length+1)}}return E;case 4:var E=C.data;if(A){if(C==A.endContainer){E=E.substring(0,A.endOffset)}if(C==A.startContainer){E=E.substring(A.startOffset,E.length+1)}}return"<![CDATA["+E+"]]>";case 5:return"&"+C.nodeName+";";case 6:var E="<!ENTITY "+C.nodeName;if(C.publicId){E+=' PUBLIC "'+C.publicId+'"';if(C.systemId){E+=' "'+C.systemId+'"'}if(C.notationName){E+=" NDATA "+C.notationName}}else{if(C.systemId){E+=' SYSTEM "'+C.systemId+'"';if(C.notationName){E+=" NDATA "+C.notationName}}else{E+='"';var D=C.firstChild;while(D){E+=getNodeHTML(D,A);D=D.nextSibling}E+='"'}}return E+">";case 7:var E="<?"+C.target+" "+C.data+"?>";return E;case 8:var E=C.data;if(A){if(C==A.endContainer){E=E.substring(0,A.endOffset)}if(C==A.startContainer){E=E.substring(A.startOffset,E.length+1)}}E="<!--"+E+"-->";return E;case 9:var E="";var F=false;var D=C.firstChild;while(D){if(D.nodeType!=10){F=true}E+=getNodeHTML(D,A);D=D.nextSibling}if(!F&&C.doctype){E=getNodeHTML(C.doctype,A)+E}return E;case 10:var E="<!DOCTYPE "+C.nodeName;if(C.publicId){E+=' PUBLIC "'+C.publicId+'"';if(C.systemId){E+=' "'+C.systemId+'"'}}else{if(C.systemId){E+=' SYSTEM "'+C.systemId+'"'}}if(C.internalSubset){E+=" "+C.internalSubset}E+=">\n";return E;case 11:var E="";var D=C.firstChild;while(D){E+=getNodeHTML(D,A);D=D.nextSibling}return E;case 12:var E="<!NOTATION "+C.nodeName;if(C.publicId){E+=' PUBLIC "'+C.publicId+'"';if(C.systemId){E+=' "'+C.systemId+'"'}}else{if(C.systemId){E+=' SYSTEM "'+C.systemId+'"'}}E+=">";return E}}function nodeInRange(E,B){const A=0;const C=1;const H=2;const D=3;try{var G=document.createRange();G.selectNode(E);if((B.compareBoundaryPoints(D,G)==-1)&&(B.compareBoundaryPoints(C,G)==1)){return true}}catch(F){}return false}function contenteditable_contextmenu(A){if(A&&A.target&&A.target.ownerDocument&&A.target.ownerDocument.designMode&&(A.target.ownerDocument.designMode=="on")){contenteditable_event_stop(A);var B=contenteditable_focused_iframe();webeditor_menu("context",false,getAbsoluteOffsetLeft(B)+A.clientX,getAbsoluteOffsetTop(B)+A.clientY);return false}}function contenteditable_webeditor_clipboard_cut(){if(webeditor.clipboard){try{webeditor.clipboardText=contenteditable_copyFromClipboard()}catch(A){webeditor.clipboardText="";webeditor.clipboard=false}}}function contenteditable_webeditor_clipboard_copy(){if(webeditor.clipboard){try{webeditor.clipboardText=contenteditable_copyFromClipboard()}catch(A){webeditor.clipboardText="";webeditor.clipboard=false}}}function contenteditable_webeditor_clipboard(){if(webeditor.clipboard&&webeditor.clipboardHTML&&webeditor.clipboardText){return true}else{return false}}function contenteditable_webeditor_clipboard_paste(){if(webeditor.clipboard&&webeditor.clipboardHTML&&webeditor.clipboardText&&(webeditor.clipboardText==contenteditable_copyFromClipboard())){return true}else{return false}}function contenteditable_copyToClipboard(F){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var C=Components.interfaces.nsIClipboard;var B=Components.classes["@mozilla.org/widget/clipboard;1"].getService(C);if(!B){return false}var A=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!A){return false}A.addDataFlavor("text/unicode");var E=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);E.data=F;A.setTransferData("text/unicode",E,F.length*2);B.setData(A,null,C.kGlobalClipboard)}catch(D){}}function contenteditable_copyFromClipboard(){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var D=Components.interfaces.nsIClipboard;var C=Components.classes["@mozilla.org/widget/clipboard;1"].getService(D);if(!C){return""}var A=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!A){return""}A.addDataFlavor("text/unicode");C.getData(A,C.kGlobalClipboard);var F=new Object();var B=new Object();A.getTransferData("text/unicode",F,B);if(F){F=F.value.QueryInterface(Components.interfaces.nsISupportsString)}if(F){pastetext=F.data.substring(0,B.value/2)}return pastetext}catch(E){return""}};