var webeditor;webeditor.skin="default";WebEditorSkin();webeditor.count=0;webeditor.inited=0;webeditor.initTimeout=1000;webeditor.initTimeoutMultiplier=1;webeditor.disabled=false;webeditor.clipboard=true;webeditor.useCSS=true;webeditor.WYSIWYGselect=true;webeditor.pasteToDelete=false;webeditor.scrollContentToTop=true;webeditor.contextmenus=true;webeditor.contextmenusAlign=true;webeditor.refreshtoolbarOnAnyEvent=false;webeditor.forceParamPlay="-1";webeditor.baseHref=""+document.location.protocol+"//"+document.location.host+document.location.pathname;webeditor.baseHrefPath=""+webeditor.baseHref.substring(0,webeditor.baseHref.lastIndexOf("/")+1);webeditor.baseHrefPrefix="";webeditor.baseHrefRelative="";webeditor.baseHrefPathRelative="";webeditor.shortenLocalURLs=true;webeditor.shortenLocalURLsOldSpecialCases=true;webeditor.shortenLocalURLsSearch=true;webeditor.shortenLocalURLsPath=true;webeditor.shortenLocalURLsBase=false;webeditor.shortenLocalURLsRootBase=false;webeditor.shortenLocalURLsHost=true;webeditor.shortenLocalURLsBaseHref=true;webeditor.shortenLocalURLsBaseHrefSelf=false;webeditor.shortenLocalURLsRootPath=true;webeditor.shortenLocalURLsRoot=false;webeditor.shortenLocalURLsRegExp=new Object();webeditor.shortenLocalURLsClipboardRootPath=true;webeditor.shortenLocalURLsExpandRelativePaths=false;webeditor.shortenNearlyEmptyContent=true;webeditor.fixBaseHrefPastedURLs=true;webeditor.encodeScriptTags=true;webeditor.encodeCommentTags=true;webeditor.encodePercentTags=true;webeditor.encodeQuestionTags=true;webeditor.encodePhpTags=true;webeditor.content2textareaOnBlur=true;webeditor.formatcontent=true;webeditor.mergecontent=true;webeditor.setcontentbodyinnerhtml=false;webeditor.setcontentbodydocumentwrite=true;webeditor.container="";webeditor.minWidth="";webeditor.maxWidth="";webeditor.minHeight="";webeditor.maxHeight="";webeditor.stylesheets=new Array();webeditor.textareaResizeStyle=true;webeditor.textareaResizeCalculate=true;webeditor.textareaResizeStep=true;webeditor.getAttribute_attributes=true;webeditor.getAttribute_outerHTML=false;webeditor.getAttribute_amp=true;webeditor.useCssStyleGetAttribute=true;webeditor.contentSelectionBaseNode=new Array();webeditor.contentSelectionBaseOffset=new Array();webeditor.contentSelectionExtentNode=new Array();webeditor.contentSelectionExtentOffset=new Array();webeditor.removeformatAllHTML=false;webeditor.removeformatAllXML=false;webeditor.removeformatAllNamespace=false;webeditor.removeformatAllLang=false;webeditor.removeformatAllClass=false;webeditor.removeformatAllStyle=true;webeditor.removeformatEmptyStyle=true;webeditor.removeformatEmptySpan=true;webeditor.removeformatAllSpan=false;webeditor.removeformatEmptyFont=false;webeditor.removeformatAllFont=true;webeditor.removeformatAllDelIns=false;webeditor.removeformatEmptyPDiv=true;webeditor.removeformatAllFormatTags=true;webeditor.removeformatAllMsoClass=false;webeditor.removeformatAllMsoStyle=false;webeditor.removeformatAllMsoConditional=false;webeditor.autoclean=true;webeditor.autocleanAllHTML=false;webeditor.autocleanAllXML=true;webeditor.autocleanAllNamespace=true;webeditor.autocleanAllLang=true;webeditor.autocleanAllClass=false;webeditor.autocleanAllStyle=false;webeditor.autocleanEmptyStyle=true;webeditor.autocleanEmptySpan=true;webeditor.autocleanAllSpan=false;webeditor.autocleanEmptyFont=true;webeditor.autocleanAllFont=false;webeditor.autocleanAllDelIns=true;webeditor.autocleanEmptyPDiv=false;webeditor.autocleanAllFormatTags=false;webeditor.autocleanAllMsoClass=true;webeditor.autocleanAllMsoStyle=true;webeditor.autocleanAllMsoConditional=true;webeditor.nbsp2blank=false;webeditor.encodeCharCodes=true;webeditor.encodeUnknownCharCodes=true;webeditor.boldAsStrong=true;webeditor.italicAsEm=true;webeditor.striketroughAsStrike=true;webeditor.inserthorizontalruleUnstyled=true;webeditor.styleAttributeNamesToLowerCase=true;webeditor.cssFontSize="pt";webeditor.cssIndent="40px";webeditor.removeStyleBackgroundColorInherit=true;webeditor.removeStyleColorInherit=true;webeditor.cssRGB="";webeditor.cssRGBnames={"#000000":"black","#000080":"navy","#00008b":"darkblue","#0000cd":"mediumblue","#0000ff":"blue","#006400":"darkgreen","#008000":"green","#008080":"teal","#008b8b":"darkcyan","#00bfff":"deepskyblue","#00ced1":"darkturquoise","#00fa9a":"mediumspringgreen","#00ff00":"lime","#00ff7f":"springgreen","#00ffff":"aqua","#191970":"midnightblue","#1e90ff":"dodgerblue","#20b2aa":"lightseagreen","#228b22":"forestgreen","#2e8b57":"seagreen","#2f4f4f":"darkslategray","#32cd32":"limegreen","#3cb371":"mediumseagreen","#40e0d0":"turquoise","#4169e1":"royalblue","#4682b4":"steelblue","#483d8b":"darkslateblue","#48d1cc":"mediumturquoise","#4b0082":"indigo","#556b2f":"darkolivegreen","#5f9ea0":"cadetblue","#6495ed":"cornflowerblue","#66cdaa":"mediumaquamarine","#696969":"dimgray","#6a5acd":"slateblue","#6b8e23":"olivedrab","#708090":"slategray","#778899":"lightslategray","#7b68ee":"mediumslateblue","#7cfc00":"lawngreen","#7fff00":"chartreuse","#7fffd4":"aquamarine","#800000":"maroon","#800080":"purple","#808000":"olive","#808080":"gray","#87ceeb":"skyblue","#87cefa":"lightskyblue","#8a2be2":"blueviolet","#8b0000":"darkred","#8b008b":"darkmagenta","#8b4513":"saddlebrown","#8fbc8f":"darkseagreen","#90ee90":"lightgreen","#9370db":"mediumpurple","#9400d3":"darkviolet","#98fb98":"palegreen","#9932cc":"darkorchid","#9acd32":"yellowgreen","#a0522d":"sienna","#a52a2a":"brown","#a9a9a9":"darkgray","#add8e6":"lightblue","#adff2f":"greenyellow","#afeeee":"paleturquoise","#b0c4de":"lightsteelblue","#b0e0e6":"powderblue","#b22222":"firebrick","#b8860b":"darkgoldenrod","#ba55d3":"mediumorchid","#bc8f8f":"rosybrown","#bdb76b":"darkkhaki","#c0c0c0":"silver","#c71585":"mediumvioletred","#cd5c5c":"indianred","#cd853f":"peru","#d2691e":"chocolate","#d2b48c":"tan","#d3d3d3":"lightgray","#d8bfd8":"thistle","#da70d6":"orchid","#daa520":"goldenrod","#db7093":"palevioletred","#dc143c":"crimson","#dcdcdc":"gainsboro","#dda0dd":"plum","#deb887":"burleywood","#e0ffff":"lightcyan","#e6e6fa":"lavender","#e9967a":"darksalmon","#ee82ee":"violet","#eee8aa":"palegoldenrod","#f08080":"lightcoral","#f0e68c":"khaki","#f0f8ff":"aliceblue","#f0fff0":"honeydew","#f0ffff":"azure","#f4a460":"sandybrown","#f5deb3":"wheat","#f5f5dc":"beige","#f5f5f5":"whitesmoke","#f5fffa":"mintcream","#f8f8ff":"ghostwhite","#fa8072":"salmon","#faebd7":"antiquewhite","#faf0e6":"linen","#fafad2":"lightgoldenrodyellow","#fdf5e6":"oldlace","#ff0000":"red","#ff00ff":"fuchsia","#ff1493":"deeppink","#ff4500":"orangered","#ff6347":"tomato","#ff69b4":"hotpink","#ff7f50":"coral","#ff8c00":"darkorange","#ffa07a":"lightsalmon","#ffa500":"orange","#ffb6c1":"lightpink","#ffc0cb":"pink","#ffd700":"gold","#ffdab9":"peachpuff","#ffdead":"navajowhite","#ffe4b5":"moccasin","#ffe4c4":"bisque","#ffe4e1":"mistyrose","#ffebcd":"blanchedalmond","#ffefd5":"papayawhip","#fff0f5":"lavenderblush","#fff5ee":"seashell","#fff8dc":"cornsilk","#fffacd":"lemonchiffon","#fffaf0":"floralwhite","#fffafa":"snow","#ffff00":"yellow","#ffffe0":"lightyellow","#fffff0":"ivory","#ffffff":"white"};webeditor.strip={};webeditor.replace={};webeditor.reformat={font:{"#":"span",face:"font-family",size:"font-size",color:"color"},u:{"#":"span","":"text-decoration: underline"},p:{align:{left:"text-align: left",center:"text-align: center",right:"text-align: right",justify:"text-align: justify"}},nobr:{"#":"span","":"white-space: nowrap"},"":""};webeditor.videoAutoAltSources=true;webeditor.audioAutoAltSources=true;var webeditor_keyCode_command="ctrlKey";var webeditor_keyCode_undo=90;var webeditor_keyCode_redo=89;var webeditor_keyCode_enter=13;var webeditor_keyCode_cut=88;var webeditor_keyCode_copy=67;var webeditor_keyCode_paste=86;var webeditor_keyCode_backspace=8;var webeditor_keyCode_delete=46;function WebEditor(C,D,B){if(!B){B=new Object()}for(var A in B){if(typeof (webeditor[A])!="undefined"){webeditor[A]=B[A]}}if(webeditor.baseHref.match("^/.*$")){webeditor.baseHref=""+document.location.protocol+"//"+document.location.host+webeditor.baseHref;webeditor.baseHrefPath=""+webeditor.baseHref.substring(0,webeditor.baseHref.lastIndexOf("/")+1)}else{if(!webeditor.baseHref.match("^https?://")){webeditor.baseHref=""+document.location.href.substring(0,document.location.href.lastIndexOf("/")+1)+webeditor.baseHref;if(webeditor.baseHref.length!=webeditor.baseHref.lastIndexOf("/")+1){webeditor.baseHref+="/"}webeditor.baseHrefPath=""+webeditor.baseHref}else{webeditor.baseHrefPath=""+webeditor.baseHref.substring(0,webeditor.baseHref.lastIndexOf("/")+1)}}webeditor.baseHrefRelative=""+webeditor.baseHref.replace(new RegExp("^https?://[^/]+"),"");webeditor.baseHrefPathRelative=""+webeditor.baseHrefPath.replace(new RegExp("^https?://[^/]+"),"");if((typeof (B.stylesheet)!="undefined")&&(B.stylesheet!="")&&(B.stylesheet!=false)){if(B.stylesheet.match("^https?://.*$")){}else{if(B.stylesheet.match("^/.*$")){}else{B.stylesheet=document.location.pathname.substring(0,document.location.pathname.lastIndexOf("/")+1)+B.stylesheet}}}if((typeof (B.language)=="undefined")||(B.language=="")||(B.language==false)){if(document.location.pathname.match(".*.asp$")){B.language="asp"}else{if(document.location.pathname.match(".*.aspx$")){B.language="aspx"}else{if(document.location.pathname.match(".*.cfm$")){B.language="cfm"}else{if(document.location.pathname.match(".*.jsp$")){B.language="jsp"}else{if(document.location.pathname.match(".*.php$")){B.language="php"}}}}}}if((typeof (B.manager)=="undefined")&&(typeof (B.language)!="undefined")&&(B.language!="html")){B.manager="manager"}return HardCoreWebEditor(B.rootpath,B.language,C,D,B.value_htmlencoded,B.stylesheet,B.showhtml,B.manager,B.onEnter,B.onShiftEnter,B.onCtrlEnter,B.onAltEnter,B.toolbar,B.width,B.height,B.format,B.encoding,B.direction)}function HardCoreWebEditor(I,L,S,K,C,Q,M,G,E,O,D,A,F,J,H,N,B,R){webeditor_menu_init();webeditor_dropdown_init("formatclass");webeditor_dropdown_init("formatblock");webeditor_dropdown_init("fontname");webeditor_dropdown_init("fontsize");webeditor.count+=1;if(I){webeditor.rootpath=I}webeditor.language=L||"html";webeditor.stylesheet=Q||"";webeditor.stylesheets[S]=webeditor.stylesheet;webeditor.manager=G||"";webeditor.onEnter=E||"";webeditor.onShiftEnter=O||"";webeditor.onCtrlEnter=D||"";webeditor.onAltEnter=A||"";if(F&&(typeof (F)=="string")){webeditor.toolbar=document.getElementById(F)||parent.document.getElementById(F)||""}else{webeditor.toolbar=F||""}if(webeditor.toolbar){webeditor.toolbarid=webeditor.toolbar.id}if(webeditor.toolbar){webeditor.WYSIWYGselect=false}webeditor.width=J||"100%";webeditor.height=H||"100%";webeditor.format=N||"";webeditor.encoding=B||"UTF-8";webeditor.direction=R||"";if(!webeditor.select_focused){webeditor.select_focused=new Array()}if(!webeditor.textarea_content){webeditor.textarea_content=new Array()}if((!webeditor.manager)||(webeditor.manager=="basic")){webeditor.image_window_width="550";webeditor.image_window_height="600";webeditor.hyperlink_window_width="475";webeditor.hyperlink_window_height="475"}else{webeditor.image_window_width="750";webeditor.image_window_height="500";webeditor.hyperlink_window_width="750";webeditor.hyperlink_window_height="450";if(screen.width>=1280){webeditor.image_window_width=1000;webeditor.hyperlink_window_width=1000}else{if(screen.width>=1024){webeditor.image_window_width=875;webeditor.hyperlink_window_width=875}else{if(screen.width>=800){webeditor.image_window_width=750;webeditor.hyperlink_window_width=750}}}if(screen.width>=1024){webeditor.image_window_height=700;webeditor.hyperlink_window_height=650}else{if(screen.width>=768){webeditor.image_window_height=600;webeditor.hyperlink_window_height=550}else{if(screen.width>=600){webeditor.image_window_height=500;webeditor.hyperlink_window_height=450}}}}K=webeditor_empty_content_fix(K);K=contenteditable_split_content(S,K);if(webeditor.replace){K=contenteditable_doReplace(K,webeditor.replace)}try{if(webeditor_custom_encode){K=webeditor_custom_encode(K)}}catch(P){}try{if(typeof (webeditor_custom_initialize)!="undefined"){K=webeditor_custom_initialize(K)}}catch(P){}K=contenteditable_encodeScriptTags(K);contenteditable(S,K,Q,webeditor.container);contenteditable_onload(webeditor_init);if(webeditor.container){webeditor_init()}}function HardCoreWebEditorFocus(A){return WebEditorFocus(A)}function WebEditorFocus(A){contenteditable_enable(A);if(A){contenteditable_focus(A)}}function WebEditorEnable(A){return WebEditorActivate(A)}function WebEditorActivate(A){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(typeof (webeditor_menu_hide)!="undefined"){webeditor_menu_hide()}if(A&&(typeof (A)=="string")){contenteditable_inited[A]=true;contenteditable_enable(A)}else{if(A&&A.tagName&&(A.tagName=="IFRAME")&&((A.className=="webeditor_contenteditable")||(A.className=="webeditor_contenteditable_disabled"))&&A.id){contenteditable_inited[A.id]=true;contenteditable_enable(A)}else{contenteditable_reinit();contenteditable_enable()}}}function WebEditorDisable(A){return WebEditorDeactivate(A)}function WebEditorDeactivate(A){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(typeof (webeditor_menu_hide)!="undefined"){webeditor_menu_hide()}if(A&&(typeof (A)=="string")){contenteditable_disable(A);contenteditable_inited[A]=false;contenteditable_inited_document[A]=false;contenteditable_inited_stylesheet[A]=false}else{if(A&&A.tagName&&(A.tagName=="IFRAME")&&((A.className=="webeditor_contenteditable")||(A.className=="webeditor_contenteditable_disabled"))&&A.id){contenteditable_disable(A.id);contenteditable_inited[A.id]=false;contenteditable_inited_document[A.id]=false;contenteditable_inited_stylesheet[A.id]=false}else{contenteditable_disable();contenteditable_inited=new Array()}}}function HardCoreWebEditorDOMInspector(A){return WebEditorDOMInspector(A)}function WebEditorDOMInspector(B,A){var C="";C+='<table summary="" class="webeditor_DOM_inspector" cellpadding="0" cellspacing="0" bgcolor="#C0C0C0" border="0" width="100%">\r\n';if(B){C+='<tr><td id="webeditor_DOM_inspector_'+B+'">\r\n'}else{C+='<tr><td id="webeditor_DOM_inspector">\r\n'}C+="&nbsp;\r\n";C+="</td></tr>\r\n";C+="</table>\r\n";if(A&&(typeof (A)=="string")&&document.getElementById(A)){document.getElementById(A).innerHTML=C}else{if(A&&(typeof (A.innerHTML)!="undefined")){A.innerHTML=C}else{document.write(C)}}}function WebEditorSkin(B){if(B){webeditor.skin=B}if(webeditor.skin){webeditor.skinpath=webeditor.rootpath+webeditor.skin+"/"}else{webeditor.skinpath=webeditor.rootpath}webeditor.buttonpath=webeditor.skinpath;var E=document.getElementById("webeditor_skin_css");if(E){if(!E.href.match(webeditor.skinpath+"webeditor.css$")){E.href=webeditor.skinpath+"webeditor.css"}}else{var D=document.getElementsByTagName("head");if(D&&D[0]){if(webeditor.count||(webeditor.type!="safari")){E=document.createElement("link");E.id="webeditor_skin_css";E.rel="stylesheet";E.type="text/css";E.href=webeditor.skinpath+"webeditor.css";D[0].appendChild(E)}}}var F=document.getElementsByTagName("table");for(var C=0;C<F.length;C++){if(F[C].className=="webeditor_toolbar"){var G=F[C].getElementsByTagName("img");for(var A=0;A<G.length;A++){G[A].src=webeditor.buttonpath+G[A].src.substring(G[A].src.lastIndexOf("/")+1)}}}}function WebEditorToolbarRefresh(A){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(typeof (webeditor_menu_hide)!="undefined"){webeditor_menu_hide()}if(A){contenteditable_focus(A)}webeditor_refreshToolbar(true)}function HardCoreWebEditorToolbar(B,A){switch(arguments.length){case 0:return WebEditorToolbar();break;case 1:return WebEditorToolbar(B);break;case 2:return WebEditorToolbar(B,A);break;case 3:return WebEditorToolbar(B,A,arguments[2]);break;case 4:return WebEditorToolbar(B,A,arguments[2],arguments[3]);break;case 5:return WebEditorToolbar(B,A,arguments[2],arguments[3],arguments[4]);break;case 6:return WebEditorToolbar(B,A,arguments[2],arguments[3],arguments[4],arguments[5]);break;case 7:return WebEditorToolbar(B,A,arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]);break;case 8:return WebEditorToolbar(B,A,arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]);break;case 9:return WebEditorToolbar(B,A,arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8]);break;default:return WebEditorToolbar(B,A,arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]);break}}function WebEditorToolbar(name,options){var html="";WebEditorSkin();var rows=new Array(0);if((name&&(typeof (name)=="string"))||(name===null)){if(arguments.length>2){for(var i=2;i<arguments.length;i++){if(arguments[i]){rows[rows.length]=arguments[i]}}}}else{if(arguments.length>1){for(var i=1;i<arguments.length;i++){if(arguments[i]){rows[rows.length]=arguments[i]}}}options=name}if(!options){options=new Array()}if(options.toolbar1){for(var i=1;i<10;i++){if(options["toolbar"+i]){rows[i-1]=options["toolbar"+i]}}}else{if((name=="-COMPACT-")||(rows.length&&(rows[0]=="-COMPACT-"))||(options.toolbar=="-COMPACT-")){rows[0]="formatclass formatblock fontname fontsize find help";rows[1]="cut copy paste clean delete selectall undo redo insertorderedlist insertunorderedlist outdent indent justify nobr textformat forecolor backcolor spellcheck preview";rows[2]="table insertmedia imagemap createlink mailto anchor unlink specialcharacter formmenu iframe box positionmenu inserthorizontalrule printbreak print import viewdetails viewsource save"}else{if((name=="-COMPACT2-")||(rows.length&&(rows[0]=="-COMPACT2-"))||(options.toolbar=="-COMPACT2-")){rows[0]="formatclass formatblock fontname fontsize insertorderedlist insertunorderedlist outdent indent justify nobr textformat forecolor backcolor spellcheck find help";rows[1]="cut copy paste clean delete selectall undo redo table insertmedia imagemap createlink mailto anchor unlink specialcharacter formmenu iframe box positionmenu inserthorizontalrule printbreak print import viewdetails viewsource preview save"}else{if((name=="-MINIMAL-")||(rows.length&&(rows[0]=="-MINIMAL-"))||(options.toolbar=="-MINIMAL-")){rows[0]="cut copy paste clean delete selectall undo redo formatclass formatblock spellcheck find help";rows[1]="table insertmedia imagemap createlink mailto anchor unlink specialcharacter formmenu iframe inserthorizontalrule insertorderedlist insertunorderedlist print import viewdetails viewsource preview save"}else{if((name=="-FULL-")||(rows.length&&(rows[0]=="-FULL-"))||(options.toolbar=="-FULL-")){rows[0]="formatclass formatblock fontname fontsize bold italic underline forecolor backcolor superscript subscript strikethrough removeformat help";rows[1]="cut copy paste clean delete selectall undo redo specialcharacter insertmedia imagemap iframe createlink mailto anchor unlink inserthorizontalrule insertorderedlist insertunorderedlist outdent indent justifyleft justifycenter justifyright justifyfull nobr";rows[2]="createtable tableproperties insertcaption insertrowhead insertrowfoot rowproperties insertrowabove insertrowbelow deleterow splitcellrows columnproperties insertcolumnleft insertcolumnright deletecolumn splitcellcolumns cellproperties insertcellleft insertcellright deletecell splitcell mergecells import find printbreak print preview";rows[3]="form submitbutton resetbutton backbutton imagebutton file button text password hidden textarea checkbox radio select position forwards backwards front back abovetext belowtext box spellcheck viewdetails viewsource save"}else{if((name=="-ALL-")||(rows.length&&(rows[0]=="-ALL-"))||(options.toolbar=="-ALL-")){rows[0]="formatclass formatblock fontname fontsize textformat bold italic underline forecolor backcolor superscript subscript strikethrough removeformat help";rows[1]="cut copy paste clean delete selectall undo redo specialcharacter insertmedia imagemap iframe createlink mailto anchor unlink inserthorizontalrule insertorderedlist insertunorderedlist outdent indent justify justifyleft justifycenter justifyright justifyfull nobr find";rows[2]="table createtable tableproperties insertcaption insertrowhead insertrowfoot rowproperties insertrowabove insertrowbelow deleterow splitcellrows columnproperties insertcolumnleft insertcolumnright deletecolumn splitcellcolumns cellproperties insertcellleft insertcellright deletecell splitcell mergecells ltr rtl import printbreak print preview";rows[3]="formmenu form submitbutton resetbutton backbutton imagebutton file button text password hidden textarea checkbox radio select positionmenu position forwards backwards front back abovetext belowtext box spellcheck viewdetails viewsource save"}else{if((name=="-DEFAULT-")||(rows.length&&(rows[0]=="-DEFAULT-"))||(options.toolbar=="-DEFAULT-")){rows[0]="formatclass formatblock fontname fontsize find help";rows[1]="cut copy paste clean delete selectall undo redo insertorderedlist insertunorderedlist outdent indent justify nobr textformat forecolor backcolor spellcheck preview";rows[2]="table insertmedia imagemap createlink mailto anchor unlink specialcharacter formmenu iframe box positionmenu inserthorizontalrule printbreak print import viewdetails viewsource save"}}}}}}}if(!rows.length){rows[0]="formatclass formatblock fontname fontsize find help";rows[1]="cut copy paste clean delete selectall undo redo insertorderedlist insertunorderedlist outdent indent justify nobr textformat forecolor backcolor spellcheck preview";rows[2]="table insertmedia imagemap createlink mailto anchor unlink specialcharacter formmenu iframe box positionmenu inserthorizontalrule printbreak print import viewdetails viewsource save"}var container=options.container;if(options.formatblock&&(typeof (options.formatblock)=="object")&&(typeof (options.formatblock.length)=="number")){for(var i=0;i<options.formatblock.length;i++){if(typeof (options.formatblock[i])=="string"){var formatblock=options.formatblock[i];options.formatblock[i]=new Object();options.formatblock[i].name=formatblock;options.formatblock[i].value=formatblock}}}else{if(options.formatblock&&(typeof (options.formatblock)=="object")&&(typeof (options.formatblock.length)=="undefined")){var formatblock_options=new Array();var i=0;for(var optionname in options.formatblock){formatblock_options[i]=new Object();formatblock_options[i].name=""+optionname;formatblock_options[i++].value=""+options.formatblock[optionname]}options.formatblock=formatblock_options}else{if(!options.formatblock){var i=0;options.formatblock=new Array();options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_normal");options.formatblock[i++].value="<p>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_paragraph");options.formatblock[i++].value="<p>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_formatted");options.formatblock[i++].value="<pre>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_heading1");options.formatblock[i++].value="<h1>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_heading2");options.formatblock[i++].value="<h2>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_heading3");options.formatblock[i++].value="<h3>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_heading4");options.formatblock[i++].value="<h4>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_heading5");options.formatblock[i++].value="<h5>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_heading6");options.formatblock[i++].value="<h6>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_numberedlist");options.formatblock[i++].value="<ol>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_bulletedlist");options.formatblock[i++].value="<ul>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_directorylist");options.formatblock[i++].value="<dir>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_menulist");options.formatblock[i++].value="<menu>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_definitionterm");options.formatblock[i++].value="<dt>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_definition");options.formatblock[i++].value="<dd>";options.formatblock[i]=new Object();options.formatblock[i].name=Text("formatblock_address");options.formatblock[i++].value="<address>"}}}if(options.fontname&&(typeof (options.fontname)=="object")&&(typeof (options.fontname.length)=="number")){for(var i=0;i<options.fontname.length;i++){if(typeof (options.fontname[i])=="string"){var fontname=options.fontname[i];options.fontname[i]=new Object();options.fontname[i].name=fontname;options.fontname[i].value=fontname}}}else{if(options.fontname&&(typeof (options.fontname)=="object")&&(typeof (options.fontname.length)=="undefined")){var fontname_options=new Array();var i=0;for(var optionname in options.fontname){fontname_options[i]=new Object();fontname_options[i].name=""+optionname;fontname_options[i++].value=""+options.fontname[optionname]}options.fontname=fontname_options}else{if(!options.fontname){var i=0;options.fontname=new Array();options.fontname[i]=new Object();options.fontname[i].name="Andale Mono, sans-serif";options.fontname[i++].value="Andale Mono, sans-serif";options.fontname[i]=new Object();options.fontname[i].name="Arial, Helvetica, sans-serif";options.fontname[i++].value="Arial, Helvetica, sans-serif";options.fontname[i]=new Object();options.fontname[i].name="Arial Black, Gadget, sans-serif";options.fontname[i++].value="Arial Black, Gadget, sans-serif";options.fontname[i]=new Object();options.fontname[i].name="Comic Sans MS, cursive";options.fontname[i++].value="Comic Sans MS, cursive";options.fontname[i]=new Object();options.fontname[i].name="Courier New, Courier, monospace";options.fontname[i++].value="Courier New, Courier, monospace";options.fontname[i]=new Object();options.fontname[i].name="Georgia, serif";options.fontname[i++].value="Georgia, serif";options.fontname[i]=new Object();options.fontname[i].name="Impact, Charcoal, sans-serif";options.fontname[i++].value="Impact, Charcoal, sans-serif";options.fontname[i]=new Object();options.fontname[i].name="Lucida Console, Monaco, monospace";options.fontname[i++].value="Lucida Console, Monaco, monospace";options.fontname[i]=new Object();options.fontname[i].name="Lucida Sans Unicode, Lucida Grande, sans-serif";options.fontname[i++].value="Lucida Sans Unicode, Lucida Grande, sans-serif";options.fontname[i]=new Object();options.fontname[i].name="MS Sans Serif, Geneva, sans-serif";options.fontname[i++].value="MS Sans Serif, Geneva, sans-serif";options.fontname[i]=new Object();options.fontname[i].name="MS Serif, New York, serif";options.fontname[i++].value="MS Serif, New York, serif";options.fontname[i]=new Object();options.fontname[i].name="Palatino Linotype, Book Antiqua, Palatino, serif";options.fontname[i++].value="Palatino Linotype, Book Antiqua, Palatino, serif";options.fontname[i]=new Object();options.fontname[i].name="Tahoma, Geneva, sans-serif";options.fontname[i++].value="Tahoma, Geneva, sans-serif";options.fontname[i]=new Object();options.fontname[i].name="Times New Roman, Times, serif";options.fontname[i++].value="Times New Roman, Times, serif";options.fontname[i]=new Object();options.fontname[i].name="Trebuchet MS, Helvetica, sans-serif";options.fontname[i++].value="Trebuchet MS, Helvetica, sans-serif";options.fontname[i]=new Object();options.fontname[i].name="Verdana, Geneva, sans-serif";options.fontname[i++].value="Verdana, Geneva, sans-serif";options.fontname[i]=new Object();options.fontname[i].name="Symbol";options.fontname[i++].value="Symbol";options.fontname[i]=new Object();options.fontname[i].name="Webdings";options.fontname[i++].value="Webdings";options.fontname[i]=new Object();options.fontname[i].name="Wingdings, Zapf Dingbats";options.fontname[i++].value="Wingdings, Zapf Dingbats"}}}if(options.fontsize&&(typeof (options.fontsize)=="object")&&(typeof (options.fontsize.length)=="number")){for(var i=0;i<options.fontsize.length;i++){if(typeof (options.fontsize[i])=="string"){var fontsize=options.fontsize[i];options.fontsize[i]=new Object();options.fontsize[i].name=fontsize;options.fontsize[i].value=fontsize}}}else{if(options.fontsize&&(typeof (options.fontsize)=="object")&&(typeof (options.fontsize.length)=="undefined")){var fontsize_options=new Array();var i=0;for(var optionname in options.fontsize){fontsize_options[i]=new Object();fontsize_options[i].name=""+optionname;fontsize_options[i++].value=""+options.fontsize[optionname]}options.fontsize=fontsize_options}else{if(!options.fontsize){var i=0;options.fontsize=new Array();options.fontsize[i]=new Object();options.fontsize[i].name="8";options.fontsize[i++].value="1";options.fontsize[i]=new Object();options.fontsize[i].name="10";options.fontsize[i++].value="2";options.fontsize[i]=new Object();options.fontsize[i].name="12";options.fontsize[i++].value="3";options.fontsize[i]=new Object();options.fontsize[i].name="14";options.fontsize[i++].value="4";options.fontsize[i]=new Object();options.fontsize[i].name="18";options.fontsize[i++].value="5";options.fontsize[i]=new Object();options.fontsize[i].name="24";options.fontsize[i++].value="6";options.fontsize[i]=new Object();options.fontsize[i].name="36";options.fontsize[i++].value="7"}}}webeditor.options=options;if(name&&(typeof (name)=="string")){html+='<table summary="" id="webeditor_toolbar_'+name+'" class="webeditor_toolbar" cellpadding="0" cellspacing="0" bgcolor="#C0C0C0" border="0">\r\n'}else{html+='<table summary="" class="webeditor_toolbar" cellpadding="0" cellspacing="0" bgcolor="#C0C0C0" border="0">\r\n'}var maxcellcount=0;for(var i=0;i<rows.length;i++){html+="<tr>\r\n";var elements=rows[i].split(" ");var cellcount=0;for(var j=0;j<elements.length;j++){switch(elements[j]){case"":break;case"formatclass":cellcount+=5;if(webeditor.WYSIWYGselect){html+='<td colspan="5">\r\n';html+='<span unselectable="on" style="white-space: nowrap;"><input unselectable="on" readonly="readonly" style="width: 105px;" type="text" class="webeditor_select" id="formatclass" name="webeditor_formatclass" value="" size="10" onclick="webeditor_dropdown(\'formatclass\', this)"><img unselectable="on" onclick="webeditor_dropdown(\'formatclass\', this.previousSibling)" align="top" border="0" src="'+webeditor.buttonpath+'dropdown.gif"></span>\r\n';html+="</td>\r\n";webeditor_dropdown_init("formatclass");webeditor_dropdown_option("formatclass","&nbsp;","")}else{html+='<td colspan="5">\r\n';html+='<select unselectable="on" class="webeditor_select" id="formatclass" name="webeditor_formatclass" title="'+Text("toolbar_formatclass")+'" style="width: 125px;">\r\n';html+='  <option value="">&nbsp;</option>\r\n';html+="</select>\r\n";html+="</td>\r\n"}break;case"formatblock":cellcount+=4;if(webeditor.WYSIWYGselect){html+='<td colspan="4">\r\n';html+='<span unselectable="on" style="white-space: nowrap;"><input unselectable="on" readonly="readonly" style="width: 80px;" type="text" class="webeditor_select" id="formatblock" name="webeditor_formatblock" value="" size="10" onclick="webeditor_dropdown(\'formatblock\', this)"><img unselectable="on" onclick="webeditor_dropdown(\'formatblock\', this.previousSibling)" align="top" border="0" src="'+webeditor.buttonpath+'dropdown.gif"></span>\r\n';html+="</td>\r\n";webeditor_dropdown_init("formatblock");for(var k=0;k<options.formatblock.length;k++){webeditor_dropdown_option("formatblock",options.formatblock[k].name,options.formatblock[k].value)}}else{html+='<td colspan="4">\r\n';html+='<select unselectable="on" class="webeditor_select" id="formatblock" name="webeditor_formatblock" title="'+Text("toolbar_formatblock")+'" style="width: 100px;">\r\n';for(var k=0;k<options.formatblock.length;k++){html+='  <option value="'+options.formatblock[k].value+'">'+options.formatblock[k].name+"</option>\r\n"}html+="</select>\r\n";html+="</td>\r\n"}break;case"fontname":cellcount+=6;if(webeditor.WYSIWYGselect){html+='<td colspan="6">\r\n';html+='<span unselectable="on" style="white-space: nowrap;"><input unselectable="on" readonly="readonly" style="width: 130px;" type="text" class="webeditor_select" id="fontname" name="webeditor_fontname" value="" size="10" onclick="webeditor_dropdown(\'fontname\', this)"><img unselectable="on" onclick="webeditor_dropdown(\'fontname\', this.previousSibling)" align="top" border="0" src="'+webeditor.buttonpath+'dropdown.gif"></span>\r\n';html+="</td>\r\n";webeditor_dropdown_init("fontname");for(var k=0;k<options.fontname.length;k++){webeditor_dropdown_option("fontname",options.fontname[k].name,options.fontname[k].value)}}else{html+='<td colspan="6">\r\n';html+='<select unselectable="on" class="webeditor_select" id="fontname" name="webeditor_fontname" title="'+Text("toolbar_fontname")+'" style="width: 150px;">\r\n';html+='  <option value="">&nbsp;</option>\r\n';for(var k=0;k<options.fontname.length;k++){html+='  <option value="'+options.fontname[k].value+'">'+options.fontname[k].name+"</option>\r\n"}html+="</select>\r\n";html+="</td>\r\n"}break;case"fontsize":cellcount+=2;if(webeditor.WYSIWYGselect){html+='<td colspan="2">\r\n';html+='<span unselectable="on" style="white-space: nowrap;"><input unselectable="on" readonly="readonly" style="width: 30px;" type="text" class="webeditor_select" id="fontsize" name="webeditor_fontsize" value="" size="10" onclick="webeditor_dropdown(\'fontsize\', this)"><img unselectable="on" onclick="webeditor_dropdown(\'fontsize\', this.previousSibling)" align="top" border="0" src="'+webeditor.buttonpath+'dropdown.gif"></span>\r\n';html+="</td>\r\n";webeditor_dropdown_init("fontsize","300px","225px");for(var k=0;k<options.fontsize.length;k++){webeditor_dropdown_option("fontsize",options.fontsize[k].name,options.fontsize[k].value)}}else{html+='<td colspan="2">\r\n';html+='<select unselectable="on" class="webeditor_select" id="fontsize" name="webeditor_fontsize" title="'+Text("toolbar_fontsize")+'" style="width: 50px;">\r\n';html+='  <option value="">&nbsp;</option>\r\n';for(var k=0;k<options.fontsize.length;k++){html+='  <option value="'+options.fontsize[k].value+'">'+options.fontsize[k].name+"</option>\r\n"}html+="</select>\r\n";html+="</td>\r\n"}break;case"textformat":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="textformat" src="'+webeditor.buttonpath+'textformat.gif" alt="'+Text("toolbar_textformat")+'" title="'+Text("toolbar_textformat")+'" onmouseover="webeditor_menu(\'textformat\', this)" onclick="return false;"></span></td>\r\n';break;case"bold":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="bold" src="'+webeditor.buttonpath+'bold.gif" alt="'+Text("toolbar_bold")+'" title="'+Text("toolbar_bold")+'"></span></td>\r\n';break;case"italic":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="italic" src="'+webeditor.buttonpath+'italic.gif" alt="'+Text("toolbar_italic")+'" title="'+Text("toolbar_italic")+'"></span></td>\r\n';break;case"underline":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="underline" src="'+webeditor.buttonpath+'underline.gif" alt="'+Text("toolbar_underline")+'" title="'+Text("toolbar_underline")+'"></span></td>\r\n';break;case"forecolor":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="forecolor" src="'+webeditor.buttonpath+'forecolor.gif" alt="'+Text("toolbar_forecolor")+'" title="'+Text("toolbar_forecolor")+'" onmouseover="webeditor_menu(\'colour\', this)"></span></td>\r\n';break;case"backcolor":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="backcolor" src="'+webeditor.buttonpath+'backcolor.gif" alt="'+Text("toolbar_backcolor")+'" title="'+Text("toolbar_backcolor")+'" onmouseover="webeditor_menu(\'colour\', this)"></span></td>\r\n';break;case"removeformat":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="removeformat" src="'+webeditor.buttonpath+'removeformat.gif" alt="'+Text("toolbar_removeformat")+'" title="'+Text("toolbar_removeformat")+'"></span></td>\r\n';break;case"cut":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="cut" src="'+webeditor.buttonpath+'cut.gif" alt="'+Text("toolbar_cut")+'" title="'+Text("toolbar_cut")+'"></span></td>\r\n';break;case"copy":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="copy" src="'+webeditor.buttonpath+'copy.gif" alt="'+Text("toolbar_copy")+'" title="'+Text("toolbar_copy")+'"></span></td>\r\n';break;case"paste":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="paste" src="'+webeditor.buttonpath+'paste.gif" alt="'+Text("toolbar_paste")+'" title="'+Text("toolbar_paste")+'"></span></td>\r\n';break;case"delete":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="delete" src="'+webeditor.buttonpath+'delete.gif" alt="'+Text("toolbar_delete")+'" title="'+Text("toolbar_delete")+'"></span></td>\r\n';break;case"selectall":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="selectall" src="'+webeditor.buttonpath+'selectall.gif" alt="'+Text("toolbar_selectall")+'" title="'+Text("toolbar_selectall")+'"></span></td>\r\n';break;case"undo":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="undo" src="'+webeditor.buttonpath+'undo.gif" alt="'+Text("toolbar_undo")+'" title="'+Text("toolbar_undo")+'"></span></td>\r\n';break;case"redo":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="redo" src="'+webeditor.buttonpath+'redo.gif" alt="'+Text("toolbar_redo")+'" title="'+Text("toolbar_redo")+'"></span></td>\r\n';break;case"specialcharacter":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="specialcharacter" src="'+webeditor.buttonpath+'specialcharacter.gif" alt="'+Text("toolbar_specialcharacter")+'" title="'+Text("toolbar_specialcharacter")+'"></span></td>\r\n';break;case"insertmedia":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="insertmedia" src="'+webeditor.buttonpath+'media.gif" alt="'+Text("toolbar_insertmedia")+'" title="'+Text("toolbar_insertmedia")+'"></span></td>\r\n';break;case"insertimage":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="insertimage" src="'+webeditor.buttonpath+'image.gif" alt="'+Text("toolbar_insertimage")+'" title="'+Text("toolbar_insertimage")+'"></span></td>\r\n';break;case"insertflash":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="insertflash" src="'+webeditor.buttonpath+'flash.gif" alt="'+Text("toolbar_insertflash")+'" title="'+Text("toolbar_insertflash")+'"></span></td>\r\n';break;case"insertapplet":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="insertapplet" src="'+webeditor.buttonpath+'applet.gif" alt="'+Text("toolbar_insertapplet")+'" title="'+Text("toolbar_insertapplet")+'"></span></td>\r\n';break;case"imagemap":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="imagemap" src="'+webeditor.buttonpath+'imagemap.gif" alt="'+Text("toolbar_imagemap")+'" title="'+Text("toolbar_imagemap")+'"></span></td>\r\n';break;case"createlink":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="createlink" src="'+webeditor.buttonpath+'link.gif" alt="'+Text("toolbar_createlink")+'" title="'+Text("toolbar_createlink")+'"></span></td>\r\n';break;case"mailto":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="mailto" src="'+webeditor.buttonpath+'mailto.gif" alt="'+Text("toolbar_mailto")+'" title="'+Text("toolbar_mailto")+'"></span></td>\r\n';break;case"unlink":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="unlink" src="'+webeditor.buttonpath+'unlink.gif" alt="'+Text("toolbar_unlink")+'" title="'+Text("toolbar_unlink")+'"></span></td>\r\n';break;case"inserthorizontalrule":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="inserthorizontalrule" src="'+webeditor.buttonpath+'hr.gif" alt="'+Text("toolbar_inserthorizontalrule")+'" title="'+Text("toolbar_inserthorizontalrule")+'"></span></td>\r\n';break;case"insertorderedlist":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="insertorderedlist" src="'+webeditor.buttonpath+'ol.gif" alt="'+Text("toolbar_insertorderedlist")+'" title="'+Text("toolbar_insertorderedlist")+'"></span></td>\r\n';break;case"insertunorderedlist":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="insertunorderedlist" src="'+webeditor.buttonpath+'ul.gif" alt="'+Text("toolbar_insertunorderedlist")+'" title="'+Text("toolbar_insertunorderedlist")+'"></span></td>\r\n';break;case"outdent":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="outdent" src="'+webeditor.buttonpath+'outdent.gif" alt="'+Text("toolbar_outdent")+'" title="'+Text("toolbar_outdent")+'"></span></td>\r\n';break;case"indent":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="indent" src="'+webeditor.buttonpath+'indent.gif" alt="'+Text("toolbar_indent")+'" title="'+Text("toolbar_indent")+'"></span></td>\r\n';break;case"justify":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="justify" src="'+webeditor.buttonpath+'justify.gif" alt="'+Text("toolbar_justify")+'" title="'+Text("toolbar_justify")+'" onmouseover="webeditor_menu(\'justify\', this)" onclick="return false;"></span></td>\r\n';break;case"justifyleft":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="justifyleft" src="'+webeditor.buttonpath+'justifyleft.gif" alt="'+Text("toolbar_justifyleft")+'" title="'+Text("toolbar_justifyleft")+'"></span></td>\r\n';break;case"justifycenter":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="justifycenter" src="'+webeditor.buttonpath+'justifycenter.gif" alt="'+Text("toolbar_justifycenter")+'" title="'+Text("toolbar_justifycenter")+'"></span></td>\r\n';break;case"justifyright":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="justifyright" src="'+webeditor.buttonpath+'justifyright.gif" alt="'+Text("toolbar_justifyright")+'" title="'+Text("toolbar_justifyright")+'"></span></td>\r\n';break;case"justifyfull":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="justifyfull" src="'+webeditor.buttonpath+'justifyfull.gif" alt="'+Text("toolbar_justifyfull")+'" title="'+Text("toolbar_justifyfull")+'"></span></td>\r\n';break;case"strikethrough":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="strikethrough" src="'+webeditor.buttonpath+'strikethrough.gif" alt="'+Text("toolbar_strikethrough")+'" title="'+Text("toolbar_strikethrough")+'"></span></td>\r\n';break;case"superscript":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="superscript" src="'+webeditor.buttonpath+'superscript.gif" alt="'+Text("toolbar_superscript")+'" title="'+Text("toolbar_superscript")+'"></span></td>\r\n';break;case"subscript":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="subscript" src="'+webeditor.buttonpath+'subscript.gif" alt="'+Text("toolbar_subscript")+'" title="'+Text("toolbar_subscript")+'"></span></td>\r\n';break;case"table":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="createtable" src="'+webeditor.buttonpath+'table.gif" alt="'+Text("toolbar_createtable")+'" title="'+Text("toolbar_createtable")+'" onmouseover="webeditor_menu(\'table\', this)"></span></td>\r\n';break;case"createtable":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="createtable" src="'+webeditor.buttonpath+'createtable.gif" alt="'+Text("toolbar_createtable")+'" title="'+Text("toolbar_createtable")+'"></span></td>\r\n';break;case"tableproperties":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="tableproperties" src="'+webeditor.buttonpath+'tableproperties.gif" alt="'+Text("toolbar_tableproperties")+'" title="'+Text("toolbar_tableproperties")+'"></span></td>\r\n';break;case"rowproperties":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="rowproperties" src="'+webeditor.buttonpath+'rowproperties.gif" alt="'+Text("toolbar_rowproperties")+'" title="'+Text("toolbar_rowproperties")+'"></span></td>\r\n';break;case"insertcaption":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="insertcaption" src="'+webeditor.buttonpath+'insertcaption.gif" alt="'+Text("toolbar_insertcaption")+'" title="'+Text("toolbar_insertcaption")+'"></span></td>\r\n';break;case"insertrowhead":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="insertrowhead" src="'+webeditor.buttonpath+'insertrowhead.gif" alt="'+Text("toolbar_insertrowhead")+'" title="'+Text("toolbar_insertrowhead")+'"></span></td>\r\n';break;case"insertrowfoot":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="insertrowfoot" src="'+webeditor.buttonpath+'insertrowfoot.gif" alt="'+Text("toolbar_insertrowfoot")+'" title="'+Text("toolbar_insertrowfoot")+'"></span></td>\r\n';break;case"insertrowabove":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="insertrowabove" src="'+webeditor.buttonpath+'insertrowabove.gif" alt="'+Text("toolbar_insertrowabove")+'" title="'+Text("toolbar_insertrowabove")+'"></span></td>\r\n';break;case"insertrowbelow":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="insertrowbelow" src="'+webeditor.buttonpath+'insertrowbelow.gif" alt="'+Text("toolbar_insertrowbelow")+'" title="'+Text("toolbar_insertrowbelow")+'"></span></td>\r\n';break;case"deleterow":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="deleterow" src="'+webeditor.buttonpath+'deleterow.gif" alt="'+Text("toolbar_deleterow")+'" title="'+Text("toolbar_deleterow")+'"></span></td>\r\n';break;case"splitcellrows":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="splitcellrows" src="'+webeditor.buttonpath+'splitcellrows.gif" alt="'+Text("toolbar_splitcellrows")+'" title="'+Text("toolbar_splitcellrows")+'"></span></td>\r\n';break;case"columnproperties":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="columnproperties" src="'+webeditor.buttonpath+'columnproperties.gif" alt="'+Text("toolbar_columnproperties")+'" title="'+Text("toolbar_columnproperties")+'"></span></td>\r\n';break;case"insertcolumnleft":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="insertcolumnleft" src="'+webeditor.buttonpath+'insertcolumnleft.gif" alt="'+Text("toolbar_insertcolumnleft")+'" title="'+Text("toolbar_insertcolumnleft")+'"></span></td>\r\n';break;case"insertcolumnright":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="insertcolumnright" src="'+webeditor.buttonpath+'insertcolumnright.gif" alt="'+Text("toolbar_insertcolumnright")+'" title="'+Text("toolbar_insertcolumnright")+'"></span></td>\r\n';break;case"deletecolumn":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="deletecolumn" src="'+webeditor.buttonpath+'deletecolumn.gif" alt="'+Text("toolbar_deletecolumn")+'" title="'+Text("toolbar_deletecolumn")+'"></span></td>\r\n';break;case"splitcellcolumns":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="splitcellcolumns" src="'+webeditor.buttonpath+'splitcellcolumns.gif" alt="'+Text("toolbar_splitcellcolumns")+'" title="'+Text("toolbar_splitcellcolumns")+'"></span></td>\r\n';break;case"cellproperties":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="cellproperties" src="'+webeditor.buttonpath+'cellproperties.gif" alt="'+Text("toolbar_cellproperties")+'" title="'+Text("toolbar_cellproperties")+'"></span></td>\r\n';break;case"insertcellleft":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="insertcellleft" src="'+webeditor.buttonpath+'insertcellleft.gif" alt="'+Text("toolbar_insertcellleft")+'" title="'+Text("toolbar_insertcellleft")+'"></span></td>\r\n';break;case"insertcellright":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="insertcellright" src="'+webeditor.buttonpath+'insertcellright.gif" alt="'+Text("toolbar_insertcellright")+'" title="'+Text("toolbar_insertcellright")+'"></span></td>\r\n';break;case"deletecell":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="deletecell" src="'+webeditor.buttonpath+'deletecell.gif" alt="'+Text("toolbar_deletecell")+'" title="'+Text("toolbar_deletecell")+'"></span></td>\r\n';break;case"splitcell":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="splitcell" src="'+webeditor.buttonpath+'splitcell.gif" alt="'+Text("toolbar_splitcell")+'" title="'+Text("toolbar_splitcell")+'"></span></td>\r\n';break;case"mergecells":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon_disabled" id="mergecells" src="'+webeditor.buttonpath+'mergecells.gif" alt="'+Text("toolbar_mergecells")+'" title="'+Text("toolbar_mergecells")+'"></span></td>\r\n';break;case"find":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="find" src="'+webeditor.buttonpath+'find.gif" alt="'+Text("toolbar_find")+'" title="'+Text("toolbar_find")+'"></span></td>\r\n';break;case"print":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="print" src="'+webeditor.buttonpath+'print.gif" alt="'+Text("toolbar_print")+'" title="'+Text("toolbar_print")+'"></span></td>\r\n';break;case"printbreak":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="printbreak" src="'+webeditor.buttonpath+'printbreak.gif" alt="'+Text("toolbar_printbreak")+'" title="'+Text("toolbar_printbreak")+'"></span></td>\r\n';break;case"viewdetails":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="viewdetails" src="'+webeditor.buttonpath+'viewdetails.gif" alt="'+Text("toolbar_viewdetails")+'" title="'+Text("toolbar_viewdetails")+'"></span></td>\r\n';break;case"viewsource":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="viewsource" src="'+webeditor.buttonpath+'viewsource.gif" alt="'+Text("toolbar_viewsource")+'" title="'+Text("toolbar_viewsource")+'"></span></td>\r\n';break;case"help":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="help" src="'+webeditor.buttonpath+'help.gif" alt="'+Text("toolbar_help")+'" title="'+Text("toolbar_help")+'"></span></td>\r\n';break;case"formmenu":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="form" src="'+webeditor.buttonpath+'formmenu.gif" alt="'+Text("toolbar_form")+'" title="'+Text("toolbar_form")+'" onmouseover="webeditor_menu(\'form\', this)"></span></td>\r\n';break;case"form":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="form" src="'+webeditor.buttonpath+'form.gif" alt="'+Text("toolbar_form")+'" title="'+Text("toolbar_form")+'"></span></td>\r\n';break;case"submitbutton":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="submitbutton" src="'+webeditor.buttonpath+'submitbutton.gif" alt="'+Text("toolbar_submitbutton")+'" title="'+Text("toolbar_submitbutton")+'"></span></td>\r\n';break;case"button":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="button" src="'+webeditor.buttonpath+'button.gif" alt="'+Text("toolbar_button")+'" title="'+Text("toolbar_button")+'"></span></td>\r\n';break;case"resetbutton":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="resetbutton" src="'+webeditor.buttonpath+'resetbutton.gif" alt="'+Text("toolbar_resetbutton")+'" title="'+Text("toolbar_resetbutton")+'"></span></td>\r\n';break;case"backbutton":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="backbutton" src="'+webeditor.buttonpath+'backbutton.gif" alt="'+Text("toolbar_backbutton")+'" title="'+Text("toolbar_backbutton")+'"></span></td>\r\n';break;case"imagebutton":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="imagebutton" src="'+webeditor.buttonpath+'imagebutton.gif" alt="'+Text("toolbar_imagebutton")+'" title="'+Text("toolbar_imagebutton")+'"></span></td>\r\n';break;case"text":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="text" src="'+webeditor.buttonpath+'text.gif" alt="'+Text("toolbar_text")+'" title="'+Text("toolbar_text")+'"></span></td>\r\n';break;case"hidden":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="hidden" src="'+webeditor.buttonpath+'hidden.gif" alt="'+Text("toolbar_hidden")+'" title="'+Text("toolbar_hidden")+'"></span></td>\r\n';break;case"textarea":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="textarea" src="'+webeditor.buttonpath+'textarea.gif" alt="'+Text("toolbar_textarea")+'" title="'+Text("toolbar_textarea")+'"></span></td>\r\n';break;case"password":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="password" src="'+webeditor.buttonpath+'password.gif" alt="'+Text("toolbar_password")+'" title="'+Text("toolbar_password")+'"></span></td>\r\n';break;case"radio":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="radio" src="'+webeditor.buttonpath+'radio.gif" alt="'+Text("toolbar_radio")+'" title="'+Text("toolbar_radio")+'"></span></td>\r\n';break;case"checkbox":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="checkbox" src="'+webeditor.buttonpath+'checkbox.gif" alt="'+Text("toolbar_checkbox")+'" title="'+Text("toolbar_checkbox")+'"></span></td>\r\n';break;case"select":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="select" src="'+webeditor.buttonpath+'select.gif" alt="'+Text("toolbar_select")+'" title="'+Text("toolbar_select")+'"></span></td>\r\n';break;case"file":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="file" src="'+webeditor.buttonpath+'file.gif" alt="'+Text("toolbar_file")+'" title="'+Text("toolbar_file")+'"></span></td>\r\n';break;case"clean":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="clean" src="'+webeditor.buttonpath+'clean.gif" alt="'+Text("toolbar_clean")+'" title="'+Text("toolbar_clean")+'"></span></td>\r\n';break;case"positionmenu":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="position" src="'+webeditor.buttonpath+'positionmenu.gif" alt="'+Text("toolbar_position")+'" title="'+Text("toolbar_position")+'" onmouseover="webeditor_menu(\'position\', this)"></span></td>\r\n';break;case"position":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="position" src="'+webeditor.buttonpath+'position.gif" alt="'+Text("toolbar_position")+'" title="'+Text("toolbar_position")+'"></span></td>\r\n';break;case"forwards":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="forwards" src="'+webeditor.buttonpath+'forwards.gif" alt="'+Text("toolbar_forwards")+'" title="'+Text("toolbar_forwards")+'"></span></td>\r\n';break;case"backwards":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="backwards" src="'+webeditor.buttonpath+'backwards.gif" alt="'+Text("toolbar_backwards")+'" title="'+Text("toolbar_backwards")+'"></span></td>\r\n';break;case"front":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="front" src="'+webeditor.buttonpath+'front.gif" alt="'+Text("toolbar_front")+'" title="'+Text("toolbar_front")+'"></span></td>\r\n';break;case"back":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="back" src="'+webeditor.buttonpath+'back.gif" alt="'+Text("toolbar_back")+'" title="'+Text("toolbar_back")+'"></span></td>\r\n';break;case"abovetext":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="abovetext" src="'+webeditor.buttonpath+'abovetext.gif" alt="'+Text("toolbar_abovetext")+'" title="'+Text("toolbar_abovetext")+'"></span></td>\r\n';break;case"belowtext":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="belowtext" src="'+webeditor.buttonpath+'belowtext.gif" alt="'+Text("toolbar_belowtext")+'" title="'+Text("toolbar_belowtext")+'"></span></td>\r\n';break;case"box":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="box" src="'+webeditor.buttonpath+'box.gif" alt="'+Text("toolbar_box")+'" title="'+Text("toolbar_box")+'"></span></td>\r\n';break;case"iframe":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="iframe" src="'+webeditor.buttonpath+'iframe.gif" alt="'+Text("toolbar_iframe")+'" title="'+Text("toolbar_iframe")+'"></span></td>\r\n';break;case"preview":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="preview" src="'+webeditor.buttonpath+'preview.gif" alt="'+Text("toolbar_preview")+'" title="'+Text("toolbar_preview")+'"></span></td>\r\n';break;case"anchor":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="anchor" src="'+webeditor.buttonpath+'anchor.gif" alt="'+Text("toolbar_anchor")+'" title="'+Text("toolbar_anchor")+'"></span></td>\r\n';break;case"nobr":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="nobr" src="'+webeditor.buttonpath+'nobr.gif" alt="'+Text("toolbar_nobr")+'" title="'+Text("toolbar_nobr")+'"></span></td>\r\n';break;case"import":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="import" src="'+webeditor.buttonpath+'import.gif" alt="'+Text("toolbar_import")+'" title="'+Text("toolbar_import")+'"></span></td>\r\n';break;case"save":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="save" src="'+webeditor.buttonpath+'save.gif" alt="'+Text("toolbar_save")+'" title="'+Text("toolbar_save")+'"></span></td>\r\n';break;case"increasefontsize":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="increasefontsize" src="'+webeditor.buttonpath+'increasefontsize.gif" alt="'+Text("toolbar_increasefontsize")+'" title="'+Text("toolbar_increasefontsize")+'"></span></td>\r\n';break;case"decreasefontsize":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="decreasefontsize" src="'+webeditor.buttonpath+'decreasefontsize.gif" alt="'+Text("toolbar_decreasefontsize")+'" title="'+Text("toolbar_decreasefontsize")+'"></span></td>\r\n';break;case"usecss":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="usecss" src="'+webeditor.buttonpath+'usecss.gif" alt="'+Text("toolbar_usecss")+'" title="'+Text("toolbar_usecss")+'"></span></td>\r\n';break;case"readonly":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="readonly" src="'+webeditor.buttonpath+'readonly.gif" alt="'+Text("toolbar_readonly")+'" title="'+Text("toolbar_readonly")+'"></span></td>\r\n';break;case"spellcheck":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="spellcheck" src="'+webeditor.buttonpath+'spellcheck.gif" alt="'+Text("toolbar_spellcheck")+'" title="'+Text("toolbar_spellcheck")+'"></span></td>\r\n';break;case"saveas":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="saveas" src="'+webeditor.buttonpath+'saveas.gif" alt="'+Text("toolbar_saveas")+'" title="'+Text("toolbar_saveas")+'"></span></td>\r\n';break;case"stylesheet_toggle":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><span style="white-space: nowrap;">&nbsp; <input class="webeditor_input" id="stylesheet_toggle" type="checkbox" name="dummy" value="dummy" checked onClick="contenteditable_stylesheet_toggle(this.checked);">'+Text("toolbar_stylesheet_toggle")+"</span></span></td>\r\n";break;case"BlockDirLTR":case"ltr":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="BlockDirLTR" src="'+webeditor.buttonpath+'ltr.gif" alt="'+Text("toolbar_ltr")+'" title="'+Text("toolbar_ltr")+'"></span></td>\r\n';break;case"BlockDirRTL":case"rtl":cellcount+=1;html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="BlockDirRTL" src="'+webeditor.buttonpath+'rtl.gif" alt="'+Text("toolbar_rtl")+'" title="'+Text("toolbar_rtl")+'"></span></td>\r\n';break;default:cellcount+=1;var custom_function;try{custom_function=eval("webeditor_custom_toolbar_"+elements[j])}catch(e){custom_function=null}if(custom_function){try{html+=eval("webeditor_custom_toolbar_"+elements[j]+"()")}catch(e){}}else{if(Text("toolbar_"+elements[j])!="toolbar_"+elements[j]){html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="'+elements[j]+'" src="'+webeditor.buttonpath+""+elements[j]+'.gif" alt="'+Text("toolbar_"+elements[j])+'" title="'+Text("toolbar_"+elements[j])+'"></span></td>\r\n'}else{html+='<td class="webeditor_icon"><span unselectable="on" class="webeditor_icon"><img unselectable="on" class="webeditor_icon" id="'+elements[j]+'" src="'+webeditor.buttonpath+""+elements[j]+'.gif" alt="'+elements[j]+'" title="'+elements[j]+'"></span></td>\r\n'}}break}}if(cellcount>maxcellcount){maxcellcount=cellcount}if(i==(rows.length-1)){html+='<td colspan="'+(maxcellcount-cellcount+1)+'">&nbsp;</td><td width="100%">&nbsp;</td></tr>\r\n'}else{html+="<td>&nbsp;</td></tr>\r\n"}}html+="</table>\r\n";if(container&&(typeof (container)=="string")&&document.getElementById(container)){document.getElementById(container).innerHTML=html}else{if(container&&(typeof (container.innerHTML)!="undefined")){container.innerHTML=html}else{if((container==null)&&(typeof (container)=="object")){}else{document.write(html)}}}}function HardCoreWebEditorStylesheet(A,B){return WebEditorStylesheet(A,B)}function WebEditorStylesheet(A,B){contenteditable_stylesheet_link(A,B)}function HardCoreWebEditorSubmit(){return WebEditorSubmit()}function WebEditorSubmit(){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(typeof (webeditor_menu_hide)!="undefined"){webeditor_menu_hide()}contenteditable_onSubmit()}function WebEditorPreview(A){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(typeof (webeditor_menu_hide)!="undefined"){webeditor_menu_hide()}contenteditable_preview(A)}function HardCoreWebEditorGetContent(A){return WebEditorGetContent(A)}function WebEditorGetContent(C){if(!contenteditable_getContentBodyNode(C)){return""}webeditor.handling_event=true;var A=contenteditable_getContentBodyNode(C).innerHTML;if(webeditor.formatcontent){A=contenteditable_formatContent(contenteditable_getContentBodyNode(C))}if(webeditor.autoclean){A=cleanContentSub(A,webeditor.autocleanAllHTML,webeditor.autocleanAllXML,webeditor.autocleanAllNamespace,webeditor.autocleanAllLang,webeditor.autocleanAllClass,webeditor.autocleanAllStyle,webeditor.autocleanEmptySpan,webeditor.autocleanAllSpan,webeditor.autocleanEmptyFont,webeditor.autocleanAllFont,webeditor.autocleanAllDelIns,webeditor.autocleanEmptyPDiv,webeditor.autocleanAllFormatTags,webeditor.autocleanAllMsoClass,webeditor.autocleanAllMsoStyle,webeditor.autocleanAllMsoConditional,webeditor.autocleanEmptyStyle)}A=contenteditable_decodeScriptTags(A);if(webeditor.replace){A=contenteditable_doReplace(A,webeditor.replace)}try{if(webeditor_custom_decode){A=webeditor_custom_decode(A)}}catch(B){}try{if(webeditor_custom_finalize){A=webeditor_custom_finalize(A)}}catch(B){}A=contenteditable_merge_content(C,A);webeditor.handling_event=false;return A}function HardCoreWebEditorGetContentSelection(A){return WebEditorGetContentSelection(A)}function WebEditorGetContentSelection(C){var A=contenteditable_getContentSelection(C);if(webeditor.autoclean){A=cleanContentSub(A,webeditor.autocleanAllHTML,webeditor.autocleanAllXML,webeditor.autocleanAllNamespace,webeditor.autocleanAllLang,webeditor.autocleanAllClass,webeditor.autocleanAllStyle,webeditor.autocleanEmptySpan,webeditor.autocleanAllSpan,webeditor.autocleanEmptyFont,webeditor.autocleanAllFont,webeditor.autocleanAllDelIns,webeditor.autocleanEmptyPDiv,webeditor.autocleanAllFormatTags,webeditor.autocleanAllMsoClass,webeditor.autocleanAllMsoStyle,webeditor.autocleanAllMsoConditional,webeditor.autocleanEmptyStyle)}A=contenteditable_decodeScriptTags(A);if(webeditor.replace){A=contenteditable_doReplace(A,webeditor.replace)}try{if(webeditor_custom_decode){A=webeditor_custom_decode(A)}}catch(B){}try{if(webeditor_custom_finalize){A=webeditor_custom_finalize(A)}}catch(B){}return A}function WebEditorGetContentSelectionContainer(A){return contenteditable_selection_container(A)}function HardCoreWebEditorGetContentEdited(A){return WebEditorGetContentEdited(A)}function WebEditorGetContentEdited(F){var D;if(!F){if(contenteditable_viewsource_status[contenteditable_focused]){var A=contenteditable_focused_textarea();D=A.value}else{var C=document.getElementsByTagName("iframe").item(contenteditable_focused);if(C){D=C.contentWindow.document.body.innerHTML;if(webeditor.formatcontent){D=contenteditable_formatContent(C.contentWindow.document.body)}}}}else{for(var B=0;B<document.getElementsByTagName("iframe").length;B++){var C=document.getElementsByTagName("iframe").item(B);if((C.className=="webeditor_contenteditable")||(C.className=="webeditor_contenteditable_disabled")){if(F==C.id){if(contenteditable_viewsource_status[B]){contenteditable_focused=B;var A=contenteditable_focused_textarea();D=A.value}else{D=C.contentWindow.document.body.innerHTML;if(webeditor.formatcontent){D=contenteditable_formatContent(C.contentWindow.document.body)}}}}}}if(D){if(webeditor.autoclean){D=cleanContentSub(D,webeditor.autocleanAllHTML,webeditor.autocleanAllXML,webeditor.autocleanAllNamespace,webeditor.autocleanAllLang,webeditor.autocleanAllClass,webeditor.autocleanAllStyle,webeditor.autocleanEmptySpan,webeditor.autocleanAllSpan,webeditor.autocleanEmptyFont,webeditor.autocleanAllFont,webeditor.autocleanAllDelIns,webeditor.autocleanEmptyPDiv,webeditor.autocleanAllFormatTags,webeditor.autocleanAllMsoClass,webeditor.autocleanAllMsoStyle,webeditor.autocleanAllMsoConditional,webeditor.autocleanEmptyStyle)}D=contenteditable_decodeScriptTags(D);if(webeditor.replace){D=contenteditable_doReplace(D,webeditor.replace)}try{if(webeditor_custom_decode){D=webeditor_custom_decode(D)}}catch(E){}try{if(webeditor_custom_finalize){D=webeditor_custom_finalize(D)}}catch(E){}D=contenteditable_merge_content(F,D)}return D}function HardCoreWebEditorSetContent(A,B){return WebEditorSetContent(A,B)}function WebEditorSetContent(A,C){webeditor.handling_event=true;if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(typeof (webeditor_menu_hide)!="undefined"){webeditor_menu_hide()}A=webeditor_empty_content_fix(A);A=contenteditable_split_content(C,A);if(webeditor.replace){A=contenteditable_doReplace(A,webeditor.replace)}try{if(webeditor_custom_encode){A=webeditor_custom_encode(A)}}catch(B){}try{if(webeditor_custom_initialize){A=webeditor_custom_initialize(A)}}catch(B){}A=contenteditable_encodeScriptTags(A);contenteditable_setContent(A,C);webeditor.handling_event=false}function HardCoreWebEditorPasteContent(A,B){return WebEditorPasteContent(A,B)}function WebEditorPasteContent(A,C){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(typeof (webeditor_menu_hide)!="undefined"){webeditor_menu_hide()}if(webeditor.replace){A=contenteditable_doReplace(A,webeditor.replace)}try{if(webeditor_custom_encode){A=webeditor_custom_encode(A)}}catch(B){}try{if(webeditor_custom_initialize){A=webeditor_custom_initialize(A)}}catch(B){}A=contenteditable_encodeScriptTags(A);contenteditable_event_paste_do_pre();contenteditable_pasteContent(A,C);contenteditable_event_paste_do_post();contenteditable_event_paste_fix()}function HardCoreWebEditorCleanContent(K,A,N,D,L,I,G,P,M,F,E,H,C,B,Q,J,O){return WebEditorCleanContent(K,A,N,D,L,I,G,P,M,F,E,H,C,B,Q,J,O)}function WebEditorCleanContent(K,A,N,D,L,I,G,P,M,F,E,H,C,B,Q,J,O){cleanContent(K,A,N,D,L,I,G,P,M,F,E,H,C,B,Q,J,O)}function HardCoreWebEditorCleanContentString(K,M,R,F,E,C,I,Q,B,L,P,A,H,O,D,J,N,G){return WebEditorCleanContentString(K,M,R,F,E,C,I,Q,B,L,P,A,H,O,D,J,N,G)}function WebEditorCleanContentString(K,M,R,F,E,C,I,Q,B,L,P,A,H,O,D,J,N,G){return cleanContentSub(K,M,R,F,E,C,I,Q,B,L,P,A,H,O,D,J,N,G)}webeditor.insertSpecialCharacter=insertSpecialCharacter;webeditor.insertHyperlink=insertHyperlink;webeditor.insertImage=insertImage;webeditor.insertFlash=insertFlash;webeditor.insertApplet=insertApplet;webeditor.insertQuicktime=insertQuicktime;webeditor.insertVideo=insertVideo;webeditor.insertAudio=insertAudio;webeditor.insertTable=insertTable;webeditor.updateTable=updateTable;webeditor.updateRow=updateRow;webeditor.updateColumn=updateColumn;webeditor.updateCell=updateCell;webeditor.backColor=backColor;webeditor.backcolor=backColor;webeditor.foreColor=foreColor;webeditor.forecolor=foreColor;webeditor.insertForm=insertForm;webeditor.insertButton=insertButton;webeditor.insertText=insertText;webeditor.insertHidden=insertHidden;webeditor.insertTextarea=insertTextarea;webeditor.insertCheckbox=insertCheckbox;webeditor.insertFile=insertFile;webeditor.insertSelect=insertSelect;webeditor.insertMap=insertMap;webeditor.cleanContent=cleanContent;webeditor.insertBox=insertBox;webeditor.insertIframe=insertIframe;webeditor.insertAnchor=insertAnchor;webeditor.insertMailto=insertMailto;webeditor.importFile=importFile;function webeditor_init(){contenteditable_inited=new Array();contenteditable_init();webeditor_init_toolbar();if(webeditor.inited>=webeditor.count){webeditor_dropdown_refresh("formatclass");webeditor_dropdown_refresh("formatblock");webeditor_dropdown_refresh("fontname");webeditor_dropdown_refresh("fontsize")}contenteditable_position(true)}function webeditor_init_toolbar(){var B=contenteditable_toolbar();children=B.getElementsByTagName("DIV");for(var A=0;A<children.length;A++){if((children[A].className=="webeditor_button")||(children[A].className=="webeditor_button_selected")||(children[A].className=="webeditor_button_disabled")||(children[A].className=="webeditor_button_mouseover")||(children[A].className=="webeditor_button_mousedown")||(children[A].className=="webeditor_button_mouseup")){if(!contenteditable_getAttribute(children[A],"onmouseover")){children[A].onmouseover=webeditor_button_mouseover}if(!contenteditable_getAttribute(children[A],"onmouseout")){children[A].onmouseout=webeditor_button_mouseout}if(!contenteditable_getAttribute(children[A],"onmousedown")){children[A].onmousedown=webeditor_button_mousedown}if(!contenteditable_getAttribute(children[A],"onmouseup")){children[A].onmouseup=webeditor_button_mouseup}if(!contenteditable_getAttribute(children[A],"onclick")){children[A].onclick=webeditor_click}}}children=B.getElementsByTagName("IMG");for(var A=0;A<children.length;A++){if((children[A].className=="webeditor_icon")||(children[A].className=="webeditor_icon_selected")||(children[A].className=="webeditor_icon_disabled")||(children[A].className=="webeditor_icon_mouseover")||(children[A].className=="webeditor_icon_mousedown")||(children[A].className=="webeditor_icon_mouseup")){if(!children[A].onmouseover){children[A].onmouseover=webeditor_icon_mouseover}if(!children[A].onmouseout){children[A].onmouseout=webeditor_icon_mouseout}if(!children[A].onmousedown){children[A].onmousedown=webeditor_icon_mousedown}if(!children[A].onmouseup){children[A].onmouseup=webeditor_icon_mouseup}if(!children[A].onclick){children[A].onclick=webeditor_click}}}children=B.getElementsByTagName("SELECT");for(var A=0;A<children.length;A++){if((children[A].className=="webeditor_select")||(children[A].className=="webeditor_select_selected")||(children[A].className=="webeditor_select_disabled")){children[A].onchange=webeditor_select;webeditor_select_init(children[A])}}children=B.getElementsByTagName("INPUT");for(var A=0;A<children.length;A++){if((children[A].className=="webeditor_select")||(children[A].className=="webeditor_select_selected")||(children[A].className=="webeditor_select_disabled")){children[A].onchange=webeditor_select;webeditor_select_init(children[A])}}}var contenteditable_focused_fix=false;function webeditor_onfocus(){contenteditable_focused_fix=contenteditable_focused;if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(webeditor.handling_event){return }try{var A=contenteditable_focused_iframe();if((typeof (webeditor_custom_onfocus)!="undefined")&&A&&A.id){webeditor_custom_onfocus(A.id)}}catch(B){}}function webeditor_onblur(){contenteditable_focused_fix=false;if(webeditor.handling_event){return }try{if(webeditor_custom_onblur){webeditor_custom_onblur(contenteditable_focused_iframe().id)}}catch(E){}if(webeditor&&webeditor.content2textareaOnBlur&&(!contenteditable_viewsource_status[contenteditable_focused])){var B=contenteditable_focused_iframe();var C=B;while((C.tagName!="FORM")&&(C.tagName!="HTML")){C=C.parentNode}var A=false;if(C.tagName!="HTML"){A=C[B.id]}if(!A){A=document.getElementById(B.id+"_textarea")}if(A){if(webeditor.textarea_content[B.id]!=B.contentWindow.document.body.innerHTML){webeditor.textarea_content[B.id]=B.contentWindow.document.body.innerHTML;var D=B.contentWindow.document.body.innerHTML;if(webeditor.formatcontent){D=contenteditable_formatContent(B.contentWindow.document.body)}if(webeditor.autoclean){D=cleanContentSub(D,webeditor.autocleanAllHTML,webeditor.autocleanAllXML,webeditor.autocleanAllNamespace,webeditor.autocleanAllLang,webeditor.autocleanAllClass,webeditor.autocleanAllStyle,webeditor.autocleanEmptySpan,webeditor.autocleanAllSpan,webeditor.autocleanEmptyFont,webeditor.autocleanAllFont,webeditor.autocleanAllDelIns,webeditor.autocleanEmptyPDiv,webeditor.autocleanAllFormatTags,webeditor.autocleanAllMsoClass,webeditor.autocleanAllMsoStyle,webeditor.autocleanAllMsoConditional,webeditor.autocleanEmptyStyle)}D=contenteditable_decodeScriptTags(D);if(webeditor.replace){D=contenteditable_doReplace(D,webeditor.replace)}try{if(webeditor_custom_decode){D=webeditor_custom_decode(D)}}catch(E){}try{if(webeditor_custom_finalize){D=webeditor_custom_finalize(D)}}catch(E){}D=contenteditable_merge_content(B.id,D);A.value=D;if(A.value!=D){A.innerText=D}}}}}function webeditor_refreshToolbar(B,G){if(webeditor.refreshToolbar==false){return }var I=contenteditable_selection();var D=contenteditable_selection_range(I);if(!D){if(webeditor.refreshToolbarTimeout){clearTimeout(webeditor.refreshToolbarTimeout)}webeditor.refreshToolbarTimeout=null;webeditor.refreshToolbarTimeout=setTimeout(webeditor_refreshToolbar,100);return false}if(webeditor.refreshToolbarTimeout){clearTimeout(webeditor.refreshToolbarTimeout)}webeditor.refreshToolbarTimeout=null;var C=contenteditable_selection_range_parentNode(D);if((!D)||(C&&C.ownerDocument&&C.ownerDocument.body&&(C.ownerDocument.body.className!="WebEditor"))){webeditor.refreshToolbarTimeout=setTimeout(webeditor_refreshToolbar,100);return false}else{var E=(new Date()).getTime();if((B==true)||((typeof (contenteditable_selection_range_parentNode)!="undefined")&&(contenteditable_selection_range_parentNode()!=webeditor.contenteditable_selection_range_parentNode))){webeditor.contenteditable_selection_range_parentNode=contenteditable_selection_range_parentNode();var H=contenteditable_toolbar(true);webeditor_refreshToolbar_buttons(H);webeditor_refreshToolbar_inputs(H);webeditor_refreshToolbar_DOM_inspector();try{if(webeditor_custom_refresh){webeditor_event_handled=webeditor_custom_refresh()}}catch(F){}}var A=(new Date()).getTime();if(!G){G=(A-E)*10}if(G<100){G=100}if(webeditor.refreshToolbarTimeout){clearTimeout(webeditor.refreshToolbarTimeout)}webeditor.refreshToolbarTimeout=setTimeout(webeditor_refreshToolbar,G)}}function webeditor_refreshToolbar_buttons(G){var E=contenteditable_positionable();var H=contenteditable_isTable();var J=contenteditable_isTableCaption();var I=contenteditable_isRow();var D=contenteditable_isCell();var B=G.getElementsByTagName("IMG");for(var C=0;C<B.length;C++){try{if((B[C].className=="webeditor_icon")||(B[C].className=="webeditor_icon_selected")||(B[C].className=="webeditor_icon_disabled")||(B[C].className=="webeditor_icon_mousedown")||(B[C].className=="webeditor_icon_mouseup")){if(contenteditable_viewsource_status[contenteditable_focused]){switch(B[C].id){case"viewsource":if(B[C].className!="webeditor_icon_selected"){B[C].className="webeditor_icon_selected";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_selected"}}break;case"help":case"preview":case"print":case"save":if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}break;default:if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}break}}else{switch(B[C].id){case"viewsource":if(contenteditable_viewsource_status[contenteditable_focused]){if(B[C].className!="webeditor_icon_selected"){B[C].className="webeditor_icon_selected";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_selected"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"bold":case"italic":case"underline":case"strikethrough":case"superscript":case"subscript":case"justifyleft":case"justifyright":case"justifycenter":case"justifyfull":case"BlockDirLTR":case"BlockDirRTL":try{var A=contenteditable_focused_document().queryCommandState(B[C].id);if(A){if(B[C].className!="webeditor_icon_selected"){B[C].className="webeditor_icon_selected";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_selected"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}}catch(F){if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"insertunorderedlist":var A=contenteditable_formatblock_query().toLowerCase();if((A=="ul")||(A=="bulleted list")){if(B[C].className!="webeditor_icon_selected"){B[C].className="webeditor_icon_selected";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_selected"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"insertorderedlist":var A=contenteditable_formatblock_query().toLowerCase();if((A=="ol")||(A=="numbered list")){if(B[C].className!="webeditor_icon_selected"){B[C].className="webeditor_icon_selected";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_selected"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"tableproperties":case"insertcaption":if(!H){if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"deleterow":if((!I)&&(!J)){if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"rowproperties":case"insertrowhead":case"insertrowfoot":case"insertrowabove":case"insertrowbelow":if(!I){if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"splitcellrows":case"columnproperties":case"insertcolumnleft":case"insertcolumnright":case"deletecolumn":case"splitcellcolumns":case"cellproperties":case"insertcellleft":case"insertcellright":case"deletecell":case"splitcell":if(!D){if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"mergecells":if(!contenteditable_selection_container("table")){if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"nobr":if(contenteditable_selection_container("nobr")){if(B[C].className!="webeditor_icon_selected"){B[C].className="webeditor_icon_selected";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_selected"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"viewdetails":if(contenteditable_viewdetails_status[contenteditable_focused]){if(B[C].className!="webeditor_icon_selected"){B[C].className="webeditor_icon_selected";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_selected"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"position":case"forwards":case"backwards":case"front":case"back":case"abovetext":case"belowtext":if(!E){if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"box":if(contenteditable_selection_container("span")||contenteditable_selection_container("font")||contenteditable_selection_container("strong")||contenteditable_selection_container("em")||contenteditable_selection_container("u")){if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"import":if((webeditor.language=="")||(webeditor.language=="html")){if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"spellcheck":if((webeditor.language=="")||(webeditor.language=="html")){if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}else{if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}break;case"imagemap":if(contenteditable_selection_container("img")){if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}else{if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}break;case"createlink":case"mailto":if(contenteditable_selection_container("a")||(!contenteditable_selection_contains("a"))){if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}}else{if(B[C].className!="webeditor_icon_disabled"){B[C].className="webeditor_icon_disabled";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon_disabled"}}}break;default:if(B[C].className!="webeditor_icon"){B[C].className="webeditor_icon";if(B[C].parentNode.nodeName=="SPAN"){B[C].parentNode.className="webeditor_icon"}}break}}}}catch(F){}}}function webeditor_refreshToolbar_inputs(N){var C;if(webeditor.WYSIWYGselect){C=N.getElementsByTagName("INPUT")}else{C=N.getElementsByTagName("SELECT")}for(var J=0;J<C.length;J++){if((C[J].className=="webeditor_select")||(C[J].className=="webeditor_select_disabled")){if(contenteditable_viewsource_status[contenteditable_focused]){if(C[J].className!="webeditor_select_disabled"){C[J].className="webeditor_select_disabled"}if(C[J].disabled!=true){C[J].disabled=true}}else{if(C[J].className!="webeditor_select"){C[J].className="webeditor_select"}if(C[J].disabled!=false){C[J].disabled=false}switch(C[J].id){case"fontname":case"fontsize":try{var A=(""+contenteditable_querycommand_value(C[J].id,contenteditable_focused_document().queryCommandValue(C[J].id))).toLowerCase();if(webeditor.WYSIWYGselect){var E="";for(var B in webeditor_dropdown_options[C[J].id]){if(typeof (webeditor_dropdown_options[C[J].id][B])!="function"){if(A.toLowerCase()==webeditor_dropdown_options[C[J].id][B].toLowerCase()){E=B;break}else{if(webeditor_dropdown_options[C[J].id][B].toLowerCase().match(new RegExp("^"+A.toLowerCase()+","))){E=B;break}else{if(webeditor_dropdown_options[C[J].id][B].toLowerCase().match(new RegExp(", "+A.toLowerCase()+","))){E=B;break}}}}}if((C[J].value!=A)&&(!webeditor.select_focused[C[J].id])){if(E=="&nbsp;"){C[J].value=""}else{C[J].value=HtmlDecode(E)}}if((C[J].value=="")&&(webeditor["default_"+C[J].id])){C[J].value=webeditor["default_"+C[J].id]}}else{var O=0;for(var H=0;H<C[J].options.length;H++){if(A.toLowerCase()==C[J].options[H].value.toLowerCase()){O=H;break}}if((C[J].selectedIndex!=O)&&(!webeditor.select_focused[C[J].id])){C[J].selectedIndex=O}}}catch(L){}break;case"formatblock":try{var M=contenteditable_formatblock_query();var A="<"+M+">";if(A=="<normal>"){A="<p>"}else{if(A=="<formatted>"){A="<pre>"}else{if(A=="<heading 1>"){A="<h1>"}else{if(A=="<heading 2>"){A="<h2>"}else{if(A=="<heading 3>"){A="<h3>"}else{if(A=="<heading 4>"){A="<h4>"}else{if(A=="<heading 5>"){A="<h5>"}else{if(A=="<heading 6>"){A="<h6>"}else{if(A=="<numbered list>"){A="<ol>"}else{if(A=="<bulleted list>"){A="<ul>"}else{if(A=="<directory list>"){A="<dir>"}else{if(A=="<menu list>"){A="<menu>"}else{if(A=="<definition term>"){A="<dt>"}else{if(A=="<definition>"){A="<dd>"}}}}}}}}}}}}}}if(webeditor.WYSIWYGselect){var E="";for(var B in webeditor_dropdown_options[C[J].id]){if(typeof (webeditor_dropdown_options[C[J].id][B])!="function"){if(A.toLowerCase()==webeditor_dropdown_options[C[J].id][B].toLowerCase()){E=B;break}if(M.toLowerCase()==B.toLowerCase()){E=B;break}}}if((C[J].value!=A)&&(!webeditor.select_focused[C[J].id])){if(E=="&nbsp;"){C[J].value=""}else{C[J].value=HtmlDecode(E)}}if((C[J].value=="")&&(webeditor["default_"+C[J].id])){C[J].value=webeditor["default_"+C[J].id]}}else{var O=0;for(var H=0;H<C[J].options.length;H++){if(A.toLowerCase()==C[J].options[H].value.toLowerCase()){O=H;break}if(M.toLowerCase()==C[J].options[H].text.toLowerCase()){O=H;break}}if((C[J].selectedIndex!=O)&&(!webeditor.select_focused[C[J].id])){C[J].selectedIndex=O}}}catch(L){}break;case"formatclass":try{webeditor_refreshStylesheet(contenteditable_focused_document());var M=contenteditable_formatclass_query();var A="<"+M+">";if(webeditor.WYSIWYGselect){var E="";var F=webeditor.stylesheetclassnames;if((!F)&&parent.webeditor){F=parent.webeditor.stylesheetclassnames}var D=webeditor.stylesheetclassvalues;if((!D)&&parent.webeditor){D=parent.webeditor.stylesheetclassvalues}if(F&&D){for(var H in F){if(typeof (F[H])!="function"){var K=F[H];var G=D[K];if(K){if(A.toLowerCase()==G.toLowerCase()){E=K;break}if(M.toLowerCase()==G.toLowerCase()){E=K;break}if(M.toLowerCase()==K.toLowerCase()){E=K;break}}}}}if((C[J].value!=E)&&(!webeditor.select_focused[C[J].id])){if(E=="&nbsp;"){C[J].value=""}else{C[J].value=HtmlDecode(E)}}if((C[J].value=="")&&(webeditor["default_"+C[J].id])){C[J].value=webeditor["default_"+C[J].id]}}else{var O=0;var E=1;var F=webeditor.stylesheetclassnames;if((!F)&&parent.webeditor){F=parent.webeditor.stylesheetclassnames}var D=webeditor.stylesheetclassvalues;if((!D)&&parent.webeditor){D=parent.webeditor.stylesheetclassvalues}if(F&&D){for(var H in F){if(typeof (F[H])!="function"){var K=F[H];var G=D[K];if(K){if((!C[J].options[E])||(C[J].options[E].value!=G)){var I=new Option(K,G,false,false);C[J].options[E]=I}if(A.toLowerCase()==C[J].options[E].value.toLowerCase()){O=E}if(M.toLowerCase()==C[J].options[E].value.toLowerCase()){O=E}if(M.toLowerCase()==C[J].options[E].text.toLowerCase()){O=E}E++}}}}for(var H=C[J].options.length;H>E;H--){C[J].options[H-1]=null}if((C[J].selectedIndex!=O)&&(!webeditor.select_focused[C[J].id])){C[J].selectedIndex=O}}}catch(L){}break}}}}var C=N.getElementsByTagName("INPUT");for(var J=0;J<C.length;J++){if((C[J].className=="webeditor_input")||(C[J].className=="webeditor_input_disabled")){if(contenteditable_viewsource_status[contenteditable_focused]){if(C[J].className!="webeditor_input_disabled"){C[J].className="webeditor_input_disabled"}if(C[J].disabled!=true){C[J].disabled=true}}else{if(C[J].className!="webeditor_input"){C[J].className="webeditor_input"}if(C[J].disabled!=false){C[J].disabled=false}}}}}function webeditor_refreshToolbar_DOM_inspector(){var D;if(D=contenteditable_focused_iframe()){if(DOM_inspector=document.getElementById("webeditor_DOM_inspector_"+D.id)||document.getElementById("webeditor_DOM_inspector")){if((parentnode=contenteditable_selection_container())&&(!contenteditable_viewsource_status[contenteditable_focused])){contenteditable_dragdrop_fix(parentnode);var A="";if(parentnode&&parentnode.attributes&&(parentnode.nodeName!="BODY")){A=contenteditable_node_attributes(parentnode)}var F=0;var B="";for(var E=parentnode;(E&&(E.nodeType==1));E=E.parentNode){if((E.nodeName!="HTML")&&(E.nodeName!="BODY")&&(E.nodeName!="HEAD")&&(E.nodeName!="BASE")){if(B){B=" > "+B}B="</a>"+B;B=E.nodeName+B;B='<a href="javascript:webeditor_DOMselect('+F+",'"+E.nodeName+"','"+D.id+"');\">"+B}else{if((E.nodeName!="HEAD")&&(E.nodeName!="BASE")){if(B){B=" > "+B}B=E.nodeName+B}}F++}if(B){switch(parentnode.nodeName){case"HTML":case"BODY":case"TABLE":case"THEAD":case"TBODY":case"TFOOT":case"TR":case"TD":case"OL":case"UL":case"LI":remove="";break;default:remove='<a style="color: red;" href="javascript:webeditor_remove_parentnode(\''+D.id+"');\">"+Text("dominspector_remove")+"</a>";break}var C=B;if(A){C+=" "+A}if(remove){C+=" &lt;&lt;&lt; "+remove}if(DOM_inspector.HardCoreDOMInspectorInnerHTML!=C){DOM_inspector.HardCoreDOMInspectorInnerHTML=C;DOM_inspector.innerHTML=C}}}else{if(DOM_inspector.HardCoreDOMInspectorInnerHTML!="&nbsp;"){DOM_inspector.HardCoreDOMInspectorInnerHTML="&nbsp;";DOM_inspector.innerHTML="&nbsp;"}}}}}function webeditor_refreshStylesheet(C){var B=contenteditable_stylesheet[contenteditable_focused_iframe().id];if((!webeditor.stylesheetclassnames)||(!webeditor.stylesheetclassnames.length)||(webeditor.stylesheetclasshref!=B)){webeditor.stylesheetclassnames=new Array();webeditor.stylesheetclassvalues=new Array();webeditor.stylesheetcolours=new Array();if(C.styleSheets.length){for(var A=0;A<C.styleSheets.length;A++){if((B!="")&&(C.styleSheets[A].href.indexOf(B)>=0)&&((C.styleSheets[A].id=="stylesheet")||(!C.styleSheets[A].id))){var D=contenteditable_document_stylesheets_cssrules(C.styleSheets[A]);webeditor_refreshStylesheet_cssRules(D);webeditor.stylesheetclasshref=B}}}webeditor.stylesheetclassnames=webeditor.stylesheetclassnames.sort()}}function webeditor_refreshStylesheet_cssRules(H){if(H.length){for(var G=0;G<H.length;G++){if(H[G].selectorText){var I=H[G].selectorText.split(",");var A=H[G].selectorText;for(var C in I){if(typeof (I[C])!="function"){A=I[C];if(A.match(new RegExp("^.*\\.([-a-zA-Z0-9_]*).*$"))){var E=A.replace(/^.*\.([-a-zA-Z0-9_]*).*$/,"$1");var D=E;try{if(webeditor_custom_formatclass_option){E=webeditor_custom_formatclass_option(E)}}catch(F){}if(E&&D&&(!webeditor.stylesheetclassvalues[E])){webeditor.stylesheetclassnames[webeditor.stylesheetclassnames.length]=E;webeditor.stylesheetclassvalues[E]=D}}}}for(var B in H[G].style){if(typeof (H[G].style[B])!="function"){if(((B=="color")||(B=="backgroundColor"))&&(H[G].style[B]!="")){webeditor_refreshStylesheet_cssRules_colour(H[G].style[B])}}}if(H[G].style.getPropertyValue){webeditor_refreshStylesheet_cssRules_colour(H[G].style.getPropertyValue("color"));webeditor_refreshStylesheet_cssRules_colour(H[G].style.getPropertyValue("background-color"))}else{if((typeof (H[G].style.color)=="string")&&(typeof (H[G].style.backgroundColor)=="string")){webeditor_refreshStylesheet_cssRules_colour(H[G].style.color);webeditor_refreshStylesheet_cssRules_colour(H[G].style.backgroundColor)}else{if((H[G].style.getAttribute)&&(webeditor.useCssStyleGetAttribute)){webeditor_refreshStylesheet_cssRules_colour(H[G].style.getAttribute("color"));webeditor_refreshStylesheet_cssRules_colour(H[G].style.getAttribute("backgroundColor"))}}}if(H[G].style.cssText.match(new RegExp("[^a-z]background-color:\\s([^;]+);"))){webeditor_refreshStylesheet_cssRules_colour(RegExp.$1)}if(H[G].style.cssText.match(new RegExp("[^a-z]color:\\s([^;]+);"))){webeditor_refreshStylesheet_cssRules_colour(RegExp.$1)}}else{if(H[G].cssRules){webeditor_refreshStylesheet_cssRules(H[G].cssRules)}}}}}function webeditor_refreshStylesheet_cssRules_colour(B){if(!B){return }if(webeditor.stylesheetcolours){for(var A=0;A<=webeditor.stylesheetcolours.length;A++){if(A==webeditor.stylesheetcolours.length){webeditor.stylesheetcolours[webeditor.stylesheetcolours.length]=B;break}else{if(webeditor.stylesheetcolours[A]==B){break}}}}}function webeditor_select_parentnode(A,B,C){return webeditor_DOMselect(A,B,C)}function webeditor_DOMselect(B,D,F){contenteditable_selection_fix();if((iframe=contenteditable_focused_iframe())&&((iframe.id==F)||(!F))){var A=contenteditable_selection_container();var E=0;for(var C=A;(C&&(C.nodeType==1));C=C.parentNode){if(E==B){if(C.nodeName==D){contenteditable_selection_node(C)}else{if(C.firstChild&&C.firstChild.nodeName==D){contenteditable_selection_node(C.firstChild)}}if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}E++}webeditor_refreshToolbar(true)}}function webeditor_remove_parentnode(A){contenteditable_selection_fix();if((iframe=contenteditable_focused_iframe())&&((iframe.id==A)||(!A))){if(node=contenteditable_selection_container()){switch(node.nodeName){case"HTML":case"BODY":case"TABLE":case"THEAD":case"TBODY":case"TFOOT":case"TR":case"TD":case"OL":case"UL":case"LI":break;default:contenteditable_remove_parentnode(node);webeditor_refreshToolbar(true);if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}break}}}}function webeditor_event(A){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}var C=(A)?A:((event)?event:null);if(C&&(C.type!="mouseup")){if(typeof (webeditor_menu_hide)!="undefined"){webeditor_menu_hide()}}if(webeditor.disabled){contenteditable_event_stop(C);return }webeditor.selection_node="";contenteditable_undo_init();var B=false;try{if(webeditor_custom_event){B=webeditor_custom_event(C)}}catch(D){}if(!B){contenteditable_event_paste(C);contenteditable_event_enter(C);contenteditable_event_delete(C);contenteditable_event_dragdrop(C)}if(webeditor.refreshToolbarTimeout){clearTimeout(webeditor.refreshToolbarTimeout)}webeditor.refreshToolbarTimeout=setTimeout(webeditor_refreshToolbar,100)}function webeditor_button_mousedown(){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }if(this.className!="webeditor_button_disabled"){this.className="webeditor_button_mousedown"}}function webeditor_button_mouseup(){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }if(this.className!="webeditor_button_disabled"){this.className="webeditor_button_mouseup"}}function webeditor_button_mouseout(){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }webeditor.handling_event=false;if(this.className!="webeditor_button_disabled"){this.className="webeditor_button"}if(webeditor.refreshToolbarTimeout){clearTimeout(webeditor.refreshToolbarTimeout)}webeditor.refreshToolbarTimeout=setTimeout(webeditor_refreshToolbar,100)}function webeditor_button_mouseover(){webeditor_menu_hide();if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(this.className!="webeditor_button_disabled"){this.className="webeditor_button_mouseover"}webeditor.handling_event=true}function webeditor_icon_mousedown(){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }if(this.className!="webeditor_icon_disabled"){this.className="webeditor_icon_mousedown";if(this.parentNode.nodeName=="SPAN"){this.parentNode.className="webeditor_icon_mousedown"}}return false}function webeditor_icon_mouseup(){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }if(this.className!="webeditor_icon_disabled"){this.className="webeditor_icon_mouseup";if(this.parentNode.nodeName=="SPAN"){this.parentNode.className="webeditor_icon_mouseup"}}}function webeditor_icon_mouseout(){if((typeof (webeditor)=="undefined")||(!webeditor)){return }if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }webeditor.handling_event=false;if((this.className!="webeditor_icon_disabled")&&(this.className!="webeditor_icon_selected")){this.className="webeditor_icon";if(this.parentNode.nodeName=="SPAN"){this.parentNode.className="webeditor_icon"}}if(webeditor.refreshToolbarTimeout){clearTimeout(webeditor.refreshToolbarTimeout)}if(typeof (webeditor_refreshToolbar)!="undefined"){webeditor.refreshToolbarTimeout=setTimeout(webeditor_refreshToolbar,100)}}function webeditor_icon_mouseover(){if((typeof (webeditor)=="undefined")||(!webeditor)){return }webeditor_menu_hide();if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }if((this.className!="webeditor_icon_disabled")&&(this.className!="webeditor_icon_selected")){this.className="webeditor_icon_mouseover";if(this.parentNode.nodeName=="SPAN"){this.parentNode.className="webeditor_icon_mouseover"}}webeditor.handling_event=true}function webeditor_menu_mousedown(){if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }if(this.className!="webeditor_menu_disabled"){this.className="webeditor_menu_mousedown"}return false}function webeditor_menu_mouseup(){if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }if(this.className!="webeditor_menu_disabled"){this.className="webeditor_menu_mouseup"}}function webeditor_menu_mouseout(){if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }if((typeof (webeditor)=="undefined")||(!webeditor)){return }if((this.className!="webeditor_menu_disabled")&&(this.className!="webeditor_menu")){this.className="webeditor_menu"}}function webeditor_menu_mouseover(A){if((typeof (webeditor)=="undefined")||(!webeditor)){return }if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }if(A){if((A.className!="webeditor_menu_disabled")&&(A.className!="webeditor_menu_mouseover")){A.className="webeditor_menu_mouseover"}}if((this.className!="webeditor_menu_disabled")&&(this.className!="webeditor_menu_mouseover")){this.className="webeditor_menu_mouseover"}if(this.className!="webeditor_menu"){webeditor_submenu_hide()}}function webeditor_submenu_mouseout(){if((typeof (webeditor)=="undefined")||(!webeditor)){return }if(webeditor_submenu_parent){webeditor_submenu_parent.className="webeditor_menu"}if(this.className!="webeditor_menu_disabled"){this.className="webeditor_menu"}}function webeditor_submenu_mouseover(){if((typeof (webeditor)=="undefined")||(!webeditor)){return }if(webeditor_submenu_parent){webeditor_submenu_parent.className="webeditor_menu_mouseover"}if(this.className!="webeditor_menu_disabled"){this.className="webeditor_menu_mouseover"}var A=document.getElementById("submenu_dropdown");if(A&&A.name){var B=document.getElementById(A.name);if(B){B.className="webeditor_menu_mouseover"}}}function webeditor_click(){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(typeof (webeditor_menu_hide)!="undefined"){webeditor_menu_hide()}if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }contenteditable_focus_toolbar(this);if(this.className=="webeditor_icon_disabled"){return }if(this.className=="webeditor_menu_disabled"){return }webeditor_menu_hide();if(!webeditor_supported(this.id)){return }var custom_function;try{custom_function=eval("webeditor_custom_"+this.id)}catch(e){custom_function=null}if(custom_function){try{contenteditable_undo_save();eval("webeditor_custom_"+this.id+"()");contenteditable_undo_save()}catch(e){}}else{if(this.id=="help"){webeditor_help()}else{if(this.id=="preview"){contenteditable_preview()}else{if(this.id=="print"){if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}if(!contenteditable_print(this.id)){alert(Text("print_alert"))}if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="save"){contenteditable_save()}else{if(this.id=="viewsource"){contenteditable_undo_save();contenteditable_viewsource(this.checked);contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(contenteditable_viewsource_status[contenteditable_focused]){}else{if(this.id=="specialcharacter"){webeditor_specialcharacter()}else{if(this.id=="createtable"){webeditor_createtable()}else{if(this.id=="selecttable"){contenteditable_selecttable()}else{if(this.id=="selectrow"){contenteditable_selectrow()}else{if(this.id=="selectcolumn"){contenteditable_selectcolumn()}else{if(this.id=="selectcell"){contenteditable_selectcell()}else{if(this.id=="tableproperties"){webeditor_tableproperties()}else{if(this.id=="rowproperties"){webeditor_rowproperties()}else{if(this.id=="columnproperties"){webeditor_columnproperties()}else{if(this.id=="cellproperties"){webeditor_cellproperties()}else{if(this.id=="insertcaption"){contenteditable_undo_save();contenteditable_insertcaption();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="insertrowhead"){contenteditable_undo_save();contenteditable_insertrowhead();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="insertrowfoot"){contenteditable_undo_save();contenteditable_insertrowfoot();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="insertrowabove"){contenteditable_undo_save();contenteditable_insertrowabove();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="insertrowbelow"){contenteditable_undo_save();contenteditable_insertrowbelow();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="deleterow"){contenteditable_undo_save();contenteditable_deleterow();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="insertcolumnleft"){contenteditable_undo_save();contenteditable_insertcolumnleft();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="insertcolumnright"){contenteditable_undo_save();contenteditable_insertcolumnright();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="deletecolumn"){contenteditable_undo_save();contenteditable_deletecolumn();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="insertcellleft"){contenteditable_undo_save();contenteditable_insertcellleft();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="insertcellright"){contenteditable_undo_save();contenteditable_insertcellright();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="deletecell"){contenteditable_undo_save();contenteditable_deletecell();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="mergecells"){contenteditable_undo_save();contenteditable_mergecells();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="splitcell"){contenteditable_undo_save();contenteditable_splitcell();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="splitcellrows"){contenteditable_undo_save();contenteditable_splitcellrows();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="splitcellcolumns"){contenteditable_undo_save();contenteditable_splitcellcolumns();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="insertmedia"){webeditor_insertmedia()}else{if(this.id=="insertimage"){webeditor_insertmedia()}else{if(this.id=="insertflash"){webeditor_insertmedia()}else{if(this.id=="insertapplet"){webeditor_insertmedia()}else{if(this.id=="insertquicktime"){webeditor_insertmedia()}else{if(this.id=="insertvideo"){webeditor_insertmedia()}else{if(this.id=="insertaudio"){webeditor_insertmedia()}else{if(this.id=="imagemap"){webeditor_imagemap()}else{if(this.id=="createlink"){webeditor_createlink()}else{if(this.id=="mailto"){webeditor_mailto()}else{if(this.id=="backcolor"){webeditor_backcolor()}else{if(this.id=="forecolor"){webeditor_forecolor()}else{if(this.id=="form"){webeditor_form()}else{if(this.id=="button"){webeditor_button()}else{if(this.id=="submitbutton"){webeditor_submitbutton()}else{if(this.id=="resetbutton"){webeditor_resetbutton()}else{if(this.id=="backbutton"){webeditor_backbutton()}else{if(this.id=="imagebutton"){webeditor_imagebutton()}else{if(this.id=="text"){webeditor_text()}else{if(this.id=="password"){webeditor_password()}else{if(this.id=="textarea"){webeditor_textarea()}else{if(this.id=="checkbox"){webeditor_checkbox()}else{if(this.id=="radio"){webeditor_radio()}else{if(this.id=="select"){webeditor_selectlist()}else{if(this.id=="hidden"){webeditor_hidden()}else{if(this.id=="file"){webeditor_file()}else{if(this.id=="clean"){webeditor_clean()}else{if(this.id=="position"){contenteditable_undo_save();contenteditable_position();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="forwards"){contenteditable_undo_save();contenteditable_forwards();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="backwards"){contenteditable_undo_save();contenteditable_backwards();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="front"){contenteditable_undo_save();contenteditable_front();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="back"){contenteditable_undo_save();contenteditable_back();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="abovetext"){contenteditable_undo_save();contenteditable_abovetext();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="belowtext"){contenteditable_undo_save();contenteditable_belowtext();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="box"){webeditor_box()}else{if(this.id=="iframe"){webeditor_iframe()}else{if(this.id=="import"){webeditor_import()}else{if(this.id=="spellcheck"){contenteditable_spellcheck()}else{if(this.id=="nobr"){contenteditable_undo_save();contenteditable_nobr();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="anchor"){webeditor_anchor()}else{if(this.id=="printbreak"){contenteditable_undo_save();contenteditable_printbreak();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="undo"){if(webeditor.undo!=false){contenteditable_undo()}else{contenteditable_execcommand("undo")}if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="redo"){if(webeditor.undo!=false){contenteditable_redo()}else{contenteditable_execcommand("redo")}if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="viewdetails"){contenteditable_undo_save();contenteditable_viewdetails(this.checked);if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="find"){if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}if(!contenteditable_find(this.id)){alert(Text("find_alert"))}}else{if(this.id=="cut"){contenteditable_undo_save();if(webeditor.clipboard){webeditor.clipboardHTML=contenteditable_getContentSelection()}if(!contenteditable_execcommand(this.id)){alert(Text("cut_alert"))}contenteditable_webeditor_clipboard_cut();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="copy"){if(webeditor.clipboard){webeditor.clipboardHTML=contenteditable_getContentSelection()}if(!contenteditable_execcommand(this.id)){alert(Text("copy_alert"))}contenteditable_webeditor_clipboard_copy();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="paste"){if(contenteditable_webeditor_clipboard_paste()){contenteditable_paste_replacement_fix()}else{if(!contenteditable_execcommand(this.id)){alert(Text("paste_alert"))}}if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="saveas"){if(!contenteditable_execcommand(this.id)){alert(Text("saveas_alert"))}if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="removeformat"){contenteditable_undo_save();contenteditable_execcommand(this.id);contenteditable_removeformat();contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="selectall"){contenteditable_selection_all();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="BlockDirLTR"){contenteditable_BlockDirLTR(this.id);if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="BlockDirRTL"){contenteditable_BlockDirRTL(this.id);if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(this.id=="inserthorizontalrule"){contenteditable_undo_save();var mycontainer;if(mycontainer=contenteditable_selection_container("p")){mycontainer.parentElement.insertBefore(contenteditable_focused_document().createElement("hr"),mycontainer)}else{if(mycontainer=contenteditable_selection_container("h1")){mycontainer.parentElement.insertBefore(contenteditable_focused_document().createElement("hr"),mycontainer)}else{if(mycontainer=contenteditable_selection_container("h2")){mycontainer.parentElement.insertBefore(contenteditable_focused_document().createElement("hr"),mycontainer)}else{if(mycontainer=contenteditable_selection_container("h3")){mycontainer.parentElement.insertBefore(contenteditable_focused_document().createElement("hr"),mycontainer)}else{if(mycontainer=contenteditable_selection_container("h4")){mycontainer.parentElement.insertBefore(contenteditable_focused_document().createElement("hr"),mycontainer)}else{if(mycontainer=contenteditable_selection_container("h5")){mycontainer.parentElement.insertBefore(contenteditable_focused_document().createElement("hr"),mycontainer)}else{if(mycontainer=contenteditable_selection_container("h6")){mycontainer.parentElement.insertBefore(contenteditable_focused_document().createElement("hr"),mycontainer)}else{if(mycontainer=contenteditable_selection_container("address")){mycontainer.parentElement.insertBefore(contenteditable_focused_document().createElement("hr"),mycontainer)}else{contenteditable_execcommand(this.id)}}}}}}}}contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{contenteditable_undo_save();contenteditable_execcommand(this.id);contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}if(webeditor.refreshToolbarTimeout){clearTimeout(webeditor.refreshToolbarTimeout)}webeditor.refreshToolbarTimeout=setTimeout(webeditor_refreshToolbar,100)}function webeditor_select(){var id=this.id;var value=this.value;if(!webeditor_supported(id)){return }if((id!="undo")&&(id!="redo")){contenteditable_undo_save()}if(id=="formatclass"){webeditor_select_focus();contenteditable_formatclass(id,value);if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}contenteditable_formatclass_fix()}else{if(id=="formatblock"){webeditor_select_focus();contenteditable_formatblock(id,value);if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(id=="fontname"){webeditor_select_focus();contenteditable_fontname(id,value);if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{if(id=="fontsize"){webeditor_select_focus();contenteditable_fontsize(id,value);if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{webeditor_select_focus();var custom_function;try{custom_function=eval("webeditor_custom_"+id)}catch(e){custom_function=null}if(custom_function){try{eval("webeditor_custom_"+id+"('"+value+"')")}catch(e){}}else{contenteditable_execcommand(id,value)}if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}}}}if((id!="undo")&&(id!="redo")){contenteditable_undo_save()}if(webeditor.refreshToolbarTimeout){clearTimeout(webeditor.refreshToolbarTimeout)}webeditor.refreshToolbarTimeout=setTimeout(webeditor_refreshToolbar,100)}function webeditor_select_deactivate(A){if(A&&A.target&&A.target.id){webeditor.select_focused[A.target.id]=false}if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}return true}function webeditor_select_blur(A){if(A&&A.target&&A.target.id&&webeditor){webeditor.select_focused[A.target.id]=false}return true}function webeditor_help(){if((typeof (webeditor.help_window)=="undefined")||(webeditor.help_window==null)||webeditor.help_window.closed){webeditor.help_window=window.open(webeditor.rootpath+"help2.html?editor=webeditor","help_window","scrollbars=yes,width=600,height=435,resizable=yes,status=yes",true)}if(webeditor.help_window){webeditor.help_window.focus()}}function webeditor_specialcharacter(){if((typeof (webeditor.specialcharacter_window)=="undefined")||(webeditor.specialcharacter_window==null)||webeditor.specialcharacter_window.closed){webeditor.specialcharacter_window=window.open(webeditor.rootpath+"specialcharacter.html?editor=webeditor","specialcharacter_window","scrollbars=yes,width=500,height=425,resizable=yes,status=yes",true)}if(webeditor.specialcharacter_window){webeditor.specialcharacter_window.focus()}}function webeditor_import(){if((typeof (webeditor.import_window)=="undefined")||(webeditor.import_window==null)||webeditor.import_window.closed){if(webeditor.language){webeditor.import_window=window.open(webeditor.rootpath+"import."+webeditor.language+"?editor=webeditor","import_window","scrollbars=yes,width=350,height=200,resizable=yes,status=yes",true);if(webeditor.import_window){webeditor.import_window.focus()}}else{}}}function webeditor_createtable(){if((typeof (webeditor.table_window)=="undefined")||(webeditor.table_window==null)||webeditor.table_window.closed){if(webeditor.language){webeditor.table_window=window.open(webeditor.rootpath+"table."+webeditor.language+"?editor=webeditor","table_window","scrollbars=yes,width=475,height=400,resizable=yes,status=yes",true)}else{webeditor.table_window=window.open(webeditor.rootpath+"table.html?editor=webeditor","table_window","scrollbars=yes,width=475,height=400,resizable=yes,status=yes",true)}}if(webeditor.table_window){webeditor.table_window.focus()}}function contenteditable_selecttable(){var A;if(A=contenteditable_isTable()){contenteditable_selection_node(A)}}function contenteditable_selectrow(){var A;if(A=contenteditable_isRow()){contenteditable_selection_node(A)}}function contenteditable_selectcolumn(){var I;var J;var H;if((H=contenteditable_isCell())&&(J=contenteditable_isRow())&&(I=contenteditable_isTable())){var B=contenteditable_adjustedCellColumns(I);var C=B[contenteditable_rowIndex(J)][contenteditable_cellIndex(H)];var G=0;for(var E=0;E<I.rows.length;E++){if(!G){var A=0;for(var D=0;((D<I.rows[E].cells.length)&&(A<=C));D++){A=B[E][D];if((A==C)||(A+contenteditable_cellColSpan(I.rows[E].cells[D])>C)){var F=I.rows[E].cells[D];G=contenteditable_cellRowSpan(I.rows[E].cells[D])-1}else{if((A+contenteditable_cellColSpan(I.rows[E].cells[D]))>C){G=contenteditable_cellRowSpan(I.rows[E].cells[D])-1}}A+=contenteditable_cellColSpan(I.rows[E].cells[D])}}else{G--}}}}function contenteditable_selectcell(){var A;if(A=contenteditable_isCell()){contenteditable_selection_node(A)}}function webeditor_tableproperties(){var I;if(I=contenteditable_isTable()){if((typeof (webeditor.tableproperties_window)=="undefined")||(webeditor.tableproperties_window==null)||webeditor.tableproperties_window.closed){var C=contenteditable_getAttribute(I,"border")||"";var B="";var H="";if(I.style){B=I.style.width.replace(/[^0-9%]/g,"")||contenteditable_getAttribute(I,"width")||"";H=I.style.height.replace(/[^0-9%]/g,"")||contenteditable_getAttribute(I,"height")||""}else{B=contenteditable_getAttribute(I,"width")||"";H=contenteditable_getAttribute(I,"height")||""}var F=contenteditable_getAttribute(I,"cellPadding")||"";var D=contenteditable_getAttribute(I,"cellSpacing")||"";var K=contenteditable_getAttribute(I,"bgColor")||"";var E=contenteditable_getAttribute(I,"borderColor")||"";var A=contenteditable_getAttribute(I,"background")||"";var G=contenteditable_getAttribute(I,"class")||"";var J=contenteditable_getAttribute(I,"id")||"";if(webeditor.language){webeditor.tableproperties_window=window.open(webeditor.rootpath+"tableproperties."+webeditor.language+"?editor=webeditor&border="+encodeURIComponent(C)+"&width="+encodeURIComponent(B)+"&height="+encodeURIComponent(H)+"&cellpadding="+encodeURIComponent(F)+"&cellspacing="+encodeURIComponent(D)+"&bgcolor="+encodeURIComponent(K)+"&bordercolor="+encodeURIComponent(E)+"&background="+encodeURIComponent(A)+"&htmlclass="+encodeURIComponent(G)+"&htmlid="+encodeURIComponent(J),"tableproperties_window","scrollbars=yes,width=475,height=400,resizable=yes,status=yes",true)}else{webeditor.tableproperties_window=window.open(webeditor.rootpath+"tableproperties.html?editor=webeditor&border="+encodeURIComponent(C)+"&width="+encodeURIComponent(B)+"&height="+encodeURIComponent(H)+"&cellpadding="+encodeURIComponent(F)+"&cellspacing="+encodeURIComponent(D)+"&bgcolor="+encodeURIComponent(K)+"&bordercolor="+encodeURIComponent(E)+"&background="+encodeURIComponent(A)+"&htmlclass="+encodeURIComponent(G)+"&htmlid="+encodeURIComponent(J),"tableproperties_window","scrollbars=yes,width=475,height=400,resizable=yes,status=yes",true)}}if(webeditor.tableproperties_window){webeditor.tableproperties_window.focus()}}}function webeditor_rowproperties(){var F;if(F=contenteditable_isRow()){if((typeof (webeditor.rowproperties_window)=="undefined")||(webeditor.rowproperties_window==null)||webeditor.rowproperties_window.closed){var H=contenteditable_getAttribute(F,"align")||"";var D=contenteditable_getAttribute(F,"vAlign")||"";var A=contenteditable_getAttribute(F,"bgColor")||"";var C=contenteditable_getAttribute(F,"borderColor")||"";var B=contenteditable_getAttribute(F,"background")||"";var E=contenteditable_getAttribute(F,"class")||"";var G=contenteditable_getAttribute(F,"id")||"";if(webeditor.language){webeditor.rowproperties_window=window.open(webeditor.rootpath+"rowproperties."+webeditor.language+"?editor=webeditor&align="+encodeURIComponent(H)+"&valign="+encodeURIComponent(D)+"&bgcolor="+encodeURIComponent(A)+"&bordercolor="+encodeURIComponent(C)+"&background="+encodeURIComponent(B)+"&htmlclass="+encodeURIComponent(E)+"&htmlid="+encodeURIComponent(G),"rowproperties_window","scrollbars=yes,width=475,height=375,resizable=yes,status=yes",true)}else{webeditor.rowproperties_window=window.open(webeditor.rootpath+"rowproperties.html?editor=webeditor&align="+encodeURIComponent(H)+"&valign="+encodeURIComponent(D)+"&bgcolor="+encodeURIComponent(A)+"&bordercolor="+encodeURIComponent(C)+"&background="+encodeURIComponent(B)+"&htmlclass="+encodeURIComponent(E)+"&htmlid="+encodeURIComponent(G),"rowproperties_window","scrollbars=yes,width=475,height=375,resizable=yes,status=yes",true)}}if(webeditor.rowproperties_window){webeditor.rowproperties_window.focus()}}}function webeditor_columnproperties(){var G;if(G=contenteditable_isCell()){if((typeof (webeditor.columnproperties_window)=="undefined")||(webeditor.columnproperties_window==null)||webeditor.columnproperties_window.closed){var B=contenteditable_getAttribute(G,"width")||"";var H=contenteditable_getAttribute(G,"height")||"";var D=contenteditable_getAttribute(G,"align")||"";var E=contenteditable_getAttribute(G,"vAlign")||"";var I=contenteditable_getAttribute(G,"bgColor")||"";var C=contenteditable_getAttribute(G,"borderColor")||"";var A=contenteditable_getAttribute(G,"background")||"";var F=contenteditable_getAttribute(G,"class")||"";if(webeditor.language){webeditor.columnproperties_window=window.open(webeditor.rootpath+"columnproperties."+webeditor.language+"?editor=webeditor&width="+encodeURIComponent(B)+"&height="+encodeURIComponent(H)+"&colspan=&align="+encodeURIComponent(D)+"&valign="+encodeURIComponent(E)+"&bgcolor="+encodeURIComponent(I)+"&bordercolor="+encodeURIComponent(C)+"&background="+encodeURIComponent(A)+"&htmlclass="+encodeURIComponent(F),"columnproperties_window","scrollbars=yes,width=475,height=475,resizable=yes,status=yes",true)}else{webeditor.columnproperties_window=window.open(webeditor.rootpath+"columnproperties.html?editor=webeditor&width="+encodeURIComponent(B)+"&height="+encodeURIComponent(H)+"&colspan=&align="+encodeURIComponent(D)+"&valign="+encodeURIComponent(E)+"&bgcolor="+encodeURIComponent(I)+"&bordercolor="+encodeURIComponent(C)+"&background="+encodeURIComponent(A)+"&htmlclass="+encodeURIComponent(F),"columnproperties_window","scrollbars=yes,width=475,height=475,resizable=yes,status=yes",true)}}if(webeditor.columnproperties_window){webeditor.columnproperties_window.focus()}}}function webeditor_cellproperties(){var I;if(I=contenteditable_isCell()){if((typeof (webeditor.cellproperties_window)=="undefined")||(webeditor.cellproperties_window==null)||webeditor.cellproperties_window.closed){var B=contenteditable_getAttribute(I,"width")||"";var J=contenteditable_getAttribute(I,"height")||"";var C=contenteditable_getAttribute(I,"colSpan")||"";var D=contenteditable_getAttribute(I,"rowSpan")||"";var F=contenteditable_getAttribute(I,"align")||"";var G=contenteditable_getAttribute(I,"vAlign")||"";var L=contenteditable_getAttribute(I,"bgColor")||"";var E=contenteditable_getAttribute(I,"borderColor")||"";var A=contenteditable_getAttribute(I,"background")||"";var H=contenteditable_getAttribute(I,"class")||"";var K=contenteditable_getAttribute(I,"id")||"";if(webeditor.language){webeditor.cellproperties_window=window.open(webeditor.rootpath+"cellproperties."+webeditor.language+"?editor=webeditor&width="+encodeURIComponent(B)+"&height="+encodeURIComponent(J)+"&colspan="+encodeURIComponent(C)+"&rowspan="+encodeURIComponent(D)+"&align="+encodeURIComponent(F)+"&valign="+encodeURIComponent(G)+"&bgcolor="+encodeURIComponent(L)+"&bordercolor="+encodeURIComponent(E)+"&background="+encodeURIComponent(A)+"&htmlclass="+encodeURIComponent(H)+"&htmlid="+encodeURIComponent(K),"cellproperties_window","scrollbars=yes,width=475,height=475,resizable=yes,status=yes",true)}else{webeditor.cellproperties_window=window.open(webeditor.rootpath+"cellproperties.html?editor=webeditor&width="+encodeURIComponent(B)+"&height="+encodeURIComponent(J)+"&colspan="+encodeURIComponent(C)+"&rowspan="+encodeURIComponent(D)+"&align="+encodeURIComponent(F)+"&valign="+encodeURIComponent(G)+"&bgcolor="+encodeURIComponent(L)+"&bordercolor="+encodeURIComponent(E)+"&background="+encodeURIComponent(A)+"&htmlclass="+encodeURIComponent(H)+"&htmlid="+encodeURIComponent(K),"cellproperties_window","scrollbars=yes,width=475,height=475,resizable=yes,status=yes",true)}}if(webeditor.cellproperties_window){webeditor.cellproperties_window.focus()}}}function webeditor_insertmedia(){var W="";var T="";var Z="";var R="";var P="";var I="";var N="";var V="";var F="";var D="";var H="";var Y="";var Q="";var U="";var X="";var K="";var J="";var B="";var C="";var M="";var E="";var L=contenteditable_selection_text();var G=""+L;var A=contenteditable_selection_container("img");if(A){U="image"}else{if(A=contenteditable_selection_container("video")){U="video"}else{if(A=contenteditable_selection_container("audio")){U="audio"}else{if(contenteditable_selection_contains("audio")){A=contenteditable_selection_container();A=contenteditable_getElementByTagName("audio");if(A){U="audio"}else{U="image"}}else{if(A=contenteditable_selection_container("object")){U="object"}}}}}if(U=="image"){contenteditable_selection_node(A);W=contenteditable_getAttribute(A,"src")||"";T=contenteditable_getAttribute(A,"border")||"";Z=contenteditable_getAttribute(A,"alt")||"";if(A.style){R=A.style.width.replace(/[^0-9%]/g,"")||contenteditable_getAttribute(A,"width")||"";P=A.style.height.replace(/[^0-9%]/g,"")||contenteditable_getAttribute(A,"height")||""}else{R=contenteditable_getAttribute(A,"width")||"";P=contenteditable_getAttribute(A,"height")||""}I=contenteditable_getAttribute(A,"vspace")||"";N=contenteditable_getAttribute(A,"hspace")||"";V=contenteditable_getAttribute(A,"align")||"";F=contenteditable_getAttribute(A,"onMouseOver")||"";D=contenteditable_getAttribute(A,"onMouseOut")||"";H=contenteditable_getAttribute(A,"useMap")||"";Q=contenteditable_getAttribute(A,"class")||"";Y=contenteditable_getAttribute(A,"id")||""}else{if(U=="video"){contenteditable_selection_node(A);W=contenteditable_getAttribute(A,"src")||"";if(A.style){R=A.style.width.replace(/[^0-9%]/g,"")||contenteditable_getAttribute(A,"width")||"";P=A.style.height.replace(/[^0-9%]/g,"")||contenteditable_getAttribute(A,"height")||""}else{R=contenteditable_getAttribute(A,"width")||"";P=contenteditable_getAttribute(A,"height")||""}Q=contenteditable_getAttribute(A,"class")||"";Y=contenteditable_getAttribute(A,"id")||"";K=contenteditable_getAttribute(A,"poster")||"";J=contenteditable_getAttribute(A,"preload")||"";B=contenteditable_getAttribute(A,"autoplay")||"";C=contenteditable_getAttribute(A,"controls")||"";M=contenteditable_getAttribute(A,"loop")||"";E=contenteditable_getAttribute(A,"muted")||"";if(!W){var O=contenteditable_getElementByTagName(A,"SOURCE",false);if(O){W=contenteditable_getAttribute(O,"src")||"";X=contenteditable_getAttribute(O,"type")||""}}}else{if(U=="audio"){contenteditable_selection_node(A);W=contenteditable_getAttribute(A,"src")||"";Q=contenteditable_getAttribute(A,"class")||"";Y=contenteditable_getAttribute(A,"id")||"";J=contenteditable_getAttribute(A,"preload")||"";B=contenteditable_getAttribute(A,"autoplay")||"";C=contenteditable_getAttribute(A,"controls")||"";M=contenteditable_getAttribute(A,"loop")||"";E=contenteditable_getAttribute(A,"muted")||"";if(!W){var O=contenteditable_getElementByTagName(A,"SOURCE",false);if(O){W=contenteditable_getAttribute(O,"src")||"";X=contenteditable_getAttribute(O,"type")||""}}if(!O){W=G.replace(/^(.*?)src="(.*?)"(.*)$/gi,"$2");Q=G.replace(/^(.*?)class="(.*?)"(.*)$/gi,"$2");Y=G.replace(/^(.*?)id="(.*?)"(.*)$/gi,"$2");J=G.replace(/^(.*?)preload="(.*?)"(.*)$/gi,"$2");B=G.replace(/^(.*?)autoplay="(.*?)"(.*)$/gi,"$2");C=G.replace(/^(.*?)controls="(.*?)"(.*)$/gi,"$2");M=G.replace(/^(.*?)loop="(.*?)"(.*)$/gi,"$2");E=G.replace(/^(.*?)muted="(.*?)"(.*)$/gi,"$2");W=G.replace(/^(.*?)src="(.*?)"(.*)$/gi,"$2");X=G.replace(/^(.*?)type="(.*?)"(.*)$/gi,"$2")}}else{if(U=="object"){if(contenteditable_getAttribute(A,"classid")=="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"){W="";for(var S=A.firstChild;S;S=S.nextSibling){if((S.nodeName=="PARAM")&&(contenteditable_getAttribute(S,"name").toLowerCase()=="movie")){W=contenteditable_getAttribute(S,"value")||""}}R=contenteditable_getAttribute(A,"width")||"";P=contenteditable_getAttribute(A,"height")||"";Q=contenteditable_getAttribute(A,"class")||"";Y=contenteditable_getAttribute(A,"id")||"";U="flash";contenteditable_selection_node(A)}else{if(contenteditable_getAttribute(A,"classid")=="clsid:CAFEEFAC-0014-0002-0000-ABCDEFFEDCBA"){W="";for(var S=A.firstChild;S;S=S.nextSibling){if((S.nodeName=="PARAM")&&(contenteditable_getAttribute(S,"name")=="codebase")){W=contenteditable_getAttribute(S,"value")+W}else{if((S.nodeName=="PARAM")&&(contenteditable_getAttribute(S,"name")=="code")){W=W+contenteditable_getAttribute(S,"value")||""}}}R=contenteditable_getAttribute(A,"width")||"";P=contenteditable_getAttribute(A,"height")||"";Q=contenteditable_getAttribute(A,"class")||"";Y=contenteditable_getAttribute(A,"id")||"";U="applet";contenteditable_selection_node(A)}else{if(contenteditable_getAttribute(A,"classid")=="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B"){W="";for(var S=A.firstChild;S;S=S.nextSibling){if((S.nodeName=="PARAM")&&(contenteditable_getAttribute(S,"name").toLowerCase()=="src")){W=contenteditable_getAttribute(S,"value")||""}}R=contenteditable_getAttribute(A,"width")||"";P=contenteditable_getAttribute(A,"height")||"";Q=contenteditable_getAttribute(A,"class")||"";Y=contenteditable_getAttribute(A,"id")||"";U="quicktime";contenteditable_selection_node(A)}}}}}}}if((typeof (webeditor.image_window)=="undefined")||(webeditor.image_window==null)||webeditor.image_window.closed){if((webeditor.type=="dhtml")&&(webeditor.majorVersion==4)){webeditor.image_window=window.open(webeditor.rootpath+"media.html?editor=webeditor&href="+encodeURIComponent(W)+"&border="+encodeURIComponent(T)+"&alt="+encodeURIComponent(Z)+"&width="+encodeURIComponent(R)+"&height="+encodeURIComponent(P)+"&vspace="+encodeURIComponent(I)+"&hspace="+encodeURIComponent(N)+"&align="+encodeURIComponent(V)+"&onmouseover="+encodeURIComponent(F)+"&onmouseout="+encodeURIComponent(D)+"&usemap="+encodeURIComponent(H)+"&htmlclass="+encodeURIComponent(Q)+"&htmlid="+encodeURIComponent(Y)+"&mediaclass="+encodeURIComponent(U)+"&mediatype="+encodeURIComponent(X)+"&mediaposter="+encodeURIComponent(K)+"&mediapreload="+encodeURIComponent(J)+"&mediaautoplay="+encodeURIComponent(B)+"&mediacontrols="+encodeURIComponent(C)+"&medialoop="+encodeURIComponent(M)+"&mediamuted="+encodeURIComponent(E),"image_window","scrollbars=yes,width="+webeditor.image_window_width+",height="+webeditor.image_window_height+",resizable=yes,status=yes")}else{if(webeditor.manager&&webeditor.language){webeditor.image_window=window.open(webeditor.rootpath+"media"+webeditor.manager+"."+webeditor.language+"?editor=webeditor&href="+encodeURIComponent(W)+"&border="+encodeURIComponent(T)+"&alt="+encodeURIComponent(Z)+"&width="+encodeURIComponent(R)+"&height="+encodeURIComponent(P)+"&vspace="+encodeURIComponent(I)+"&hspace="+encodeURIComponent(N)+"&align="+encodeURIComponent(V)+"&onmouseover="+encodeURIComponent(F)+"&onmouseout="+encodeURIComponent(D)+"&usemap="+encodeURIComponent(H)+"&htmlclass="+encodeURIComponent(Q)+"&htmlid="+encodeURIComponent(Y)+"&mediaclass="+encodeURIComponent(U)+"&mediatype="+encodeURIComponent(X)+"&mediaposter="+encodeURIComponent(K)+"&mediapreload="+encodeURIComponent(J)+"&mediaautoplay="+encodeURIComponent(B)+"&mediacontrols="+encodeURIComponent(C)+"&medialoop="+encodeURIComponent(M)+"&mediamuted="+encodeURIComponent(E),"image_window","scrollbars=yes,width="+webeditor.image_window_width+",height="+webeditor.image_window_height+",resizable=yes,status=yes")}else{if(webeditor.manager){webeditor.image_window=window.open(webeditor.rootpath+"media"+webeditor.manager+".html?editor=webeditor&href="+encodeURIComponent(W)+"&border="+encodeURIComponent(T)+"&alt="+encodeURIComponent(Z)+"&width="+encodeURIComponent(R)+"&height="+encodeURIComponent(P)+"&vspace="+encodeURIComponent(I)+"&hspace="+encodeURIComponent(N)+"&align="+encodeURIComponent(V)+"&onmouseover="+encodeURIComponent(F)+"&onmouseout="+encodeURIComponent(D)+"&usemap="+encodeURIComponent(H)+"&htmlclass="+encodeURIComponent(Q)+"&htmlid="+encodeURIComponent(Y)+"&mediaclass="+encodeURIComponent(U)+"&mediatype="+encodeURIComponent(X)+"&mediaposter="+encodeURIComponent(K)+"&mediapreload="+encodeURIComponent(J)+"&mediaautoplay="+encodeURIComponent(B)+"&mediacontrols="+encodeURIComponent(C)+"&medialoop="+encodeURIComponent(M)+"&mediamuted="+encodeURIComponent(E),"image_window","scrollbars=yes,width="+webeditor.image_window_width+",height="+webeditor.image_window_height+",resizable=yes,status=yes")}else{webeditor.image_window=window.open(webeditor.rootpath+"media.html?editor=webeditor&href="+encodeURIComponent(W)+"&border="+encodeURIComponent(T)+"&alt="+encodeURIComponent(Z)+"&width="+encodeURIComponent(R)+"&height="+encodeURIComponent(P)+"&vspace="+encodeURIComponent(I)+"&hspace="+encodeURIComponent(N)+"&align="+encodeURIComponent(V)+"&onmouseover="+encodeURIComponent(F)+"&onmouseout="+encodeURIComponent(D)+"&usemap="+encodeURIComponent(H)+"&htmlclass="+encodeURIComponent(Q)+"&htmlid="+encodeURIComponent(Y)+"&mediaclass="+encodeURIComponent(U)+"&mediatype="+encodeURIComponent(X)+"&mediaposter="+encodeURIComponent(K)+"&mediapreload="+encodeURIComponent(J)+"&mediaautoplay="+encodeURIComponent(B)+"&mediacontrols="+encodeURIComponent(C)+"&medialoop="+encodeURIComponent(M)+"&mediamuted="+encodeURIComponent(E),"image_window","scrollbars=yes,width="+webeditor.image_window_width+",height="+webeditor.image_window_height+",resizable=yes,status=yes")}}}}else{if((webeditor.type=="dhtml")&&(webeditor.majorVersion==4)){webeditor.image_window.document.location=webeditor.rootpath+"media.html?editor=webeditor&href="+encodeURIComponent(W)+"&border="+encodeURIComponent(T)+"&alt="+encodeURIComponent(Z)+"&width="+encodeURIComponent(R)+"&height="+encodeURIComponent(P)+"&vspace="+encodeURIComponent(I)+"&hspace="+encodeURIComponent(N)+"&align="+encodeURIComponent(V)+"&onmouseover="+encodeURIComponent(F)+"&onmouseout="+encodeURIComponent(D)+"&usemap="+encodeURIComponent(H)+"&htmlclass="+encodeURIComponent(Q)+"&htmlid="+encodeURIComponent(Y)+"&mediaclass="+encodeURIComponent(U)+"&mediatype="+encodeURIComponent(X)+"&mediaposter="+encodeURIComponent(K)+"&mediapreload="+encodeURIComponent(J)+"&mediaautoplay="+encodeURIComponent(B)+"&mediacontrols="+encodeURIComponent(C)+"&medialoop="+encodeURIComponent(M)+"&mediamuted="+encodeURIComponent(E)}else{if(webeditor.manager&&webeditor.language){webeditor.image_window.document.location=webeditor.rootpath+"media"+webeditor.manager+"."+webeditor.language+"?editor=webeditor&href="+encodeURIComponent(W)+"&border="+encodeURIComponent(T)+"&alt="+encodeURIComponent(Z)+"&width="+encodeURIComponent(R)+"&height="+encodeURIComponent(P)+"&vspace="+encodeURIComponent(I)+"&hspace="+encodeURIComponent(N)+"&align="+encodeURIComponent(V)+"&onmouseover="+encodeURIComponent(F)+"&onmouseout="+encodeURIComponent(D)+"&usemap="+encodeURIComponent(H)+"&htmlclass="+encodeURIComponent(Q)+"&htmlid="+encodeURIComponent(Y)+"&mediaclass="+encodeURIComponent(U)+"&mediatype="+encodeURIComponent(X)+"&mediaposter="+encodeURIComponent(K)+"&mediapreload="+encodeURIComponent(J)+"&mediaautoplay="+encodeURIComponent(B)+"&mediacontrols="+encodeURIComponent(C)+"&medialoop="+encodeURIComponent(M)+"&mediamuted="+encodeURIComponent(E)}else{if(webeditor.manager){webeditor.image_window.document.location=webeditor.rootpath+"media"+webeditor.manager+".html?editor=webeditor&href="+encodeURIComponent(W)+"&border="+encodeURIComponent(T)+"&alt="+encodeURIComponent(Z)+"&width="+encodeURIComponent(R)+"&height="+encodeURIComponent(P)+"&vspace="+encodeURIComponent(I)+"&hspace="+encodeURIComponent(N)+"&align="+encodeURIComponent(V)+"&onmouseover="+encodeURIComponent(F)+"&onmouseout="+encodeURIComponent(D)+"&usemap="+encodeURIComponent(H)+"&htmlclass="+encodeURIComponent(Q)+"&htmlid="+encodeURIComponent(Y)+"&mediaclass="+encodeURIComponent(U)+"&mediatype="+encodeURIComponent(X)+"&mediaposter="+encodeURIComponent(K)+"&mediapreload="+encodeURIComponent(J)+"&mediaautoplay="+encodeURIComponent(B)+"&mediacontrols="+encodeURIComponent(C)+"&medialoop="+encodeURIComponent(M)+"&mediamuted="+encodeURIComponent(E)}else{webeditor.image_window.document.location=webeditor.rootpath+"media.html?editor=webeditor&href="+encodeURIComponent(W)+"&border="+encodeURIComponent(T)+"&alt="+encodeURIComponent(Z)+"&width="+encodeURIComponent(R)+"&height="+encodeURIComponent(P)+"&vspace="+encodeURIComponent(I)+"&hspace="+encodeURIComponent(N)+"&align="+encodeURIComponent(V)+"&onmouseover="+encodeURIComponent(F)+"&onmouseout="+encodeURIComponent(D)+"&usemap="+encodeURIComponent(H)+"&htmlclass="+encodeURIComponent(Q)+"&htmlid="+encodeURIComponent(Y)+"&mediaclass="+encodeURIComponent(U)+"&mediatype="+encodeURIComponent(X)+"&mediaposter="+encodeURIComponent(K)+"&mediapreload="+encodeURIComponent(J)+"&mediaautoplay="+encodeURIComponent(B)+"&mediacontrols="+encodeURIComponent(C)+"&medialoop="+encodeURIComponent(M)+"&mediamuted="+encodeURIComponent(E)}}}}if(webeditor.image_window){webeditor.image_window.focus()}}function webeditor_imagemap(){var A=contenteditable_selection_container("img");if(A){contenteditable_selection_node(A);if((typeof (webeditor.imagemap_window)=="undefined")||(webeditor.imagemap_window==null)||webeditor.imagemap_window.closed){webeditor.imagemap_window=window.open(webeditor.rootpath+"imagemap.html?editor=webeditor","imagemap_window","scrollbars=yes,width=600,height=600,resizable=yes,status=yes",true)}if(webeditor.imagemap_window){webeditor.imagemap_window.focus()}}}function webeditor_createlink(){var G="";var A="";var D="";var I="";var F="";var H="";var E="";var G=contenteditable_selection_text();var B=contenteditable_selection_container("a");if(B){contenteditable_selection_node(B);G=B.innerHTML;A=contenteditable_getAttribute(B,"href")||"";A=A.replace(/&amp;/gi,"&");D=contenteditable_getAttribute(B,"target")||"";F=contenteditable_getAttribute(B,"class")||"";I=contenteditable_getAttribute(B,"id")||"";H=contenteditable_getAttribute(B,"onclick")||"";E=contenteditable_getAttribute(B,"title")||""}else{if(contenteditable_selection_contains("a")){return }}if((typeof (webeditor.hyperlink_window)=="undefined")||(webeditor.hyperlink_window==null)||webeditor.hyperlink_window.closed){if(webeditor.manager&&webeditor.language){try{webeditor.hyperlink_window=window.open(webeditor.rootpath+"hyperlink"+webeditor.manager+"."+webeditor.language+"?editor=webeditor&href="+encodeURIComponent(A)+"&target="+encodeURIComponent(D)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(F)+"&onclick="+encodeURIComponent(H)+"&title="+encodeURIComponent(E)+"&text="+encodeURIComponent(G),"hyperlink_window","scrollbars=yes,width="+webeditor.hyperlink_window_width+",height="+webeditor.hyperlink_window_height+",resizable=yes,status=yes",true)}catch(C){}}else{if(webeditor.manager){try{webeditor.hyperlink_window=window.open(webeditor.rootpath+"hyperlink"+webeditor.manager+".html?editor=webeditor&href="+encodeURIComponent(A)+"&target="+encodeURIComponent(D)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(F)+"&onclick="+encodeURIComponent(H)+"&title="+encodeURIComponent(E)+"&text="+encodeURIComponent(G),"hyperlink_window","scrollbars=yes,width="+webeditor.hyperlink_window_width+",height="+webeditor.hyperlink_window_height+",resizable=yes,status=yes",true)}catch(C){}}else{try{webeditor.hyperlink_window=window.open(webeditor.rootpath+"hyperlink.html?editor=webeditor&href="+encodeURIComponent(A)+"&target="+encodeURIComponent(D)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(F)+"&onclick="+encodeURIComponent(H)+"&title="+encodeURIComponent(E)+"&text="+encodeURIComponent(G),"hyperlink_window","scrollbars=yes,width="+webeditor.hyperlink_window_width+",height="+webeditor.hyperlink_window_height+",resizable=yes,status=yes",true)}catch(C){}}}}else{if(webeditor.manager&&webeditor.language){try{webeditor.hyperlink_window.document.location=webeditor.rootpath+"hyperlink"+webeditor.manager+"."+webeditor.language+"?editor=webeditor&href="+encodeURIComponent(A)+"&target="+encodeURIComponent(D)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(F)+"&onclick="+encodeURIComponent(H)+"&text="+encodeURIComponent(G)+"&title="+encodeURIComponent(E)}catch(C){}}else{if(webeditor.manager){try{webeditor.hyperlink_window.document.location=webeditor.rootpath+"hyperlink"+webeditor.manager+".html?editor=webeditor&href="+encodeURIComponent(A)+"&target="+encodeURIComponent(D)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(F)+"&onclick="+encodeURIComponent(H)+"&text="+encodeURIComponent(G)+"&title="+encodeURIComponent(E)}catch(C){}}else{try{webeditor.hyperlink_window.document.location=webeditor.rootpath+"hyperlink.html?editor=webeditor&href="+encodeURIComponent(A)+"&target="+encodeURIComponent(D)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(F)+"&onclick="+encodeURIComponent(H)+"&text="+encodeURIComponent(G)+"&title="+encodeURIComponent(E)}catch(C){}}}}if(webeditor.hyperlink_window){webeditor.hyperlink_window.focus()}}function webeditor_mailto(){var F="";var B="";var D="";var G="";var E="";var F=contenteditable_selection_text();var C=contenteditable_selection_container("a");if(C){contenteditable_selection_node(C);F=C.innerHTML;var A=contenteditable_getAttribute(C,"href")||"";if(A.match(new RegExp("^mailto:([^?]*)(.*)$","gi"))){B=A.replace(/^mailto:([^?]*)(.*)$/gi,"$1")||""}if(A.match(new RegExp("^(.*)\\?subject=(.*)","gi"))){D=A.replace(/^(.*)\?subject=(.*)/gi,"$2")||""}D=decodeURIComponent(D);E=contenteditable_getAttribute(C,"class")||"";G=contenteditable_getAttribute(C,"id")||""}else{if(contenteditable_selection_contains("a")){return }}if((typeof (webeditor.mailto_window)=="undefined")||(webeditor.mailto_window==null)||webeditor.mailto_window.closed){webeditor.mailto_window=window.open(webeditor.rootpath+"mailto.html?editor=webeditor&email="+encodeURIComponent(B)+"&subject="+encodeURIComponent(D)+"&htmlid="+encodeURIComponent(G)+"&htmlclass="+encodeURIComponent(E),"mailto_window","width=500,height=325,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.mailto_window){webeditor.mailto_window.focus()}}function webeditor_backcolor(){if((typeof (webeditor.colour_window)=="undefined")||(webeditor.colour_window==null)||webeditor.colour_window.closed){webeditor.colour_window=window.open(webeditor.rootpath+"colour.html?editor=webeditor&attribute=backColor","colour_window","width=475,height=350,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.colour_window){webeditor.colour_window.focus()}}function webeditor_forecolor(){if((typeof (webeditor.colour_window)=="undefined")||(webeditor.colour_window==null)||webeditor.colour_window.closed){webeditor.colour_window=window.open(webeditor.rootpath+"colour.html?editor=webeditor&attribute=foreColor","colour_window","width=475,height=350,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.colour_window){webeditor.colour_window.focus()}}function webeditor_form(){var C="";var G="";var A="";var F="";var D="";var E="";var I="";var H="";var B=contenteditable_selection_container("form");if(B){contenteditable_selection_node(B);C=contenteditable_getAttribute(B,"action")||"";G=contenteditable_getAttribute(B,"enctype")||"";A=contenteditable_getAttribute(B,"method")||"";F=contenteditable_getAttribute(B,"target")||"";D=contenteditable_getAttribute(B,"onsubmit")||"";E=contenteditable_getAttribute(B,"onreset")||"";H=contenteditable_getAttribute(B,"class")||"";I=contenteditable_getAttribute(B,"id")||""}if((typeof (webeditor.form_window)=="undefined")||(webeditor.form_window==null)||webeditor.form_window.closed){webeditor.form_window=window.open(webeditor.rootpath+"form.html?editor=webeditor&action="+encodeURIComponent(C)+"&enctype="+encodeURIComponent(G)+"&method="+encodeURIComponent(A)+"&target="+encodeURIComponent(F)+"&onsubmit="+encodeURIComponent(D)+"&onreset="+encodeURIComponent(E)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(H)+"","form_window","width=475,height=375,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.form_window){webeditor.form_window.focus()}}function webeditor_button(F,J){if(!F){F="button"}if(!J){J=""}var B="";var I="";var A="";var E="";var L="";var G="";var K="";var H="";var D="";var C=contenteditable_selection_container("input");if(C){contenteditable_selection_node(C);B=contenteditable_getAttribute(C,"name")||"";I=contenteditable_getAttribute(C,"value")||"";A=contenteditable_getAttribute(C,"src")||"";E=contenteditable_getAttribute(C,"align")||"";if(!J){J=contenteditable_getAttribute(C,"onclick")||""}L=contenteditable_getAttribute(C,"onfocus")||"";G=contenteditable_getAttribute(C,"onblur")||"";H=contenteditable_getAttribute(C,"class")||"";K=contenteditable_getAttribute(C,"id")||"";D=contenteditable_getAttribute(C,"alt")||""}if((typeof (webeditor.button_window)=="undefined")||(webeditor.button_window==null)||webeditor.button_window.closed){webeditor.button_window=window.open(webeditor.rootpath+"button.html?editor=webeditor&type="+encodeURIComponent(F)+"&name="+encodeURIComponent(B)+"&value="+encodeURIComponent(I)+"&src="+encodeURIComponent(A)+"&align="+encodeURIComponent(E)+"&onclick="+encodeURIComponent(J)+"&onfocus="+encodeURIComponent(L)+"&onblur="+encodeURIComponent(G)+"&htmlid="+encodeURIComponent(K)+"&htmlclass="+encodeURIComponent(H)+"&alt="+encodeURIComponent(D)+"","button_window","width=475,height=425,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.button_window){webeditor.button_window.focus()}}function webeditor_submitbutton(){webeditor_button("submit")}function webeditor_resetbutton(){webeditor_button("reset")}function webeditor_imagebutton(){webeditor_button("image")}function webeditor_backbutton(){webeditor_button("button","history.back(-1);")}function webeditor_text(){var A="";var G="";var K="";var B="";var H="";var C="";var J="";var D="";var I="";var F="";var E=contenteditable_selection_container("input");if(E){contenteditable_selection_node(E);A=contenteditable_getAttribute(E,"name")||"";G=contenteditable_getAttribute(E,"value")||"";K=contenteditable_getAttribute(E,"size")||"";B=contenteditable_getAttribute(E,"maxLength")||"";H=contenteditable_getAttribute(E,"onclick")||"";C=contenteditable_getAttribute(E,"onchange")||"";J=contenteditable_getAttribute(E,"onfocus")||"";D=contenteditable_getAttribute(E,"onblur")||"";F=contenteditable_getAttribute(E,"class")||"";I=contenteditable_getAttribute(E,"id")||""}if((typeof (webeditor.text_window)=="undefined")||(webeditor.text_window==null)||webeditor.text_window.closed){webeditor.text_window=window.open(webeditor.rootpath+"text.html?editor=webeditor&name="+encodeURIComponent(A)+"&value="+encodeURIComponent(G)+"&size="+encodeURIComponent(K)+"&maxlength="+encodeURIComponent(B)+"&onclick="+encodeURIComponent(H)+"&onchange="+encodeURIComponent(C)+"&onfocus="+encodeURIComponent(J)+"&onblur="+encodeURIComponent(D)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(F)+"","text_window","width=475,height=475,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.text_window){webeditor.text_window.focus()}}function webeditor_password(){var A="";var G="";var K="";var B="";var H="";var C="";var J="";var D="";var I="";var F="";var E=contenteditable_selection_container("input");if(E){contenteditable_selection_node(E);A=contenteditable_getAttribute(E,"name")||"";G=contenteditable_getAttribute(E,"value")||"";K=contenteditable_getAttribute(E,"size")||"";B=contenteditable_getAttribute(E,"maxLength")||"";H=contenteditable_getAttribute(E,"onclick")||"";C=contenteditable_getAttribute(E,"onchange")||"";J=contenteditable_getAttribute(E,"onfocus")||"";D=contenteditable_getAttribute(E,"onblur")||"";F=contenteditable_getAttribute(E,"class")||"";I=contenteditable_getAttribute(E,"id")||""}if((typeof (webeditor.password_window)=="undefined")||(webeditor.password_window==null)||webeditor.password_window.closed){webeditor.password_window=window.open(webeditor.rootpath+"password.html?editor=webeditor&name="+encodeURIComponent(A)+"&value="+encodeURIComponent(G)+"&size="+encodeURIComponent(K)+"&maxlength="+encodeURIComponent(B)+"&onclick="+encodeURIComponent(H)+"&onchange="+encodeURIComponent(C)+"&onfocus="+encodeURIComponent(J)+"&onblur="+encodeURIComponent(D)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(F)+"","password_window","width=475,height=475,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.password_window){webeditor.password_window.focus()}}function webeditor_hidden(){var C="hidden";var B="";var E="";var F="";var D="";var A=contenteditable_selection_container("input");if(A){contenteditable_selection_node(A);B=contenteditable_getAttribute(A,"name")||"";E=contenteditable_getAttribute(A,"value")||"";D=contenteditable_getAttribute(A,"class")||"";F=contenteditable_getAttribute(A,"id")||""}if((typeof (webeditor.hidden_window)=="undefined")||(webeditor.hidden_window==null)||webeditor.hidden_window.closed){webeditor.hidden_window=window.open(webeditor.rootpath+"hidden.html?editor=webeditor&type="+encodeURIComponent(C)+"&name="+encodeURIComponent(B)+"&value="+encodeURIComponent(E)+"&htmlid="+encodeURIComponent(F)+"&htmlclass="+encodeURIComponent(D)+"","hidden_window","width=475,height=275,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.hidden_window){webeditor.hidden_window.focus()}}function webeditor_textarea(){var A="";var E="";var K="";var B="";var H="";var C="";var J="";var D="";var I="";var G="";var F=contenteditable_selection_container("textarea");if(F){contenteditable_selection_node(F);A=contenteditable_getAttribute(F,"name")||"";E=contenteditable_getAttribute(F,"cols")||"";K=contenteditable_getAttribute(F,"rows")||"";B=contenteditable_getAttribute(F,"wrap")||"";H=contenteditable_getAttribute(F,"onclick")||"";C=contenteditable_getAttribute(F,"onchange")||"";J=contenteditable_getAttribute(F,"onfocus")||"";D=contenteditable_getAttribute(F,"onblur")||"";G=contenteditable_getAttribute(F,"class")||"";I=contenteditable_getAttribute(F,"id")||""}if((typeof (webeditor.textarea_window)=="undefined")||(webeditor.textarea_window==null)||webeditor.textarea_window.closed){webeditor.textarea_window=window.open(webeditor.rootpath+"textarea.html?editor=webeditor&name="+encodeURIComponent(A)+"&cols="+encodeURIComponent(E)+"&rows="+encodeURIComponent(K)+"&wrap="+encodeURIComponent(B)+"&&onclick="+encodeURIComponent(H)+"&onchange="+encodeURIComponent(C)+"&onfocus="+encodeURIComponent(J)+"&onblur="+encodeURIComponent(D)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(G)+"","textarea_window","width=475,height=475,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.textarea_window){webeditor.textarea_window.focus()}}function webeditor_checkbox(){var A="";var F="";var G="";var H="";var B="";var J="";var C="";var I="";var E="";var D=contenteditable_selection_container("input");if(D){contenteditable_selection_node(D);A=contenteditable_getAttribute(D,"name")||"";F=contenteditable_getAttribute(D,"value")||"";G=contenteditable_getAttribute(D,"checked")?"checked":"";H=contenteditable_getAttribute(D,"onclick")||"";B=contenteditable_getAttribute(D,"onchange")||"";J=contenteditable_getAttribute(D,"onfocus")||"";C=contenteditable_getAttribute(D,"onblur")||"";E=contenteditable_getAttribute(D,"class")||"";I=contenteditable_getAttribute(D,"id")||""}if((typeof (webeditor.checkbox_window)=="undefined")||(webeditor.checkbox_window==null)||webeditor.checkbox_window.closed){webeditor.checkbox_window=window.open(webeditor.rootpath+"checkbox.html?editor=webeditor&name="+encodeURIComponent(A)+"&value="+encodeURIComponent(F)+"&checked="+encodeURIComponent(G)+"&onclick="+encodeURIComponent(H)+"&onchange="+encodeURIComponent(B)+"&onfocus="+encodeURIComponent(J)+"&onblur="+encodeURIComponent(C)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(E)+"","checkbox_window","width=475,height=425,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.checkbox_window){webeditor.checkbox_window.focus()}}function webeditor_radio(){var A="";var F="";var G="";var H="";var B="";var J="";var C="";var I="";var E="";var D=contenteditable_selection_container("input");if(D){contenteditable_selection_node(D);A=contenteditable_getAttribute(D,"name")||"";F=contenteditable_getAttribute(D,"value")||"";G=contenteditable_getAttribute(D,"checked")?"checked":"";H=contenteditable_getAttribute(D,"onclick")||"";B=contenteditable_getAttribute(D,"onchange")||"";J=contenteditable_getAttribute(D,"onfocus")||"";C=contenteditable_getAttribute(D,"onblur")||"";E=contenteditable_getAttribute(D,"class")||"";I=contenteditable_getAttribute(D,"id")||""}if((typeof (webeditor.radiobutton_window)=="undefined")||(webeditor.radiobutton_window==null)||webeditor.radiobutton_window.closed){webeditor.radiobutton_window=window.open(webeditor.rootpath+"radiobutton.html?editor=webeditor&name="+encodeURIComponent(A)+"&value="+encodeURIComponent(F)+"&checked="+encodeURIComponent(G)+"&onclick="+encodeURIComponent(H)+"&onchange="+encodeURIComponent(B)+"&onfocus="+encodeURIComponent(J)+"&onblur="+encodeURIComponent(C)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(E)+"","radiobutton_window","width=475,height=425,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.radiobutton_window){webeditor.radiobutton_window.focus()}}function webeditor_file(){var D="file";var A="";var H="";var B="";var I="";var C="";var K="";var E="";var J="";var G="";var F=contenteditable_selection_container("input");if(F){contenteditable_selection_node(F);A=contenteditable_getAttribute(F,"name")||"";H=contenteditable_getAttribute(F,"value")||"";B=contenteditable_getAttribute(F,"accept")||"";I=contenteditable_getAttribute(F,"onclick")||"";C=contenteditable_getAttribute(F,"onchange")||"";K=contenteditable_getAttribute(F,"onfocus")||"";E=contenteditable_getAttribute(F,"onblur")||"";G=contenteditable_getAttribute(F,"class")||"";J=contenteditable_getAttribute(F,"id")||""}if((typeof (webeditor.file_window)=="undefined")||(webeditor.file_window==null)||webeditor.file_window.closed){webeditor.file_window=window.open(webeditor.rootpath+"file.html?editor=webeditor&type="+encodeURIComponent(D)+"&name="+encodeURIComponent(A)+"&value="+encodeURIComponent(H)+"&accept="+encodeURIComponent(B)+"&onclick="+encodeURIComponent(I)+"&onchange="+encodeURIComponent(C)+"&onfocus="+encodeURIComponent(K)+"&onblur="+encodeURIComponent(E)+"&htmlid="+encodeURIComponent(J)+"&htmlclass="+encodeURIComponent(G)+"","file_window","width=475,height=375,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.file_window){webeditor.file_window.focus()}}function webeditor_selectlist(){var A="";var I="";var J="";var F="";var B="";var H="";var C="";var G="";var D="";webeditor.selectlist_options=false;webeditor.selectlist_node=false;var E=contenteditable_selection_container("select");if(E){contenteditable_selection_node(E);A=contenteditable_getAttribute(E,"name")||"";I=contenteditable_getAttribute(E,"size")||"";if(I<1){I=""}J=contenteditable_getAttribute(E,"multiple")?"multiple":"";F=contenteditable_getAttribute(E,"onclick")||"";B=contenteditable_getAttribute(E,"onchange")||"";H=contenteditable_getAttribute(E,"onfocus")||"";C=contenteditable_getAttribute(E,"onblur")||"";D=contenteditable_getAttribute(E,"class")||"";G=contenteditable_getAttribute(E,"id")||"";webeditor.selectlist_node=E;webeditor.selectlist_options=E.options}if((typeof (webeditor.select_window)=="undefined")||(webeditor.select_window==null)||webeditor.select_window.closed){webeditor.select_window=window.open(webeditor.rootpath+"select.html?editor=webeditor&name="+encodeURIComponent(A)+"&size="+encodeURIComponent(I)+"&multiple="+encodeURIComponent(J)+"&onclick="+encodeURIComponent(F)+"&onchange="+encodeURIComponent(B)+"&onfocus="+encodeURIComponent(H)+"&onblur="+encodeURIComponent(C)+"&htmlid="+encodeURIComponent(G)+"&htmlclass="+encodeURIComponent(D),"select_window","scrollbars=yes,width=875,height=400,resizable=yes,status=yes",true)}if(webeditor.select_window){webeditor.select_window.focus()}}function webeditor_selectlist_options(){if(webeditor.selectlist_options){return webeditor.selectlist_options}var A=contenteditable_selection_container("select");if(A){return A.options}}function webeditor_imagemap_node(C){if(C){var B=contenteditable_focused_document().getElementsByTagName("MAP");for(var A=0;A<B.length;A++){if(B[A].tagName=="MAP"){return B[A]}}}}function webeditor_clean(){if((typeof (webeditor.clean_window)=="undefined")||(webeditor.clean_window==null)||webeditor.clean_window.closed){webeditor.clean_window=window.open(webeditor.rootpath+"clean.html?editor=webeditor","clean_window","width=475,height=300,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.clean_window){webeditor.clean_window.focus()}}function webeditor_box(){var B="100";var H="100";var D="1";var C="solid";var F="";var A="";var I="";var G="";var E=contenteditable_selection_container("div");if(E&&E.style&&(E.style.position=="absolute")){if(E&&E.style){contenteditable_selection_node(E);B=E.style.width||"";H=E.style.height||"";D=E.style.borderTopWidth||"";C=E.style.borderTopStyle||"";F=E.style.borderTopColor||"";A=E.style.backgroundColor||"";G=contenteditable_getAttribute(E,"class")||"";I=contenteditable_getAttribute(E,"id")||""}}if((typeof (webeditor.box_window)=="undefined")||(webeditor.box_window==null)||webeditor.box_window.closed){webeditor.box_window=window.open(webeditor.rootpath+"box.html?editor=webeditor&width="+encodeURIComponent(B)+"&height="+encodeURIComponent(H)+"&borderwidth="+encodeURIComponent(D)+"&borderstyle="+encodeURIComponent(C)+"&bordercolor="+encodeURIComponent(F)+"&backgroundcolor="+encodeURIComponent(A)+"&htmlid="+encodeURIComponent(I)+"&htmlclass="+encodeURIComponent(G),"box_window","width=475,height=375,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.box_window){webeditor.box_window.focus()}}function webeditor_iframe(){var C="";var A="";var G="";var H="";var E="";var F="";var D="";var B=contenteditable_selection_container("iframe");if(B){contenteditable_selection_node(B);C=contenteditable_getAttribute(B,"width")||"";A=contenteditable_getAttribute(B,"height")||"";G=contenteditable_getAttribute(B,"src")||"";D=contenteditable_getAttribute(B,"class")||"";H=contenteditable_getAttribute(B,"id")||"";E=contenteditable_getAttribute(B,"name")||"";F=contenteditable_getAttribute(B,"title")||""}if((typeof (webeditor.iframe_window)=="undefined")||(webeditor.iframe_window==null)||webeditor.iframe_window.closed){webeditor.iframe_window=window.open(webeditor.rootpath+"iframe.html?editor=webeditor&width="+encodeURIComponent(C)+"&height="+encodeURIComponent(A)+"&src="+encodeURIComponent(G)+"&htmlid="+encodeURIComponent(H)+"&htmlclass="+encodeURIComponent(D)+"&htmlname="+encodeURIComponent(E)+"&htmltitle="+encodeURIComponent(F),"iframe_window","width=525,height=375,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.iframe_window){webeditor.iframe_window.focus()}}function webeditor_anchor(){var B="";var D="";var C="";var A=contenteditable_selection_container("a");if(A){contenteditable_selection_node(A);B=contenteditable_getAttribute(A,"name")||"";C=contenteditable_getAttribute(A,"class")||"";D=contenteditable_getAttribute(A,"id")||""}if((typeof (webeditor.anchor_window)=="undefined")||(webeditor.anchor_window==null)||webeditor.anchor_window.closed){webeditor.anchor_window=window.open(webeditor.rootpath+"anchor.html?editor=webeditor&name="+encodeURIComponent(B)+"&htmlid="+encodeURIComponent(D)+"&htmlclass="+encodeURIComponent(C),"anchor_window","width=475,height=275,scrollbars=yes,resizable=yes,status=yes",true)}if(webeditor.anchor_window){webeditor.anchor_window.focus()}}function webeditor_dropdown(A,B){if(typeof (webeditor_dropdown_close_all)!="undefined"){webeditor_dropdown_close_all()}if(typeof (webeditor_menu_hide)!="undefined"){webeditor_menu_hide()}if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }contenteditable_focus_toolbar(B);if(contenteditable_viewsource_status[contenteditable_focused]){return }if(A!="formatclass"){webeditor_dropdown_close("formatclass")}if(A!="formatblock"){webeditor_dropdown_close("formatblock")}if(A!="fontname"){webeditor_dropdown_close("fontname")}if(A!="fontsize"){webeditor_dropdown_close("fontsize")}webeditor_dropdown_refresh(A);var C=document.getElementById(A+"_dropdown");if(C&&C.style){if(contenteditable_dropdown_hidden(C)){C.style.zIndex=1+getMaxZIndex(B);if(C.style.zIndex<100000){C.style.zIndex=100000}C.style.top=""+(getAbsoluteOffsetTop(B)+B.clientHeight+(B.clientTop?B.clientTop:1))+"px";C.style.left=""+(getAbsoluteOffsetLeft(B))+"px";contenteditable_dropdown_show(C)}else{contenteditable_dropdown_hide(C)}}}function webeditor_dropdown_refresh(E){webeditor_dropdown_init(E,false,false,true);if((E=="formatclass")||(E=="fontname")||(E=="fontsize")){webeditor_dropdown_option(E,"&nbsp;","")}if(E=="formatclass"){var D=webeditor.stylesheetclassnames;if((!D)&&parent.webeditor){D=parent.webeditor.stylesheetclassnames}var B=webeditor.stylesheetclassvalues;if((!B)&&parent.webeditor){B=parent.webeditor.stylesheetclassvalues}if(D&&B){for(var C in D){if(typeof (D[C])!="function"){var G=D[C];var F=B[G];if(G){webeditor_dropdown_option("formatclass",G,F)}}}}}else{if(webeditor&&webeditor.options){for(var A=0;A<webeditor.options[E].length;A++){webeditor_dropdown_option(E,webeditor.options[E][A].name,webeditor.options[E][A].value)}}}}function webeditor_dropdown_close(A){var B=document.getElementById(A+"_dropdown");if(B&&B.style){contenteditable_dropdown_hide(B)}}function webeditor_dropdown_close_all(){if(webeditor.WYSIWYGselect){webeditor_dropdown_close("formatclass");webeditor_dropdown_close("formatblock");webeditor_dropdown_close("fontname");webeditor_dropdown_close("fontsize")}}function webeditor_dropdown_select(E,F,G){var C=document.getElementById(E);var B=contenteditable_focused_iframe();if(B&&B.id&&document.getElementById("webeditor_toolbar_"+B.id)){var D=document.getElementById("webeditor_toolbar_"+B.id);C=contenteditable_getElementById(D,E,C)}var H=document.getElementById(E+"_dropdown");if(H&&H.style){contenteditable_dropdown_hide(H)}if(C.value!=F){C.value=F;var A=new Object();A.id=E;A.name=F;A.value=G;A.select=webeditor_select;A.select()}}var webeditor_dropdown_options=new Array();function webeditor_dropdown_init(E,A,D,B){if(webeditor.WYSIWYGselect){A=A||"300px";D=D||"250px"}else{A="1px";D="1px"}var C=document.getElementById(E+"_dropdown");if(!C){C=document.createElement("IFRAME");C.setAttribute("id",E+"_dropdown");C.setAttribute("class","webeditor_dropdown");C.setAttribute("className","webeditor_dropdown");C.setAttribute("width",D);C.setAttribute("height",A);C.setAttribute("scrolling","yes");C.setAttribute("unselectable","on");if(webeditor.stylesheets[E]){C.setAttribute("src",webeditor.rootpath+"dropdown.html?stylesheet="+webeditor.stylesheets[E])}else{if(webeditor.stylesheet){C.setAttribute("src",webeditor.rootpath+"dropdown.html?stylesheet="+webeditor.stylesheet)}else{C.setAttribute("src",webeditor.rootpath+"dropdown.html")}}C.style.background="white";C.style.position="absolute";contenteditable_dropdown_hide(C);document.body.insertBefore(C,document.body.firstChild)}if(C&&C.contentWindow&&C.contentWindow.document&&C.contentWindow.document.body){C.contentWindow.document.body.innerHTML='<div unselectable="on"><table summary="" width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td id="'+E+'_dropdown_options" nowrap="nowrap"></td></tr></tbody></table></div>'}if(B&&contenteditable_stylesheet[contenteditable_focused_iframe().id]){webeditor_dropdown_stylesheet(E,contenteditable_stylesheet[contenteditable_focused_iframe().id])}webeditor_dropdown_options[E]=new Object()}function webeditor_dropdown_stylesheet(C,A){var B=document.getElementById(C+"_dropdown");if(A&&B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document.getElementById("dropdownstylesheet")&&B.contentWindow.document.getElementById("dropdownstylesheet").href){var D=B.contentWindow.document.getElementById("dropdownstylesheet").href.indexOf(A)-(B.contentWindow.document.getElementById("dropdownstylesheet").href.length-A.length);if(D){B.contentWindow.document.getElementById("dropdownstylesheet").href=A}}}function webeditor_dropdown_option(D,B,E){var C=document.getElementById(D+"_dropdown");if(C&&C.contentWindow&&C.contentWindow.document){var A=C.contentWindow.document.getElementById(D+"_dropdown_options");if(A){if(D=="formatclass"){A.innerHTML+='<div style="max-width: 250px;" unselectable="on" class="webeditor_dropdown_item" onmouseover="this.className=\'webeditor_dropdown_item_mouseover\'" onmouseout="this.className=\'webeditor_dropdown_item\'" onclick="this.className=\'webeditor_dropdown_item\'; parent.webeditor_dropdown_select(\''+D+"','"+B+"','"+E+'\')"><span unselectable="on" class="'+E+'">'+B+"</span></div>"}else{if(D=="formatblock"){A.innerHTML+='<div style="max-width: 250px;" unselectable="on" class="webeditor_dropdown_item" onmouseover="this.className=\'webeditor_dropdown_item_mouseover\'" onmouseout="this.className=\'webeditor_dropdown_item\'" onclick="this.className=\'webeditor_dropdown_item\'; parent.webeditor_dropdown_select(\''+D+"','"+B+"','"+E+"')\">"+E.substring(0,E.length-1)+' unselectable="on">'+B+"</"+E.substring(1)+"</div>"}else{if(D=="fontname"){A.innerHTML+='<div style="max-width: 250px;" unselectable="on" class="webeditor_dropdown_item" onmouseover="this.className=\'webeditor_dropdown_item_mouseover\'" onmouseout="this.className=\'webeditor_dropdown_item\'" onclick="this.className=\'webeditor_dropdown_item\'; parent.webeditor_dropdown_select(\''+D+"','"+B+"','"+E+'\')"><font unselectable="on" face="'+E+'">'+B+"</font></div>"}else{if(D=="fontsize"){A.innerHTML+='<div style="max-width: 250px;" unselectable="on" class="webeditor_dropdown_item" onmouseover="this.className=\'webeditor_dropdown_item_mouseover\'" onmouseout="this.className=\'webeditor_dropdown_item\'" onclick="this.className=\'webeditor_dropdown_item\'; parent.webeditor_dropdown_select(\''+D+"','"+B+"','"+E+'\')"><font unselectable="on" size="'+E+'">'+B+"</font></div>"}}}}webeditor_dropdown_options[D][B]=E}}}function webeditor_menu_init(){var A=document.getElementById("menu_dropdown");if(!A){A=document.createElement("DIV");A.setAttribute("id","menu_dropdown");A.setAttribute("class","webeditor_dropdown");A.setAttribute("className","webeditor_dropdown");A.style.background="white";A.style.position="absolute";A.style.width="200px";contenteditable_dropdown_hide(A);document.body.insertBefore(A,document.body.firstChild)}if(A){A.innerHTML='<DIV unselectable="on" class="webeditor_menu_dropdown"><table summary="" class="webeditor_menu_dropdown" width="100%" cellspacing="0" cellpadding="0" border="1"><TBODY><tr><td id="menu_dropdown_options" nowrap="nowrap"></td></tr></tbody></table></div>'}A=document.getElementById("submenu_dropdown");if(!A){A=document.createElement("DIV");A.setAttribute("name","");A.setAttribute("id","submenu_dropdown");A.setAttribute("class","webeditor_dropdown");A.setAttribute("className","webeditor_dropdown");A.style.background="white";A.style.position="absolute";A.style.width="200px";contenteditable_dropdown_hide(A);document.body.insertBefore(A,document.body.firstChild)}if(A){A.innerHTML='<DIV unselectable="on" class="webeditor_menu_dropdown"><table summary="" class="webeditor_menu_dropdown" width="100%" cellspacing="0" cellpadding="0" border="1"><TBODY><tr><td id="submenu_dropdown_options" nowrap="nowrap"></td></tr></tbody></table></div>'}}function webeditor_menu(D,H,I,B){if(webeditor.count&&(webeditor.count>webeditor.inited)){return }if(webeditor.disabled){return }if((!contenteditable_focused_iframe())||(!contenteditable_focused_iframe().id)||(!contenteditable_inited[contenteditable_focused_iframe().id])){return }contenteditable_focus_toolbar(H);if(contenteditable_viewsource_status[contenteditable_focused]){return }if(H){H.className="webeditor_icon_mouseover"}var C=document.getElementById("menu_dropdown");var K=document.getElementById("menu_dropdown_options");if(C&&K){K.innerHTML=webeditor_menuitems(D,H)}if(C&&C.style){if(I||B){C.style.zIndex=100000;C.style.top=""+(getAbsoluteOffsetTop(H)+B)+"px";C.style.left=""+(getAbsoluteOffsetLeft(H)+I)+"px";contenteditable_dropdown_show(C);if(webeditor.contextmenusAlign){var E=contenteditable_focused_iframe();var F=getAbsoluteOffsetTop(E)+E.offsetHeight;var A=getAbsoluteOffsetLeft(H)+B+C.offsetHeight;if(F<A){C.style.top=""+(getAbsoluteOffsetTop(H)+B-C.offsetHeight)+"px"}}}else{if(H){C.style.zIndex=1+getMaxZIndex(H);if(C.style.zIndex<100000){C.style.zIndex=100000}C.style.top=""+(getAbsoluteOffsetTop(H)+H.clientHeight+(H.clientTop?H.clientTop:1))+"px";C.style.left=""+(getAbsoluteOffsetLeft(H))+"px";contenteditable_dropdown_show(C)}}}if(C){children=C.getElementsByTagName("DIV");for(var G=0;G<children.length;G++){if((children[G].className=="webeditor_menu")||(children[G].className=="webeditor_menu_selected")||(children[G].className=="webeditor_menu_disabled")){children[G].style.width="100%";if(children[G].onmouseover&&children[G].getAttribute("onmouseover")&&children[G].removeEventListener&&children[G].addEventListener){var J=children[G].onmouseover;contenteditable_detach_event_handler(children[G],"mouseover",J);contenteditable_attach_event_handler(children[G],"mouseover",J)}if(!children[G].onmouseover){contenteditable_attach_event_handler(children[G],"mouseover",webeditor_menu_mouseover)}if(!children[G].onmouseout){contenteditable_attach_event_handler(children[G],"mouseout",webeditor_menu_mouseout)}if(!children[G].onmousedown){contenteditable_attach_event_handler(children[G],"mousedown",webeditor_menu_mousedown)}if(!children[G].onmouseup){contenteditable_attach_event_handler(children[G],"mouseup",webeditor_menu_mouseup)}if(!children[G].onclick){contenteditable_attach_event_handler(children[G],"click",webeditor_click)}}}}}var webeditor_submenu_parent;function webeditor_submenu(D,H){if((!H)||(!H.nodeType)||(!H.nodeName)){return }if(contenteditable_viewsource_status[contenteditable_focused]){return }if(H){if(H.className!="webeditor_menu_disabled"){H.className="webeditor_menu_mouseover"}}webeditor_submenu_parent=H;var A=document.getElementById(D);if(A){A.className="webeditor_menu_mouseover"}var C=document.getElementById("submenu_dropdown");if(C){C.name=D}var I=document.getElementById("submenu_dropdown_options");if(C&&I){I.innerHTML=webeditor_menuitems(D,H)}if(C&&C.style){C.style.zIndex=1+getMaxZIndex(H);if(C.style.zIndex<100000){C.style.zIndex=100000}C.style.top=""+getAbsoluteOffsetTop(H,true)+"px";C.style.left=""+(getAbsoluteOffsetLeft(H,true)+H.offsetWidth+2)+"px";contenteditable_dropdown_show(C);if(webeditor.contextmenusAlign){var E=contenteditable_focused_iframe();var F=getAbsoluteOffsetTop(E)+E.offsetHeight;var B=getAbsoluteOffsetTop(H,true)+C.offsetHeight;if(F<B){C.style.top=""+(getAbsoluteOffsetTop(H,true)+H.offsetHeight-C.offsetHeight)+"px"}}}children=C.getElementsByTagName("DIV");for(var G=0;G<children.length;G++){if((children[G].className=="webeditor_menu")||(children[G].className=="webeditor_menu_selected")||(children[G].className=="webeditor_menu_disabled")){children[G].style.width="100%";if(!children[G].onmouseover){children[G].onmouseover=webeditor_submenu_mouseover}if(!children[G].onmouseout){children[G].onmouseout=webeditor_submenu_mouseout}if(!children[G].onmousedown){children[G].onmousedown=webeditor_menu_mousedown}if(!children[G].onmouseup){children[G].onmouseup=webeditor_menu_mouseup}if(!children[G].onclick){children[G].onclick=webeditor_click}}}}function webeditor_menuitems(B,D){var C="";var H=contenteditable_isTable();var J=contenteditable_isTableCaption();var I=contenteditable_isRow();var E=contenteditable_isCell();var F=contenteditable_positionable();var G=contenteditable_selection_text();var A=contenteditable_selection_container();if(B=="clipboard"){C+=webeditor_menu_clipboard(B,D)}else{if(B=="colour"){C+=webeditor_menu_colour(B,D)}else{if(B=="form"){C+=webeditor_menu_form(B,D)}else{if(B=="justify"){C+=webeditor_menu_justify(B,D)}else{if(B=="position"){C+=webeditor_menu_position(B,D,F)}else{if(B=="table"){C+=webeditor_menu_table(B,D,H,J,I,E)}else{if(B=="textformat"){C+=webeditor_menu_textformat(B,D)}else{if(B=="tableinsert"){C+=webeditor_menu_tableinsert(B,D,H,J,I,E)}else{if(B=="tabledelete"){C+=webeditor_menu_tabledelete(B,D,H,J,I,E)}else{if(B=="tableselect"){C+=webeditor_menu_tableselect(B,D,H,J,I,E)}else{if(B=="tablemodify"){C+=webeditor_menu_tablemodify(B,D,H,J,I,E)}else{if(B=="tablepropertiesmenu"){C+=webeditor_menu_tablepropertiesmenu(B,D,H,J,I,E)}else{if(B=="context"){C+=webeditor_menu_clipboard(B,D,G);if((G!="")&&(A.nodeName!="IMG")){C+=webeditor_menu_text(B,D)}if((A.nodeName=="H1")||(A.nodeName=="H2")||(A.nodeName=="H3")||(A.nodeName=="H4")||(A.nodeName=="H5")||(A.nodeName=="H6")){C+=webeditor_menu_heading(B,D)}if((A.nodeName=="P")||(A.nodeName=="DIV")){C+=webeditor_menu_paragraph(B,D)}if(F&&(F.nodeName!="TABLE")){C+=webeditor_menu_separator();C+=webeditor_menu_position(B,D,F)}if(H){C+=webeditor_menu_table(B,D,H,J,I,E)}if(F&&(F.nodeName=="TABLE")){C+=webeditor_menu_separator();C+=webeditor_menu_position(B,D,F)}}}}}}}}}}}}}}return C}function webeditor_menu_hide(){webeditor_submenu_hide();var A=document.getElementById("menu_dropdown");if(A){contenteditable_dropdown_hide(A)}}function webeditor_submenu_hide(){var A=document.getElementById("submenu_dropdown");if(A){contenteditable_dropdown_hide(A)}if(A&&A.name){var B=document.getElementById(A.name);if(B){B.className="webeditor_menu"}A.name=""}}function webeditor_menu_separator(){var A="";A+='<div unselectable="on" class="webeditor_menu_separator"><img unselectable="on" src="'+webeditor.rootpath+'spacer.gif" alt=""></div>';return A}function webeditor_menu_table(C,G,E,D,B,A){var F="";F+='<div unselectable="on" class="webeditor_menu_heading"><span unselectable="on">'+Text("toolbar_menu_table")+"</span></div>";F+='<div onclick="return false;" unselectable="on" class="webeditor_menu" id="tableinsert" onmouseover="webeditor_submenu(\'tableinsert\',this);"><img unselectable="on" src="'+webeditor.buttonpath+'tableinsert.gif" alt="'+Text("toolbar_menu_tableinsert")+'"> <span unselectable="on">'+Text("toolbar_menu_tableinsert")+"</span></div>";F+='<div onclick="return false;" unselectable="on" class="webeditor_menu" id="tabledelete" onmouseover="webeditor_submenu(\'tabledelete\',this);"><img unselectable="on" src="'+webeditor.buttonpath+'tabledelete.gif" alt="'+Text("toolbar_menu_tabledelete")+'"> <span unselectable="on">'+Text("toolbar_menu_tabledelete")+"</span></div>";F+='<div onclick="return false;" unselectable="on" class="webeditor_menu" id="tableselect" onmouseover="webeditor_submenu(\'tableselect\',this);"><img unselectable="on" src="'+webeditor.buttonpath+'tableselect.gif" alt="'+Text("toolbar_menu_tableselect")+'"> <span unselectable="on">'+Text("toolbar_menu_tableselect")+"</span></div>";F+='<div onclick="return false;" unselectable="on" class="webeditor_menu" id="tablemodify" onmouseover="webeditor_submenu(\'tablemodify\',this);"><img unselectable="on" src="'+webeditor.buttonpath+'tablemodify.gif" alt="'+Text("toolbar_menu_tablemodify")+'"> <span unselectable="on">'+Text("toolbar_menu_tablemodify")+"</span></div>";F+='<div onclick="return false;" unselectable="on" class="webeditor_menu" id="tablepropertiesmenu" onmouseover="webeditor_submenu(\'tablepropertiesmenu\',this);"><img unselectable="on" src="'+webeditor.buttonpath+'tablepropertiesmenu.gif" alt="'+Text("toolbar_menu_tablepropertiesmenu")+'"> <span unselectable="on">'+Text("toolbar_menu_tablepropertiesmenu")+"</span></div>";return F}function webeditor_menu_tablepropertiesmenu(C,G,E,D,B,A){var F="";if(!E){F+='<div unselectable="on" class="webeditor_menu_disabled" id="tableproperties"><img unselectable="on" src="'+webeditor.buttonpath+'tableproperties.gif" alt="'+Text("toolbar_tableproperties")+'"> <span unselectable="on">'+Text("toolbar_tableproperties")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="tableproperties"><img unselectable="on" src="'+webeditor.buttonpath+'tableproperties.gif" alt="'+Text("toolbar_tableproperties")+'"> <span unselectable="on">'+Text("toolbar_tableproperties")+"</span></div>"}if(!B){F+='<div unselectable="on" class="webeditor_menu_disabled" id="rowproperties"><img unselectable="on" src="'+webeditor.buttonpath+'rowproperties.gif" alt="'+Text("toolbar_rowproperties")+'"> <span unselectable="on">'+Text("toolbar_rowproperties")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="rowproperties"><img unselectable="on" src="'+webeditor.buttonpath+'rowproperties.gif" alt="'+Text("toolbar_rowproperties")+'"> <span unselectable="on">'+Text("toolbar_rowproperties")+"</span></div>"}if(!A){F+='<div unselectable="on" class="webeditor_menu_disabled" id="columnproperties"><img unselectable="on" src="'+webeditor.buttonpath+'columnproperties.gif" alt="'+Text("toolbar_columnproperties")+'"> <span unselectable="on">'+Text("toolbar_columnproperties")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu_disabled" id="cellproperties"><img unselectable="on" src="'+webeditor.buttonpath+'cellproperties.gif" alt="'+Text("toolbar_cellproperties")+'"> <span unselectable="on">'+Text("toolbar_cellproperties")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="columnproperties"><img unselectable="on" src="'+webeditor.buttonpath+'columnproperties.gif" alt="'+Text("toolbar_columnproperties")+'"> <span unselectable="on">'+Text("toolbar_columnproperties")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu" id="cellproperties"><img unselectable="on" src="'+webeditor.buttonpath+'cellproperties.gif" alt="'+Text("toolbar_cellproperties")+'"> <span unselectable="on">'+Text("toolbar_cellproperties")+"</span></div>"}return F}function webeditor_menu_tableinsert(C,G,E,D,B,A){var F="";F+='<div unselectable="on" class="webeditor_menu" id="createtable"><img unselectable="on" src="'+webeditor.buttonpath+'createtable.gif" alt="'+Text("toolbar_createtable")+'"> <span unselectable="on">'+Text("toolbar_createtable")+"</span></div>";if(!E){F+='<div unselectable="on" class="webeditor_menu_disabled" id="insertcaption"><img unselectable="on" src="'+webeditor.buttonpath+'insertcaption.gif" alt="'+Text("toolbar_insertcaption")+'"> <span unselectable="on">'+Text("toolbar_insertcaption")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="insertcaption"><img unselectable="on" src="'+webeditor.buttonpath+'insertcaption.gif" alt="'+Text("toolbar_insertcaption")+'"> <span unselectable="on">'+Text("toolbar_insertcaption")+"</span></div>"}if(!B){F+='<div unselectable="on" class="webeditor_menu_disabled" id="insertrowhead"><img unselectable="on" src="'+webeditor.buttonpath+'insertrowhead.gif" alt="'+Text("toolbar_insertrowhead")+'"> <span unselectable="on">'+Text("toolbar_insertrowhead")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu_disabled" id="insertrowfoot"><img unselectable="on" src="'+webeditor.buttonpath+'insertrowfoot.gif" alt="'+Text("toolbar_insertrowfoot")+'"> <span unselectable="on">'+Text("toolbar_insertrowfoot")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu_disabled" id="insertrowabove"><img unselectable="on" src="'+webeditor.buttonpath+'insertrowabove.gif" alt="'+Text("toolbar_insertrowabove")+'"> <span unselectable="on">'+Text("toolbar_insertrowabove")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu_disabled" id="insertrowbelow"><img unselectable="on" src="'+webeditor.buttonpath+'insertrowbelow.gif" alt="'+Text("toolbar_insertrowbelow")+'"> <span unselectable="on">'+Text("toolbar_insertrowbelow")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="insertrowhead"><img unselectable="on" src="'+webeditor.buttonpath+'insertrowhead.gif" alt="'+Text("toolbar_insertrowhead")+'"> <span unselectable="on">'+Text("toolbar_insertrowhead")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu" id="insertrowfoot"><img unselectable="on" src="'+webeditor.buttonpath+'insertrowfoot.gif" alt="'+Text("toolbar_insertrowfoot")+'"> <span unselectable="on">'+Text("toolbar_insertrowfoot")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu" id="insertrowabove"><img unselectable="on" src="'+webeditor.buttonpath+'insertrowabove.gif" alt="'+Text("toolbar_insertrowabove")+'"> <span unselectable="on">'+Text("toolbar_insertrowabove")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu" id="insertrowbelow"><img unselectable="on" src="'+webeditor.buttonpath+'insertrowbelow.gif" alt="'+Text("toolbar_insertrowbelow")+'"> <span unselectable="on">'+Text("toolbar_insertrowbelow")+"</span></div>"}if(!A){F+='<div unselectable="on" class="webeditor_menu_disabled" id="insertcolumnleft"><img unselectable="on" src="'+webeditor.buttonpath+'insertcolumnleft.gif" alt="'+Text("toolbar_insertcolumnleft")+'"> <span unselectable="on">'+Text("toolbar_insertcolumnleft")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu_disabled" id="insertcolumnright"><img unselectable="on" src="'+webeditor.buttonpath+'insertcolumnright.gif" alt="'+Text("toolbar_insertcolumnright")+'"> <span unselectable="on">'+Text("toolbar_insertcolumnright")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu_disabled" id="insertcellleft"><img unselectable="on" src="'+webeditor.buttonpath+'insertcellleft.gif" alt="'+Text("toolbar_insertcellleft")+'"> <span unselectable="on">'+Text("toolbar_insertcellleft")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu_disabled" id="insertcellright"><img unselectable="on" src="'+webeditor.buttonpath+'insertcellright.gif" alt="'+Text("toolbar_insertcellright")+'"> <span unselectable="on">'+Text("toolbar_insertcellright")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="insertcolumnleft"><img unselectable="on" src="'+webeditor.buttonpath+'insertcolumnleft.gif" alt="'+Text("toolbar_insertcolumnleft")+'"> <span unselectable="on">'+Text("toolbar_insertcolumnleft")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu" id="insertcolumnright"><img unselectable="on" src="'+webeditor.buttonpath+'insertcolumnright.gif" alt="'+Text("toolbar_insertcolumnright")+'"> <span unselectable="on">'+Text("toolbar_insertcolumnright")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu" id="insertcellleft"><img unselectable="on" src="'+webeditor.buttonpath+'insertcellleft.gif" alt="'+Text("toolbar_insertcellleft")+'"> <span unselectable="on">'+Text("toolbar_insertcellleft")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu" id="insertcellright"><img unselectable="on" src="'+webeditor.buttonpath+'insertcellright.gif" alt="'+Text("toolbar_insertcellright")+'"> <span unselectable="on">'+Text("toolbar_insertcellright")+"</span></div>"}return F}function webeditor_menu_tabledelete(C,G,E,D,B,A){var F="";if((!B)&&(!D)){F+='<div unselectable="on" class="webeditor_menu_disabled" id="deleterow"><img unselectable="on" src="'+webeditor.buttonpath+'deleterow.gif" alt="'+Text("toolbar_deleterow")+'"> <span unselectable="on">'+Text("toolbar_deleterow")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="deleterow"><img unselectable="on" src="'+webeditor.buttonpath+'deleterow.gif" alt="'+Text("toolbar_deleterow")+'"> <span unselectable="on">'+Text("toolbar_deleterow")+"</span></div>"}if(!A){F+='<div unselectable="on" class="webeditor_menu_disabled" id="deletecolumn"><img unselectable="on" src="'+webeditor.buttonpath+'deletecolumn.gif" alt="'+Text("toolbar_deletecolumn")+'"> <span unselectable="on">'+Text("toolbar_deletecolumn")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu_disabled" id="deletecell"><img unselectable="on" src="'+webeditor.buttonpath+'deletecell.gif" alt="'+Text("toolbar_deletecell")+'"> <span unselectable="on">'+Text("toolbar_deletecell")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="deletecolumn"><img unselectable="on" src="'+webeditor.buttonpath+'deletecolumn.gif" alt="'+Text("toolbar_deletecolumn")+'"> <span unselectable="on">'+Text("toolbar_deletecolumn")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu" id="deletecell"><img unselectable="on" src="'+webeditor.buttonpath+'deletecell.gif" alt="'+Text("toolbar_deletecell")+'"> <span unselectable="on">'+Text("toolbar_deletecell")+"</span></div>"}return F}function webeditor_menu_tableselect(C,G,E,D,B,A){var F="";if(!E){F+='<div unselectable="on" class="webeditor_menu_disabled" id="selecttable"><img unselectable="on" src="'+webeditor.buttonpath+'selecttable.gif" alt="'+Text("toolbar_selecttable")+'"> <span unselectable="on">'+Text("toolbar_selecttable")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="selecttable"><img unselectable="on" src="'+webeditor.buttonpath+'selecttable.gif" alt="'+Text("toolbar_selecttable")+'"> <span unselectable="on">'+Text("toolbar_selecttable")+"</span></div>"}if(!B){F+='<div unselectable="on" class="webeditor_menu_disabled" id="selectrow"><img unselectable="on" src="'+webeditor.buttonpath+'selectrow.gif" alt="'+Text("toolbar_selectrow")+'"> <span unselectable="on">'+Text("toolbar_selectrow")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="selectrow"><img unselectable="on" src="'+webeditor.buttonpath+'selectrow.gif" alt="'+Text("toolbar_selectrow")+'"> <span unselectable="on">'+Text("toolbar_selectrow")+"</span></div>"}if(!A){F+='<div unselectable="on" class="webeditor_menu_disabled" id="selectcell"><img unselectable="on" src="'+webeditor.buttonpath+'selectcell.gif" alt="'+Text("toolbar_selectcell")+'"> <span unselectable="on">'+Text("toolbar_selectcell")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="selectcell"><img unselectable="on" src="'+webeditor.buttonpath+'selectcell.gif" alt="'+Text("toolbar_selectcell")+'"> <span unselectable="on">'+Text("toolbar_selectcell")+"</span></div>"}return F}function webeditor_menu_tablemodify(C,G,E,D,B,A){var F="";if(!contenteditable_selection_container("table")){F+='<div unselectable="on" class="webeditor_menu_disabled" id="mergecells"><img unselectable="on" src="'+webeditor.buttonpath+'mergecells.gif" alt="'+Text("toolbar_mergecells")+'"> <span unselectable="on">'+Text("toolbar_mergecells")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="mergecells"><img unselectable="on" src="'+webeditor.buttonpath+'mergecells.gif" alt="'+Text("toolbar_mergecells")+'"> <span unselectable="on">'+Text("toolbar_mergecells")+"</span></div>"}if(!A){F+='<div unselectable="on" class="webeditor_menu_disabled" id="splitcell"><img unselectable="on" src="'+webeditor.buttonpath+'splitcell.gif" alt="'+Text("toolbar_splitcell")+'"> <span unselectable="on">'+Text("toolbar_splitcell")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu_disabled" id="splitcellcolumns"><img unselectable="on" src="'+webeditor.buttonpath+'splitcellcolumns.gif" alt="'+Text("toolbar_splitcellcolumns")+'"> <span unselectable="on">'+Text("toolbar_splitcellcolumns")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu_disabled" id="splitcellrows"><img unselectable="on" src="'+webeditor.buttonpath+'splitcellrows.gif" alt="'+Text("toolbar_splitcellrows")+'"> <span unselectable="on">'+Text("toolbar_splitcellrows")+"</span></div>"}else{F+='<div unselectable="on" class="webeditor_menu" id="splitcell"><img unselectable="on" src="'+webeditor.buttonpath+'splitcell.gif" alt="'+Text("toolbar_splitcell")+'"> <span unselectable="on">'+Text("toolbar_splitcell")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu" id="splitcellcolumns"><img unselectable="on" src="'+webeditor.buttonpath+'splitcellcolumns.gif" alt="'+Text("toolbar_splitcellcolumns")+'"> <span unselectable="on">'+Text("toolbar_splitcellcolumns")+"</span></div>";F+='<div unselectable="on" class="webeditor_menu" id="splitcellrows"><img unselectable="on" src="'+webeditor.buttonpath+'splitcellrows.gif" alt="'+Text("toolbar_splitcellrows")+'"> <span unselectable="on">'+Text("toolbar_splitcellrows")+"</span></div>"}return F}function webeditor_menu_form(A,C){var B="";B+='<div unselectable="on" class="webeditor_menu" id="form"><img unselectable="on" src="'+webeditor.buttonpath+'form.gif" alt="'+Text("toolbar_form")+'"> <span unselectable="on">'+Text("toolbar_form")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="submitbutton"><img unselectable="on" src="'+webeditor.buttonpath+'submitbutton.gif" alt="'+Text("toolbar_submitbutton")+'"> <span unselectable="on">'+Text("toolbar_submitbutton")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="resetbutton"><img unselectable="on" src="'+webeditor.buttonpath+'resetbutton.gif" alt="'+Text("toolbar_resetbutton")+'"> <span unselectable="on">'+Text("toolbar_resetbutton")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="backbutton"><img unselectable="on" src="'+webeditor.buttonpath+'backbutton.gif" alt="'+Text("toolbar_backbutton")+'"> <span unselectable="on">'+Text("toolbar_backbutton")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="imagebutton"><img unselectable="on" src="'+webeditor.buttonpath+'imagebutton.gif" alt="'+Text("toolbar_imagebutton")+'"> <span unselectable="on">'+Text("toolbar_imagebutton")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="file"><img unselectable="on" src="'+webeditor.buttonpath+'file.gif" alt="'+Text("toolbar_file")+'"> <span unselectable="on">'+Text("toolbar_file")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="button"><img unselectable="on" src="'+webeditor.buttonpath+'button.gif" alt="'+Text("toolbar_button")+'"> <span unselectable="on">'+Text("toolbar_button")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="text"><img unselectable="on" src="'+webeditor.buttonpath+'text.gif" alt="'+Text("toolbar_text")+'"> <span unselectable="on">'+Text("toolbar_text")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="password"><img unselectable="on" src="'+webeditor.buttonpath+'password.gif" alt="'+Text("toolbar_password")+'"> <span unselectable="on">'+Text("toolbar_password")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="hidden"><img unselectable="on" src="'+webeditor.buttonpath+'hidden.gif" alt="'+Text("toolbar_hidden")+'"> <span unselectable="on">'+Text("toolbar_hidden")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="textarea"><img unselectable="on" src="'+webeditor.buttonpath+'textarea.gif" alt="'+Text("toolbar_textarea")+'"> <span unselectable="on">'+Text("toolbar_textarea")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="checkbox"><img unselectable="on" src="'+webeditor.buttonpath+'checkbox.gif" alt="'+Text("toolbar_checkbox")+'"> <span unselectable="on">'+Text("toolbar_checkbox")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="radio"><img unselectable="on" src="'+webeditor.buttonpath+'radio.gif" alt="'+Text("toolbar_radio")+'"> <span unselectable="on">'+Text("toolbar_radio")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="select"><img unselectable="on" src="'+webeditor.buttonpath+'select.gif" alt="'+Text("toolbar_select")+'"> <span unselectable="on">'+Text("toolbar_select")+"</span></div>";return B}function webeditor_menu_position(B,D,A){var C="";if(!A){C+='<div unselectable="on" class="webeditor_menu_disabled" id="position"><img unselectable="on" src="'+webeditor.buttonpath+'position.gif" alt="'+Text("toolbar_position")+'"> <span unselectable="on">'+Text("toolbar_position")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu_disabled" id="forwards"><img unselectable="on" src="'+webeditor.buttonpath+'forwards.gif" alt="'+Text("toolbar_forwards")+'"> <span unselectable="on">'+Text("toolbar_forwards")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu_disabled" id="backwards"><img unselectable="on" src="'+webeditor.buttonpath+'backwards.gif" alt="'+Text("toolbar_backwards")+'"> <span unselectable="on">'+Text("toolbar_backwards")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu_disabled" id="front"><img unselectable="on" src="'+webeditor.buttonpath+'front.gif" alt="'+Text("toolbar_front")+'"> <span unselectable="on">'+Text("toolbar_front")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu_disabled" id="back"><img unselectable="on" src="'+webeditor.buttonpath+'back.gif" alt="'+Text("toolbar_back")+'"> <span unselectable="on">'+Text("toolbar_back")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu_disabled" id="abovetext"><img unselectable="on" src="'+webeditor.buttonpath+'abovetext.gif" alt="'+Text("toolbar_abovetext")+'"> <span unselectable="on">'+Text("toolbar_abovetext")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu_disabled" id="belowtext"><img unselectable="on" src="'+webeditor.buttonpath+'belowtext.gif" alt="'+Text("toolbar_belowtext")+'"> <span unselectable="on">'+Text("toolbar_belowtext")+"</span></div>"}else{C+='<div unselectable="on" class="webeditor_menu" id="position"><img unselectable="on" src="'+webeditor.buttonpath+'position.gif" alt="'+Text("toolbar_position")+'"> <span unselectable="on">'+Text("toolbar_position")+"</span></div>";if(D||(A&&A.style&&A.style.position&&(A.style.position!="static"))){C+='<div unselectable="on" class="webeditor_menu" id="forwards"><img unselectable="on" src="'+webeditor.buttonpath+'forwards.gif" alt="'+Text("toolbar_forwards")+'"> <span unselectable="on">'+Text("toolbar_forwards")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu" id="backwards"><img unselectable="on" src="'+webeditor.buttonpath+'backwards.gif" alt="'+Text("toolbar_backwards")+'"> <span unselectable="on">'+Text("toolbar_backwards")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu" id="front"><img unselectable="on" src="'+webeditor.buttonpath+'front.gif" alt="'+Text("toolbar_front")+'"> <span unselectable="on">'+Text("toolbar_front")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu" id="back"><img unselectable="on" src="'+webeditor.buttonpath+'back.gif" alt="'+Text("toolbar_back")+'"> <span unselectable="on">'+Text("toolbar_back")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu" id="abovetext"><img unselectable="on" src="'+webeditor.buttonpath+'abovetext.gif" alt="'+Text("toolbar_abovetext")+'"> <span unselectable="on">'+Text("toolbar_abovetext")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu" id="belowtext"><img unselectable="on" src="'+webeditor.buttonpath+'belowtext.gif" alt="'+Text("toolbar_belowtext")+'"> <span unselectable="on">'+Text("toolbar_belowtext")+"</span></div>"}}return C}function webeditor_menu_text(A,C){var B="";B+='<div unselectable="on" class="webeditor_menu_heading"><span unselectable="on">'+Text("toolbar_menu_text")+"</span></div>";B+='<div onclick="return false;" unselectable="on" class="webeditor_menu" id="textformat" onmouseover="webeditor_submenu(\'textformat\',this);"><img unselectable="on" src="'+webeditor.buttonpath+'textformat.gif" alt="'+Text("toolbar_menu_textformat")+'"> <span unselectable="on">'+Text("toolbar_menu_textformat")+"</span></div>";return B}function webeditor_menu_textformat(A,C){var B="";B+='<div unselectable="on" class="webeditor_menu" id="bold"><img unselectable="on" src="'+webeditor.buttonpath+'bold.gif" alt="'+Text("toolbar_bold")+'"> <span unselectable="on">'+Text("toolbar_bold")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="italic"><img unselectable="on" src="'+webeditor.buttonpath+'italic.gif" alt="'+Text("toolbar_italic")+'"> <span unselectable="on">'+Text("toolbar_italic")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="underline"><img unselectable="on" src="'+webeditor.buttonpath+'underline.gif" alt="'+Text("toolbar_underline")+'"> <span unselectable="on">'+Text("toolbar_underline")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="forecolor"><img unselectable="on" src="'+webeditor.buttonpath+'forecolor.gif" alt="'+Text("toolbar_forecolor")+'"> <span unselectable="on">'+Text("toolbar_forecolor")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="backcolor"><img unselectable="on" src="'+webeditor.buttonpath+'backcolor.gif" alt="'+Text("toolbar_backcolor")+'"> <span unselectable="on">'+Text("toolbar_backcolor")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="superscript"><img unselectable="on" src="'+webeditor.buttonpath+'superscript.gif" alt="'+Text("toolbar_superscript")+'"> <span unselectable="on">'+Text("toolbar_superscript")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="subscript"><img unselectable="on" src="'+webeditor.buttonpath+'subscript.gif" alt="'+Text("toolbar_subscript")+'"> <span unselectable="on">'+Text("toolbar_subscript")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="strikethrough"><img unselectable="on" src="'+webeditor.buttonpath+'strikethrough.gif" alt="'+Text("toolbar_strikethrough")+'"> <span unselectable="on">'+Text("toolbar_strikethrough")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="removeformat"><img unselectable="on" src="'+webeditor.buttonpath+'removeformat.gif" alt="'+Text("toolbar_removeformat")+'"> <span unselectable="on">'+Text("toolbar_removeformat")+"</span></div>";return B}function webeditor_menu_justify(A,C){var B="";B+='<div unselectable="on" class="webeditor_menu" id="justifyleft"><img unselectable="on" src="'+webeditor.buttonpath+'justifyleft.gif" alt="'+Text("toolbar_justifyleft")+'"> <span unselectable="on">'+Text("toolbar_justifyleft")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="justifycenter"><img unselectable="on" src="'+webeditor.buttonpath+'justifycenter.gif" alt="'+Text("toolbar_justifycenter")+'"> <span unselectable="on">'+Text("toolbar_justifycenter")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="justifyright"><img unselectable="on" src="'+webeditor.buttonpath+'justifyright.gif" alt="'+Text("toolbar_justifyright")+'"> <span unselectable="on">'+Text("toolbar_justifyright")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="justifyfull"><img unselectable="on" src="'+webeditor.buttonpath+'justifyfull.gif" alt="'+Text("toolbar_justifyfull")+'"> <span unselectable="on">'+Text("toolbar_justifyfull")+"</span></div>";return B}function webeditor_menu_heading(A,C){var B="";B+='<div unselectable="on" class="webeditor_menu_heading"><span unselectable="on">'+Text("toolbar_menu_heading")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="outdent"><img unselectable="on" src="'+webeditor.buttonpath+'outdent.gif" alt="'+Text("toolbar_outdent")+'"> <span unselectable="on">'+Text("toolbar_outdent")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="indent"><img unselectable="on" src="'+webeditor.buttonpath+'indent.gif" alt="'+Text("toolbar_indent")+'"> <span unselectable="on">'+Text("toolbar_indent")+"</span></div>";B+='<div onclick="return false;" unselectable="on" class="webeditor_menu" id="justify" onmouseover="webeditor_submenu(\'justify\',this);"><img unselectable="on" src="'+webeditor.buttonpath+'justify.gif" alt="'+Text("toolbar_menu_justify")+'"> <span unselectable="on">'+Text("toolbar_menu_justify")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="nobr"><img unselectable="on" src="'+webeditor.buttonpath+'nobr.gif" alt="'+Text("toolbar_nobr")+'"> <span unselectable="on">'+Text("toolbar_nobr")+"</span></div>";return B}function webeditor_menu_paragraph(A,C){var B="";B+='<div unselectable="on" class="webeditor_menu_heading"><span unselectable="on">'+Text("toolbar_menu_paragraph")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="outdent"><img unselectable="on" src="'+webeditor.buttonpath+'outdent.gif" alt="'+Text("toolbar_outdent")+'"> <span unselectable="on">'+Text("toolbar_outdent")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="indent"><img unselectable="on" src="'+webeditor.buttonpath+'indent.gif" alt="'+Text("toolbar_indent")+'"> <span unselectable="on">'+Text("toolbar_indent")+"</span></div>";B+='<div onclick="return false;" unselectable="on" class="webeditor_menu" id="justify" onmouseover="webeditor_submenu(\'justify\',this);"><img unselectable="on" src="'+webeditor.buttonpath+'justify.gif" alt="'+Text("toolbar_menu_justify")+'"> <span unselectable="on">'+Text("toolbar_menu_justify")+"</span></div>";B+='<div unselectable="on" class="webeditor_menu" id="nobr"><img unselectable="on" src="'+webeditor.buttonpath+'nobr.gif" alt="'+Text("toolbar_nobr")+'"> <span unselectable="on">'+Text("toolbar_nobr")+"</span></div>";return B}function webeditor_menu_clipboard(B,D,A){var C="";if(A==""){C+='<div unselectable="on" class="webeditor_menu_disabled" id="cut"><img unselectable="on" src="'+webeditor.buttonpath+'cut.gif" alt="'+Text("toolbar_cut")+'"> <span unselectable="on">'+Text("toolbar_cut")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu_disabled" id="copy"><img unselectable="on" src="'+webeditor.buttonpath+'copy.gif" alt="'+Text("toolbar_copy")+'"> <span unselectable="on">'+Text("toolbar_copy")+"</span></div>"}else{C+='<div unselectable="on" class="webeditor_menu" id="cut"><img unselectable="on" src="'+webeditor.buttonpath+'cut.gif" alt="'+Text("toolbar_cut")+'"> <span unselectable="on">'+Text("toolbar_cut")+"</span></div>";C+='<div unselectable="on" class="webeditor_menu" id="copy"><img unselectable="on" src="'+webeditor.buttonpath+'copy.gif" alt="'+Text("toolbar_copy")+'"> <span unselectable="on">'+Text("toolbar_copy")+"</span></div>"}C+='<div unselectable="on" class="webeditor_menu" id="paste"><img unselectable="on" src="'+webeditor.buttonpath+'paste.gif" alt="'+Text("toolbar_paste")+'"> <span unselectable="on">'+Text("toolbar_paste")+"</span></div>";return C}function webeditor_menu_colour(B,E){var D="";D+='<div unselectable="on" class="webeditor_menu" onclick="webeditor.'+E.id+'(\'inherit\');webeditor_menu_hide();"><img unselectable="on" width="16" height="16" src="'+webeditor.rootpath+'spacer.gif" alt=""> <span unselectable="on">'+Text("toolbar_menu_autocolours")+"</span></div>";if(webeditor.stylesheetcolours){D+='<div unselectable="on" class="webeditor_menu_heading"><span unselectable="on">'+Text("toolbar_menu_stylesheetcolours")+"</span></div>";var C='<table summary="" class="webeditor_menu_colour"><tr>';for(var A=0;A<webeditor.stylesheetcolours.length;A++){if((A!=0)&&((A%8)==0)){C+="<td>&nbsp;</td></tr><tr>"}C+='<td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+"('"+webeditor.stylesheetcolours[A]+'\');webeditor_menu_hide();" style="background-color:'+webeditor.stylesheetcolours[A]+'" title="'+webeditor.stylesheetcolours[A]+'" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td>'}C+="<td>&nbsp;</td></tr></table>";D+=C}D+='<div unselectable="on" class="webeditor_menu_heading"><span unselectable="on">'+Text("toolbar_menu_standardcolours")+"</span></div>";D+='<table summary="" class="webeditor_menu_colour"><tr><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_000000" style="background-color:#000000" title="#000000" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_FFFFFF" style="background-color:#FFFFFF" title="#FFFFFF" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_008000" style="background-color:#008000" title="#008000" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_800000" style="background-color:#800000" title="#800000" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_808000" style="background-color:#808000" title="#808000" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_000080" style="background-color:#000080" title="#000080" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_800080" style="background-color:#800080" title="#800080" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_808080" style="background-color:#808080" title="#808080" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td>&nbsp;</td></tr><tr><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_FFFF00" style="background-color:#FFFF00" title="#FFFF00" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_00FF00" style="background-color:#00FF00" title="#00FF00" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_00FFFF" style="background-color:#00FFFF" title="#00FFFF" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_FF00FF" style="background-color:#FF00FF" title="#FF00FF" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_C0C0C0" style="background-color:#C0C0C0" title="#C0C0C0" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_FF0000" style="background-color:#FF0000" title="#FF0000" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_0000FF" style="background-color:#0000FF" title="#0000FF" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td class="webeditor_menu_colour"><div unselectable="on" onclick="webeditor.'+E.id+'(\'#\'+this.id.substring(4));webeditor_menu_hide();" id="col_008080" style="background-color:#008080" title="#008080" class="webeditor_menu_colour" onmouseover="this.parentNode.className=\'webeditor_menu_colour_mouseover\'" onmouseout="this.parentNode.className=\'webeditor_menu_colour\'"><img unselectable="on" class="webeditor_menu_colour" src="'+webeditor.rootpath+'spacer.gif" alt=""></div></td><td>&nbsp;</td></tr></table>';D+='<div unselectable="on" class="webeditor_menu" id="'+E.id+'"><img unselectable="on" src="'+webeditor.buttonpath+'colours.gif" alt="'+Text("toolbar_menu_morecolours")+'"> <span unselectable="on">'+Text("toolbar_menu_morecolours")+"</span></div>";return D}function scrollAllToTopLeft(A){scrollAllToTop(A);scrollAllToLeft(A)}function scrollAllToTop(A){var B=0;if(A.offsetParent){if(A.scrollTop){A.scrollTop=0}while(A=A.offsetParent){if(A.offsetParent){if(A.scrollTop){A.scrollTop=0}}}}}function scrollAllToLeft(A){var B=0;if(A.offsetParent){if(A.scrollLeft){A.scrollLeft=0}while(A=A.offsetParent){if(A.offsetParent){if(A.scrollLeft){A.scrollLeft=0}}}}}function getAbsoluteOffsetTop(A,C){var B=0;if(A.offsetParent){B=A.offsetTop;B-=A.scrollTop;while(A=A.offsetParent){if(A.offsetParent||(!C)){B+=A.offsetTop;B-=A.scrollTop}}}return B}function getAbsoluteOffsetLeft(A,C){var B=0;if(A.offsetParent){B=A.offsetLeft;B-=A.scrollLeft;while(A=A.offsetParent){if(A.offsetParent||(!C)){B+=A.offsetLeft;B-=A.scrollLeft}}}return B}function getMaxZIndex(A){var B=0;while(A&&(A!=document.body)){if(A.style&&(A.style.zIndex>B)){B=A.style.zIndex}A=A.offsetParent}return B}function cleanContent(M,R,F,E,C,I,Q,B,L,P,A,H,O,D,J,N,G){if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}contenteditable_undo_save();contenteditable_cleanContent_fix();var K=contenteditable_getContentSelection();if(K){K=cleanContentSub(K,M,R,F,E,C,I,Q,B,L,P,A,H,O,D,J,N,G);contenteditable_event_paste_do_pre();contenteditable_pasteContent(K);contenteditable_event_paste_do_post();contenteditable_event_paste_fix()}else{K=contenteditable_getContent();K=cleanContentSub(K,M,R,F,E,C,I,Q,B,L,P,A,H,O,D,J,N,G);contenteditable_event_paste_do_pre();contenteditable_setContent(K);contenteditable_event_paste_do_post();contenteditable_event_paste_fix()}contenteditable_undo_save()}function cleanContentSub(M,O,T,G,F,D,K,S,B,N,R,A,J,Q,E,L,P,H){RegExp.global=true;RegExp.multiline=true;if(O){M=M.replace(/(<\/?[^>]*>)[\r\n]+/gi,"$1 ");M=M.replace(/<\/?[^>]*>/gi,"")}if(T){M=M.replace(/<\?xml[^>]*>/gi,"");M=M.replace(/<xml[^>]*>/gi,"");M=M.replace(/<\?[^>]*\?>/gi,"");if(webeditor.encodeQuestionTags){M=M.replace(/&lt;\?xml[^&]*&gt;/gi,"");M=M.replace(/&lt;xml[^&]*&gt;/gi,"");M=M.replace(/&lt;\?[^&]*\?&gt;/gi,"")}}if(G){M=M.replace(/<\/?[a-z]+:[^>]*>/gi,"");if(webeditor.encodeQuestionTags){M=M.replace(/&lt;\/?[a-z]+:[^&]*&gt;/gi,"")}}if(F){M=M.replace(/(<[^>]+)[ \t\r\n]+lang=[^ \t\r\n|>]*([^>]*>)/gi,"$1 $2")}if(A){M=M.replace(/<del[^>]*>.*<\/del>/gi,"");M=M.replace(/<ins[^>]*>(.*)<\/ins>/gi,"$1")}if(D){M=M.replace(/(<[^>]+)[ \t\r\n]+class=[^ \t\r\n|>]*([^>]*>)/gi,"$1 $2")}if(E){M=M.replace(/(<[^>]+)[ \t\r\n]+class=Mso[^ \t\r\n>]*([^>]*>)/gi,"$1 $2");M=M.replace(/(<[^>]+)[ \t\r\n]+class="Mso[^ \t\r\n>"]*"([^>]*>)/gi,"$1 $2")}if(K){M=M.replace(/(<[^>]+)[ \t\r\n]+style="[^"]*"([^>]*>)/gi,"$1$2")}if(L){M=M.replace(/(<[^>]+[ \t\r\n]+style="[^"]*)[; \t\r\n]*mso-[^:]+:[^;"]+;([^"]*"[^>]*>)/gi,"$1$2");M=M.replace(/(<[^>]+[ \t\r\n]+style="[^"]*)[; \t\r\n]*mso-[^:]+:[^;"]+("[^>]*>)/gi,"$1$2");M=M.replace(/(<[^>]+[ \t\r\n]+style=")mso-[^:]+:[^;"]+;([^"]*"[^>]*>)/gi,"$1$2");M=M.replace(/(<[^>]+[ \t\r\n]+style=")mso-[^:]+:[^;"]+("[^>]*>)/gi,"$1$2");M=M.replace(/(<[^>]+[ \t\r\n]+style='[^']*)[; \t\r\n]*mso-[^:]+:[^;']+;([^']*'[^>]*>)/gi,"$1$2");M=M.replace(/(<[^>]+[ \t\r\n]+style='[^']*)[; \t\r\n]*mso-[^:]+:[^;']+('[^>]*>)/gi,"$1$2");M=M.replace(/(<[^>]+[ \t\r\n]+style=')mso-[^:]+:[^;']+;([^']*'[^>]*>)/gi,"$1$2");M=M.replace(/(<[^>]+[ \t\r\n]+style=')mso-[^:]+:[^;']+('[^>]*>)/gi,"$1$2")}if(H){M=M.replace(/(<[^>]+)[ \t\r\n]+style=""([^>]*>)/gi,"$1$2")}if(P){while(true){var C=M.indexOf("<![endif]-->");var I=M.substring(0,C).lastIndexOf("<!--[if");if((C<0)||(I<0)){break}M=M.substring(0,I)+M.substring(C+12)}while(true){var C=M.indexOf("[endif]");var I=M.substring(0,C).lastIndexOf("[if");if((C<0)||(I<0)){break}M=M.substring(0,I)+M.substring(C+7)}}if(S){M=M.replace(/<span *><span *>([^<]*)<\/span><\/span>/gi,"<span>$1</span>");M=M.replace(/<span><\/span>/gi,"");M=M.replace(/<span\s[^>]*><\/span>/gi,"");M=M.replace(/<span *>([^<]*)<\/span>/gi,"$1")}if(B){M=M.replace(/<\/?span[^>]*>/gi,"")}if(N){M=M.replace(/<font><font>([^<]*)<\/font><\/font>/gi,"<font>$1</font>");M=M.replace(/<font[^>]*><\/font>/gi,"");M=M.replace(/<font>([^<]*)<\/font>/gi,"$1")}if(R){M=M.replace(/<\/?font[^>]*>/gi,"")}if(J){M=M.replace(/<p>( |&nbsp;)*<\/p>[\r\n]*/gi,"");M=M.replace(/<p><\/p>[\r\n]*/gi,"");M=M.replace(/<p\/>[\r\n]*/gi,"");M=M.replace(/<div>( |&nbsp;)*<\/div>[\r\n]*/gi,"");M=M.replace(/<div><\/div>[\r\n]*/gi,"");M=M.replace(/<div\/>[\r\n]*/gi,"");M=M.replace(/<p\s[^>]*>( |&nbsp;)*<\/p>[\r\n]*/gi,"");M=M.replace(/<p\s[^>]*><\/p>[\r\n]*/gi,"");M=M.replace(/<p\s[^>]*\/>[\r\n]*/gi,"");M=M.replace(/<div\s[^>]*>( |&nbsp;)*<\/div>[\r\n]*/gi,"");M=M.replace(/<div\s[^>]*><\/div>[\r\n]*/gi,"");M=M.replace(/<div\s[^>]*\/>[\r\n]*/gi,"")}if(Q){M=M.replace(/<(\/?)address[^>]*>/gi,"<$1p>");M=M.replace(/<\/?b>/gi,"");M=M.replace(/<\/?big>/gi,"");M=M.replace(/<\/?blink[^>]*>/gi,"");M=M.replace(/<(\/?)blockquote>/gi,"<$1p>");M=M.replace(/<(\/?)center>/gi,"<$1p>");M=M.replace(/<\/?cite>/gi,"");M=M.replace(/<\/?code>/gi,"");M=M.replace(/<\/?em>/gi,"");M=M.replace(/<(\/?)h1>/gi,"<$1p>");M=M.replace(/<(\/?)h2>/gi,"<$1p>");M=M.replace(/<(\/?)h3>/gi,"<$1p>");M=M.replace(/<(\/?)h4>/gi,"<$1p>");M=M.replace(/<(\/?)h5>/gi,"<$1p>");M=M.replace(/<(\/?)h6>/gi,"<$1p>");M=M.replace(/<\/?i>/gi,"");M=M.replace(/<\/?kbd>/gi,"");M=M.replace(/<(\/?)pre>/gi,"<$1p>");M=M.replace(/<\/?q>/gi,"");M=M.replace(/<\/?s>/gi,"");M=M.replace(/<\/?samp>/gi,"");M=M.replace(/<\/?small>/gi,"");M=M.replace(/<\/?strike>/gi,"");M=M.replace(/<\/?strong>/gi,"");M=M.replace(/<\/?sub>/gi,"");M=M.replace(/<\/?sup>/gi,"");M=M.replace(/<\/?u>/gi,"");M=M.replace(/<\/?var>/gi,"")}M=M.replace(/<p([ \t\r\n]+[^<]*)?><span([ \t\r\n]+[^<]*)?>([^<]*)<\/p><\/span>/gi,"<p $1><span $2>$3</span></p>");M=M.replace(/<span([ \t\r\n]+[^<]*)?><p([ \t\r\n]+[^<]*)?>([^<]*)<\/span><\/p>/gi,"<p $1><span $2>$3</span></p>");M=M.replace(/<([a-zA-Z][a-zA-Z0-9]*)[ \t\r\n]+>/g,"<$1>");return M}function insertMailto(D,E,F,H){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();var B="mailto:"+D;if(E){B+="?subject="+E.replace("&","%26").replace(":","%3A").replace("=","%3D")}var C=contenteditable_selection_container("a");if(C){G=C.innerHTML;if(contenteditable_getAttribute(C,"href")!=B){if(B==""){contenteditable_removeAttribute(C,"href")}else{contenteditable_setAttribute(C,"href",B)}}if(contenteditable_getAttribute(C,"class")!=F){if(F==""){contenteditable_removeAttribute(C,"class")}else{contenteditable_setAttribute(C,"class",F)}}if(contenteditable_getAttribute(C,"id")!=H){if(H==""){contenteditable_removeAttribute(C,"id")}else{contenteditable_setAttribute(C,"id",H)}}C.innerHTML=G}else{var G=contenteditable_selection_text()||E||D||"&nbsp;";var A="";if(B){A+=' href="'+B+'"'}if(H){A+=' id="'+H+'"'}if(F){A+=' class="'+F+'"'}C=contenteditable_pasteContent("<a"+A+">"+G+"</a>");if(C){contenteditable_selection_node(C)}if(C=contenteditable_selection_container("a")){insertMailto(D,E,F,H)}}contenteditable_undo_save();contenteditable_mailto_fix();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}function insertAnchor(C,D,F){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();var B=contenteditable_selection_container("a");if(B){if(contenteditable_getAttribute(B,"name")!=C){if(C==""){contenteditable_removeAttribute(B,"name")}else{contenteditable_setAttribute(B,"name",C)}}if(contenteditable_getAttribute(B,"class")!=D){if(D==""){contenteditable_removeAttribute(B,"class")}else{contenteditable_setAttribute(B,"class",D)}}if(contenteditable_getAttribute(B,"id")!=F){if(F==""){contenteditable_removeAttribute(B,"id")}else{contenteditable_setAttribute(B,"id",F)}}}else{var E=contenteditable_selection_text()||"&nbsp;";var A="";if(C){A+=' name="'+C+'"'}if(F){A+=' id="'+F+'"'}if(D){A+=' class="'+D+'"'}B=contenteditable_pasteContent("<a"+A+">"+E+"</a>");if(B){contenteditable_selection_node(B)}if(B=contenteditable_selection_container("a")){insertAnchor(C,D,F)}}contenteditable_undo_save();contenteditable_anchor_fix();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}function insertBox(B,K,D,C,G,A,I,L){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();var F=contenteditable_selection_container("div");if(F&&F.style&&(F.style.position=="absolute")){B=B.replace(/^([0-9]+)$/gi,"$1px");K=K.replace(/^([0-9]+)$/gi,"$1px");D=D.replace(/^([0-9]+)$/gi,"$1px");try{if(B){F.style.width=B}}catch(H){}try{if(K){F.style.height=K}}catch(H){}try{if(D){F.style.borderWidth=D}}catch(H){}try{if(C){F.style.borderStyle=C}}catch(H){}try{if(G){F.style.borderColor=G}}catch(H){}try{if(A){F.style.backgroundColor=A}}catch(H){}if(contenteditable_getAttribute(F,"class")!=I){if(I==""){contenteditable_removeAttribute(F,"class")}else{contenteditable_setAttribute(F,"class",I)}}if(contenteditable_getAttribute(F,"id")!=L){if(L==""){contenteditable_removeAttribute(F,"id")}else{contenteditable_setAttribute(F,"id",L)}}}else{var J=contenteditable_selection_text()||"&nbsp;&nbsp;";var E="";E+=' style="position:absolute;';B=B.replace(/^([0-9]+)$/gi,"$1px");K=K.replace(/^([0-9]+)$/gi,"$1px");D=D.replace(/^([0-9]+)$/gi,"$1px");if(B){E+=" width: "+B+";"}if(K){E+=" height: "+K+";"}if(D){E+=" border-width: "+D+";"}if(C){E+=" border-style: "+C+";"}if(G){E+=" border-color: "+G+";"}if(A){E+=" background-color: "+A+";"}E+='"';if(L){E+=' id="'+L+'"'}if(I){E+=' class="'+I+'"'}F=contenteditable_pasteContent("<div"+E+">"+J+"</div>");if(F){contenteditable_selection_node(F)}if(F=contenteditable_selection_container("div")){insertBox(B,K,D,C,G,A,I,L)}contenteditable_position(true)}contenteditable_undo_save();contenteditable_box_fix();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}function insertIframe(B,H,A,G,I,D,C){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();var F=contenteditable_selection_container("iframe");if(F){if(contenteditable_getAttribute(F,"width")!=B){if(B==""){contenteditable_removeAttribute(F,"width")}else{contenteditable_setAttribute(F,"width",B)}}if(contenteditable_getAttribute(F,"height")!=H){if(H==""){contenteditable_removeAttribute(F,"height")}else{contenteditable_setAttribute(F,"height",H)}}if(contenteditable_getAttribute(F,"src")!=A){if(A==""){contenteditable_removeAttribute(F,"src")}else{contenteditable_setAttribute(F,"src",A)}}if(contenteditable_getAttribute(F,"class")!=G){if(G==""){contenteditable_removeAttribute(F,"class")}else{contenteditable_setAttribute(F,"class",G)}}if(contenteditable_getAttribute(F,"id")!=I){if(I==""){contenteditable_removeAttribute(F,"id")}else{contenteditable_setAttribute(F,"id",I)}}if(contenteditable_getAttribute(F,"name")!=I){if(D==""){contenteditable_removeAttribute(F,"name")}else{contenteditable_setAttribute(F,"name",D)}}if(contenteditable_getAttribute(F,"title")!=I){if(C==""){contenteditable_removeAttribute(F,"title")}else{contenteditable_setAttribute(F,"title",C)}}}else{var E="";if(B){E+=' width="'+B+'"'}if(H){E+=' height="'+H+'"'}if(A){E+=' src="'+A+'"'}if(I){E+=' id="'+I+'"'}if(D){E+=' name="'+D+'"'}if(C){E+=' title="'+C+'"'}if(G){E+=' class="'+G+'"'}F=contenteditable_pasteContent("<iframe"+E+">&nbsp;</iframe>");if(F){contenteditable_selection_node(F)}if(F=contenteditable_selection_container("iframe")){insertIframe(B,H,A,G,I,D,C)}contenteditable_insertiframe_fix(B,H,A,G,I,D,C)}contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}function insertForm(C,A,H,G,E,F,I,J){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();var B=contenteditable_selection_container("form");if(B){if(contenteditable_getAttribute(B,"action")!=C){if(C==""){contenteditable_removeAttribute(B,"action")}else{contenteditable_setAttribute(B,"action",C)}}if(contenteditable_getAttribute(B,"method")!=A){if(A==""){contenteditable_removeAttribute(B,"method")}else{contenteditable_setAttribute(B,"method",A)}}if(contenteditable_getAttribute(B,"enctype")!=H){if(H==""){contenteditable_removeAttribute(B,"enctype")}else{contenteditable_setAttribute(B,"enctype",H)}}if(contenteditable_getAttribute(B,"target")!=G){if(G==""){contenteditable_removeAttribute(B,"target")}else{contenteditable_setAttribute(B,"target",G)}}if(contenteditable_getAttribute(B,"onsubmit")!=E){if(E==""){contenteditable_removeAttribute(B,"onsubmit")}else{contenteditable_setAttribute(B,"onsubmit",E)}}if(contenteditable_getAttribute(B,"onreset")!=F){if(F==""){contenteditable_removeAttribute(B,"onreset")}else{contenteditable_setAttribute(B,"onreset",F)}}if(contenteditable_getAttribute(B,"class")!=I){if(I==""){contenteditable_removeAttribute(B,"class")}else{contenteditable_setAttribute(B,"class",I)}}if(contenteditable_getAttribute(B,"id")!=J){if(J==""){contenteditable_removeAttribute(B,"id")}else{contenteditable_setAttribute(B,"id",J)}}}else{var D="";if(C){D+=' action="'+C+'"'}if(A){D+=' method="'+A+'"'}if(H){D+=' enctype="'+H+'"'}if(G){D+=' target="'+G+'"'}if(E){D+=' onsubmit="'+E+'"'}if(F){D+=' onreset="'+F+'"'}if(J){D+=' id="'+J+'"'}if(I){D+=' class="'+I+'"'}B=contenteditable_pasteContent("<form"+D+"><br></form>");if(B){contenteditable_selection_node(B)}if(B=contenteditable_selection_container("form")){insertForm(C,A,H,G,E,F,I,J)}}contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}function insertButton(E,B,H,A,D,I,K,F,G,J,C){insertInput("input",E,B,H,"","","","","","","","","",A,D,I,"",K,F,G,J,C)}function insertText(D,A,G,K,B,H,C,J,E,F,I){insertInput("input",D,A,G,"","","",K,B,"","","","","","",H,C,J,E,F,I,"")}function insertHidden(B,A,D,C,E){insertInput("input",B,A,D,"","","","","","","","","","","","","","","",C,E,"")}function insertTextarea(A,E,J,B,G,C,I,D,F,H){insertInput("textarea","",A,"","","","","","",E,J,B,"","","",G,C,I,D,F,H,"")}function insertCheckbox(C,A,F,G,H,B,J,D,E,I){insertInput("input",C,A,F,G,"","","","","","","","","","",H,B,J,D,E,I,"")}function insertFile(D,A,G,B,H,C,J,E,F,I){insertInput("input",D,A,G,"","","","","","","","",B,"","",H,C,J,E,F,I,"")}function insertSelect(A,H,J,I,E,B,G,C,D,F){if(webeditor.selectlist_node){contenteditable_selection_node(webeditor.selectlist_node)}insertInput("select","",A,"","",J,I,H,"","","","","","","",E,B,G,C,D,F,"")}function insertInput(Y,B,a,P,F,V,A,N,S,J,I,H,C,E,Q,Z,T,W,D,O,U,X){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();var K=contenteditable_selection_container(Y);if((!K)&&(Y=="select")&&(webeditor.selectlist_node)){K=webeditor.selectlist_node}if(K){contenteditable_selection_node(K);if(contenteditable_getAttribute(K,"name")!=a){if(a==""){contenteditable_removeAttribute(K,"name")}else{contenteditable_setAttribute(K,"name",a)}}if(contenteditable_getAttribute(K,"value")!=P){if(P==""){contenteditable_removeAttribute(K,"value")}else{contenteditable_setAttribute(K,"value",P)}}if(!F){contenteditable_removeAttribute(K,"checked")}else{contenteditable_setAttribute(K,"checked",true)}if(!V){contenteditable_removeAttribute(K,"multiple")}else{contenteditable_setAttribute(K,"multiple",true)}if(contenteditable_getAttribute(K,"size")!=N){if(N==""){contenteditable_removeAttribute(K,"size")}else{contenteditable_setAttribute(K,"size",N)}}if(contenteditable_getAttribute(K,"maxLength")!=S){if(S==""){contenteditable_removeAttribute(K,"maxLength")}else{contenteditable_setAttribute(K,"maxLength",S)}}if(contenteditable_getAttribute(K,"cols")!=J){if(J==""){contenteditable_removeAttribute(K,"cols")}else{contenteditable_setAttribute(K,"cols",J)}}if(contenteditable_getAttribute(K,"rows")!=I){if(I==""){contenteditable_removeAttribute(K,"rows")}else{contenteditable_setAttribute(K,"rows",I)}}if(contenteditable_getAttribute(K,"wrap")!=H){if(H==""){contenteditable_removeAttribute(K,"wrap")}else{contenteditable_setAttribute(K,"wrap",H)}}if(contenteditable_getAttribute(K,"accept")!=C){if(C==""){contenteditable_removeAttribute(K,"accept")}else{contenteditable_setAttribute(K,"accept",C)}}if(contenteditable_getAttribute(K,"src")!=E){if(E==""){contenteditable_removeAttribute(K,"src")}else{contenteditable_setAttribute(K,"src",E)}}if(contenteditable_getAttribute(K,"align")!=Q){if(Q==""){contenteditable_removeAttribute(K,"align")}else{contenteditable_setAttribute(K,"align",Q)}}if(contenteditable_getAttribute(K,"onclick")!=Z){if(Z==""){contenteditable_removeAttribute(K,"onclick")}else{contenteditable_setAttribute(K,"onclick",Z)}}if(contenteditable_getAttribute(K,"onchange")!=T){if(T==""){contenteditable_removeAttribute(K,"onchange")}else{contenteditable_setAttribute(K,"onchange",T)}}if(contenteditable_getAttribute(K,"onfocus")!=W){if(W==""){contenteditable_removeAttribute(K,"onfocus")}else{contenteditable_setAttribute(K,"onfocus",W)}}if(contenteditable_getAttribute(K,"onblur")!=D){if(D==""){contenteditable_removeAttribute(K,"onblur")}else{contenteditable_setAttribute(K,"onblur",D)}}if(contenteditable_getAttribute(K,"class")!=O){if(O==""){contenteditable_removeAttribute(K,"class")}else{contenteditable_setAttribute(K,"class",O)}}if(contenteditable_getAttribute(K,"id")!=U){if(U==""){contenteditable_removeAttribute(K,"id")}else{contenteditable_setAttribute(K,"id",U)}}if(contenteditable_getAttribute(K,"alt")!=X){if(X==""){contenteditable_removeAttribute(K,"alt")}else{contenteditable_setAttribute(K,"alt",X)}}if(A){K.selectedIndex=0;for(var R=0;R<A.length;R++){var L=contenteditable_focused_document().createElement("option");L.text=A[R].text;L.value=A[R].value;L.selected=A[R].defaultselected;L.defaultSelected=A[R].defaultselected;K.options[R]=L}K.length=A.length}if(contenteditable_getAttribute(K,"type")!=B){if(B==""){contenteditable_removeAttribute(K,"type")}else{contenteditable_setAttribute(K,"type",B)}}}else{var G="";var M="";if(A){for(var R=0;R<A.length;R++){M+='<option value="';M+=A[R].value;M+='"';M+=A[R].defaultselected?" selected":"";M+=">";M+=A[R].text}}if(B){G+=' type="'+B+'"'}if(a){G+=' name="'+a+'"'}if(P){G+=' value="'+P+'"'}if(F){G+=" checked"}if(V){G+=" multiple"}if(N){G+=' size="'+N+'"'}if(S){G+=' maxLength="'+S+'"'}if(J){G+=' cols="'+J+'"'}if(I){G+=' rows="'+I+'"'}if(H){G+=' wrap="'+H+'"'}if(E){G+=' src="'+E+'"'}if(Z){G+=' onclick="'+Z+'"'}if(T){G+=' onchange="'+T+'"'}if(W){G+=' onfocus="'+W+'"'}if(D){G+=' onblur="'+D+'"'}if(U){G+=' id="'+U+'"'}if(O){G+=' class="'+O+'"'}if(X){G+=' alt="'+X+'"'}if(Y=="textarea"){K=contenteditable_pasteContent("<textarea"+G+"></textarea>");if(K){contenteditable_selection_node(K)}if(K=contenteditable_selection_container(Y)){insertInput(Y,B,a,P,F,V,A,N,S,J,I,H,C,E,Q,Z,T,W,D,O,U,X)}}else{if(Y=="select"){K=contenteditable_pasteContent("<select"+G+">"+M+"</select>");if(K){contenteditable_selection_node(K)}if(K=contenteditable_selection_container(Y)){insertInput(Y,B,a,P,F,V,A,N,S,J,I,H,C,E,Q,Z,T,W,D,O,U,X)}}else{K=contenteditable_pasteContent("<input"+G+">");if(K){contenteditable_selection_node(K)}if(K=contenteditable_selection_container(Y)){insertInput(Y,B,a,P,F,V,A,N,S,J,I,H,C,E,Q,Z,T,W,D,O,U,X)}}}}contenteditable_undo_save();if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}function insertMap(D,J,C,A,K,L){var H="";if(A){for(var F=0;F<A.length;F++){var E=A[F].text.split("=");var G=E[0];var I=E[1];var B=A[F].value;H+='<area shape="';H+=G;H+='" coords="';H+=I;H+='" href="';H+=B;H+='">'}}if(D){contenteditable_setAttribute(D,"useMap","#"+C);if(!J){J=contenteditable_focused_document().createElement("map");contenteditable_setAttribute(J,"name",C);D.parentNode.insertBefore(J,D)}if(J){if(contenteditable_getAttribute(J,"class")!=K){if(K==""){contenteditable_removeAttribute(J,"class")}else{contenteditable_setAttribute(J,"class",K)}}if(contenteditable_getAttribute(J,"id")!=L){if(L==""){contenteditable_removeAttribute(J,"id")}else{contenteditable_setAttribute(J,"id",L)}}contenteditable_setAttribute(J,"name",C);J.innerHTML=H;contenteditable_insertmap_fix(J);contenteditable_event_paste_fix(J)}}}function insertTable(L,F,C,B,I,G,D,A,K,E,H,J){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();if(!C){C="1"}contenteditable_createtable(L,F,C,B,I,G,D,A,K,E,H,J);contenteditable_undo_save()}function insertHyperlink(A,D,F,C,G,B,E){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();contenteditable_createlink(A,D,F,C,G,B,E);contenteditable_undo_save()}function insertImage(A,D,E,B,J,C,K,G,H,M,L,I,F){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();contenteditable_insertimage(A,D,E,B,J,C,K,G,H,M,L,I,F);contenteditable_undo_save()}function insertFlash(E,D,B,A,C,F){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();contenteditable_insertflash(E,D,B,A,C,F);contenteditable_undo_save()}function insertApplet(E,D,B,A,C,F){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();contenteditable_insertapplet(E,D,B,A,C,F);contenteditable_undo_save()}function insertQuicktime(E,D,B,A,C,F){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();contenteditable_insertquicktime(E,D,B,A,C,F);contenteditable_undo_save()}function insertVideo(A,F,C,L,I,M,G,K,B,H,E,D,J){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();contenteditable_insertvideo(A,F,C,L,I,M,G,K,B,H,E,D,J);contenteditable_undo_save()}function insertAudio(A,E,H,J,F,B,G,D,C,I){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();contenteditable_insertaudio(A,E,H,J,F,B,G,D,C,I);contenteditable_undo_save()}function insertSpecialCharacter(A){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();contenteditable_specialcharacter(A);contenteditable_undo_save();if(webeditor.specialcharacter_window){webeditor.specialcharacter_window.close();webeditor.specialcharacter_window=null}}function backColor(A){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();if(A){contenteditable_execcommand("backcolor",rgb2hexColor(A))}contenteditable_undo_save()}function foreColor(A){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();if(A){contenteditable_execcommand("forecolor",rgb2hexColor(A))}contenteditable_undo_save()}function rgb2hexColor(A){if(A.match(new RegExp("^rgb\\( *(.*) *, *(.*) *, *(.*) *\\)$"))){var B="0123456789ABCDEF";A="#"+B.charAt(Math.floor(RegExp.$1/16))+B.charAt(RegExp.$1%16)+B.charAt(Math.floor(RegExp.$2/16))+B.charAt(RegExp.$2%16)+B.charAt(Math.floor(RegExp.$3/16))+B.charAt(RegExp.$3%16)}return A}function updateTable(B){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();var A;if(A=contenteditable_isTable()){if((contenteditable_getAttribute(A,"width")!=B.width.value)||((contenteditable_getAttribute(A,"width")!=A.style.width)&&(A.style.width!=""))){if(B.width.value==""){contenteditable_removeAttribute(A,"width");A.style.width="auto";A.style.width="";try{delete A.style.width}catch(C){}if(A.style.removeProperty){A.style.removeProperty("width")}if(contenteditable_getAttribute(A,"style")==""){contenteditable_removeAttribute(A,"style")}}else{contenteditable_setAttribute(A,"width",B.width.value);if(A.style.width){if(B.width.value.match(new RegExp("^[0-9]+$"))){A.style.width=B.width.value+"px"}else{A.style.width=B.width.value}}}}if((contenteditable_getAttribute(A,"height")!=B.height.value)||((contenteditable_getAttribute(A,"height")!=A.style.height)&&(A.style.height!=""))){if(B.height.value==""){contenteditable_removeAttribute(A,"height");A.style.height="auto";A.style.height="";try{delete A.style.height}catch(C){}if(A.style.removeProperty){A.style.removeProperty("height")}if(contenteditable_getAttribute(A,"style")==""){contenteditable_removeAttribute(A,"style")}}else{contenteditable_setAttribute(A,"height",B.height.value);if(A.style.height){if(B.height.value.match(new RegExp("^[0-9]+$"))){A.style.height=B.height.value+"px"}else{A.style.height=B.height.value}}}}if(contenteditable_getAttribute(A,"cellPadding")!=B.cellpadding.value){if(B.cellpadding.value==""){contenteditable_removeAttribute(A,"cellPadding")}else{contenteditable_setAttribute(A,"cellPadding",B.cellpadding.value)}}if(contenteditable_getAttribute(A,"cellSpacing")!=B.cellspacing.value){if(B.cellspacing.value==""){contenteditable_removeAttribute(A,"cellSpacing")}else{contenteditable_setAttribute(A,"cellSpacing",B.cellspacing.value)}}if(contenteditable_getAttribute(A,"border")!=B.border.value){if(B.border.value==""){contenteditable_removeAttribute(A,"border")}else{contenteditable_setAttribute(A,"border",B.border.value)}}if(contenteditable_getAttribute(A,"bgColor")!=B.bgcolor.value){if(B.bgcolor.value==""){contenteditable_removeAttribute(A,"bgColor")}else{contenteditable_setAttribute(A,"bgColor",B.bgcolor.value)}}if(contenteditable_getAttribute(A,"borderColor")!=B.bordercolor.value){if(B.bordercolor.value==""){contenteditable_removeAttribute(A,"borderColor")}else{contenteditable_setAttribute(A,"borderColor",B.bordercolor.value)}}if(contenteditable_getAttribute(A,"background")!=B.background.value){if(B.background.value==""){contenteditable_removeAttribute(A,"background")}else{contenteditable_setAttribute(A,"background",B.background.value)}}if(contenteditable_getAttribute(A,"class")!=B.htmlclass.value){if(B.htmlclass.value==""){contenteditable_removeAttribute(A,"class")}else{contenteditable_setAttribute(A,"class",B.htmlclass.value)}}if(contenteditable_getAttribute(A,"id")!=B.htmlid.value){if(B.htmlid.value==""){contenteditable_removeAttribute(A,"id")}else{contenteditable_setAttribute(A,"id",B.htmlid.value)}}}contenteditable_undo_save()}function updateRow(A){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();var B;if(B=contenteditable_isRow()){if(contenteditable_getAttribute(B,"align")!=A.align.value){if(A.align.value==""){contenteditable_removeAttribute(B,"align")}else{contenteditable_setAttribute(B,"align",A.align.value)}}if(contenteditable_getAttribute(B,"vAlign")!=A.valign.value){if(A.valign.value==""){contenteditable_removeAttribute(B,"vAlign")}else{contenteditable_setAttribute(B,"vAlign",A.valign.value)}}if(contenteditable_getAttribute(B,"bgColor")!=A.bgcolor.value){if(A.bgcolor.value==""){contenteditable_removeAttribute(B,"bgColor")}else{contenteditable_setAttribute(B,"bgColor",A.bgcolor.value)}}if(contenteditable_getAttribute(B,"borderColor")!=A.bordercolor.value){if(A.bordercolor.value==""){contenteditable_removeAttribute(B,"borderColor")}else{contenteditable_setAttribute(B,"borderColor",A.bordercolor.value)}}if(contenteditable_getAttribute(B,"background")!=A.background.value){if(A.background.value==""){contenteditable_removeAttribute(B,"background")}else{contenteditable_setAttribute(B,"background",A.background.value)}}if(contenteditable_getAttribute(B,"class")!=A.htmlclass.value){if(A.htmlclass.value==""){contenteditable_removeAttribute(B,"class")}else{contenteditable_setAttribute(B,"class",A.htmlclass.value)}}if(contenteditable_getAttribute(B,"id")!=A.htmlid.value){if(A.htmlid.value==""){contenteditable_removeAttribute(B,"id")}else{contenteditable_setAttribute(B,"id",A.htmlid.value)}}}contenteditable_undo_save()}function updateColumn(A){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();var J;var K;var I;if((I=contenteditable_isCell())&&(K=contenteditable_isRow())&&(J=contenteditable_isTable())){var C=contenteditable_adjustedCellColumns(J);var D=C[contenteditable_rowIndex(K)][contenteditable_cellIndex(I)];var H=0;for(var F=0;F<J.rows.length;F++){if(!H){var B=0;for(var E=0;((E<J.rows[F].cells.length)&&(B<=D));E++){B=C[F][E];if((B==D)||(B+contenteditable_cellColSpan(J.rows[F].cells[E])>D)){var G=J.rows[F].cells[E];if(contenteditable_getAttribute(G,"width")!=A.width.value){if(A.width.value==""){contenteditable_removeAttribute(G,"width")}else{contenteditable_setAttribute(G,"width",A.width.value)}}if(contenteditable_getAttribute(G,"height")!=A.height.value){if(A.height.value==""){contenteditable_removeAttribute(G,"height")}else{contenteditable_setAttribute(G,"height",A.height.value)}}if(contenteditable_getAttribute(G,"align")!=A.align.value){if(A.align.value==""){contenteditable_removeAttribute(G,"align")}else{contenteditable_setAttribute(G,"align",A.align.value)}}if(contenteditable_getAttribute(G,"vAlign")!=A.valign.value){if(A.valign.value==""){contenteditable_removeAttribute(G,"vAlign")}else{contenteditable_setAttribute(G,"vAlign",A.valign.value)}}if(contenteditable_getAttribute(G,"bgColor")!=A.bgcolor.value){if(A.bgcolor.value==""){contenteditable_removeAttribute(G,"bgColor")}else{contenteditable_setAttribute(G,"bgColor",A.bgcolor.value)}}if(contenteditable_getAttribute(G,"borderColor")!=A.bordercolor.value){if(A.bordercolor.value==""){contenteditable_removeAttribute(G,"borderColor")}else{contenteditable_setAttribute(G,"borderColor",A.bordercolor.value)}}if(contenteditable_getAttribute(G,"background")!=A.background.value){if(A.background.value==""){contenteditable_removeAttribute(G,"background")}else{contenteditable_setAttribute(G,"background",A.background.value)}}if(contenteditable_getAttribute(G,"class")!=A.htmlclass.value){if(A.htmlclass.value==""){contenteditable_removeAttribute(G,"class")}else{contenteditable_setAttribute(G,"class",A.htmlclass.value)}}H=contenteditable_cellRowSpan(J.rows[F].cells[E])-1}else{if((B+contenteditable_cellColSpan(J.rows[F].cells[E]))>D){H=contenteditable_cellRowSpan(J.rows[F].cells[E])-1}}B+=contenteditable_cellColSpan(J.rows[F].cells[E])}}else{H--}}}contenteditable_undo_save()}function updateCell(B){contenteditable_focused_contentwindow_focus(false);contenteditable_undo_save();var A;if(A=contenteditable_isCell()){if(contenteditable_getAttribute(A,"width")!=B.width.value){if(B.width.value==""){contenteditable_removeAttribute(A,"width")}else{contenteditable_setAttribute(A,"width",B.width.value)}}if(contenteditable_getAttribute(A,"height")!=B.height.value){if(B.height.value==""){contenteditable_removeAttribute(A,"height")}else{contenteditable_setAttribute(A,"height",B.height.value)}}if(contenteditable_getAttribute(A,"colSpan")!=B.colspan.value){if(B.colspan.value==""){contenteditable_removeAttribute(A,"colSpan")}else{contenteditable_setAttribute(A,"colSpan",B.colspan.value)}}if(contenteditable_getAttribute(A,"rowSpan")!=B.rowspan.value){if(B.rowspan.value==""){contenteditable_removeAttribute(A,"rowSpan")}else{contenteditable_setAttribute(A,"rowSpan",B.rowspan.value)}}if(contenteditable_getAttribute(A,"align")!=B.align.value){if(B.align.value==""){contenteditable_removeAttribute(A,"align")}else{contenteditable_setAttribute(A,"align",B.align.value)}}if(contenteditable_getAttribute(A,"vAlign")!=B.valign.value){if(B.valign.value==""){contenteditable_removeAttribute(A,"vAlign")}else{contenteditable_setAttribute(A,"vAlign",B.valign.value)}}if(contenteditable_getAttribute(A,"bgColor")!=B.bgcolor.value){if(B.bgcolor.value==""){contenteditable_removeAttribute(A,"bgColor")}else{contenteditable_setAttribute(A,"bgColor",B.bgcolor.value)}}if(contenteditable_getAttribute(A,"borderColor")!=B.bordercolor.value){if(B.bordercolor.value==""){contenteditable_removeAttribute(A,"borderColor")}else{contenteditable_setAttribute(A,"borderColor",B.bordercolor.value)}}if(contenteditable_getAttribute(A,"background")!=B.background.value){if(B.background.value==""){contenteditable_removeAttribute(A,"background")}else{contenteditable_setAttribute(A,"background",B.background.value)}}if(contenteditable_getAttribute(A,"class")!=B.htmlclass.value){if(B.htmlclass.value==""){contenteditable_removeAttribute(A,"class")}else{contenteditable_setAttribute(A,"class",B.htmlclass.value)}}if(contenteditable_getAttribute(A,"id")!=B.htmlid.value){if(B.htmlid.value==""){contenteditable_removeAttribute(A,"id")}else{contenteditable_setAttribute(A,"id",B.htmlid.value)}}}contenteditable_undo_save()}function importFile(A){A=contenteditable_split_content(false,A);if(webeditor.replace){A=contenteditable_doReplace(A,webeditor.replace)}try{if(webeditor_custom_encode){A=webeditor_custom_encode(A)}}catch(B){}try{if(webeditor_custom_initialize){A=webeditor_custom_initialize(A)}}catch(B){}A=contenteditable_encodeScriptTags(A);contenteditable_setContent(A)}var contenteditable_contents=new Array();var contenteditable_contents_head=new Array();var contenteditable_contents_body=new Array();var contenteditable_stylesheet=new Array();var contenteditable_inited=new Array();var contenteditable_inited_document=new Array();var contenteditable_inited_stylesheet=new Array();var contenteditable_viewsource_status=new Array();var contenteditable_viewdetails_status=new Array();var contenteditable_onfocus=new Array();var contenteditable_onblur=new Array();var contenteditable_focused=0;var contenteditable_event_paste_pre="";var contenteditable_event_paste_post="";var contenteditable_event_pasted_pre="";var contenteditable_event_pasted_post="";var contenteditable_event_paste_parentNode="";var contenteditable_event_paste_previousNode=new Array();var contenteditable_event_paste_nextNode=new Array();function contenteditable(G,F,D,B){var C="";contenteditable_contents[G]=F;if(D){var A=document.getElementById("stylesheet_toggle");if(A){A.checked=true}contenteditable_stylesheet[G]=D}else{var A=document.getElementById("stylesheet_toggle");if(A){A.checked=true}contenteditable_stylesheet[G]=webeditor.rootpath+"default.css"}var E="";E+="width: "+webeditor.width+"; height: "+webeditor.height+";";if(webeditor.minWidth){E+=" min-width: "+webeditor.minWidth+";"}if(webeditor.maxWidth){E+=" max-width: "+webeditor.maxWidth+";"}if(webeditor.minHeight){E+=" min-height: "+webeditor.minHeight+";"}if(webeditor.maxHeight){E+=" max-height: "+webeditor.maxHeight+";"}if((webbrowser=="MSIE")&&(webeditor.majorVersion==6)){if(webeditor.width=="100%"){E+=" width: auto !important;";if(webeditor.minWidth){E+=" width: "+webeditor.minWidth+";"}}if(webeditor.height=="100%"){E+=" height: auto !important;";if(webeditor.minHeight){E+=" height: "+webeditor.minHeight+";"}}}C+='<textarea id="'+G+'_textarea" name="'+G+'" cols="1" rows="1" style="display:none"></textarea>';C+='<iframe src="'+webeditor.rootpath+"empty."+webeditor.language+"?basehref="+encodeURIComponent(webeditor.baseHref)+'" id="'+G+'" class="webeditor_contenteditable" width="'+webeditor.width+'" height="'+webeditor.height+'" style="'+E+'"></iframe>';contenteditable_inited[G]=false;contenteditable_inited_document[G]=false;contenteditable_inited_stylesheet[G]=false;if(B&&(typeof (B)=="string")&&document.getElementById(B)){document.getElementById(B).innerHTML=C}else{if(B&&(typeof (B.innerHTML)!="undefined")){B.innerHTML=C}else{document.write(C)}}}function contenteditable_onSubmit(){for(var B=0;B<document.getElementsByTagName("iframe").length;B++){var C=document.getElementsByTagName("iframe").item(B);if((C.className=="webeditor_contenteditable")||(C.className=="webeditor_contenteditable_disabled")){if(contenteditable_viewsource_status[B]){contenteditable_focused=B;contenteditable_viewsource(false)}var D=C;while(D&&(D.tagName!="FORM")&&(D.tagName!="HTML")){D=D.parentNode}var A=false;if(D&&(D.tagName!="HTML")){A=D[C.id]}if((!A)||(A.id!=C.id+"_textarea")){A=document.getElementById(C.id+"_textarea")}if(A){var E=C.contentWindow.document.body.innerHTML;if(webeditor.formatcontent){E=contenteditable_formatContent(C.contentWindow.document.body)}if(webeditor.autoclean){E=cleanContentSub(E,webeditor.autocleanAllHTML,webeditor.autocleanAllXML,webeditor.autocleanAllNamespace,webeditor.autocleanAllLang,webeditor.autocleanAllClass,webeditor.autocleanAllStyle,webeditor.autocleanEmptySpan,webeditor.autocleanAllSpan,webeditor.autocleanEmptyFont,webeditor.autocleanAllFont,webeditor.autocleanAllDelIns,webeditor.autocleanEmptyPDiv,webeditor.autocleanAllFormatTags,webeditor.autocleanAllMsoClass,webeditor.autocleanAllMsoStyle,webeditor.autocleanAllMsoConditional,webeditor.autocleanEmptyStyle)}E=contenteditable_decodeScriptTags(E);if(webeditor.replace){E=contenteditable_doReplace(E,webeditor.replace)}try{if(webeditor_custom_decode){E=webeditor_custom_decode(E)}}catch(F){}try{if(webeditor_custom_finalize){E=webeditor_custom_finalize(E)}}catch(F){}E=contenteditable_merge_content(C.id,E);A.value=E;if(A.value!=E){A.innerText=E}}}}}function contenteditable_getContent(B){var A=contenteditable_getContentBodyNode(B);if(A){return A.innerHTML}}function contenteditable_getContentBodyNode(C){if(!C){if(contenteditable_viewsource_status[contenteditable_focused]){contenteditable_viewsource(false)}var B=document.getElementsByTagName("iframe").item(contenteditable_focused);if(B){return B.contentWindow.document.body}}else{for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);if((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled")){if(C==B.id){if(contenteditable_viewsource_status[A]){contenteditable_focused=A;contenteditable_viewsource(false)}return B.contentWindow.document.body}}}}}function contenteditable_getContentSelection(F){if(!F){if(contenteditable_viewsource_status[contenteditable_focused]){contenteditable_viewsource(false)}var A=contenteditable_focused_contentwindow();var E=contenteditable_selection(A);var D=contenteditable_selection_text(E);return D}else{for(var B=0;B<document.getElementsByTagName("iframe").length;B++){var C=document.getElementsByTagName("iframe").item(B);if((C.className=="webeditor_contenteditable")||(C.className=="webeditor_contenteditable_disabled")){if(F==C.id){if(contenteditable_viewsource_status[B]){contenteditable_focused=B;contenteditable_viewsource(false)}var A=C.contentWindow;var E=contenteditable_selection(A);var D=contenteditable_selection_text(E);return D}}}}}function contenteditable_setContent(C,D){if(!D){if(contenteditable_viewsource_status[contenteditable_focused]){contenteditable_viewsource(false)}var B=document.getElementsByTagName("iframe").item(contenteditable_focused);if(B){contenteditable_setContent_body(C,D,B)}}else{for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);if((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled")){if(D==B.id){if(contenteditable_viewsource_status[A]){contenteditable_focused=A;contenteditable_viewsource(false)}contenteditable_setContent_body(C,D,B)}}}}}function contenteditable_pasteContent(D,G){var F;if(!G){var C=contenteditable_pasteContent_node(contenteditable_focused_document());C.innerHTML=D;contenteditable_event_paste_fix(C);if(contenteditable_viewsource_status[contenteditable_focused]){contenteditable_viewsource(false)}if(C.childNodes.length==1){C=contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),C.firstChild,D);F=C}else{C=contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),C,D);if(C){F=C.firstChild;contenteditable_remove_parentnode(C)}}}else{for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);if((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled")){if(G==B.id){var C=contenteditable_pasteContent_node();try{C.innerHTML=D}catch(E){D=D.replace(/<hr>/g,"");D=D.replace(/<hr\s[^>]*>/g,"");C.innerHTML=D}contenteditable_event_paste_fix(C);if(contenteditable_viewsource_status[A]){contenteditable_focused=A;contenteditable_viewsource(false)}if(C.childNodes.length==1){C=contenteditable_insertNodeAtSelection(B.contentWindow,C.firstChild,D);F=C}else{C=contenteditable_insertNodeAtSelection(B.contentWindow,C,D);if(C){F=C.firstChild;contenteditable_remove_parentnode(C)}}}}}}return F}function contenteditable_getElementById(B,E,A){if(B.getAttribute("id")==E){return B}var D=null;for(var C=0;C<B.childNodes.length;C++){if(B.childNodes[C].nodeType==1){D=contenteditable_getElementById(B.childNodes[C],E,A)}if(D!=null){break}}if(D!=null){return D}else{return A}}function contenteditable_getElementByTagName(B,E,A){if(B.tagName==E){return B}var D=null;if(B&&B.childNodes&&B.childNodes.length){for(var C=0;C<B.childNodes.length;C++){if(B.childNodes[C].nodeType==1){D=contenteditable_getElementByTagName(B.childNodes[C],E,A)}if(D!=null){break}}}if(D!=null){return D}else{return A}}function contenteditable_focus_toolbar(B){var A=B;while(A&&(A.nodeName!="TABLE")&&(A.nodeName!="BODY")&&(A.nodeName!="HTML")){A=A.parentNode}if(A&&A.id&&(A.id.match(new RegExp("^webeditor_toolbar_")))){contenteditable_focus(A.id.replace(new RegExp("^webeditor_toolbar_"),""))}}function contenteditable_focus(C){for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);if((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled")){if(C==B.id){if(!contenteditable_onfocus[A]){contenteditable_reinit()}contenteditable_onfocus[A]();if(webeditor.contentSelectionFocused!=contenteditable_focused){if(webeditor.contentSelectionBaseNode[contenteditable_focused]&&webeditor.contentSelectionExtentNode[contenteditable_focused]){contenteditable_selection().setBaseAndExtent(webeditor.contentSelectionBaseNode[contenteditable_focused],webeditor.contentSelectionBaseOffset[contenteditable_focused],webeditor.contentSelectionExtentNode[contenteditable_focused],webeditor.contentSelectionExtentOffset[contenteditable_focused])}webeditor.contentSelectionBaseNode[contenteditable_focused]=false;webeditor.contentSelectionExtentNode[contenteditable_focused]=false}}}}}function contenteditable_focused_contentwindow(){if(document.getElementsByTagName("iframe").item(contenteditable_focused)){return document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow}else{}}function contenteditable_focused_contentwindow_focus(A){if(A&&contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}else{if(contenteditable_focused_contentwindow()&&((!contenteditable_selection())||(contenteditable_selection().type=="None"))){contenteditable_focused_contentwindow().focus()}}}function contenteditable_focused_document(){if(document&&document.getElementsByTagName("iframe")&&document.getElementsByTagName("iframe").item(contenteditable_focused)&&document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow){return document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document}}function contenteditable_focused_iframe(){return document.getElementsByTagName("iframe").item(contenteditable_focused)}function contenteditable_focused_form(){var A=contenteditable_focused_iframe();while((A.tagName!="FORM")&&(A.tagName!="HTML")){A=A.parentNode}if(A.tagName!="HTML"){return A}}function contenteditable_focused_textarea(){var A=contenteditable_focused_iframe();var B=contenteditable_focused_form();if(B){return B[A.id]}else{return document.getElementById(A.id+"_textarea")}}function contenteditable_iframe(C){var B=document.getElementsByTagName("iframe");for(var A=0;A<B.length;A++){if((B.item(A).className=="webeditor_contenteditable")||(B.item(A).className=="webeditor_contenteditable_disabled")){if(B.item(A).id==C){return B.item(A)}}}}function contenteditable_createtable(F,G,L,K,I,Q,D,P,A,O,J,S){var H=contenteditable_focused_contentwindow();if((F>0)&&(G>0)){var R=H.document.createElement("table");if(L){contenteditable_setAttribute(R,"border",L)}if(K){contenteditable_setAttribute(R,"width",K)}if(I){contenteditable_setAttribute(R,"height",I)}if(Q){contenteditable_setAttribute(R,"cellPadding",Q)}if(D){contenteditable_setAttribute(R,"cellSpacing",D)}if(P){contenteditable_setAttribute(R,"background",P)}if(A){contenteditable_setAttribute(R,"bgColor",A)}if(O){contenteditable_setAttribute(R,"borderColor",O)}if(J){contenteditable_setAttribute(R,"class",J)}if(S){contenteditable_setAttribute(R,"id",S)}var B=H.document.createElement("tbody");for(var N=0;N<F;N++){var C=H.document.createElement("tr");for(var M=0;M<G;M++){var E=H.document.createElement("td");E.innerHTML="&nbsp;";C.appendChild(E)}B.appendChild(C)}R.appendChild(B);contenteditable_insertNodeAtSelection(H,R)}}function contenteditable_isTable(){var A;if((A=contenteditable_isRow())||(A=contenteditable_isTableCaption())||(A=contenteditable_selection_container())){while((A)&&(A.tagName!="TABLE")&&(A.tagName!="HTML")){A=A.parentNode}if((!A)||(A.tagName=="HTML")){return false}else{return A}}}function contenteditable_isTableCaption(){var A=contenteditable_selection_container();while((A)&&(A.tagName!="CAPTION")&&(A.tagName!="TABLE")&&(A.tagName!="HTML")){A=A.parentNode}if((!A)||(A.tagName!="CAPTION")){return false}else{return A}}function contenteditable_isTableHead(){var A;if((A=contenteditable_isRow())||(A=contenteditable_selection_container())){while((A)&&(A.tagName!="THEAD")&&(A.tagName!="TABLE")&&(A.tagName!="HTML")){A=A.parentNode}if(A&&(A.tagName=="THEAD")){return A}else{return false}}}function contenteditable_isTableBody(){var A;if((A=contenteditable_isRow())||(A=contenteditable_selection_container())){while((A)&&(A.tagName!="TBODY")&&(A.tagName!="TABLE")&&(A.tagName!="HTML")){A=A.parentNode}if(A&&(A.tagName=="TBODY")){return A}else{return false}}}function contenteditable_isTableFoot(){var A;if((A=contenteditable_isRow())||(A=contenteditable_selection_container())){while((A)&&(A.tagName!="TFOOT")&&(A.tagName!="TABLE")&&(A.tagName!="HTML")){A=A.parentNode}if((A)&&(A.tagName=="TFOOT")){return A}else{return false}}}function contenteditable_isRow(){var A;if((A=contenteditable_isCell())||(A=contenteditable_selection_container())){while((A)&&(A.tagName!="TR")&&(A.tagName!="HTML")){A=A.parentNode}if((!A)||(A.tagName=="HTML")){return false}else{return A}}}function contenteditable_isCell(){var A=contenteditable_selection_container();while((A)&&(A.tagName!="TD")&&(A.tagName!="TH")&&(A.tagName!="BODY")&&(A.tagName!="HTML")){A=A.parentNode}if((!A)||(A.tagName=="BODY")||(A.tagName=="HTML")){return false}else{return A}}function contenteditable_rowIndex(B){var D=0;var C=B.nodeName;var A=B.parentNode;if(A.nodeName!="TABLE"){while(A=A.previousSibling){if((A.nodeName=="THEAD")||(A.nodeName=="TBODY")){D+=A.rows.length}}}while(B=B.previousSibling){if(C==B.nodeName){D++}}return D}function contenteditable_adjustedCellColumns(I){var B=new Array();var A=new Array();for(var G=0;G<I.rows.length;G++){if(!A[G]){A[G]=new Array()}if(!B[G]){B[G]=new Array()}var D=0;for(var F=0;F<I.rows[G].cells.length;F++){var E=contenteditable_cellRowSpan(I.rows[G].cells[F]);var C=contenteditable_cellColSpan(I.rows[G].cells[F]);if(!A[G][D]){A[G][D]=0}while(A[G][D]){D+=A[G][D]}if(E>1){var H=parseInt(E);while(H>1){H--;if(!A[G+H]){A[G+H]=new Array()}A[G+H][D]=C}}B[G][F]=D;D+=C}}return B}function contenteditable_adjustedSelectionColumns(F){var E=new Array();var G=new Array();for(var C=0;C<F.length;C++){if(!G[C]){G[C]=new Array()}if(!E[C]){E[C]=new Array()}var D=0;for(var B=0;B<F[C].length;B++){if(!G[C][D]){G[C][D]=0}while(G[C][D]){D+=G[C][D]}if(contenteditable_cellRowSpan(F[C][B])>1){var A=parseInt(contenteditable_cellRowSpan(F[C][B]));while(A>1){A--;if(!G[C+A]){G[C+A]=new Array()}G[C+A][D]=contenteditable_cellColSpan(F[C][B])}}E[C][B]=D;D+=contenteditable_cellColSpan(F[C][B])}}return E}function contenteditable_insertrow_rowspans(B,C){if(B){for(var D=B.previousSibling;D;D=D.previousSibling){C++;for(var A=D.firstChild;A;A=A.nextSibling){if(A.tagName=="TD"){if((contenteditable_cellRowSpan(A)>C)&&(contenteditable_cellRowSpan(A)>1)){A.rowSpan++}}}}}}function contenteditable_insertcaption(){var C;if(C=contenteditable_isTable()){var A;for(var B=C.firstChild;B;B=B.nextSibling){if(B.tagName=="CAPTION"){A=B}}if(!A){A=contenteditable_focused_contentwindow().document.createElement("caption");A.innerHTML="caption";if(C.firstChild){C.insertBefore(A,C.firstChild)}else{C.appendChild(A)}}}}function contenteditable_insertrowhead(){var E;var G;if((E=contenteditable_isTable())&&(G=contenteditable_isRow())){var C;var F;for(var D=E.firstChild;D;D=D.nextSibling){if(D.tagName=="THEAD"){F=D}if(D.tagName=="CAPTION"){C=D}}if(F){}else{if(C){F=contenteditable_focused_contentwindow().document.createElement("thead");if(C.nextSibling){E.insertBefore(F,C.nextSibling)}else{E.appendChild(F)}}else{F=contenteditable_focused_contentwindow().document.createElement("thead");if(E.firstChild){E.insertBefore(F,E.firstChild)}else{E.appendChild(F)}}}var B=G.cloneNode(true);for(var A=B.firstChild;A;A=A.nextSibling){if(A.tagName=="TD"){contenteditable_removeAttribute(A,"rowSpan");A.innerHTML="&nbsp;"}}if(F.firstChild){F.insertBefore(B,F.firstChild)}else{F.appendChild(B)}}}function contenteditable_insertrowfoot(){var D;var F;if((D=contenteditable_isTable())&&(F=contenteditable_isRow())){var E;for(var C=D.firstChild;C;C=C.nextSibling){if(C.tagName=="TFOOT"){E=C}}if(!E){E=contenteditable_focused_contentwindow().document.createElement("tfoot");D.appendChild(E)}var B=F.cloneNode(true);for(var A=B.firstChild;A;A=A.nextSibling){if(A.tagName=="TD"){contenteditable_removeAttribute(A,"rowSpan");A.innerHTML="&nbsp;"}}E.appendChild(B)}}function contenteditable_insertrowabove(){var C;if(C=contenteditable_isRow()){var B=C.cloneNode(true);for(var A=B.firstChild;A;A=A.nextSibling){if(A.tagName=="TD"){contenteditable_removeAttribute(A,"rowSpan");A.innerHTML="&nbsp;"}}C.parentNode.insertBefore(B,C)}contenteditable_insertrow_rowspans(B,0)}function contenteditable_insertrowbelow(){var C;if(C=contenteditable_isRow()){var B=C.cloneNode(true);for(var A=B.firstChild;A;A=A.nextSibling){if(A.tagName=="TD"){if(contenteditable_cellRowSpan(A)>1){A.parentNode.removeChild(A)}A.innerHTML="&nbsp;"}}C.parentNode.insertBefore(B,C.nextSibling)}contenteditable_insertrow_rowspans(B,-1)}function contenteditable_deleterow(){var A=contenteditable_isTable();var B;if(tablecaption=contenteditable_isTableCaption()){A=tablecaption.parentNode;A.removeChild(tablecaption)}else{if((B=contenteditable_isRow())&&(tablehead=contenteditable_isTableHead())){if(tablehead.rows.length>1){B.parentNode.removeChild(B)}else{tablehead.parentNode.removeChild(tablehead)}}else{if((B=contenteditable_isRow())&&(tablebody=contenteditable_isTableBody())){if(tablebody.rows.length>1){B.parentNode.removeChild(B)}else{tablebody.parentNode.removeChild(tablebody)}}else{if((B=contenteditable_isRow())&&(tablefoot=contenteditable_isTableFoot())){if(tablefoot.rows.length>1){B.parentNode.removeChild(B)}else{tablefoot.parentNode.removeChild(tablefoot)}}else{if((B=contenteditable_isRow())&&(A=contenteditable_isTable())){if(A.rows.length>1){B.parentNode.removeChild(B)}else{A.parentNode.removeChild(A)}}}}}}if(A&&(A.rows.length==0)){A.parentNode.removeChild(A)}}function contenteditable_insertcolumnleft(){var K;var L;var J;if((J=contenteditable_isCell())&&(L=contenteditable_isRow())&&(K=contenteditable_isTable())){var D=contenteditable_adjustedCellColumns(K);var E=D[contenteditable_rowIndex(L)][contenteditable_cellIndex(J)];var I=0;for(var H=0;H<K.rows.length;H++){if(!I){var B=0;for(var G=0;((G<K.rows[H].cells.length)&&(B<=E));G++){var F=contenteditable_cellRowSpan(K.rows[H].cells[G]);var C=contenteditable_cellColSpan(K.rows[H].cells[G]);B=D[H][G];if(B==E){var A=contenteditable_focused_contentwindow().document.createElement("td");A.innerHTML="&nbsp;";if(contenteditable_cellRowSpan(K.rows[H].cells[G])){A.rowSpan=contenteditable_cellRowSpan(K.rows[H].cells[G])}I=F-1;K.rows[H].insertBefore(A,K.rows[H].cells[G])}else{if((B+C)>E){K.rows[H].cells[G].colSpan+=1;I=F-1}}B+=contenteditable_cellColSpan(K.rows[H].cells[G])}}else{I--}}}}function contenteditable_insertcolumnright(){var K;var L;var J;if((J=contenteditable_isCell())&&(L=contenteditable_isRow())&&(K=contenteditable_isTable())){var D=contenteditable_adjustedCellColumns(K);var E=D[contenteditable_rowIndex(L)][contenteditable_cellIndex(J)]+contenteditable_cellColSpan(J);var I=0;for(var H=0;H<K.rows.length;H++){if(!I){var B=0;for(var G=0;((G<K.rows[H].cells.length)&&(B<E));G++){var F=contenteditable_cellRowSpan(K.rows[H].cells[G]);var C=contenteditable_cellColSpan(K.rows[H].cells[G]);B=D[H][G];B+=C;if(B==E){var A=contenteditable_focused_contentwindow().document.createElement("td");A.innerHTML="&nbsp;";if(K.rows[H].cells[G].rowSpan){A.rowSpan=contenteditable_cellRowSpan(K.rows[H].cells[G])}I=F-1;if(K.rows[H].cells[G].nextSibling){K.rows[H].insertBefore(A,K.rows[H].cells[G].nextSibling)}else{K.rows[H].appendChild(A)}}else{if(B>E){K.rows[H].cells[G].colSpan+=1;I=F-1}}}}else{I--}}}}function contenteditable_deletecolumn(){var H;var I;var G;if((G=contenteditable_isCell())&&(I=contenteditable_isRow())&&(H=contenteditable_isTable())){if(I.cells.length>1){var B=contenteditable_adjustedCellColumns(H);var C=B[contenteditable_rowIndex(I)][contenteditable_cellIndex(G)];var F=0;for(var E=0;E<H.rows.length;E++){if(!F){var A=0;for(var D=0;((D<H.rows[E].cells.length)&&(A<=C));D++){A=B[E][D];if((A==C)&&(contenteditable_cellColSpan(H.rows[E].cells[D])==1)){F=contenteditable_cellRowSpan(H.rows[E].cells[D])-1;H.rows[E].removeChild(H.rows[E].cells[D]);A++;A=C+1}else{if((A+contenteditable_cellColSpan(H.rows[E].cells[D]))>C){H.rows[E].cells[D].colSpan-=1;F=contenteditable_cellRowSpan(H.rows[E].cells[D])-1;A+=contenteditable_cellColSpan(H.rows[E].cells[D]);A=C+1}}}}else{F--}}}else{H.parentNode.removeChild(H)}}}function contenteditable_insertcellleft(){var A;if(A=contenteditable_isCell()){var B=contenteditable_focused_contentwindow().document.createElement("td");B.innerHTML="&nbsp;";A.parentNode.insertBefore(B,A)}}function contenteditable_insertcellright(){var A;if(A=contenteditable_isCell()){var B=contenteditable_focused_contentwindow().document.createElement("td");B.innerHTML="&nbsp;";A.parentNode.insertBefore(B,A.nextSibling)}}function contenteditable_deletecell(){var B;var C;var A;if((A=contenteditable_isCell())&&(C=contenteditable_isRow())&&(B=contenteditable_isTable())){if(C.cells.length>1){C.removeChild(A)}else{contenteditable_deleterow()}}}function contenteditable_mergecells(){if(cells=contenteditable_selection_cells()){var E=contenteditable_adjustedSelectionColumns(cells);var C="";var H=0;var F=0;for(var G=0;G<cells.length;G++){if(C!=""){C+="<br>\r\n"}var A=0;for(var D=0;D<cells[G].length;D++){A=E[G][D];if(G==0){H+=contenteditable_cellColSpan(cells[G][D])}if(H==A){if(D==0){F+=contenteditable_cellRowSpan(cells[G][D])}}else{if(A==0){F+=contenteditable_cellRowSpan(cells[G][D])}}if(cells[G][D].innerHTML!="&nbsp;"){C+=cells[G][D].innerHTML}if(G||D){var B=cells[G][D].parentNode;B.removeChild(cells[G][D])}}}if(C==""){C="&nbsp;"}cells[0][0].innerHTML=C;cells[0][0].rowSpan=F;cells[0][0].colSpan=H}}function contenteditable_splitcell(){var I;var J;var H;if((H=contenteditable_isCell())&&(J=contenteditable_isRow())&&(I=contenteditable_isTable())){var B=contenteditable_cellIndex(H);var F=contenteditable_cellColSpan(H);var G=contenteditable_cellRowSpan(H);contenteditable_removeAttribute(H,"colSpan");contenteditable_removeAttribute(H,"rowSpan");for(var D=0;D<G;D++){if(D){if(J.rowIndex<J.parentNode.rows.length){J=J.parentNode.rows[J.rowIndex+1]}else{var E=J.cloneNode(false);J.parentNode.appendChild(E);J=E}}for(var C=0;C<F;C++){var A=H.cloneNode(true);contenteditable_removeAttribute(A,"colSpan");contenteditable_removeAttribute(A,"rowSpan");A.innerHTML="&nbsp;";if(D){if(J.cells&&J.cells[B]&&J.cells[B].nextSibling){J.insertBefore(A,J.cells[B].nextSibling)}else{J.appendChild(A)}}else{if(C){if(J.cells&&J.cells[B]&&J.cells[B].nextSibling){J.insertBefore(A,J.cells[B].nextSibling)}else{J.appendChild(A)}}}}}}}function contenteditable_splitcellcolumns(){var E;var G;var A;if((A=contenteditable_isCell())&&(G=contenteditable_isRow())){var D=contenteditable_cellIndex(A);var F=contenteditable_cellColSpan(A);contenteditable_removeAttribute(A,"colSpan");for(var C=1;C<F;C++){var B=A.cloneNode(true);contenteditable_removeAttribute(B,"colSpan");B.innerHTML="&nbsp;";if(A.nextSibling){G.insertBefore(B,A.nextSibling)}else{G.appendChild(B)}}}}function contenteditable_splitcellrows(){var H;var B;if((B=contenteditable_isCell())&&(H=contenteditable_isRow())){var F=contenteditable_cellIndex(B);var G=contenteditable_cellColSpan(B);var E=contenteditable_cellRowSpan(B);contenteditable_removeAttribute(B,"rowSpan");for(var D=1;D<E;D++){if(H.rowIndex<H.parentNode.rows.length){H=H.parentNode.rows[H.rowIndex+1]}else{var A=H.cloneNode(false);H.parentNode.appendChild(A);H=A}var C=B.cloneNode(true);contenteditable_removeAttribute(C,"rowSpan");if(G){contenteditable_setAttribute(C,"colSpan",G)}C.innerHTML="&nbsp;";if(H.cells[F]){H.insertBefore(C,H.cells[F])}else{H.appendChild(C)}}}}function contenteditable_createlink(A,E,I,H,K,J,G){var D=contenteditable_focused_contentwindow();if(A){if(contenteditable_selection()&&(contenteditable_selection().type=="Control")){var B=contenteditable_selection_container();I="<"+B.tagName.toLowerCase()+contenteditable_formatContentNodeAttributes(B)+">"}if(!I){I=A}I=I.replace(/<a\s+[^>]+>/gi,"");I=I.replace(/<\/a>/gi,"");var C=contenteditable_selection_container("a");if(C){contenteditable_selection_node(C);contenteditable_setAttribute(C,"href",A);if(E){contenteditable_setAttribute(C,"target",E)}else{contenteditable_removeAttribute(C,"target")}if(H){contenteditable_setAttribute(C,"class",H)}else{contenteditable_removeAttribute(C,"class")}if(K){contenteditable_setAttribute(C,"id",K)}else{contenteditable_removeAttribute(C,"id")}if(J){contenteditable_setAttribute(C,"onclick",J)}else{contenteditable_removeAttribute(C,"onclick")}if(G){contenteditable_setAttribute(C,"title",G)}else{contenteditable_removeAttribute(C,"title")}contenteditable_insertlink_fix(C,A,E,I,H,K,J,G)}else{var F=D.document.createElement("a");contenteditable_setAttribute(F,"href",A);if(E){contenteditable_setAttribute(F,"target",E)}if(H){contenteditable_setAttribute(F,"class",H)}if(K){contenteditable_setAttribute(F,"id",K)}if(J){contenteditable_setAttribute(F,"onclick",J)}if(G){contenteditable_setAttribute(F,"title",G)}F.innerHTML=I;var B=contenteditable_insertNodeAtSelection(D,F,null,true);contenteditable_insertlink_fix(B,A,E,I,H,K,J,G)}}}function contenteditable_insertimage(A,D,G,B,M,C,N,J,K,P,O,L,I){var H=contenteditable_focused_contentwindow();if(A){var F=contenteditable_selection_container("object");if((contenteditable_getAttribute(F,"classid")=="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000")||(contenteditable_getAttribute(F,"classid")=="clsid:CAFEEFAC-0014-0002-0000-ABCDEFFEDCBA")){F.parentNode.removeChild(F)}var E=H.document.createElement("img");contenteditable_setAttribute(E,"src",A);if(D){contenteditable_setAttribute(E,"border",D)}if(G){contenteditable_setAttribute(E,"alt",G)}if(B){contenteditable_setAttribute(E,"width",B)}if(M){contenteditable_setAttribute(E,"height",M)}if(C){contenteditable_setAttribute(E,"vspace",C)}if(N){contenteditable_setAttribute(E,"hspace",N)}if(J){contenteditable_setAttribute(E,"align",J)}if(O){contenteditable_setAttribute(E,"onMouseOver",O)}if(L){contenteditable_setAttribute(E,"onMouseOut",L)}if(I){contenteditable_setAttribute(E,"useMap",I)}if(K){contenteditable_setAttribute(E,"class",K)}if(P){contenteditable_setAttribute(E,"id",P)}contenteditable_insertNodeAtSelection(H,E);contenteditable_insertimage_fix(A,D,G,B,M,C,N,J,K,P,O,L,I)}}function contenteditable_insertflash(A,E,B,H,G,I){var F=contenteditable_focused_contentwindow();if(A){var C=contenteditable_selection_container("object");if((contenteditable_getAttribute(C,"classid")=="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000")||(contenteditable_getAttribute(C,"classid")=="clsid:CAFEEFAC-0014-0002-0000-ABCDEFFEDCBA")||(contenteditable_getAttribute(C,"classid")=="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B")){C.parentNode.removeChild(C)}var D="<object";D+=' codeBase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab"';D+=' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"';if(B){D+=' width="'+B+'"'}if(H){D+=' height="'+H+'"'}if(G){D+=' class="'+G+'"'}if(I){D+=' id="'+I+'"'}D+=">";D+='<param name="movie" value="'+A+'">';D+='<param name="quality" value="high">';D+="<embed";D+=' src="'+A+'"';D+=' pluginspage="http://www.macromedia.com/go/getflashplayer"';D+=' type="application/x-shockwave-flash"';D+=' quality="high"';if(B){D+=' width="'+B+'"'}if(H){D+=' height="'+H+'"'}D+=">";D+="<noembed>";D+=E;D+="</noembed>";D+="</embed>";D+="</object>";contenteditable_pasteContent(D)}}function contenteditable_insertapplet(A,G,C,J,I,K){var H=contenteditable_focused_contentwindow();if(A){var E=contenteditable_selection_container("object");if((contenteditable_getAttribute(E,"classid")=="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000")||(contenteditable_getAttribute(E,"classid")=="clsid:CAFEEFAC-0014-0002-0000-ABCDEFFEDCBA")||(contenteditable_getAttribute(E,"classid")=="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B")){E.parentNode.removeChild(E)}var B;var D;if(A.lastIndexOf("/")>=0){B=A.substring(A.lastIndexOf("/")+1);D=A.substring(0,A.lastIndexOf("/")+1)}else{B=A;D=""}var F="";F+="<object";F+=' codeBase="http://java.sun.com/products/plugin/autodl/jinstall-1_4_2-windows-i586.cab"';F+=' classid="clsid:CAFEEFAC-0014-0002-0000-ABCDEFFEDCBA"';if(C){F+=' width="'+C+'"'}if(J){F+=' height="'+J+'"'}if(I){F+=' class="'+I+'"'}if(K){F+=' id="'+K+'"'}F+=">";F+='<param name="codebase" value="'+D+'">';F+='<param name="code" value="'+B+'">';F+='<param name="type" value="application/x-java-applet">';F+="<comment>";F+="<embed";F+=' pluginspage="http://java.sun.com/products/plugin/index.html#download"';F+=' codebase="'+D+'"';F+=' code="'+B+'"';F+=' type="application/x-java-applet"';if(C){F+=' width="'+C+'"'}if(J){F+=' height="'+J+'"'}F+=">";F+="<noembed>";F+="<applet";F+=' codebase="'+D+'"';F+=' code="'+B+'"';if(C){F+=' width="'+C+'"'}if(J){F+=' height="'+J+'"'}F+=">";F+=G;F+="</applet>";F+="</noembed>";F+="</embed>";F+="</comment>";F+="</object>";contenteditable_pasteContent(F)}}function contenteditable_insertquicktime(A,E,B,H,G,I){var F=contenteditable_focused_contentwindow();if(A){var C=contenteditable_selection_container("object");if((contenteditable_getAttribute(C,"classid")=="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000")||(contenteditable_getAttribute(C,"classid")=="clsid:CAFEEFAC-0014-0002-0000-ABCDEFFEDCBA")||(contenteditable_getAttribute(C,"classid")=="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B")){C.parentNode.removeChild(C)}var D="<object";D+=' codeBase="http://www.apple.com/qtactivex/qtplugin.cab"';D+=' classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B"';if(B){D+=' width="'+B+'"'}if(H){D+=' height="'+H+'"'}if(G){D+=' class="'+G+'"'}if(I){D+=' id="'+I+'"'}D+=">";D+='<param name="src" value="'+A+'">';D+="<embed";D+=' src="'+A+'"';D+=' pluginspage="http://www.apple.com/quicktime/"';D+=' type="video/quicktime"';if(B){D+=' width="'+B+'"'}if(H){D+=' height="'+H+'"'}D+=">";D+="<noembed>";D+=E;D+="</noembed>";D+="</embed>";D+="</object>";contenteditable_pasteContent(D)}}function contenteditable_insertvideo(B,H,C,O,L,P,J,N,A,K,E,D,M){var I=contenteditable_focused_contentwindow();if(!J){if(B.substring(B.length-4)==".mp4"){J="video/mp4"}else{if(B.substring(B.length-4)==".m4v"){J="video/mp4"}else{if(B.substring(B.length-4)==".ogv"){J="video/ogg"}else{if(B.substring(B.length-4)==".ogx"){J="video/ogg"}else{if(B.substring(B.length-5)==".webm"){J="video/webm"}}}}}}if(B){var F=contenteditable_selection_container("video");var G="<video";if(C){G+=' width="'+C+'"'}if(O){G+=' height="'+O+'"'}if(L){G+=' class="'+L+'"'}if(P){G+=' id="'+P+'"'}if(N){G+=' poster="'+N+'"'}if(A){G+=' preload="'+A+'"'}if(K){G+=' autoplay="true"'}if(E){G+=' controls="true"'}if(D){G+=' loop="true"'}if(M){G+=' muted="true"'}G+=">";G+='<source src="'+B+'"';if(J){G+=' type="'+J+'"'}G+=">";if(webeditor.videoAutoAltSources){if(J=="video/mp4"){G+='<source src="'+(B.replace(/\.(mp4|m4v)$/gi,".ogv"))+'" type="video/ogg">';G+='<source src="'+(B.replace(/\.(mp4|m4v)$/gi,".webm"))+'" type="video/webm">'}if(J=="video/ogg"){G+='<source src="'+(B.replace(/\.(ogv|ogx)$/gi,".mp4"))+'" type="video/mp4">';G+='<source src="'+(B.replace(/\.(ogv|ogx)$/gi,".webm"))+'" type="video/webm">'}if(J=="video/webm"){G+='<source src="'+(B.replace(/\.(webm)$/gi,".mp4"))+'" type="video/mp4">';G+='<source src="'+(B.replace(/\.(webm)$/gi,".ogv"))+'" type="video/ogg">'}}G+="</video>";contenteditable_pasteContent(G)}}function contenteditable_insertaudio(B,G,K,M,I,A,J,D,C,L){var H=contenteditable_focused_contentwindow();if(!I){if(B.substring(B.length-4)==".mp3"){I="audio/mpeg"}else{if(B.substring(B.length-4)==".ogg"){I="audio/ogg"}else{if(B.substring(B.length-4)==".wav"){I="audio/wav"}}}}if(B){var E=contenteditable_selection_container("audio");if(!E){if(contenteditable_selection_contains("audio")){E=contenteditable_selection_container();E=contenteditable_getElementByTagName("audio")}}var F="<audio";if(K){F+=' class="'+K+'"'}if(M){F+=' id="'+M+'"'}if(A){F+=' preload="'+A+'"'}if(J){F+=' autoplay="true"'}if(D){F+=' controls="true"'}if(C){F+=' loop="true"'}if(L){F+=' muted="true"'}F+=">";F+='<source src="'+B+'"';if(I){F+=' type="'+I+'"'}F+=">";if(webeditor.videoAutoAltSources){if(I=="audio/mpeg"){F+='<source src="'+(B.replace(/\.(mp3)$/gi,".ogg"))+'" type="audio/ogg">';F+='<source src="'+(B.replace(/\.(mp3)$/gi,".wav"))+'" type="audio/wav">'}if(I=="audio/ogg"){F+='<source src="'+(B.replace(/\.(ogg)$/gi,".mp3"))+'" type="audio/mpeg">';F+='<source src="'+(B.replace(/\.(ogg)$/gi,".wav"))+'" type="audio/wav">'}if(I=="audio/wav"){F+='<source src="'+(B.replace(/\.(wav)$/gi,".mp3"))+'" type="audio/mpeg">';F+='<source src="'+(B.replace(/\.(wav)$/gi,".ogg"))+'" type="audio/wav">'}}F+="</audio>";contenteditable_pasteContent(F)}}function contenteditable_stylesheet_link(D,H){if(!D){D=webeditor.rootpath+"default.css";var A=document.getElementById("stylesheet_toggle");if(A){A.checked=true}}else{var A=document.getElementById("stylesheet_toggle");if(A){A.checked=true}}for(var C=0;C<document.getElementsByTagName("iframe").length;C++){var E=document.getElementsByTagName("iframe").item(C);if((E.className=="webeditor_contenteditable")||(E.className=="webeditor_contenteditable_disabled")){if((H==E.id)||(!H)){webeditor.stylesheets[E.id]=D;try{var G=E.contentWindow.document.getElementById("stylesheet");var B=E.contentWindow.document.createElement("link");B.id="stylesheet";B.rel="stylesheet";B.type="text/css";B.href=D;G.parentNode.replaceChild(B,G);G=false;contenteditable_stylesheet[E.id]=D;webeditor.stylesheetclassnames=new Array();webeditor.stylesheetclassvalues=new Array();webeditor_refreshToolbar(true)}catch(F){}}}}}function contenteditable_stylesheet_toggle(B){editor_stylesheet=webeditor.rootpath+"editor.css";for(var C=0;C<document.getElementsByTagName("iframe").length;C++){var D=document.getElementsByTagName("iframe").item(C);if((D.className=="webeditor_contenteditable")||(D.className=="webeditor_contenteditable_disabled")){try{if(B){D.contentWindow.document.getElementById("stylesheet").href=contenteditable_stylesheet[D.id];var A=document.getElementById("stylesheet_toggle");if(A){A.checked=true}}else{D.contentWindow.document.getElementById("stylesheet").href=editor_stylesheet;var A=document.getElementById("stylesheet_toggle");if(A){A.checked=false}}}catch(E){}}}}function contenteditable_formatclass_query(){var B="";for(var A=contenteditable_selection_container();((A!=null)&&(A.nodeName!="HTML"));A=A.parentNode){if(A.className!=""){B=A.className;break}}return B}function contenteditable_formatclass_attribute(B,D){if(D){B.className=D}else{contenteditable_removeAttribute(B,"class");if((B.nodeName=="SPAN")&&(B.childNodes)&&(B.childNodes.length==1)){var C=true;for(var A in B.attributes){if(typeof (B.attributes[j])!="function"){if(B.attributes[A]&&(B.attributes[A].specified==true)){C=false;break}}}if(C){B.parentNode.replaceChild(B.childNodes[0],B)}}else{if((B.nodeName=="SPAN")&&(!B.childNodes)||(B.childNodes.length==0)){var C=true;for(var A in B.attributes){if(typeof (B.attributes[A])!="function"){if(B.attributes[A]&&(B.attributes[A].specified==true)){C=false;break}}}if(C&&B.parentNode){B.parentNode.removeChild(B)}}}}}function contenteditable_fontname(C,B){if(B==""){var A=contenteditable_selection_container("font");if(A){contenteditable_removeAttribute(A,"face");if(!contenteditable_node_attributes(A)){contenteditable_remove_parentnode(A)}return true}else{return false}}else{return contenteditable_execcommand(C,B)}}function contenteditable_fontsize(C,B){if(B==""){var A=contenteditable_selection_container("font");if(A){contenteditable_removeAttribute(A,"size");if(!contenteditable_node_attributes(A)){contenteditable_remove_parentnode(A)}return true}else{return false}}else{return contenteditable_execcommand(C,B)}}function contenteditable_viewdetails(A){if(A==null){A=!contenteditable_viewdetails_status[contenteditable_focused]}if(A){contenteditable_viewdetails_status[contenteditable_focused]=true;contenteditable_stylesheet_toggle(false)}else{contenteditable_viewdetails_status[contenteditable_focused]=false;contenteditable_stylesheet_toggle(true)}webeditor_refreshToolbar(true)}function contenteditable_viewsource(B){if(true){var F=contenteditable_focused_iframe();var C=contenteditable_focused_form();if(C&&C.tagName!="HTML"){var L=contenteditable_focused_textarea();if(!contenteditable_viewsource_status[contenteditable_focused]){contenteditable_viewsource_status[contenteditable_focused]=true;var K=contenteditable_viewdetails_status[contenteditable_focused]||false;contenteditable_viewdetails(false);contenteditable_viewdetails_status[contenteditable_focused]=K;var J=F.contentWindow.document.body.innerHTML;if(webeditor.formatcontent){J=contenteditable_formatContent(F.contentWindow.document.body)}if(webeditor.autoclean){J=cleanContentSub(J,webeditor.autocleanAllHTML,webeditor.autocleanAllXML,webeditor.autocleanAllNamespace,webeditor.autocleanAllLang,webeditor.autocleanAllClass,webeditor.autocleanAllStyle,webeditor.autocleanEmptySpan,webeditor.autocleanAllSpan,webeditor.autocleanEmptyFont,webeditor.autocleanAllFont,webeditor.autocleanAllDelIns,webeditor.autocleanEmptyPDiv,webeditor.autocleanAllFormatTags,webeditor.autocleanAllMsoClass,webeditor.autocleanAllMsoStyle,webeditor.autocleanAllMsoConditional,webeditor.autocleanEmptyStyle)}J=contenteditable_decodeScriptTags(J);if(webeditor.replace){J=contenteditable_doReplace(J,webeditor.replace)}try{if(webeditor_custom_decode){J=webeditor_custom_decode(J)}}catch(I){}try{if(webeditor_custom_finalize){J=webeditor_custom_finalize(J)}}catch(I){}J=contenteditable_merge_content(F.id,J);L.value=J;var G=F.offsetWidth;var M=F.offsetHeight;webeditor.contentSelectionBaseNode[contenteditable_focused]=false;webeditor.contentSelectionBaseOffset[contenteditable_focused]=false;webeditor.contentSelectionExtentNode[contenteditable_focused]=false;webeditor.contentSelectionExtentOffset[contenteditable_focused]=false;contenteditable_iframe_hide(F);webeditor.contentSelectionBaseNode[contenteditable_focused]=false;webeditor.contentSelectionBaseOffset[contenteditable_focused]=false;webeditor.contentSelectionExtentNode[contenteditable_focused]=false;webeditor.contentSelectionExtentOffset[contenteditable_focused]=false;L.style.display="block";if(webeditor.textareaResizeStyle&&L.style){if(L.offsetWidth<G){L.style.width=G}if(L.offsetHeight<M){L.style.height=M}}if(webeditor.textareaResizeCalculate){if(L.offsetWidth<G){var H=L.offsetWidth;L.cols+=1;var D=(L.offsetWidth-H);if(L.offsetWidth<G){L.cols+=Math.floor((G-L.offsetWidth)/D)+1}}if(L.offsetHeight<M){var E=L.offsetHeight;L.rows+=1;var A=(L.offsetHeight-E);if(L.offsetHeight<M){L.rows+=Math.floor((M-L.offsetHeight)/A)+1}}}if(webeditor.textareaResizeStep){while(L.offsetWidth<G){var H=L.offsetWidth;L.cols+=2;if(H>=L.offsetWidth){break}}while(L.offsetHeight<M){var E=L.offsetHeight;L.rows+=2;if(H>=L.offsetWidth){break}}}contenteditable_viewsource_onfocus(L)}else{contenteditable_viewsource_status[contenteditable_focused]=false;contenteditable_viewdetails(contenteditable_viewdetails_status[contenteditable_focused]);if(webeditor.replace){L.value=contenteditable_doReplace(L.value,webeditor.replace)}L.style.display="none";contenteditable_iframe_show(F);contenteditable_viewsource_textarea2html(L,F);contenteditable_enable();contenteditable_position(true)}webeditor_refreshToolbar(true)}return }else{if(!contenteditable_viewsource_status[contenteditable_focused]){contenteditable_viewsource_status[contenteditable_focused]=true;contenteditable_stylesheet_toggle(false);contenteditable_viewsource_show()}else{contenteditable_viewsource_status[contenteditable_focused]=false;contenteditable_stylesheet_toggle(true);contenteditable_viewsource_hide()}}}function contenteditable_node_attributes(C){var A="";if(C&&C.attributes){for(var B=0;B<C.attributes.length;B++){if((C.attributes[B].name=="src")&&((!C.getAttribute(C.attributes[B].name))||(C.getAttribute(C.attributes[B].name)=="/"))){}else{if((C.attributes[B].name=="background")&&((!C.getAttribute(C.attributes[B].name))||(C.getAttribute(C.attributes[B].name)=="/"))){}else{if((C.attributes[B].name=="complete")&&((!C.getAttribute(C.attributes[B].name))||(C.getAttribute(C.attributes[B].name)==""))){}else{if((typeof (webeditor.strip[C.nodeName+"."+C.attributes[B].name])!="undefined")||(typeof (webeditor.strip["."+C.attributes[B].name])!="undefined")){}else{if((C.attributes[B].specified)&&(C.attributes[B].name)&&(C.attributes[B].name=="class")&&((contenteditable_getAttribute(C,C.attributes[B].name)=="Apple-style-span")||(contenteditable_getAttribute(C,C.attributes[B].name)=="khtml-block-placeholder"))){}else{if((C.attributes[B].specified)&&(C.attributes[B].nodeName)&&(C.attributes[B].nodeName=="class")&&((contenteditable_getAttribute(C,C.attributes[B].nodeName)=="Apple-style-span")||(contenteditable_getAttribute(C,C.attributes[B].nodeName)=="khtml-block-placeholder"))){}else{if((C.attributes[B].specified)&&(C.attributes[B].name)&&(C.attributes[B].name=="type")&&(contenteditable_getAttribute(C,C.attributes[B].name)=="_moz")){}else{if((C.attributes[B].specified)&&(C.attributes[B].nodeName)&&(C.attributes[B].nodeName=="type")&&(contenteditable_getAttribute(C,C.attributes[B].nodeName)=="_moz")){}else{if((C.attributes[B].specified)&&(C.attributes[B].name)&&(C.attributes[B].name.substr(0,4)=="_moz")){}else{if((C.attributes[B].specified)&&(C.attributes[B].nodeName)&&(C.attributes[B].nodeName.substr(0,4)=="_moz")){}else{if((C.attributes[B].specified)&&(C.attributes[B].name)){A+=C.attributes[B].name+'="'+contenteditable_getAttribute(C,C.attributes[B].name)+'" '}else{if((C.attributes[B].specified)&&(C.attributes[B].nodeName)){A+=C.attributes[B].nodeName+'="'+contenteditable_getAttribute(C,C.attributes[B].nodeName)+'" '}}}}}}}}}}}}}}A=contenteditable_node_attributes_fix(A,C);return A}function contenteditable_nextnode(A,B,D){var C=B;if(B&&B.firstChild&&(!D)){return B.firstChild}else{while(B&&(B!=A)&&(!B.nextSibling)){B=B.parentNode}if(B&&(B!=A)){if(B.nextSibling==C){return false}return B.nextSibling}else{return false}}}function contenteditable_previousnode(A,B){if(A==B){while(B&&B.lastChild){B=B.lastChild}}else{if(B){if(B.previousSibling){B=B.previousSibling;while(B&&B.lastChild){B=B.lastChild}}else{B=B.parentNode}}}if(B&&(B!=A)){return B}else{return false}}function contenteditable_event_cut_down(A){if(A&&(A.type=="keydown")&&A[webeditor_keyCode_command]&&(A.keyCode==webeditor_keyCode_cut)){return true}else{return false}}function contenteditable_event_cut_up(A){if(A&&(A.type=="keyup")&&A[webeditor_keyCode_command]&&(A.keyCode==webeditor_keyCode_cut)){return true}else{return false}}function contenteditable_event_cut_keypress(A){if(A&&(A.type=="keypress")&&A[webeditor_keyCode_command]&&(A.keyCode==webeditor_keyCode_cut)){return true}else{return false}}function contenteditable_event_copy_down(A){if(A&&(A.type=="keydown")&&A[webeditor_keyCode_command]&&(A.keyCode==webeditor_keyCode_copy)){return true}else{return false}}function contenteditable_event_copy_up(A){if(A&&(A.type=="keyup")&&A[webeditor_keyCode_command]&&(A.keyCode==webeditor_keyCode_copy)){return true}else{return false}}function contenteditable_event_copy_keypress(A){if(A&&(A.type=="keypress")&&A[webeditor_keyCode_command]&&(A.keyCode==webeditor_keyCode_copy)){return true}else{return false}}function contenteditable_event_paste_down(A){if(A&&(A.type=="keydown")&&A[webeditor_keyCode_command]&&(A.keyCode==webeditor_keyCode_paste)){return true}else{return false}}function contenteditable_event_paste_up(A){if(A&&(A.type=="keyup")&&A[webeditor_keyCode_command]&&(A.keyCode==webeditor_keyCode_paste)){return true}else{return false}}function contenteditable_event_paste_keypress(A){if(A&&(A.type=="keypress")&&A[webeditor_keyCode_command]&&(A.keyCode==webeditor_keyCode_paste)){return true}else{return false}}function contenteditable_event_paste(A){if(webeditor.clipboard&&(contenteditable_event_cut_down(A)||contenteditable_event_cut_keypress(A))){webeditor.clipboardHTML=contenteditable_getContentSelection();if(contenteditable_execcommand("cut")){contenteditable_webeditor_clipboard_cut()}else{webeditor.clipboard=false}contenteditable_event_stop(A);return }else{if(webeditor.clipboard&&(contenteditable_event_copy_down(A)||contenteditable_event_copy_keypress(A))){webeditor.clipboardHTML=contenteditable_getContentSelection();if(contenteditable_execcommand("copy")){contenteditable_webeditor_clipboard_copy()}else{webeditor.clipboard=false}contenteditable_event_stop(A);return }else{if(contenteditable_webeditor_clipboard_paste()){if(contenteditable_event_paste_down(A)&&(!contenteditable_event_pasted_pre)){contenteditable_undo_save();contenteditable_event_stop(A)}else{if(contenteditable_event_paste_up(A)||contenteditable_event_pasted_pre){contenteditable_paste_replacement_fix();contenteditable_event_stop(A)}else{if(contenteditable_event_paste_keypress(A)){contenteditable_undo_save();contenteditable_paste_replacement_fix();contenteditable_event_stop(A)}}}return }}}if(!contenteditable_event_pasted_post){if(contenteditable_event_paste_down(A)&&(!contenteditable_event_pasted_pre)){contenteditable_undo_save();contenteditable_event_paste_do_pre()}else{if(contenteditable_event_paste_up(A)||contenteditable_event_pasted_pre){contenteditable_event_paste_do_post();setTimeout(contenteditable_event_paste_do_fix,100)}else{if(contenteditable_event_paste_keypress(A)){contenteditable_undo_save();contenteditable_event_paste_do_pre();contenteditable_event_paste_do_post();setTimeout(contenteditable_event_paste_do_fix,100)}}}}}function contenteditable_event_paste_do_pre(){contenteditable_event_pasted_pre=true;contenteditable_paste_fix_prepare()}function contenteditable_event_paste_do_post(){contenteditable_event_pasted_post=true}function contenteditable_event_paste_do_fix(){contenteditable_event_paste_fix();if(webeditor.fixBaseHrefPastedURLs){contenteditable_paste_fix()}contenteditable_undo_save()}function contenteditable_event_paste_fix(A){contenteditable_event_paste_fix_sub("A","href",A);contenteditable_event_paste_fix_sub("IMG","src",A);contenteditable_event_paste_fix_sub("INPUT","src",A);contenteditable_event_paste_fix_sub("TABLE","background",A);contenteditable_event_paste_fix_sub("TR","background",A);contenteditable_event_paste_fix_sub("TD","background",A);contenteditable_event_paste_fix_sub("IFRAME","src",A);contenteditable_event_paste_fix_sub("AREA","href",A);contenteditable_event_pasted_pre=false;contenteditable_event_pasted_post=false}function contenteditable_event_paste_fix_sub(E,J,B){if(webeditor.shortenLocalURLs){var C="";if(document.location.protocol){C+=document.location.protocol+"//"}if(document.location.hostname){C+=document.location.hostname}if(document.location.port){C+=":"+document.location.port}var D="";if(document.location.pathname){D+=document.location.pathname.substring(0,document.location.pathname.lastIndexOf("/")+1)}var M="";if(document.location.pathname){M+=document.location.pathname}var N="";if(document.location.search){N+=document.location.search}var G=C;var K=D;var I=M;var A=N;if(webeditor.baseHref.match(new RegExp("^(https?://[^/]+)([^?]*)(.*)$"))){C=RegExp.$1;M=RegExp.$2;N=RegExp.$3;D=M.substring(0,M.lastIndexOf("/")+1)}if((!webeditor.shortenLocalURLsRootBase)&&(D=="/")){D=""}var L;if(B&&(typeof (B)=="string")){if(webeditor.shortenLocalURLsHost){B=B.replace(new RegExp("("+J+"=)"+G+"([/?&].+|$)","gi"),"$1$2");B=B.replace(new RegExp("("+J+"=)"+C+"([/?&].+|$)","gi"),"$1$2");B=B.replace(new RegExp("("+J+'=")'+G+"([/?&].+|$)","gi"),"$1$2");B=B.replace(new RegExp("("+J+'=")'+C+"([/?&].+|$)","gi"),"$1$2")}return B}else{if(B){L=B.getElementsByTagName(E);var F=B;contenteditable_event_paste_fix_node(F,E,J,C,D,M,N,G,K,I,A)}else{L=contenteditable_focused_document().getElementsByTagName(E)}}for(var H=0;H<L.length;H++){var F=L[H];contenteditable_event_paste_fix_node(F,E,J,C,D,M,N,G,K,I,A)}}return B}function contenteditable_event_paste_fix_node(F,E,L,C,D,P,Q,H,M,J,B){var O=new Array();if(webeditor.shortenLocalURLsHost&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+H+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+H),"")}if(webeditor.shortenLocalURLsHost&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+C+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+C),"")}if(webeditor.shortenLocalURLsOldSpecialCases){if((B!="")&&webeditor.shortenLocalURLsSearch&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+H+J+B.replace(/\?/,"\\?").replace(/\+/,"\\+").replace(/\[/,"\\[")+".+")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+H+J+B.replace(/\?/,"\\?").replace(/\+/,"\\+").replace(/\[/,"\\[")),"")}if((Q!="")&&webeditor.shortenLocalURLsSearch&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+C+P+Q.replace(/\?/,"\\?").replace(/\+/,"\\+").replace(/\[/,"\\[")+".+")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+C+P+Q.replace(/\?/,"\\?").replace(/\+/,"\\+").replace(/\[/,"\\[")),"")}if((B!="")&&webeditor.shortenLocalURLsSearch&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+H+J+B.replace(/\?/,"\\?").replace(/\+/,"\\+").replace(/\[/,"\\[")+".+")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+H+J+B.replace(/\?/,"\\?").replace(/\+/,"\\+").replace(/\[/,"\\[")),"")}if((Q!="")&&webeditor.shortenLocalURLsSearch&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+C+P+Q.replace(/\?/,"\\?").replace(/\+/,"\\+").replace(/\[/,"\\[")+".+")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+C+P+Q.replace(/\?/,"\\?").replace(/\+/,"\\+").replace(/\[/,"\\[")),"")}if(webeditor.shortenLocalURLsPath&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+H+J+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+H+J),"")}if(webeditor.shortenLocalURLsPath&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+C+P+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+C+P),"")}if(webeditor.shortenLocalURLsPath&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+J+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+J),"")}if(webeditor.shortenLocalURLsPath&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+P+"/.+")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+P+"/"),"")}if(webeditor.shortenLocalURLsPath&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+P+"[?].+")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+P+"[?]"),"?")}if(webeditor.shortenLocalURLsPath&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+P+"$")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+P+""),"")}if(webeditor.shortenLocalURLsBase&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+H+M+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+H+M),"")}if(webeditor.shortenLocalURLsBase&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+C+D+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+C+D),"")}if(webeditor.shortenLocalURLsBase&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+M+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+M),"")}if(webeditor.shortenLocalURLsBase&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+D+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+D),"")}if(webeditor.shortenLocalURLsHost&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+H+"/#.+")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+H+"/"),"")}if(webeditor.shortenLocalURLsHost&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+C+"/#.+")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+C+"/"),"")}if(webeditor.shortenLocalURLsHost&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+H+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+H),"")}if(webeditor.shortenLocalURLsHost&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+C+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+C),"")}if(webeditor.shortenLocalURLsRootPath&&(!webeditor.baseHref)&&contenteditable_getAttribute(F,L).substring(0,17+webeditor.rootpath.length+webeditor.language.length)==webeditor.rootpath+"empty."+webeditor.language+"?basehref=#"){O[O.length]=contenteditable_getAttribute(F,L).substring(16+webeditor.rootpath.length+webeditor.language.length)}if(webeditor.shortenLocalURLsRootPath&&(!webeditor.baseHref)&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+C+webeditor.rootpath+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+C+webeditor.rootpath),"")}if(webeditor.shortenLocalURLsRootPath&&(!webeditor.baseHref)&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+webeditor.rootpath+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+webeditor.rootpath),"")}if(webeditor.shortenLocalURLsBaseHref&&(!webeditor.baseHref)&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+C+webeditor.baseHref+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+C+webeditor.baseHref),"")}if(webeditor.shortenLocalURLsBaseHref&&(!webeditor.baseHref)&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+webeditor.baseHref+"([/?&].+|$)")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+webeditor.baseHref),"")}if(webeditor.shortenLocalURLsRoot&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^"+C+"/.+")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^"+C+"/"),"")}if(webeditor.shortenLocalURLsRoot&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^/.+")))){O[O.length]=contenteditable_getAttribute(F,L).replace(new RegExp("^/"),"")}}var G=contenteditable_getAttribute(F,L);for(var I=0;I<O.length;I++){if(O[I].length<G.length){G=O[I]}}if(webeditor.shortenLocalURLsClipboardRootPath&&webeditor.clipboardHTML){if(webeditor.clipboardHTML.match(new RegExp(L+'="('+D+")"+(contenteditable_getAttribute(F,L).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"))+'"'))){G=D+contenteditable_getAttribute(F,L)}else{if(webeditor.clipboardHTML.match(new RegExp(L+'="(/)'+(contenteditable_getAttribute(F,L).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"))+'"'))){G="/"+contenteditable_getAttribute(F,L)}else{if(webeditor.clipboardHTML.match(new RegExp(L+'="(/[^"]+)'+(contenteditable_getAttribute(F,L).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"))+'"'))){var K=webeditor.clipboardHTML.match(new RegExp(L+'="(/[^"]+)'+(contenteditable_getAttribute(F,L).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"))+'"'));G=K[1]+contenteditable_getAttribute(F,L)}else{if(webeditor.clipboardHTML.match(new RegExp(L+'="(/)'+(contenteditable_getAttribute(F,L).replace(new RegExp("^[./]+","g"),""))+'"'))){G="/"+(contenteditable_getAttribute(F,L).replace(new RegExp("^[./]+","g"),""))}else{if(webeditor.clipboardHTML.match(new RegExp(L+'="(/)'+(contenteditable_getAttribute(F,L).replace(new RegExp("^https?://[^/]+/","g"),""))+'"'))){G="/"+(contenteditable_getAttribute(F,L).replace(new RegExp("^https?://[^/]+/","g"),""))}}}}}}if(webeditor.shortenLocalURLsExpandRelativePaths){if(G.match(new RegExp("^../"))&&(D!="")){var A=""+D;while(G.match(new RegExp("^../"))){G=G.substring(3);A=A.replace(new RegExp("/[^/]+/$"),"/")}G=A+G}}if(F&&(F.nodeName==E)&&((""+contenteditable_getAttribute(F,L)).match(new RegExp("^mailto:.+")))){G=contenteditable_getAttribute(F,L)}else{if(G.match(new RegExp("^(https?://[^/]+)([^?]*)(.*)$"))){}else{if(G.match(new RegExp("^../(.*)$"))){}else{if(webeditor.baseHrefPrefix&&(G.substr(0,webeditor.baseHrefPrefix.length)!=webeditor.baseHrefPrefix)){G=webeditor.baseHrefPrefix+G}}}}for(var N in webeditor.shortenLocalURLsRegExp){G=G.replace(new RegExp(N),webeditor.shortenLocalURLsRegExp[N])}if(F&&((!F.attributes)||(!F.getAttribute(L))||(!F.getAttribute(L).specified))){}else{if(G!=contenteditable_getAttribute(F,L)){contenteditable_setAttribute(F,L,G)}}}function contenteditable_event_enter(A){if(A&&A.keyCode&&(A.keyCode==webeditor_keyCode_enter)){if((A.type=="keydown")||(A.type=="keypress")){contenteditable_undo_save()}contenteditable_event_enter_fix(A);if(webeditor.onCtrlEnter&&A.ctrlKey){if(webeditor.onCtrlEnter.toLowerCase()=="<p>"){contenteditable_event_enter_p(A)}else{if(A.type=="keydown"){contenteditable_event_stop(A);contenteditable_pasteContent(webeditor.onCtrlEnter)}else{contenteditable_event_stop(A)}}}else{if(webeditor.onShiftEnter&&A.shiftKey){if(webeditor.onShiftEnter.toLowerCase()=="<p>"){contenteditable_event_enter_p(A)}else{if(A.type=="keydown"){contenteditable_event_stop(A);contenteditable_pasteContent(webeditor.onShiftEnter)}else{contenteditable_event_stop(A)}}}else{if(webeditor.onAltEnter&&A.altKey){if(webeditor.onAltEnter.toLowerCase()=="<p>"){contenteditable_event_enter_p(A)}else{if(A.type=="keydown"){contenteditable_event_stop(A);contenteditable_pasteContent(webeditor.onAltEnter)}else{contenteditable_event_stop(A)}}}else{if(webeditor.onEnter&&contenteditable_selection_container("li")){}else{if(webeditor.onEnter){if(webeditor.onEnter.toLowerCase()=="<p>"){contenteditable_event_enter_p(A)}else{if(A.type=="keydown"){contenteditable_event_stop(A);contenteditable_pasteContent(webeditor.onEnter)}else{contenteditable_event_stop(A)}}}}}}}}else{if(A&&A[webeditor_keyCode_command]&&(A.type=="keydown")&&(A.keyCode==webeditor_keyCode_undo)){if(webeditor.undo!=false){contenteditable_event_stop(A);contenteditable_undo()}}else{if(A&&A[webeditor_keyCode_command]&&(A.type=="keydown")&&(A.keyCode==webeditor_keyCode_redo)){if(webeditor.undo!=false){contenteditable_event_stop(A);contenteditable_redo()}}else{if(A&&(A.type=="keydown")){if(!webeditor.undoSaveBeforeUndo){contenteditable_undo_save();webeditor.undoSaveBeforeUndo=true}}else{if(A&&(A.type=="mouseup")){}else{}}}}}}function contenteditable_positionable(){var A=contenteditable_selection_container();while(A&&(A.tagName!="IMG")&&(A.tagName!="TABLE")&&(A.tagName!="P")&&(A.tagName!="DIV")&&(A.tagName!="INPUT")&&(A.tagName!="SELECT")&&(A.tagName!="TEXTAREA")&&(A.tagName!="IFRAME")&&(A.tagName!="MARQUEE")&&(A.tagName!="HR")&&(A.tagName!="OBJECT")){A=A.parentNode}return A}function contenteditable_positionable_front_max(){var B=contenteditable_focused_document().body;var A=B;var D=0;while(A=contenteditable_nextnode(B,A)){if(A.style&&(A.style.position||A.style.zIndex)){var C=parseInt(A.style.zIndex)||parseInt("0"+A.style.zIndex);if(C>D){D=C}}}return D}function contenteditable_positionable_back_min(){var B=contenteditable_focused_document().body;var A=B;var D=contenteditable_positionable_front_max();while(A=contenteditable_nextnode(B,A)){if(A.style&&(A.style.position||A.style.zIndex)){var C=parseInt(A.style.zIndex)||parseInt("0"+A.style.zIndex);if(C<D){D=C}}}return D}function contenteditable_removeformat(){var A=contenteditable_getContentSelection();A=cleanContentSub(A,webeditor.removeformatAllHTML,webeditor.removeformatAllXML,webeditor.removeformatAllNamespace,webeditor.removeformatAllLang,webeditor.removeformatAllClass,webeditor.removeformatAllStyle,webeditor.removeformatEmptySpan,webeditor.removeformatAllSpan,webeditor.removeformatEmptyFont,webeditor.removeformatAllFont,webeditor.removeformatAllDelIns,webeditor.removeformatEmptyPDiv,webeditor.removeformatAllFormatTags,webeditor.removeformatAllMsoClass,webeditor.removeformatAllMsoStyle,webeditor.removeformatAllMsoConditional,webeditor.removeformatEmptyStyle);contenteditable_event_paste_do_pre();contenteditable_pasteContent(A);contenteditable_event_paste_do_post();contenteditable_event_paste_fix()}function contenteditable_preview(H){var C;if(H){C=contenteditable_iframe(H)}else{C=contenteditable_focused_iframe()}var G=window.open("","preview_window","width=850,height=600,resizable=yes,status=yes,titlebar=yes,scrollbars=yes,menubar=no,location=no,toolbar=no",true);if(webeditor.preview_window){G.focus()}var D=contenteditable_getContentBodyNode().innerHTML;if(webeditor.formatcontent){D=contenteditable_formatContent(contenteditable_getContentBodyNode())}if(webeditor.autoclean){D=cleanContentSub(D,webeditor.autocleanAllHTML,webeditor.autocleanAllXML,webeditor.autocleanAllNamespace,webeditor.autocleanAllLang,webeditor.autocleanAllClass,webeditor.autocleanAllStyle,webeditor.autocleanEmptySpan,webeditor.autocleanAllSpan,webeditor.autocleanEmptyFont,webeditor.autocleanAllFont,webeditor.autocleanAllDelIns,webeditor.autocleanEmptyPDiv,webeditor.autocleanAllFormatTags,webeditor.autocleanAllMsoClass,webeditor.autocleanAllMsoStyle,webeditor.autocleanAllMsoConditional,webeditor.autocleanEmptyStyle)}D=contenteditable_decodeScriptTags(D);if(webeditor.replace){D=contenteditable_doReplace(D,webeditor.replace)}try{if(webeditor_custom_decode){D=webeditor_custom_decode(D)}}catch(F){}try{if(webeditor_custom_finalize){D=webeditor_custom_finalize(D)}}catch(F){}D=contenteditable_merge_content(C.id,D);var B=contenteditable_content_has_head(D);var E=contenteditable_content_has_body(D);var A=contenteditable_content_has_content(D);if(typeof (contenteditable_preview_fix)=="function"){contenteditable_preview_fix(G,B,E,A);return }if(B){G.document.write(B)}else{if(webeditor.format=="xhtml"){G.document.writeln('<?xml version="1.0" encoding="'+webeditor.encoding+'" ?>');G.document.writeln('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');G.document.writeln('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">')}else{G.document.writeln("<html>")}G.document.writeln("<head>");G.document.writeln("<title>"+Text("preview_title")+"</title>");if(webeditor.format=="xhtml"){if(webeditor.stylesheets[C.id]){G.document.writeln('<link rel="stylesheet" type="text/css" href="'+webeditor.stylesheets[C.id]+'" />')}else{G.document.writeln('<link rel="stylesheet" type="text/css" href="'+webeditor.stylesheet+'" />')}G.document.writeln('<base href="'+webeditor.baseHref+'" />')}else{if(webeditor.stylesheets[C.id]){G.document.writeln('<link rel="stylesheet" type="text/css" href="'+webeditor.stylesheets[C.id]+'">')}else{G.document.writeln('<link rel="stylesheet" type="text/css" href="'+webeditor.stylesheet+'">')}G.document.writeln('<base href="'+webeditor.baseHref+'">')}G.document.writeln("</head>")}if(E){G.document.write(E)}else{if(webeditor.direction){G.document.write('<body style="margin: 0px;" dir="'+webeditor.direction+'">')}else{G.document.write('<body style="margin: 0px;">')}}G.document.writeln(A);G.document.writeln("</body>");G.document.writeln("</html>");G.document.close()}function contenteditable_spellcheck(){var A;if((typeof (A)=="undefined")||(webeditor.spellcheck_window==null)||A.closed){var B=contenteditable_focused_iframe().id;if(webeditor.language){A=window.open(webeditor.rootpath+"spellcheck."+webeditor.language+"?editor=webeditor&amp;id="+B,"spellcheck_window","scrollbars=yes,width=500,height=350,resizable=yes,status=yes",true);if(webeditor.spellcheck_window){A.focus()}}else{}}}function contenteditable_save(){contenteditable_onSubmit();var A=contenteditable_focused_iframe();while((A=A.parentNode)&&(A.nodeName!="FORM")){}if(A){A.submit()}}function contenteditable_contains(A,B){while((B)&&(B!=A)){B=B.parentNode}if(B==A){return true}else{return false}}function contenteditable_remove_parentnode(C){var A=0;for(var D=C.firstChild;D;D=D.nextSibling){A++}if(A==C.childNodes.length){var B=C.parentNode;var E=C.nextSibling;if(B){while(C.firstChild){B.insertBefore(C.firstChild,C)}B.removeChild(C)}}}function contenteditable_clonenode(A){var F=A.cloneNode(true);if(A.outerHTML!=F.outerHTML){try{F.innerHTML=A.innerHTML}catch(C){}if(A.outerHTML!=F.outerHTML){F=A.cloneNode(false);var E=false;for(var B=A.lastChild;B;B=B.previousSibling){var D=contenteditable_clonenode(B);if(D&&E&&E.insertBefore){F.insertBefore(D,E);E=D}else{F.appendChild(D);E=D}}}}return F}function contenteditable_nobr(){var A=contenteditable_selection_container("nobr");if(A){contenteditable_remove_parentnode(A)}else{var B=contenteditable_selection_text()||"&nbsp;";contenteditable_event_paste_do_pre();contenteditable_pasteContent("<nobr>"+B+"</nobr>");contenteditable_event_paste_do_post();contenteditable_event_paste_fix();contenteditable_nobr_fix()}}function contenteditable_printbreak(){var A=contenteditable_selection_text()||"&nbsp;";contenteditable_pasteContent('<div title="Print Page Break" style="page-break-before: always; background-color: #C0C0C0; vertical-align: middle; height: 1px; font-size: 1px;">'+A+"</div>")}function contenteditable_position_offsetTop(A){var B=A.offsetTop;while(A=A.offsetParent){B+=parseInt(A.offsetTop)}return B}function contenteditable_position_offsetLeft(A){var B=A.offsetLeft;while(A=A.offsetParent){B+=parseInt(A.offsetLeft)}return B}function contenteditable_focused_getContent(){var A=document.getElementsByTagName("iframe").item(contenteditable_focused);if(A&&A.contentWindow){return A.contentWindow.document.body.innerHTML}}function contenteditable_focused_setContent(B){var A=document.getElementsByTagName("iframe").item(contenteditable_focused);if(A&&A.contentWindow){A.contentWindow.document.body.innerHTML=B}}function contenteditable_undo_init(){if(webeditor.undo==false){return }if(!webeditor.undo){contenteditable_undo_save()}}function contenteditable_undo_save(){if(webeditor.undo==false){return }var B=contenteditable_focused_getContent();if(!webeditor.undo){webeditor.undo=new Array();webeditor.undo.MAX=25}if(!webeditor.undo[contenteditable_focused]){webeditor.undo[contenteditable_focused]=new Array();webeditor.undo[contenteditable_focused][0]=new Object();webeditor.undo[contenteditable_focused][0].content=B;webeditor.undo[contenteditable_focused][0].bookmark=contenteditable_selection_bookmark();webeditor.undo[contenteditable_focused].current=0;webeditor.undo[contenteditable_focused].latest=webeditor.undo[contenteditable_focused].current}if((typeof (webeditor.undo[contenteditable_focused].current)!="undefined")&&(B!=webeditor.undo[contenteditable_focused][webeditor.undo[contenteditable_focused].current].content)){if(!webeditor.undo[contenteditable_focused][webeditor.undo[contenteditable_focused].current+1]){webeditor.undo[contenteditable_focused][webeditor.undo[contenteditable_focused].current+1]=new Object()}webeditor.undo[contenteditable_focused][webeditor.undo[contenteditable_focused].current+1].content=B;webeditor.undo[contenteditable_focused][webeditor.undo[contenteditable_focused].current+1].bookmark=contenteditable_selection_bookmark();webeditor.undo[contenteditable_focused].current++;webeditor.undo[contenteditable_focused].latest=webeditor.undo[contenteditable_focused].current}if(webeditor.undo[contenteditable_focused].current==webeditor.undo.MAX){for(var A=1;A<=webeditor.undo.MAX;A++){webeditor.undo[contenteditable_focused][A-1].content=webeditor.undo[contenteditable_focused][A].content;webeditor.undo[contenteditable_focused][A-1].bookmark=webeditor.undo[contenteditable_focused][A].bookmark}webeditor.undo[contenteditable_focused].current=webeditor.undo.MAX-1;webeditor.undo[contenteditable_focused].latest=webeditor.undo[contenteditable_focused].current}}function contenteditable_undo(){if(webeditor.undo==false){return }if(webeditor.undoSaveBeforeUndo){contenteditable_undo_save();webeditor.undoSaveBeforeUndo=false}if(webeditor.undo&&webeditor.undo[contenteditable_focused]){if(webeditor.undo[contenteditable_focused].current){webeditor.undo[contenteditable_focused].current--}contenteditable_event_paste_do_pre();contenteditable_focused_setContent(webeditor.undo[contenteditable_focused][webeditor.undo[contenteditable_focused].current].content);contenteditable_event_paste_do_post();contenteditable_event_paste_fix();contenteditable_selection_bookmark(webeditor.undo[contenteditable_focused][webeditor.undo[contenteditable_focused].current].bookmark)}}function contenteditable_redo(){if(webeditor.undo==false){return }if(webeditor.undoSaveBeforeUndo){contenteditable_undo_save();webeditor.undoSaveBeforeUndo=false}if(webeditor.undo&&webeditor.undo[contenteditable_focused]){if(webeditor.undo[contenteditable_focused].current<webeditor.undo[contenteditable_focused].latest){webeditor.undo[contenteditable_focused].current++}contenteditable_event_paste_do_pre();contenteditable_focused_setContent(webeditor.undo[contenteditable_focused][webeditor.undo[contenteditable_focused].current].content);contenteditable_event_paste_do_post();contenteditable_event_paste_fix();contenteditable_selection_bookmark(webeditor.undo[contenteditable_focused][webeditor.undo[contenteditable_focused].current].bookmark)}}function contenteditable_formatContent(G){var D="";if(webeditor.format=="html"){D="";for(var F=G.firstChild;F;F=F.nextSibling){D+=contenteditable_formatContentNodeHTML(F,G)}}else{if(webeditor.format=="xhtml"){D="";for(var F=G.firstChild;F;F=F.nextSibling){D+=contenteditable_formatContentNodeXHTML(F,G)}}else{if(G){D=G.innerHTML;if(webeditor.forceParamPlay!=""){D=D.replace(/<PARAM[ \r\n]+NAME="Play"[ \r\n]+VALUE="0"[ \r\n]*>/i,'<PARAM NAME="Play" VALUE="'+webeditor.forceParamPlay+'">')}if(D.match(new RegExp("<OBJECT","i"))){var J=D.split(/<OBJECT/i);if(J.length){if(J.length==1){J[1]=J[0];J[0]=""}D=J[0];for(var B=1;B<J.length;B++){var E=J[B].split(/<\/OBJECT>/i);if(E.length){if(E.length==1){E[1]=""}var C=E[0].split(/<EMBED/i);if(C.length){if(C.length==1){C[1]=C[0];C[0]=""}var H=C[1].split(/<\/EMBED>/i);if(H.length){if(H.length==1){H[1]=""}var A=E[0].match(new RegExp("[ \\r\\n]width=([^ \\r\\n]*)"));if(A&&(A.length>1)){H[0]=H[0].replace(/[ \r\n]width=[^ \r\n]*/i," width="+A[1])}var I=E[0].match(new RegExp("[ \\r\\n]height=([^ \\r\\n]*)"));if(I&&(I.length>1)){H[0]=H[0].replace(/[ \r\n]height=[^ \r\n]*/i," height="+I[1])}D+="<OBJECT"+C[0]+"<EMBED"+H[0]+"</EMBED>"+H[1]+"</OBJECT>"+E[1]}else{D+="<OBJECT"+C[0]+"<EMBED"+C[1]+"</OBJECT>"+E[1]}}else{D+="<OBJECT"+E[0]+"</OBJECT>"+E[1]}}else{D+="<OBJECT"+object[B]}}}}}}}D=D.replace(/<([a-zA-Z][a-zA-Z0-9]*)[ \t\r\n]+>/g,"<$1>");D=D.replace(/\r\n(\r\n)+/g,"\r\n");D=D.replace(/\r(\r)+/g,"\r\n");D=D.replace(/\n(\n)+/g,"\r\n");if(webeditor.shortenNearlyEmptyContent){D=D.replace(/^[\r\n]+/gi,"");D=D.replace(/[\r\n]+$/gi,"");if(D=="<br>"){D=""}if(D=="<br />"){D=""}if(D=="<p>"){D=""}if(D=="<p />"){D=""}if(D=="<p>&nbsp;</p>"){D=""}}D=contenteditable_formatContent_fix(D);D=contenteditable_formatContent_fix_common(D);return D}function contenteditable_formatContent_fix_common(A){if(!A){return A}if(webeditor.shortenLocalURLsBaseHrefSelf){A=A.replace(new RegExp("href=/"+webeditor.baseHrefRelative+" "),"href=/ ");A=A.replace(new RegExp("href=/"+webeditor.baseHrefRelative+">"),"href=/>");A=A.replace(new RegExp('href="/'+webeditor.baseHrefRelative+'"'),'href="/"')}return A}function contenteditable_formatContentNodeHTML(B,I,G){var E="";if(B.tagName){if((B.firstChild)||(B.tagName.match(new RegExp("^(TEXTAREA|PRE|TABLE|THEAD|TBODY|TFOOT|TR|TD|DIR|MENU|DL|OL|UL|FORM|SELECT|H1|H2|H3|H4|H5|H6|A|OBJECT|EMBED|NOEMBED|MAP|IFRAME|DIV|SPAN)$")))){if(typeof (webeditor.strip[B.tagName])=="undefined"){if(webeditor.reformat[B.tagName.toLowerCase()]&&webeditor.reformat[B.tagName.toLowerCase()]["#"]){E+="<"+webeditor.reformat[B.tagName.toLowerCase()]["#"]+contenteditable_formatContentNodeAttributes(B)+">"}else{E+="<"+B.tagName.toLowerCase()+contenteditable_formatContentNodeAttributes(B)+">"}if(B.tagName.match(new RegExp("^(PRE|TABLE|THEAD|TBODY|TFOOT|TR|DIR|MENU|DL|OL|UL|FORM|SELECT|OBJECT|EMBED|NOEMBED)$"))){if((!B.nextSibling)||(B.nextSibling.nodeName!="#text")||((B.nextSibling.nodeValue[0]!="\r")&&(B.nextSibling.nodeValue[0]!="\n"))){if(!(G||(B.tagName=="PRE"))){E+="\r\n"}}}}if(!webeditor.strip[B.tagName]){var D=contenteditable_formatContentNodeHTML_fix(B);var F=B;for(var F=B.firstChild;F;F=F.nextSibling){if(F.nodeName=="EMBED"){D=""}E+=contenteditable_formatContentNodeHTML(F,I,(G||(B.tagName=="PRE")))}E+=D}if(typeof (webeditor.strip[B.tagName])=="undefined"){if(webeditor.reformat[B.tagName.toLowerCase()]&&webeditor.reformat[B.tagName.toLowerCase()]["#"]){E+="</"+webeditor.reformat[B.tagName.toLowerCase()]["#"]+">"}else{E+="</"+B.tagName.toLowerCase()+">"}if(B.tagName.match(new RegExp("^(PRE|TABLE|THEAD|TBODY|TFOOT|TR|DIR|MENU|DL|OL|UL|FORM|OPTION|TD|P|DIV|LI|DD|DT|H1|H2|H3|H4|H5|H6|IFRAME|OBJECT|EMBED|NOEMBED|MAP|IFRAME)$"))){if((!B.nextSibling)||(B.nextSibling.nodeName!="#text")||((B.nextSibling.nodeValue[0]!="\r")&&(B.nextSibling.nodeValue[0]!="\n"))){if(!G){E+="\r\n"}}}}}else{if(typeof (webeditor.strip[B.tagName])=="undefined"){if(webeditor.reformat[B.tagName.toLowerCase()]&&webeditor.reformat[B.tagName.toLowerCase()]["#"]){E+="<"+webeditor.reformat[B.tagName.toLowerCase()]["#"]+contenteditable_formatContentNodeAttributes(B)+">"}else{E+="<"+B.tagName.toLowerCase()+contenteditable_formatContentNodeAttributes(B)+">"}if(B.tagName.match(new RegExp("^(P|BR|HR|LI|DD|DT)$"))){if((!B.nextSibling)||(B.nextSibling.nodeName!="#text")||((B.nextSibling.nodeValue[0]!="\r")&&(B.nextSibling.nodeValue[0]!="\n"))){if(!G){E+="\r\n"}}}}}}else{if(B.nodeValue){var H=B.nodeValue;if(H.match(new RegExp("^<script","i"))&&H.match(new RegExp("<\/script>","i"))){}else{if(H.match(new RegExp("^<!--"))&&H.match(new RegExp("-->"))){}else{var A="";for(var C=0;C<H.length;C++){var J=""+H.charAt(C);if(J.match(new RegExp("([^-a-zA-Z0-9\\t\\n\\r !#$%&'()*+,./:;=?@\\[\\\\\\]^_`{|}~])"))){A+=contenteditable_formatContentEscape(RegExp.$1)}else{A+=J}}H=A;if(webeditor.nbsp2blank){H=H.replace(/&nbsp;/g," ")}H=H.replace(/(&(?![#a-zA-Z0-9]+;))/gi,"&amp;")}}E+=H}}return E}function contenteditable_formatContentNodeXHTML(B,I,G){var E="";if(B.tagName){if((B.firstChild)||(B.tagName.match(new RegExp("^(TEXTAREA|PRE|TABLE|THEAD|TBODY|TFOOT|TR|TD|DIR|MENU|DL|OL|UL|FORM|SELECT|H1|H2|H3|H4|H5|H6|A|OBJECT|EMBED|NOEMBED|MAP|IFRAME|DIV|SPAN)$")))){if(typeof (webeditor.strip[B.tagName])=="undefined"){if(webeditor.reformat[B.tagName.toLowerCase()]&&webeditor.reformat[B.tagName.toLowerCase()]["#"]){E+="<"+webeditor.reformat[B.tagName.toLowerCase()]["#"]+contenteditable_formatContentNodeAttributes(B)+">"}else{E+="<"+B.tagName.toLowerCase()+contenteditable_formatContentNodeAttributes(B)+">"}if(B.tagName.match(new RegExp("^(PRE|TABLE|THEAD|TBODY|TFOOT|TR|DIR|MENU|DL|OL|UL|FORM|SELECT|OBJECT|EMBED|NOEMBED)$"))){if((!B.nextSibling)||(B.nextSibling.nodeName!="#text")||((B.nextSibling.nodeValue[0]!="\r")&&(B.nextSibling.nodeValue[0]!="\n"))){if(!(G||(B.tagName=="PRE"))){E+="\r\n"}}}}if(!webeditor.strip[B.tagName]){var D=contenteditable_formatContentNodeXHTML_fix(B);var F=B;for(var F=B.firstChild;F;F=F.nextSibling){if(F.nodeName=="EMBED"){D=""}E+=contenteditable_formatContentNodeXHTML(F,I,(G||(B.tagName=="PRE")))}E+=D}if(typeof (webeditor.strip[B.tagName])=="undefined"){if(webeditor.reformat[B.tagName.toLowerCase()]&&webeditor.reformat[B.tagName.toLowerCase()]["#"]){E+="</"+webeditor.reformat[B.tagName.toLowerCase()]["#"]+">"}else{E+="</"+B.tagName.toLowerCase()+">"}if(B.tagName.match(new RegExp("^(PRE|TABLE|THEAD|TBODY|TFOOT|TR|DIR|MENU|DL|OL|UL|FORM|OPTION|TD|P|DIV|LI|DD|DT|H1|H2|H3|H4|H5|H6|IFRAME|OBJECT|EMBED|NOEMBED|MAP|IFRAME)$"))){if((!B.nextSibling)||(B.nextSibling.nodeName!="#text")||((B.nextSibling.nodeValue[0]!="\r")&&(B.nextSibling.nodeValue[0]!="\n"))){if(!G){E+="\r\n"}}}}}else{if(typeof (webeditor.strip[B.tagName])=="undefined"){if(B.tagName.charAt(0)=="/"){if(webeditor.reformat[B.tagName.toLowerCase()]&&webeditor.reformat[B.tagName.toLowerCase()]["#"]){E+="<"+webeditor.reformat[B.tagName.toLowerCase()]["#"]+contenteditable_formatContentNodeAttributes(B)+">"}else{E+="<"+B.tagName.toLowerCase()+contenteditable_formatContentNodeAttributes(B)+">"}}else{var J=I.getElementsByTagName("/"+B.tagName);if(J.length){if(webeditor.reformat[B.tagName.toLowerCase()]&&webeditor.reformat[B.tagName.toLowerCase()]["#"]){E+="<"+webeditor.reformat[B.tagName.toLowerCase()]["#"]+contenteditable_formatContentNodeAttributes(B)+">"}else{E+="<"+B.tagName.toLowerCase()+contenteditable_formatContentNodeAttributes(B)+">"}}else{if(webeditor.reformat[B.tagName.toLowerCase()]&&webeditor.reformat[B.tagName.toLowerCase()]["#"]){E+="<"+webeditor.reformat[B.tagName.toLowerCase()]["#"]+contenteditable_formatContentNodeAttributes(B)+" />"}else{E+="<"+B.tagName.toLowerCase()+contenteditable_formatContentNodeAttributes(B)+" />"}}}if(B.tagName.match(new RegExp("^(P|BR|HR|LI|DD|DT)$"))){if((!B.nextSibling)||(B.nextSibling.nodeName!="#text")||((B.nextSibling.nodeValue[0]!="\r")&&(B.nextSibling.nodeValue[0]!="\n"))){if(!G){E+="\r\n"}}}}}}else{if(B.nodeValue){var H=B.nodeValue;if(H.match(new RegExp("^<script","i"))&&H.match(new RegExp("<\/script>","i"))){}else{if(H.match(new RegExp("^<!--"))&&H.match(new RegExp("-->"))){}else{var A="";for(var C=0;C<H.length;C++){var K=""+H.charAt(C);if(K.match(new RegExp("([^-a-zA-Z0-9\\t\\n\\r !#$%&'()*+,./:;=?@\\[\\\\\\]^_`{|}~])"))){A+=contenteditable_formatContentEscape(RegExp.$1)}else{A+=K}}H=A;if(webeditor.nbsp2blank){H=H.replace(/&nbsp;/g," ")}H=H.replace(/(&(?![#a-zA-Z0-9]+;))/gi,"&amp;")}}E+=H}}return E}function contenteditable_formatContentNodeAttributes(C){var A="";if(C&&C.attributes){for(var B=0;B<C.attributes.length;B++){if(((C.tagName!="A")&&(C.tagName!="IFRAME"))&&(C.attributes[B].name=="href")&&((!C.getAttribute(C.attributes[B].name))||(C.getAttribute(C.attributes[B].name)=="/"))){}else{if((C.attributes[B].name=="src")&&((!C.getAttribute(C.attributes[B].name))||(C.getAttribute(C.attributes[B].name)=="/"))){}else{if((C.attributes[B].name=="background")&&((!C.getAttribute(C.attributes[B].name))||(C.getAttribute(C.attributes[B].name)=="/"))){}else{if(C.attributes[B].specified||(C.tagName=="AREA")||(C.tagName=="INPUT")){if((typeof (webeditor.strip[C.nodeName+"."+C.attributes[B].name])!="undefined")||(typeof (webeditor.strip["."+C.attributes[B].name])!="undefined")){}else{if((C.attributes[B].specified)&&(C.attributes[B].name)&&(C.attributes[B].name=="class")&&((contenteditable_getAttribute(C,C.attributes[B].name)=="Apple-style-span")||(contenteditable_getAttribute(C,C.attributes[B].name)=="khtml-block-placeholder")||(contenteditable_getAttribute(C,C.attributes[B].name)=="webkit-block-placeholder"))){}else{if((C.attributes[B].specified)&&(C.attributes[B].nodeName)&&(C.attributes[B].nodeName=="class")&&((contenteditable_getAttribute(C,C.attributes[B].nodeName)=="Apple-style-span")||(contenteditable_getAttribute(C,C.attributes[B].nodeName)=="khtml-block-placeholder"))){}else{if((C.attributes[B].specified)&&(C.attributes[B].name)&&(C.attributes[B].name=="type")&&(contenteditable_getAttribute(C,C.attributes[B].name)=="_moz")){}else{if((C.attributes[B].specified)&&(C.attributes[B].nodeName)&&(C.attributes[B].nodeName=="type")&&(contenteditable_getAttribute(C,C.attributes[B].nodeName)=="_moz")){}else{if((C.attributes[B].specified)&&(C.attributes[B].name)&&(C.attributes[B].name.substr(0,4)=="_moz")){}else{if((C.attributes[B].specified)&&(C.attributes[B].nodeName)&&(C.attributes[B].nodeName.substr(0,4)=="_moz")){}else{if((C.attributes[B].name)&&(C.attributes[B].specified||((C.tagName=="AREA")&&((C.attributes[B].name=="coords")||(C.attributes[B].name=="shape")))||((C.tagName=="INPUT")&&(C.attributes[B].name=="value")))){if((webeditor.forceParamPlay!="")&&(C.tagName.toLowerCase()=="param")&&(C.name.toLowerCase()=="play")&&(C.attributes[B].name.toLowerCase()=="value")){A+=" "+C.attributes[B].name+'="'+webeditor.forceParamPlay+'"'}else{if(contenteditable_getAttribute(C,C.attributes[B].name)){if(webeditor.reformat[C.tagName.toLowerCase()]&&(typeof (webeditor.reformat[C.tagName.toLowerCase()][C.attributes[B].name.toLowerCase()])=="object")&&(webeditor.reformat[C.tagName.toLowerCase()][C.attributes[B].name.toLowerCase()][contenteditable_getAttribute(C,C.attributes[B].name)])){A+=' style="'+webeditor.reformat[C.tagName.toLowerCase()][C.attributes[B].name.toLowerCase()][contenteditable_getAttribute(C,C.attributes[B].name)]+';"'}else{if(webeditor.reformat[C.tagName.toLowerCase()]&&webeditor.reformat[C.tagName.toLowerCase()][C.attributes[B].name.toLowerCase()]){A+=' style="'+webeditor.reformat[C.tagName.toLowerCase()][C.attributes[B].name.toLowerCase()]+": "+contenteditable_getAttribute(C,C.attributes[B].name).replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;")+';"'}else{A+=" "+C.attributes[B].name+'="'+contenteditable_getAttribute(C,C.attributes[B].name).replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;")+'"'}}}else{if((C.attributes[B].name=="checked")||(C.attributes[B].name=="compact")||(C.attributes[B].name=="declare")||(C.attributes[B].name=="defer")||(C.attributes[B].name=="disabled")||(C.attributes[B].name=="ismap")||(C.attributes[B].name=="multiple")||(C.attributes[B].name=="noresize")||(C.attributes[B].name=="noshade")||(C.attributes[B].name=="nowrap")||(C.attributes[B].name=="readonly")||(C.attributes[B].name=="selected")){A+=" "+C.attributes[B].name+'="'+C.attributes[B].name+'"'}else{A+=" "+C.attributes[B].name+'=""'}}}}else{if((C.attributes[B].specified)&&(C.attributes[B].nodeName)){if((webeditor.forceParamPlay!="")&&(C.tagName.toLowerCase()=="param")&&(C.name.toLowerCase()=="play")&&(C.attributes[B].nodeName.toLowerCase()=="value")){A+=" "+C.attributes[B].nodeName+'="'+webeditor.forceParamPlay+'"'}else{if(contenteditable_getAttribute(C,C.attributes[B].nodeName)){A+=" "+C.attributes[B].nodeName+'="'+contenteditable_getAttribute(C,C.attributes[B].nodeName).replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;")+'"'}else{if((C.attributes[B].nodeName=="checked")||(C.attributes[B].nodeName=="compact")||(C.attributes[B].nodeName=="declare")||(C.attributes[B].nodeName=="defer")||(C.attributes[B].nodeName=="disabled")||(C.attributes[B].nodeName=="ismap")||(C.attributes[B].nodeName=="multiple")||(C.attributes[B].nodeName=="noresize")||(C.attributes[B].nodeName=="noshade")||(C.attributes[B].nodeName=="nowrap")||(C.attributes[B].nodeName=="readonly")||(C.attributes[B].nodeName=="selected")){A+=" "+C.attributes[B].nodeName+'="'+C.attributes[B].nodeName+'"'}else{A+=" "+C.attributes[B].nodeName+'=""'}}}}}}}}}}}}}}}}}if((A=="")&&webeditor.reformat[C.tagName.toLowerCase()]&&webeditor.reformat[C.tagName.toLowerCase()][""]){A+=' style="'+webeditor.reformat[C.tagName.toLowerCase()][""]+';"'}}if(webeditor.cssFontSize=="pt"){A=contenteditable_doReplace(A,{'font-size: 1([ ;"])':"font-size: 8pt$1",'font-size: 2([ ;"])':"font-size: 10pt$1",'font-size: 3([ ;"])':"font-size: 12pt$1",'font-size: 4([ ;"])':"font-size: 14pt$1",'font-size: 5([ ;"])':"font-size: 18pt$1",'font-size: 6([ ;"])':"font-size: 24pt$1",'font-size: 7([ ;"])':"font-size: 36pt$1"});A=contenteditable_doReplace(A,{'font-size: xx-small([ ;"])':"font-size: 8pt$1",'font-size: x-small([ ;"])':"font-size: 10pt$1",'font-size: small([ ;"])':"font-size: 12pt$1",'font-size: medium([ ;"])':"font-size: 14pt$1",'font-size: large([ ;"])':"font-size: 18pt$1",'font-size: x-large([ ;"])':"font-size: 24pt$1",'font-size: xx-large([ ;"])':"font-size: 36pt$1"})}else{A=contenteditable_doReplace(A,{'font-size: 1([ ;"])':"font-size: xx-small$1",'font-size: 2([ ;"])':"font-size: x-small$1",'font-size: 3([ ;"])':"font-size: small$1",'font-size: 4([ ;"])':"font-size: medium$1",'font-size: 5([ ;"])':"font-size: large$1",'font-size: 6([ ;"])':"font-size: x-large$1",'font-size: 7([ ;"])':"font-size: xx-large$1"});A=contenteditable_doReplace(A,{'font-size: 8pt([ ;"])':"font-size: xx-small$1",'font-size: 10pt([ ;"])':"font-size: x-small$1",'font-size: 12pt([ ;"])':"font-size: small$1",'font-size: 14pt([ ;"])':"font-size: medium$1",'font-size: 18pt([ ;"])':"font-size: large$1",'font-size: 24pt([ ;"])':"font-size: x-large$1",'font-size: 36pt([ ;"])':"font-size: xx-large$1"})}if(webeditor.cssIndent=="40px"){A=contenteditable_doReplace(A,{"margin-left: 0em":"margin-left: 0px","margin-left: 3em":"margin-left: 40px","margin-left: 6em":"margin-left: 80px","margin-left: 9em":"margin-left: 120px","margin-left: 12em":"margin-left: 160px","margin-left: 15em":"margin-left: 200px","margin-left: 18em":"margin-left: 240px","margin-left: 21em":"margin-left: 280px","margin-left: 24em":"margin-left: 320px","margin-left: 27em":"margin-left: 360px","margin-left: 30em":"margin-left: 400px"})}else{if(webeditor.cssIndent=="3em"){A=contenteditable_doReplace(A,{"margin-left: 0px":"margin-left: 0em","margin-left: 40px":"margin-left: 3em","margin-left: 80px":"margin-left: 6em","margin-left: 120px":"margin-left: 9em","margin-left: 160px":"margin-left: 12em","margin-left: 200px":"margin-left: 15em","margin-left: 240px":"margin-left: 18em","margin-left: 280px":"margin-left: 21em","margin-left: 320px":"margin-left: 24em","margin-left: 360px":"margin-left: 27em","margin-left: 400px":"margin-left: 30em"})}}if(webeditor.removeStyleBackgroundColorInherit){A=contenteditable_doReplace(A,{"background-color: *inherit;?":""})}if(webeditor.removeStyleColorInherit){A=contenteditable_doReplace(A,{"color: *inherit;?":""})}A=A.replace(/(.*) style="([^"]*)"(.*) style="([^"]*)"(.*)/gi,'$1$3 style="$2; $4"');A=A.replace(/;;/gi,";");A=A.replace(/ style="[ ;]*"/gi,"");if(C.tagName=="IMG"){A=A.replace(/ complete=""/g," ")}if(C.tagName=="INPUT"){A=A.replace(/ maxLength=/g," maxlength=")}if(C.tagName=="FORM"){A=A.replace(/ method="GET"/g,' method="get"');A=A.replace(/ method="POST"/g,' method="post"');A=A.replace(/ method="PUT"/g,' method="put"')}if(webeditor.styleAttributeNamesToLowerCase){try{while(A.match(/.* style="[^"]*?([-_a-zA-Z0-9]*[A-Z]+[-_a-zA-Z0-9]*[ ]*:)[^"]*"/g)){A=A.replace(/.* style="[^"]*?([-_a-zA-Z0-9]*[A-Z]+[-_a-zA-Z0-9]*[ ]*:)[^"]*"/g,function(F,E){return F.replace(E,E.toLowerCase())})}}catch(D){}}if(webeditor.cssRGB=="hex"){try{while(A.match(/.* style="[^"]*?(rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\))[^"]*"/g)){A=A.replace(/.* style="[^"]*?(rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\))[^"]*"/g,function(L,K){var I=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\)/.exec(K);var J=parseInt(I[1],10);var H=parseInt(I[2],10);var E=parseInt(I[3],10);var F=E|(H<<8)|(J<<16)|(1<<24);var G="#"+F.toString(16).substring(1);return L.replace(K,G)})}}catch(D){}}else{if(webeditor.cssRGB=="name"){try{while(A.match(/.* style="[^"]*?(rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\))[^"]*"/g)){A=A.replace(/.* style="[^"]*?(rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\))[^"]*"/g,function(M,E){var G=/rgb\((\d+), *(\d+), *(\d+)\)/.exec(E);var I=parseInt(G[1],10);var J=parseInt(G[2],10);var L=parseInt(G[3],10);var K=L|(J<<8)|(I<<16)|(1<<24);var H="#"+K.toString(16).substring(1);var F=webeditor.cssRGBnames[H.toLowerCase()]?webeditor.cssRGBnames[H.toLowerCase()]:H;return M.replace(E,F)})}}catch(D){}}}return A}function contenteditable_formatContentEscape(A){if(!webeditor.encodeCharCodes){return A}switch(A.charCodeAt(0)){case 34:return"&quot;";case 38:return"&amp;";case 39:return"&apos;";case 60:return"&lt;";case 62:return"&gt;";case 160:return"&nbsp;";case 161:return"&iexcl;";case 162:return"&cent;";case 163:return"&pound;";case 164:return"&curren;";case 165:return"&yen;";case 166:return"&brvbar;";case 167:return"&sect;";case 168:return"&uml;";case 169:return"&copy;";case 170:return"&ordf;";case 171:return"&laquo;";case 172:return"&not;";case 173:return"&shy;";case 174:return"&reg;";case 175:return"&macr;";case 176:return"&deg;";case 177:return"&plusmn;";case 178:return"&sup2;";case 179:return"&sup3;";case 180:return"&acute;";case 181:return"&micro;";case 182:return"&para;";case 183:return"&middot;";case 184:return"&cedil;";case 185:return"&supl;";case 186:return"&ordm;";case 187:return"&raquo;";case 188:return"&frac14;";case 189:return"&frac12;";case 190:return"&frac34;";case 191:return"&iquest;";case 192:return"&Agrave;";case 193:return"&Aacute;";case 194:return"&Acirc;";case 195:return"&Atilde;";case 196:return"&Auml;";case 197:return"&Aring;";case 198:return"&AElig;";case 199:return"&Ccedil;";case 200:return"&Egrave;";case 201:return"&Eacute;";case 202:return"&Ecirc;";case 203:return"&Euml;";case 204:return"&Igrave;";case 205:return"&Iacute;";case 206:return"&Icirc;";case 207:return"&Iuml;";case 208:return"&ETH;";case 209:return"&Ntilde;";case 210:return"&Ograve;";case 211:return"&Oacute;";case 212:return"&Ocirc;";case 213:return"&Otilde;";case 214:return"&Ouml;";case 215:return"&times;";case 216:return"&Oslash;";case 217:return"&Ugrave;";case 218:return"&Uacute;";case 219:return"&Ucirc;";case 220:return"&Uuml;";case 221:return"&Yacute;";case 222:return"&THORN;";case 223:return"&szlig;";case 224:return"&agrave;";case 225:return"&aacute;";case 226:return"&acirc;";case 227:return"&atilde;";case 228:return"&auml;";case 229:return"&aring;";case 230:return"&aelig;";case 231:return"&ccedil;";case 232:return"&egrave;";case 233:return"&eacute;";case 234:return"&ecirc;";case 235:return"&euml;";case 236:return"&igrave;";case 237:return"&iacute;";case 238:return"&icirc;";case 239:return"&iuml;";case 240:return"&eth;";case 241:return"&ntilde;";case 242:return"&ograve;";case 243:return"&oacute;";case 244:return"&ocirc;";case 245:return"&otilde;";case 246:return"&ouml;";case 247:return"&divide;";case 248:return"&oslash;";case 249:return"&ugrave;";case 250:return"&uacute;";case 251:return"&ucirc;";case 252:return"&uuml;";case 253:return"&yacute;";case 254:return"&thorn;";case 255:return"&yuml;";case 338:return"&OElig;";case 339:return"&oelig;";case 352:return"&Scaron;";case 353:return"&scaron;";case 376:return"&Yuml;";case 710:return"&circ;";case 732:return"&tilde;";case 8194:return"&ensp;";case 8195:return"&emsp;";case 8201:return"&thinsp;";case 8204:return"&zwnj;";case 8205:return"&zwj;";case 8206:return"&lrm;";case 8207:return"&rlm;";case 8211:return"&ndash;";case 8212:return"&mdash;";case 8216:return"&lsquo;";case 8217:return"&rsquo;";case 8218:return"&sbquo;";case 8220:return"&ldquo;";case 8221:return"&rdquo;";case 8222:return"&bdquo;";case 8224:return"&dagger;";case 8225:return"&Dagger;";case 8240:return"&permil;";case 8249:return"&lsaquo;";case 8250:return"&rsaquo;";case 8364:return"&euro;";case 402:return"&fnof;";case 913:return"&Alpha;";case 914:return"&Beta;";case 915:return"&Gamma;";case 916:return"&Delta;";case 917:return"&Epsilon;";case 918:return"&Zeta;";case 919:return"&Eta;";case 920:return"&Theta;";case 921:return"&Iota;";case 922:return"&Kappa;";case 923:return"&Lambda;";case 924:return"&Mu;";case 925:return"&Nu;";case 926:return"&Xi;";case 927:return"&Omicron;";case 928:return"&Pi;";case 929:return"&Rho;";case 931:return"&Sigma;";case 932:return"&Tau;";case 933:return"&Upsilon;";case 934:return"&Phi;";case 935:return"&Chi;";case 936:return"&Psi;";case 937:return"&Omega;";case 945:return"&alpha;";case 946:return"&beta;";case 947:return"&gamma;";case 948:return"&delta;";case 949:return"&epsilon;";case 950:return"&zeta;";case 951:return"&eta;";case 952:return"&theta;";case 953:return"&iota;";case 954:return"&kappa;";case 955:return"&lambda;";case 956:return"&mu;";case 957:return"&nu;";case 958:return"&xi;";case 959:return"&omicron;";case 960:return"&pi;";case 961:return"&rho;";case 962:return"&sigmaf;";case 963:return"&sigma;";case 964:return"&tau;";case 965:return"&upsilon;";case 966:return"&phi;";case 967:return"&chi;";case 968:return"&psi;";case 969:return"&omega;";case 977:return"&thetasym;";case 978:return"&upsih;";case 982:return"&piv;";case 8226:return"&bull;";case 8230:return"&hellip;";case 8242:return"&prime;";case 8243:return"&Prime;";case 8254:return"&oline;";case 8260:return"&frasl;";case 8472:return"&weierp;";case 8465:return"&image;";case 8476:return"&real;";case 8482:return"&trade;";case 8501:return"&alefsym;";case 8592:return"&larr;";case 8593:return"&uarr;";case 8594:return"&rarr;";case 8595:return"&darr;";case 8596:return"&harr;";case 8629:return"&crarr;";case 8656:return"&lArr;";case 8657:return"&uArr;";case 8658:return"&rArr;";case 8659:return"&dArr;";case 8660:return"&hArr;";case 8704:return"&forall;";case 8706:return"&part;";case 8707:return"&exist;";case 8709:return"&empty;";case 8711:return"&nabla;";case 8712:return"&isin;";case 8713:return"&notin;";case 8715:return"&ni;";case 8719:return"&prod;";case 8721:return"&sum;";case 8722:return"&minus;";case 8727:return"&lowast;";case 8730:return"&radic;";case 8733:return"&prop;";case 8734:return"&infin;";case 8736:return"&ang;";case 8743:return"&and;";case 8744:return"&or;";case 8745:return"&cap;";case 8746:return"&cup;";case 8747:return"&int;";case 8756:return"&there4;";case 8764:return"&sim;";case 8773:return"&cong;";case 8776:return"&asymp;";case 8800:return"&ne;";case 8801:return"&equiv;";case 8804:return"&le;";case 8805:return"&ge;";case 8834:return"&sub;";case 8835:return"&sup;";case 8836:return"&nsub;";case 8838:return"&sube;";case 8839:return"&supe;";case 8853:return"&oplus;";case 8855:return"&otimes;";case 8869:return"&perp;";case 8901:return"&sdot;";case 8968:return"&lceil;";case 8969:return"&rceil;";case 8970:return"&lfloor;";case 8971:return"&rfloor;";case 9001:return"&lang;";case 9002:return"&rang;";case 9674:return"&loz;";case 9824:return"&spades;";case 9827:return"&clubs;";case 9829:return"&hearts;";case 9830:return"&diams;";default:if(webeditor.encodeUnknownCharCodes){return"&#"+A.charCodeAt(0)+";"}else{return A}}}function contenteditable_encodeScriptTags(A){RegExp.global=true;RegExp.multiline=true;A=""+A;if(webeditor.strip.SCRIPT){A=A.replace(/<script([^>]*)>.*?<\/script>/gi,"")}else{if(typeof (webeditor.strip.SCRIPT)!="undefined"){A=A.replace(/<script([^>]*)>/gi,"");A=A.replace(/<\/script>/gi,"")}}if(webeditor.strip.NOSCRIPT){A=A.replace(/<noscript([^>]*)>.*?<\/noscript>/gi,"")}else{if(typeof (webeditor.strip.NOSCRIPT)!="undefined"){A=A.replace(/<noscript([^>]*)>/gi,"");A=A.replace(/<\/noscript>/gi,"")}}if(webeditor.encodeScriptTags){startscript=A.indexOf("<script");while(startscript>=0){endscript=A.indexOf("<\/script>",startscript);if(endscript<0){break}scriptcontent=A.substring(startscript,endscript+9);scriptcontent=scriptcontent.replace(/&/gi,"&amp;");scriptcontent=scriptcontent.replace(/"/gi,"&quot;");scriptcontent=scriptcontent.replace(/</gi,"&lt;");scriptcontent=scriptcontent.replace(/>/gi,"&gt;");scriptcontent=scriptcontent.replace(/\r\n/gi,"<br>");scriptcontent=scriptcontent.replace(/\n/gi,"<br>");scriptcontent=scriptcontent.replace(/\r/gi,"<br>");A=A.substring(0,startscript)+scriptcontent+A.substring(endscript+9);startscript=A.indexOf("<script",startscript+scriptcontent.length)}A=A.replace(/<script([^>]*)>/gi,"&lt;script$1&gt;");A=A.replace(/<script/gi,"&lt;script");A=A.replace(/<\/script>/gi,"&lt;/script&gt;");A=A.replace(/<noscript([^>]*)>/gi,"&lt;noscript$1&gt;");A=A.replace(/<noscript/gi,"&lt;noscript");A=A.replace(/<\/noscript>/gi,"&lt;/noscript&gt;")}if(webeditor.encodeCommentTags){A=A.replace(/<!--\[([^>]*)\]>/gi,"&lt;!--[$1]&gt;");A=A.replace(/<!\[([^>]*)\]-->/gi,"&lt;![$1]--&gt;");A=A.replace(/<!\[([^>]*)\]>/gi,"&lt;![$1]&gt;");A=A.replace(/<!--([^>]*)-->/gi,"&lt;!--$1--&gt;");A=A.replace(/<!--/gi,"&lt;!--");A=A.replace(/-->/gi,"--&gt;")}if(webeditor.encodePercentTags){startscript=A.indexOf("<%");while(startscript>=0){endscript=A.indexOf("%>",startscript);if(endscript<0){break}scriptcontent=A.substring(startscript,endscript+2);scriptcontent=scriptcontent.replace(/&/gi,"&amp;");scriptcontent=scriptcontent.replace(/"/gi,"&quot;");scriptcontent=scriptcontent.replace(/</gi,"&lt;");scriptcontent=scriptcontent.replace(/>/gi,"&gt;");scriptcontent=scriptcontent.replace(/\r\n/gi,"<br>");scriptcontent=scriptcontent.replace(/\n/gi,"<br>");scriptcontent=scriptcontent.replace(/\r/gi,"<br>");A=A.substring(0,startscript)+scriptcontent+A.substring(endscript+2);startscript=A.indexOf("<%",startscript+scriptcontent.length)}A=A.replace(/<%/gi,"&lt;%");A=A.replace(/%>/gi,"%&gt;")}if(webeditor.encodeQuestionTags){startscript=A.indexOf("<?");while(startscript>=0){endscript=A.indexOf("?>",startscript);if(endscript<0){break}scriptcontent=A.substring(startscript,endscript+2);scriptcontent=scriptcontent.replace(/&/gi,"&amp;");scriptcontent=scriptcontent.replace(/"/gi,"&quot;");scriptcontent=scriptcontent.replace(/</gi,"&lt;");scriptcontent=scriptcontent.replace(/>/gi,"&gt;");scriptcontent=scriptcontent.replace(/\r\n/gi,"<br>");scriptcontent=scriptcontent.replace(/\n/gi,"<br>");scriptcontent=scriptcontent.replace(/\r/gi,"<br>");A=A.substring(0,startscript)+scriptcontent+A.substring(endscript+2);startscript=A.indexOf("<?",startscript+scriptcontent.length)}A=A.replace(/<\?/gi,"&lt;?");A=A.replace(/\?>/gi,"?&gt;")}if(webeditor.encodePhpTags){startscript=A.indexOf("<?php");while(startscript>=0){endscript=A.indexOf("?>",startscript);if(endscript<0){break}scriptcontent=A.substring(startscript,endscript+2);scriptcontent=scriptcontent.replace(/&/gi,"&amp;");scriptcontent=scriptcontent.replace(/"/gi,"&quot;");scriptcontent=scriptcontent.replace(/</gi,"&lt;");scriptcontent=scriptcontent.replace(/>/gi,"&gt;");scriptcontent=scriptcontent.replace(/\r\n/gi,"<br>");scriptcontent=scriptcontent.replace(/\n/gi,"<br>");scriptcontent=scriptcontent.replace(/\r/gi,"<br>");A=A.substring(0,startscript)+scriptcontent+A.substring(endscript+2);startscript=A.indexOf("<?php",startscript+scriptcontent.length)}A=A.replace(/<\?php/gi,"&lt;?php");A=A.replace(/\?>/gi,"?&gt;")}return A}function contenteditable_decodeScriptTags(A){RegExp.global=true;RegExp.multiline=true;A=""+A;if(webeditor.encodePhpTags){A=A.replace(/&lt;\?php/gi,"<?php");A=A.replace(/\?&gt;/gi,"?>");startscript=A.indexOf("<?php");while(startscript>=0){endscript=A.indexOf("?>",startscript);if(endscript<0){break}scriptcontent=A.substring(startscript,endscript+2);scriptcontent=scriptcontent.replace(/<br \/>/gi,"\r\n");scriptcontent=scriptcontent.replace(/<br>/gi,"\r\n");scriptcontent=scriptcontent.replace(/&lt;/gi,"<");scriptcontent=scriptcontent.replace(/&gt;/gi,">");scriptcontent=scriptcontent.replace(/&quot;/gi,'"');scriptcontent=scriptcontent.replace(/&amp;/gi,"&");A=A.substring(0,startscript)+scriptcontent+A.substring(endscript+2);startscript=A.indexOf("<?php",startscript+scriptcontent.length)}}if(webeditor.encodeQuestionTags){A=A.replace(/&lt;\?/gi,"<?");A=A.replace(/\?&gt;/gi,"?>");startscript=A.indexOf("<?");while(startscript>=0){endscript=A.indexOf("?>",startscript);if(endscript<0){break}scriptcontent=A.substring(startscript,endscript+2);scriptcontent=scriptcontent.replace(/<br \/>/gi,"\r\n");scriptcontent=scriptcontent.replace(/<br>/gi,"\r\n");scriptcontent=scriptcontent.replace(/&lt;/gi,"<");scriptcontent=scriptcontent.replace(/&gt;/gi,">");scriptcontent=scriptcontent.replace(/&quot;/gi,'"');scriptcontent=scriptcontent.replace(/&amp;/gi,"&");A=A.substring(0,startscript)+scriptcontent+A.substring(endscript+2);startscript=A.indexOf("<?",startscript+scriptcontent.length)}}if(webeditor.encodePercentTags){A=A.replace(/&lt;%/gi,"<%");A=A.replace(/%&gt;/gi,"%>");startscript=A.indexOf("<%");while(startscript>=0){endscript=A.indexOf("%>",startscript);if(endscript<0){break}scriptcontent=A.substring(startscript,endscript+2);scriptcontent=scriptcontent.replace(/<br \/>/gi,"\r\n");scriptcontent=scriptcontent.replace(/<br>/gi,"\r\n");scriptcontent=scriptcontent.replace(/&lt;/gi,"<");scriptcontent=scriptcontent.replace(/&gt;/gi,">");scriptcontent=scriptcontent.replace(/&quot;/gi,'"');scriptcontent=scriptcontent.replace(/&amp;/gi,"&");A=A.substring(0,startscript)+scriptcontent+A.substring(endscript+2);startscript=A.indexOf("<%",startscript+scriptcontent.length)}}if(webeditor.encodeCommentTags){A=A.replace(/&lt;!--\[([^&]*)\]&gt;/gi,"<!--[$1]>");A=A.replace(/&lt;!\[([^&]*)\]--&gt;/gi,"<![$1]-->");A=A.replace(/&lt;!\[([^&]*)\]&gt;/gi,"<![$1]>");A=A.replace(/&lt;!--([^&]*)--&gt;/gi,"<!--$1-->");A=A.replace(/&lt;!--([^>]*)--&gt;/gi,"<!--$1-->");A=A.replace(/&lt;!--/gi,"<!--");A=A.replace(/--&gt;/gi,"-->")}if(webeditor.encodeScriptTags){while(A.match(new RegExp("&lt;script([^&]*)=&quot;([^&]*)&quot;","gi"))){A=A.replace(/&lt;script([^&]*)=&quot;([^&]*)&quot;/gi,'&lt;script$1="$2"')}A=A.replace(/&lt;script([^&]*)&gt;/gi,"<script$1>");A=A.replace(/&lt;script/gi,"<script");A=A.replace(/&lt;\/script&gt;/gi,"<\/script>");A=A.replace(/&lt;noscript([^&]*)&gt;/gi,"<noscript$1>");A=A.replace(/&lt;noscript/gi,"<noscript");A=A.replace(/&lt;\/noscript&gt;/gi,"</noscript>");startscript=A.indexOf("<script");while(startscript>=0){endscript=A.indexOf("<\/script>",startscript);if(endscript<0){break}scriptcontent=A.substring(startscript,endscript+9);scriptcontent=scriptcontent.replace(/<br \/>[\r\n]*/gi,"\r\n");scriptcontent=scriptcontent.replace(/<br>[\r\n]*/gi,"\r\n");scriptcontent=scriptcontent.replace(/&lt;/gi,"<");scriptcontent=scriptcontent.replace(/&gt;/gi,">");scriptcontent=scriptcontent.replace(/&quot;/gi,'"');scriptcontent=scriptcontent.replace(/&amp;/gi,"&");A=A.substring(0,startscript)+scriptcontent+A.substring(endscript+9);startscript=A.indexOf("<script",startscript+scriptcontent.length)}}return A}function contenteditable_content_has_head(A){RegExp.global=false;RegExp.multiline=true;if((A.indexOf("<body")>-1)&&(A.indexOf("</body>")>-1)){return A.substring(0,A.indexOf("<body"))}else{return""}}function contenteditable_content_has_body(A){RegExp.global=false;RegExp.multiline=true;if((A.indexOf("<body")>-1)&&(A.indexOf("</body>")>-1)){return A.substring(A.indexOf("<body")).match(new RegExp("^(<body[^>]*>)","i"))[1]}else{return""}}function contenteditable_content_has_content(A){RegExp.global=false;RegExp.multiline=true;if((A.indexOf("<body")>-1)&&(A.indexOf("</body>")>-1)){return A.substring(A.indexOf("<body"),A.indexOf("</body>")).match(new RegExp("^<body[^>]*>((.|\\r|\\n)*)","i"))[1]}else{return A}}function contenteditable_split_content(C,B){if(!C){var A=document.getElementsByTagName("iframe").item(contenteditable_focused);if(A&&A.id){C=A.id}}if(C){contenteditable_contents_head[C]=contenteditable_content_has_head(B);contenteditable_contents_body[C]=contenteditable_content_has_body(B)}return contenteditable_content_has_content(B)}function contenteditable_merge_content(C,B){if(!webeditor.mergecontent){return B}if(!C){var A=document.getElementsByTagName("iframe").item(contenteditable_focused);if(A&&A.id){C=A.id}}if(C){if(contenteditable_contents_body[C]){B=contenteditable_contents_body[C]+B+"</body>"}if(contenteditable_contents_head[C]){B=contenteditable_contents_head[C]+B+"</html>"}}return B}function contenteditable_setBody(A,E){if(!A){return }RegExp.global=false;RegExp.multiline=true;var B=contenteditable_contents_body[E].substring(6,contenteditable_contents_body[E].length-1);while(B){var D;if(D=B.match(new RegExp('^(\\w+)="([^"]*)"\\s*(.*)',"i"))){for(var C=0;C<A.attributes.length;C++){if(A.attributes[C].name.toLowerCase()==D[1]){A.setAttribute(A.attributes[C].name,D[2])}}B=D[3]}else{if(D=B.match(new RegExp('^(\\w+)=([^\\s])\\s*(.*)"',"i"))){for(var C=0;C<A.attributes.length;C++){if(A.attributes[C].name.toLowerCase()==D[1]){A.setAttribute(A.attributes[C].name,D[2])}}B=D[3]}else{B=false}}}}function contenteditable_paste_replacement_fix(){contenteditable_pasteContent('<div id="webeditor_clipboard">'+webeditor.clipboardHTML+"</div>");var F="";if(webeditor.clipboardHTML){F=webeditor.clipboardHTML.replace("[\r\n\t]"," ")}var C=contenteditable_focused_document().getElementById("webeditor_clipboard");if(!C){return }var G=F.match(new RegExp("<a [^>]*>","gi"));var I=C.getElementsByTagName("A");if(G&&I){for(var K=0;(K<G.length)&&(K<I.length);K++){if(contenteditable_getAttribute(I[K],"href")&&contenteditable_getAttribute(G[K],"href")){contenteditable_setAttribute(I[K],"href",contenteditable_getAttribute(G[K],"href"))}}}var A=F.match(new RegExp("<img [^>]*>","gi"));var D=C.getElementsByTagName("IMG");if(A&&D){for(var K=0;(K<A.length)&&(K<D.length);K++){if(contenteditable_getAttribute(D[K],"src")&&contenteditable_getAttribute(A[K],"src")){contenteditable_setAttribute(D[K],"src",contenteditable_getAttribute(A[K],"src"))}}}var L=F.match(new RegExp("<input [^>]*>","gi"));var Q=C.getElementsByTagName("INPUT");if(L&&Q){for(var K=0;(K<L.length)&&(K<Q.length);K++){if(contenteditable_getAttribute(Q[K],"src")&&contenteditable_getAttribute(L[K],"src")){contenteditable_setAttribute(Q[K],"src",contenteditable_getAttribute(L[K],"src"))}}}var S=F.match(new RegExp("<table [^>]*>","gi"));var B=C.getElementsByTagName("TABLE");if(S&&B){for(var K=0;(K<S.length)&&(K<B.length);K++){if(contenteditable_getAttribute(B[K],"background")&&contenteditable_getAttribute(S[K],"background")){contenteditable_setAttribute(B[K],"background",contenteditable_getAttribute(S[K],"background"))}}}var H=F.match(new RegExp("<tr [^>]*>","gi"));var M=C.getElementsByTagName("TR");if(H&&M){for(var K=0;(K<H.length)&&(K<M.length);K++){if(contenteditable_getAttribute(M[K],"background")&&contenteditable_getAttribute(H[K],"background")){contenteditable_setAttribute(M[K],"background",contenteditable_getAttribute(H[K],"background"))}}}var O=F.match(new RegExp("<td [^>]*>","gi"));var R=C.getElementsByTagName("TR");if(O&&R){for(var K=0;(K<O.length)&&(K<R.length);K++){if(contenteditable_getAttribute(R[K],"background")&&contenteditable_getAttribute(O[K],"background")){contenteditable_setAttribute(R[K],"background",contenteditable_getAttribute(O[K],"background"))}}}var N=F.match(new RegExp("<iframe [^>]*>","gi"));var E=C.getElementsByTagName("IFRAME");if(N&&E){for(var K=0;(K<N.length)&&(K<E.length);K++){if(contenteditable_getAttribute(E[K],"src")&&contenteditable_getAttribute(N[K],"src")){contenteditable_setAttribute(E[K],"src",contenteditable_getAttribute(N[K],"src"))}}}var J=F.match(new RegExp("<area [^>]*>","gi"));var P=C.getElementsByTagName("AREA");if(J&&P){for(var K=0;(K<J.length)&&(K<P.length);K++){if(contenteditable_getAttribute(P[K],"href")&&contenteditable_getAttribute(J[K],"href")){contenteditable_setAttribute(P[K],"href",contenteditable_getAttribute(J[K],"href"))}}}contenteditable_remove_parentnode(C)}function contenteditable_doReplace(H,A){var L=false;var O="";while(H!=O){O=H;for(var P in A){var F;if(F=P.match("^([*A-Z][^ ]*)>([^ ]+)([ ]+([^ ]+))?([ ]+(.*?))?$")){if(replacematches=A[P].match("^([^ ]+)?([ ]+([^ ]+))?([ ]+(.*?))?$")){var I=F[1]?F[1]:"";var D=F[2]?F[2]:"";var K=F[4]?F[4]:"";var B=F[6]?F[6]:"";var M=replacematches[1]?replacematches[1]:"";var N=replacematches[3]?replacematches[3]:"";var C=replacematches[5]?replacematches[5]:"";var G=contenteditable_splitTags(H,I);for(var E=1;E<G.length;E+=2){G[E]=contenteditable_replaceTags(G[E],D,K,B,M,N,C)}H=G.join("")}}else{if(F=P.match("^([*A-Z][^ ]*)([ ]+([^ ]+))?([ ]+(.*?))?$")){if(replacematches=A[P].match("^([^ ]+)?([ ]+([^ ]+))?([ ]+(.*?))?$")){var D=F[1]?F[1]:"";var K=F[3]?F[3]:"";var B=F[5]?F[5]:"";var M=replacematches[1]?replacematches[1]:"";var N=replacematches[3]?replacematches[3]:"";var C=replacematches[5]?replacematches[5]:"";H=contenteditable_replaceTags(H,D,K,B,M,N,C)}}else{if((P==" ")&&(A[P]=="")){L=true}else{if(P!=""){var J="";while(H!=J){J=H;H=H.replace(new RegExp(P,"gi"),A[P])}}}}}}if(L){var J="";while(H!=J){J=H;H=H.replace(new RegExp("<([^ ]+)[ ]+>","gi"),"<$1>");H=H.replace(new RegExp("<([^>]+)[ ][ ]([^>]+)>","gi"),"<$1 $2>");H=H.replace(new RegExp('<([^>]+)=" ([^>]+)>',"gi"),'<$1="$2>');H=H.replace(new RegExp('<([^>]+) " ([^>]+)>',"gi"),'<$1" $2>');H=H.replace(new RegExp('<([^>]+) ">',"gi"),'<$1">');H=H.replace(new RegExp("\r?\n\r?\n","gi"),"\r\n")}}}return H}function contenteditable_splitTags(A,F){var E=new Array();if(A==""){E[E.length]=""}else{if(F==""){}else{if(F=="*"){}else{var B=0;var D=contenteditable_findStartTag(A,F);while(D>=0){E[E.length]=A.substring(B,D);var C=contenteditable_findClosingEndTag(A,F,D);if(C<0){E[E.length]=A.substring(D);B=A.length;D=-1;break}else{E[E.length]=A.substring(D,C);B=C;D=contenteditable_findStartTag(A,F,B)}}E[E.length]=A.substring(B)}}}return E}function contenteditable_findStartTag(B,E,C){if(!C){C=0}var D=B.indexOf("<"+E,C);if(D<0){D=B.indexOf("<"+E.toLowerCase(),C)}if(D<0){D=B.indexOf("<"+E.toUpperCase(),C)}while((D>=0)&&(B.charAt(D+1+E.length)!=">")&&(B.charAt(D+1+E.length)!=" ")&&(B.charAt(D+1+E.length)!="/")){var A=B.indexOf("<"+E,D+1);if(A<0){A=B.indexOf("<"+E.toLowerCase(),D+1)}if(A<0){A=B.indexOf("<"+E.toUpperCase(),D+1)}D=A}return D}function contenteditable_findClosingEndTag(D,F,E){var C=E+1;var B=E+1;var A=0;while(A>=0){if(C==B){C=contenteditable_findStartTag(D,F,C+1);B=contenteditable_findEndTag(D,F,B+1)}else{if((C<B)&&(C>=0)){C=contenteditable_findStartTag(D,F,C+1)}else{if((C>B)&&(B>=0)){B=contenteditable_findEndTag(D,F,B+1)}else{if((C<0)&&(B>=0)){B=contenteditable_findEndTag(D,F,B+1)}}}}if((C<0)&&(B<0)){break}else{if((C>=0)&&(B<0)){break}else{if((C<0)&&(B>=0)){A-=1}else{if(C<B){A+=1}else{if(C>B){A-=1}else{break}}}}}}if(B>=0){B+=F.length+3}return B}function contenteditable_findEndTag(A,D,B){if(!B){B=0}var C=A.indexOf("</"+D+">",B);if(C<0){C=A.indexOf("</"+D.toLowerCase()+">",B)}if(C<0){C=A.indexOf("</"+D.toUpperCase()+">",B)}return C}function contenteditable_replaceTags(H,F,J,C,M,Q,G){var L;var B;var A;var D;F=F.toUpperCase();J=J.toUpperCase();M=M.toUpperCase();Q=Q.toUpperCase();if((F=="*")&&(J=="STYLE")&&(C!="")&&(M=="*")&&(Q=="STYLE")){var E="";var K="";if((E=C.match("^(.*?): *(.*?)$"))&&(K=G.match("^(.*?): *(.*?)$"))){var I=E[1]?E[1]:"";var P=E[2]?E[2]:"";I=I.replace(new RegExp("\\*","gi"),'[^:;"]+');I=I.replace(new RegExp(" ","gi"),"[ ]*");P=P.replace(new RegExp("\\*","gi"),'[^:;"]+');P=P.replace(new RegExp(" ","gi"),"[ ]*");var O=K[1]?K[1]:"";var N=K[2]?K[2]:"";if(I==O){L="<([^ >]+)( [^>]*)? "+J+'="?([^">]*[; ])?'+I+'[ ]*:([^">]* )?'+P+'( [^">]*)?([ ;][^">]*)"?( ([^>]*))?>';B="<$1$2 "+Q+'="$3'+O+":$4"+N+'$5 $6"$7>';A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D)}}C=C.replace(new RegExp("\\*","gi"),'[^:;"]+');C=C.replace(new RegExp(" ","gi"),"[ ]*");L="<([^ >]+)( [^>]*)? "+J+'="?'+C+'[ ]*[;]*([^">]*)"?( ([^>]*))?>';B="<$1$2 "+Q+'="'+G+'$3"$4>';A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);L="<([^ >]+)( [^>]*)? "+J+'="?([^">]*?)([; ])'+C+'[ ]*[;]*([^">]*)"?( ([^>]*))?>';B="<$1$2 "+Q+'="$3$4'+G+'$5"$6>';A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);L="<([^ >]+)( [^>]*)? "+J+'=" *"( ([^>]*))?>';B="<$1$2$3>";A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}else{if((F!="")&&(J=="STYLE")&&(C!="")&&(M!="")&&(Q=="STYLE")){var E="";var K="";if((E=C.match("^(.*?): *(.*?)$"))&&(K=G.match("^(.*?): *(.*?)$"))){var I=E[1]?E[1]:"";var P=E[2]?E[2]:"";I=I.replace(new RegExp("\\*","gi"),'[^:;"]+');I=I.replace(new RegExp(" ","gi"),"[ ]*");P=P.replace(new RegExp("\\*","gi"),'[^:;"]+');P=P.replace(new RegExp(" ","gi"),"[ ]*");var O=K[1]?K[1]:"";var N=K[2]?K[2]:"";if(I==O){L="<("+F+")( [^>]*)? "+J+'="?([^">]*[; ])?'+I+'[ ]*:([^">]* )?'+P+'( [^">]*)?([ ;][^">]*)"?( ([^>]*))?>';B="<"+M+"$2 "+Q+'="$3'+O+":$4"+N+'$5 $6"$7>';A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D)}}C=C.replace(new RegExp("\\*","gi"),'[^:;"]+');C=C.replace(new RegExp(" ","gi"),"[ ]*");L="<("+F+")( [^>]*)? "+J+'="?'+C+'[ ]*[;]*([^">]*)"?( ([^>]*))?>';B="<"+M+"$2 "+Q+'="'+G+'$3"$4>';A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);L="<("+F+")( [^>]*)? "+J+'="?([^">]*?)([; ])'+C+'[ ]*[;]*([^">]*)"?( ([^>]*))?>';B="<"+M+"$2 "+Q+'="$3$4'+G+'$5"$6>';A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);L="<("+F+")( [^>]*)? "+J+'=" *"( ([^>]*))?>';B="<"+M+"$2$3>";A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}else{if((F!="")&&(J=="")&&(C=="")&&(M!="")){L="<"+F+">";B="";A="</"+F+">";D="";if(M!=""){B="<"+M;if((Q!="")&&(G!="")){B+=" "+Q+'="'+G+'"'}B+=">";D="</"+M+">"}H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}else{if((F!="")&&(J=="*")&&(C=="*")&&(M!="")&&(Q=="*")&&(G=="*")){L="<"+F+"( [^>]*)?>";B="<"+M+"$1>";A="</"+F+">";D="</"+M+">";H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}}}}if((F!="")&&(J=="*")&&(C=="*")&&(M=="")&&(Q=="")&&(G=="")){L="<"+F+"( [^>]*)?>";B="";A="</"+F+">";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}if((F!="")&&(J=="")&&(C=="")&&(M=="")&&(Q=="")&&(G=="")){H=contenteditable_replaceContainerTags(H,F,J,C,M,Q,G);C=C.replace(new RegExp("\\*","gi"),'[^ :;>"]+');L="<"+F+"( *)?>";B="";A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}if((F!="")&&(J!="")&&(C!="")&&(M=="")&&(Q=="")&&(G=="")){H=contenteditable_replaceContainerTags(H,F,J,C,M,Q,G);C=C.replace(new RegExp("\\*","gi"),'[^ :;>"]+');L="<"+F+"( [^>]*)? "+J+'="?'+C+'"?( ([^>]*))?>';B="";A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}if((F=="*")&&(J!="")&&(C=="*")&&(M=="*")&&(Q=="")&&(G=="")){L="<([^ >]+)( [^>]*)? "+J+'="?[^>]*"?( ([^>]*))?>';B="<$1$2$3>";A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}if((F!="")&&(J!="")&&(C=="*")&&(M!="")&&(Q=="")&&(G=="")){L="<"+F+"( [^>]*)? "+J+'="?[^>]*"?( ([^>]*))?>';B="<"+F+"$1$2>";A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}else{if((F=="*")&&(J!="")&&(C!="")&&(M=="*")&&(Q=="")&&(G=="")){L="<([^ >]+)( [^>]*)? "+J+"=(("+C+')|("'+C+'"))( [^>]*)?>';B="<$1$2$6>";A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}else{if((F!="")&&(J!="")&&(C!="")&&(M!="")&&(Q=="")&&(G=="")){L="<"+F+"( [^>]*)? "+J+"=(("+C+')|("'+C+'"))( [^>]*)?>';B="<"+F+"$1$5>";A="";D="";H=contenteditable_replaceTagsSub(H,L,B,A,D);return H}}}return H}function contenteditable_replaceTagsSub(B,E,A,F,D){var C="";while(B!=C){C=B;if(E!=""){B=B.replace(new RegExp(E,"gi"),A)}if(F!=""){B=B.replace(new RegExp(F,"gi"),D)}}return B}function contenteditable_replaceContainerTags(I,E,K,C,N,P,F){var H=contenteditable_splitTags(I,E);for(var G=1;G<H.length;G+=2){var C=C.replace(new RegExp("\\*","gi"),'[^ :;>"]+');var M="";if(K!=""){M="^<"+E+"( [^>]*)? "+K+'="?'+C+'"?( ([^>]*))?>'}else{M="^<"+E+"( *)?>"}var B="";var A="</"+E+">$";var D="";if(H[G].match(M)&&H[G].match(A)){if(M!=""){H[G]=H[G].replace(new RegExp(M,"i"),B)}if(A!=""){H[G]=H[G].replace(new RegExp(A,"i"),D)}}var O=H[G].substr(0,1);var J=H[G].substr(H[G].length-1,1);var L=H[G].substring(1,H[G].length-1);H[G]=O+contenteditable_replaceContainerTags(L,E,K,C,N,P,F)+J}I=H.join("");return I}if(typeof (encodeURIComponent)!="function"){encodeURIComponent=function(A){return escape(A)}}if(typeof (decodeURIComponent)!="function"){decodeURIComponent=function(A){return unescape(A)}}String.prototype.trim=function(){return(this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,""))};String.prototype.startsWith=function(A){return(this.match("^"+A)==A)};String.prototype.endsWith=function(A){return(this.match(A+"$")==A)};