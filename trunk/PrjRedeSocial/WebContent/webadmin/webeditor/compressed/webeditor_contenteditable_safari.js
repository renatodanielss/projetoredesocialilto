if(!browserIs("Win")){webeditor_keyCode_command="metaKey";webeditor_keyCode_paste=118}webeditor_keyCode_esc=27;webeditor_keyCode_pageup=33;webeditor_keyCode_pagedown=34;webeditor_keyCode_end=35;webeditor_keyCode_home=36;webeditor_keyCode_left=37;webeditor_keyCode_up=38;webeditor_keyCode_right=39;webeditor_keyCode_down=40;webeditor_keyCode_insert=45;webeditor_keyCode_a=97;webeditor.disable=new Array();webeditor.confirm=new Array();if(webeditor.majorVersion<5){webeditor.WYSIWYGselect=false}else{webeditor.WYSIWYGselect=true}webeditor.fixLinkOnClick=true;webeditor.fixLinkOnClick_Alert=false;webeditor.fixLinkOnClick_Alert_A=false;webeditor.fixLinkOnClick_Alert_AREA=false;webeditor.fixLinkOnClick_Alert_INPUT_BUTTON=false;webeditor.fixLinkOnClick_Alert_INPUT_FILE=false;webeditor.fixLinkOnClick_Alert_INPUT_IMAGE=false;webeditor.fixLinkOnClick_Alert_INPUT_SUBMIT=false;webeditor.fixLinkOnClick_Alert_Message='WARNING: You have clicked on a link (or a form button).\r\n\r\nUnfortunately, links in editable content are "active" in the Safari web browser.\r\n\r\nYour web browser may now replace the web content editor input field with the "clicked" web page.\r\n\r\nTo stop this, press and hold down the ESC key before/while selecting OK below.\r\n\r\nTo avoid this problem, position the caret/cursor somewhere outside the link and use the arrow/cursor keys to move the caret/cursor to the link.\r\n\r\nHopefully, Apple\'s Safari programmers will fix this problem in the next version of the Safari web browser. (Techncally, by disabling links in editable content, or by adding support for Event.preventDefault() and Event.stopPropagation()).';webeditor.fixLinkOnClick_Cancel=true;webeditor.fixLinkOnClick_Undo=false;webeditor.fixLinkOnClick_False_A_ONCLICK=true;webeditor.fixLinkOnClick_False_AREA_HREF=true;webeditor.fixLinkOnUnload=false;webeditor.fixLinkOnUnload_Alert=false;webeditor.fixLinkOnUnload_Cancel=false;webeditor.fixExeccommandInserthorizontalrule_DOM=true;webeditor.fixExeccommandStrikethrough_DOM=true;webeditor.fixExeccommandInsertorderedlist_DOM=true;webeditor.fixExeccommandInsertunorderedlist_DOM=true;webeditor.fixExeccommandIndent_DOM=true;webeditor.fixExeccommandOutdent_DOM=true;webeditor.fixExeccommandUnlink_DOM=true;webeditor.fixExeccommandFormatblock_Paste=true;webeditor.fixExeccommandFormatblock_Paste_DOM_fix=false;webeditor.fixExeccommandFind_Alert=true;webeditor.fixExeccommandCut_Alert=true;webeditor.fixExeccommandCopy_Alert=true;webeditor.fixExeccommandPaste_Alert=true;webeditor.fixExeccommand_Paste_Fix=false;webeditor.fixExeccommandRemoveformat_Fix=false;webeditor.fixExeccommand_DOM=false;webeditor.fixInsertimage_DOM=false;webeditor.fixInsertlink_DOM=false;webeditor.fixFormatclass_DOM=false;webeditor.fixFormatclass_Paste=false;webeditor.fixFormatclass_Paste_DOM=false;webeditor.fixFormatclass_ViewSource=false;webeditor.fixNobr_DOM=false;webeditor.fixBox_DOM=false;webeditor.fixMailto_DOM=false;webeditor.fixAnchor_DOM=false;webeditor.fixDOM_ResetInnerHTML=false;webeditor.nbsp2blank=true;webeditor.fixImageStyleBorderDefaults=true;webeditor.fixExeccommand2DPosition=true;function webeditor_empty_content_fix(A){if((A=="<p>")||(A=="<p />")){A="<p>&nbsp;</p>"}return A}function webeditor_supported(A){if(webeditor.disable[A]){alert(webeditor.disable[A]);return false}if(webeditor.confirm[A]){return confirm(webeditor.confirm[A])}return true}function webeditor_select_init(A){A.ondeactivate=webeditor_select_deactivate;A.onblur=webeditor_select_blur;A.onfocus=webeditor_select_focus}function webeditor_select_focus(A){if(A&&A.target&&A.target.id){webeditor.select_focused[A.target.id]=true}return true}function contenteditable_onload(A){window.addEventListener("load",A,true);WebEditorSkin()}function contenteditable_onload_remove(A){window.removeEventListener("load",A,true)}function contenteditable_attach_event_handler(C,B,A){C.addEventListener(B,A,true)}function contenteditable_detach_event_handler(C,B,A){C.removeEventListener(B,A,true)}function contenteditable_event_false(){return false}function contenteditable_false(){return false}function contenteditable_onclick_handler(A){if(parent.webeditor.fixLinkOnClick_Undo){parent.webeditor.SafariOnClickIframe=false}if(A.type=="click"){for(var B=A.target;B&&(B.nodeName!="BODY");B=B.parentNode){if((B.nodeName=="A")||(B.nodeName=="AREA")||((B.nodeName=="INPUT")&&((B.type.toUpperCase()=="BUTTON")||(B.type.toUpperCase()=="FILE")||(B.type.toUpperCase()=="IMAGE")||(B.type.toUpperCase()=="SUBMIT")))){if(parent.webeditor.fixLinkOnClick_Undo){parent.webeditor.SafariOnClickIframe=contenteditable_focused_iframe();parent.webeditor.SafariOnClickLocation=contenteditable_focused_iframe().document.location.href;parent.webeditor.SafariOnClickContent=WebEditorGetContent();setTimeout(contenteditable_onunload_handler,1000)}if(parent.webeditor.fixLinkOnClick_Alert){parent.webeditor.SafariOnClickContent=WebEditorGetContent();contenteditable_undo_save();alert(parent.webeditor.fixLinkOnClick_Alert_Message)}if((B.nodeName=="A")&&(parent.webeditor.fixLinkOnClick_Alert_A)){parent.webeditor.SafariOnClickContent=WebEditorGetContent();contenteditable_undo_save();alert(parent.webeditor.fixLinkOnClick_Alert_Message)}if((B.nodeName=="AREA")&&(parent.webeditor.fixLinkOnClick_Alert_AREA)){parent.webeditor.SafariOnClickContent=WebEditorGetContent();contenteditable_undo_save();alert(parent.webeditor.fixLinkOnClick_Alert_Message)}if((B.nodeName=="INPUT")&&(B.type.toUpperCase()=="BUTTON")&&(parent.webeditor.fixLinkOnClick_Alert_INPUT_BUTTON)){parent.webeditor.SafariOnClickContent=WebEditorGetContent();contenteditable_undo_save();alert(parent.webeditor.fixLinkOnClick_Alert_Message)}if((B.nodeName=="INPUT")&&(B.type.toUpperCase()=="FILE")&&(parent.webeditor.fixLinkOnClick_Alert_INPUT_FILE)){parent.webeditor.SafariOnClickContent=WebEditorGetContent();contenteditable_undo_save();alert(parent.webeditor.fixLinkOnClick_Alert_Message)}if((B.nodeName=="INPUT")&&(B.type.toUpperCase()=="IMAGE")&&(parent.webeditor.fixLinkOnClick_Alert_INPUT_IMAGE)){parent.webeditor.SafariOnClickContent=WebEditorGetContent();contenteditable_undo_save();alert(parent.webeditor.fixLinkOnClick_Alert_Message)}if((B.nodeName=="INPUT")&&(B.type.toUpperCase()=="SUBMIT")&&(parent.webeditor.fixLinkOnClick_Alert_INPUT_SUBMIT)){parent.webeditor.SafariOnClickContent=WebEditorGetContent();contenteditable_undo_save();alert(parent.webeditor.fixLinkOnClick_Alert_Message)}if(parent.webeditor.fixLinkOnClick_Cancel){contenteditable_event_stop(A);return false}}}}}function contenteditable_onunload_handler(A){if(parent.webeditor.fixLinkOnClick_Undo){if(parent.webeditor.SafariOnClickIframe){if(!parent.webeditor.SafariOnClickIframe.document){setTimeout(contenteditable_onunload_handler,1000);return false}parent.webeditor.SafariOnClickIframe.document.location.href=parent.webeditor.SafariOnClickLocation;return false}}}function contenteditable_reinit(){for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);try{if(B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document&&B.contentWindow.document.body){if(((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled"))){try{B.contentWindow.document.removeEventListener("focus",contenteditable_onfocus[A],true)}catch(C){}try{B.contentWindow.document.removeEventListener("blur",contenteditable_onblur[A],true)}catch(C){}}}}catch(C){}}contenteditable_inited=new Array();contenteditable_onfocus=new Array();contenteditable_onblur=new Array();for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);try{if(B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document&&B.contentWindow.document.body){if(((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled"))&&(!contenteditable_inited[B.id])){try{if(!contenteditable_onfocus[A]){contenteditable_onfocus[A]=new Function("event","if ((contenteditable_focused) && ((event) && (! event.target))) return; contenteditable_focused="+A+";webeditor_onfocus();webeditor_refreshToolbar(true);")}if(!contenteditable_onblur[A]){contenteditable_onblur[A]=new Function("event",'webeditor_onblur();webeditor_refreshToolbar(true);webeditor.clipboardHTML="";')}B.contentWindow.document.addEventListener("focus",contenteditable_onfocus[A],true);B.contentWindow.document.addEventListener("blur",contenteditable_onblur[A],true)}catch(C){}contenteditable_inited[B.id]=true}}}catch(C){}}}function contenteditable_init(){var F=true;for(var B=0;B<document.getElementsByTagName("iframe").length;B++){var C=document.getElementsByTagName("iframe").item(B);if(((C.className=="webeditor_contenteditable")||(C.className=="webeditor_contenteditable_disabled"))&&(!contenteditable_inited[C.id])){try{if(contenteditable_stylesheet[C.id]&&C&&C.contentWindow&&C.contentWindow.document&&C.contentWindow.document.getElementById("stylesheet")&&(!contenteditable_inited_stylesheet[C.id])){C.contentWindow.document.getElementById("stylesheet").href=contenteditable_stylesheet[C.id];contenteditable_inited_stylesheet[C.id]=true}else{if(contenteditable_stylesheet[C.id]&&C&&C.contentWindow&&C.contentWindow.document&&(!C.contentWindow.document.getElementById("stylesheet"))){if(C.src&&C.contentWindow&&C.contentWindow.document&&C.contentWindow.document.location){C.contentWindow.document.location.href=C.src;contenteditable_inited_document[C.id]=false;setTimeout(contenteditable_init,webeditor.initTimeout);webeditor.initTimeout=webeditor.initTimeout*webeditor.initTimeoutMultiplier;return }else{setTimeout(contenteditable_init,webeditor.initTimeout);webeditor.initTimeout=webeditor.initTimeout*webeditor.initTimeoutMultiplier;return }}else{if(C.src&&C.contentWindow&&C.contentWindow.document&&C.contentWindow.document.location){if(!contenteditable_inited_document[C.id]){C.contentWindow.document.location.href=C.src;contenteditable_inited_document[C.id]=true;setTimeout(contenteditable_init,webeditor.initTimeout);webeditor.initTimeout=webeditor.initTimeout*webeditor.initTimeoutMultiplier;return }else{}}else{setTimeout(contenteditable_init,webeditor.initTimeout);webeditor.initTimeout=webeditor.initTimeout*webeditor.initTimeoutMultiplier;return }}}}catch(E){alert(Text("webbrowser_unsupported_contenteditable")+"\r\n\r\n"+E+"\r\n\r\n"+E.message)}}}for(var B=0;B<document.getElementsByTagName("iframe").length;B++){var C=document.getElementsByTagName("iframe").item(B);if(((C.className=="webeditor_contenteditable")||(C.className=="webeditor_contenteditable_disabled"))&&(!contenteditable_inited[C.id])){try{if(webeditor.fixLinkOnUnload){C.contentWindow.addEventListener("unload",contenteditable_onunload_handler,true);C.contentWindow.document.body.addEventListener("unload",contenteditable_onunload_handler,true)}if(webeditor.fixLinkOnClick){C.contentWindow.document.addEventListener("click",contenteditable_onclick_handler,false)}if(webeditor.direction){C.contentWindow.document.dir=webeditor.direction}C.contentWindow.document.designMode="on";C.contentWindow.document.execCommand("redo",false,null);if(C.contentWindow.document.body){C.contentWindow.document.body.innerHTML=contenteditable_contents[C.id];contenteditable_setBody(C.contentWindow.document.body,C.id)}if(!contenteditable_onfocus[B]){contenteditable_onfocus[B]=new Function("event","if ((contenteditable_focused) && ((event) && (! event.target))) return; contenteditable_focused="+B+";webeditor_onfocus();webeditor_refreshToolbar(true);")}if(!contenteditable_onblur[B]){contenteditable_onblur[B]=new Function("event",'webeditor_onblur();webeditor_refreshToolbar(true);webeditor.clipboardHTML="";')}C.contentWindow.document.addEventListener("focus",contenteditable_onfocus[B],true);C.contentWindow.document.addEventListener("blur",contenteditable_onblur[B],true);C.contentWindow.document.addEventListener("click",contenteditable_onfocus[B],true);C.contentWindow.addEventListener("blur",contenteditable_onblur[B],true);C.contentWindow.document.addEventListener("keydown",contenteditable_event,true);C.contentWindow.document.addEventListener("keyup",contenteditable_event,true);C.contentWindow.document.addEventListener("keypress",contenteditable_event,true);C.contentWindow.document.addEventListener("mousedown",contenteditable_event,true);C.contentWindow.document.addEventListener("mouseup",contenteditable_event,true);if(webeditor.fixExeccommand2DPosition){C.contentWindow.document.addEventListener("mousemove",contenteditable_event_drag_move,true);C.contentWindow.document.addEventListener("drag",contenteditable_event_false,true);C.contentWindow.document.addEventListener("dragstart",contenteditable_event_false,true);C.contentWindow.document.addEventListener("dragend",contenteditable_event_false,true);C.contentWindow.document.addEventListener("drop",contenteditable_event_false,true)}else{C.contentWindow.document.addEventListener("drag",contenteditable_event,true)}if(webeditor.contextmenus){C.contentWindow.document.addEventListener("contextmenu",contenteditable_contextmenu,true)}var D=C;while((D.tagName!="FORM")&&(D.tagName!="HTML")){D=D.parentNode}if(D.tagName!="HTML"){D.addEventListener("submit",contenteditable_onSubmit,true);D[C.id].value=contenteditable_contents[C.id]}document.addEventListener("submit",contenteditable_onSubmit,true);window.addEventListener("submit",contenteditable_onSubmit,true)}catch(E){alert(Text("webbrowser_unsupported_contenteditable")+"\r\n\r\n"+E+"\r\n\r\n"+E.message)}if(!contenteditable_inited[C.id]){webeditor.inited+=1}contenteditable_inited[C.id]=true;if(F){F=false;contenteditable_focused=B;if(webeditor.fixLinkOnClick_False_A_ONCLICK){var A=contenteditable_focused_contentwindow().document.getElementsByTagName("a");for(var B=0;B<A.length;B++){A[B].setAttribute("onClick","return parent.contenteditable_false();"+(A[B].getAttribute("onClick")||""))}}if(webeditor.fixLinkOnClick_False_AREA_HREF){var A=contenteditable_focused_contentwindow().document.getElementsByTagName("area");for(var B=0;B<A.length;B++){A[B].setAttribute("href","javascript:return parent.contenteditable_false();"+(A[B].getAttribute("href")||""))}}}try{}catch(E){}}}if(webeditor.scrollContentToTop){var C=document.getElementsByTagName("iframe").item(contenteditable_focused);try{}catch(E){}webeditor_onfocus();webeditor_refreshToolbar(true);if(document.location.href.indexOf("#")<0){window.scrollTo(0,0)}}webeditor.refreshToolbar=true}function contenteditable_enable(D){for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);if(((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled"))&&(contenteditable_inited[B.id])){if((B.id==D)||(!D)){try{if(B.className!="webeditor_contenteditable"){B.className="webeditor_contenteditable"}if(B.contentWindow.document.designMode!="on"){B.contentWindow.document.designMode="on"}if(webeditor.direction&&(B.contentWindow.document.dir!=webeditor.direction)){B.contentWindow.document.dir=webeditor.direction}}catch(C){}try{if(!contenteditable_onfocus[A]){contenteditable_onfocus[A]=new Function("event","if ((contenteditable_focused) && ((event) && (! event.target))) return; contenteditable_focused="+A+";webeditor_onfocus();webeditor_refreshToolbar(true);")}if(!contenteditable_onblur[A]){contenteditable_onblur[A]=new Function("event",'webeditor_onblur();webeditor_refreshToolbar(true);webeditor.clipboardHTML="";')}B.contentWindow.document.addEventListener("focus",contenteditable_onfocus[A],true);B.contentWindow.document.addEventListener("blur",contenteditable_onblur[A],true)}catch(C){}contenteditable_inited[B.id]=true}}}}function contenteditable_disable(D){for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);if((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled")){if((B.id==D)||(!D)){try{if(B.className!="webeditor_contenteditable_disabled"){B.className="webeditor_contenteditable_disabled"}if(B.contentWindow.document.designMode!="off"){B.contentWindow.document.designMode="off"}if(webeditor.direction&&(B.contentWindow.document.dir!=webeditor.direction)){B.contentWindow.document.dir=webeditor.direction}}catch(C){}try{B.contentWindow.document.removeEventListener("focus",contenteditable_onfocus[A],true)}catch(C){}try{B.contentWindow.document.removeEventListener("blur",contenteditable_onblur[A],true)}catch(C){}}}}}function contenteditable_toolbar(A){if(webeditor.toolbar&&webeditor.toolbar.contentDocument&&webeditor.toolbar.contentDocument.body){return webeditor.toolbar.contentDocument}else{if(A&&contenteditable_focused_iframe()&&contenteditable_focused_iframe().id&&document.getElementById("webeditor_toolbar_"+contenteditable_focused_iframe().id)){return document.getElementById("webeditor_toolbar_"+contenteditable_focused_iframe().id)}else{return document}}}function contenteditable_document_stylesheets_cssrules(A){return A.cssRules}function contenteditable_selection_fix(){if(webeditor.contentSelectionBaseNode[contenteditable_focused]&&webeditor.contentSelectionExtentNode[contenteditable_focused]){contenteditable_selection().setBaseAndExtent(webeditor.contentSelectionBaseNode[contenteditable_focused],webeditor.contentSelectionBaseOffset[contenteditable_focused],webeditor.contentSelectionExtentNode[contenteditable_focused],webeditor.contentSelectionExtentOffset[contenteditable_focused])}}function contenteditable_event(A){var G=parent.document.getElementsByTagName("iframe");for(var F=0;F<G.length;F++){if(((G[F].className=="webeditor_contenteditable")||(G[F].className=="webeditor_contenteditable_disabled"))&&(G[F].document==A.target.ownerDocument)&&((F!=contenteditable_focused)||(F!=contenteditable_focused_fix))){webeditor_onblur();contenteditable_focused=F;G[F].contentWindow.focus();webeditor_onfocus();webeditor_refreshToolbar(true)}}if(A&&(A.type=="keydown")&&(A.keyCode!=webeditor_keyCode_backspace)&&(A.keyCode!=webeditor_keyCode_esc)&&(A.keyCode!=webeditor_keyCode_pageup)&&(A.keyCode!=webeditor_keyCode_pagedown)&&(A.keyCode!=webeditor_keyCode_end)&&(A.keyCode!=webeditor_keyCode_home)&&(A.keyCode!=webeditor_keyCode_left)&&(A.keyCode!=webeditor_keyCode_up)&&(A.keyCode!=webeditor_keyCode_right)&&(A.keyCode!=webeditor_keyCode_down)&&(A.keyCode!=webeditor_keyCode_insert)&&(A.keyCode!=webeditor_keyCode_delete)){var H=contenteditable_selection();if((H!=null)&&H.baseNode){if((H.baseNode.nodeType==3)&&(H.baseNode==H.extentNode)&&(H.baseNode.parentNode.tagName=="LI")&&(!H.baseNode.parentNode.nextSibling)&&(A.keyCode==webeditor_keyCode_enter)&&(H.baseNode.nodeValue.match(/^[ \xA0]*$/)!=null)&&((!H.baseNode.nextSibling)||((H.baseNode.nextSibling.nodeType==3)&&(!H.baseNode.nextSibling.nextSibling)&&(H.baseNode.nextSibling.nodeValue.match(/^[ \xA0]*$/)!=null)))){var J=contenteditable_nextnode(false,H.baseNode.parentNode,true);H.baseNode.parentNode.parentNode.removeChild(H.baseNode.parentNode);H.setBaseAndExtent(J,0,J,0);contenteditable_event_stop(A)}else{if((H.baseNode.nodeType==3)&&(H.baseNode==H.extentNode)&&(H.baseOffset==0)&&(!H.baseNode.previousSibling)&&(H.baseNode.parentNode.tagName=="LI")&&(!H.baseNode.parentNode.previousSibling)){var C=contenteditable_focused_contentwindow().document.createTextNode(""+String.fromCharCode(160));H.baseNode.parentNode.insertBefore(C,H.baseNode)}else{if((H.baseNode.nodeType==3)&&(H.baseNode==H.extentNode)&&(H.baseOffset==0)&&(H.baseNode.parentNode.tagName=="LI")&&(A.keyCode==webeditor_keyCode_enter)){var C=contenteditable_focused_contentwindow().document.createTextNode(""+String.fromCharCode(160));H.baseNode.parentNode.insertBefore(C,H.baseNode)}else{if((H.baseNode.nodeType==3)&&(H.baseNode==H.extentNode)&&(H.baseOffset==H.baseNode.nodeValue.length)&&(!H.baseNode.nextSibling)&&(H.baseNode.parentNode.tagName=="LI")&&(!H.baseNode.parentNode.nextSibling)){var C=contenteditable_focused_contentwindow().document.createTextNode(""+String.fromCharCode(160));H.baseNode.parentNode.appendChild(C)}else{if((H.baseNode.nodeType==3)&&(H.baseNode==H.extentNode)&&(H.baseOffset==H.baseNode.nodeValue.length)&&(H.baseNode.parentNode.tagName=="LI")&&(A.keyCode==webeditor_keyCode_enter)){var C=contenteditable_focused_contentwindow().document.createTextNode(""+String.fromCharCode(160));H.baseNode.parentNode.appendChild(C)}else{if((H.baseNode.nodeType==3)&&(H.baseNode==H.extentNode)&&(H.baseOffset!=H.baseNode.nodeValue.length)&&(H.baseNode.parentNode.tagName=="LI")&&(A.keyCode==webeditor_keyCode_enter)){}else{if((H.baseNode.nodeType==3)&&(H.baseNode==H.extentNode)&&(H.baseOffset==0)&&(!H.baseNode.previousSibling)&&((H.baseNode.parentNode.tagName=="TH")||(H.baseNode.parentNode.tagName=="TD"))&&(!H.baseNode.parentNode.previousSibling)&&(H.baseNode.parentNode.parentNode.tagName=="TR")&&(!H.baseNode.parentNode.parentNode.previousSibling)){var C=contenteditable_focused_contentwindow().document.createTextNode(""+String.fromCharCode(160));H.baseNode.parentNode.insertBefore(C,H.baseNode)}else{if((H.baseNode.nodeType==3)&&(H.baseNode==H.extentNode)&&(H.baseOffset==H.baseNode.nodeValue.length)&&(!H.baseNode.nextSibling)&&((H.baseNode.parentNode.tagName=="TH")||(H.baseNode.parentNode.tagName=="TD"))&&(!H.baseNode.parentNode.nextSibling)&&(H.baseNode.parentNode.parentNode.tagName=="TR")&&(!H.baseNode.parentNode.parentNode.nextSibling)){var C=contenteditable_focused_contentwindow().document.createTextNode(""+String.fromCharCode(160));H.baseNode.parentNode.appendChild(C)}else{if((H.baseNode.nodeType==3)&&(H.baseNode==H.extentNode)&&(H.baseOffset==0)&&(!H.baseNode.previousSibling)&&(H.baseNode.parentNode.tagName=="CAPTION")){var C=contenteditable_focused_contentwindow().document.createTextNode(""+String.fromCharCode(160));H.baseNode.parentNode.insertBefore(C,H.baseNode)}else{if((A.keyCode==webeditor_keyCode_enter)&&contenteditable_isCell()&&(!webeditor.onEnter)){contenteditable_event_stop(A);var C=contenteditable_pasteContent("<br>");if(C&&C.nextSibling){H.setBaseAndExtent(C.nextSibling,0,C.nextSibling,0)}else{if(C){var I=contenteditable_focused_contentwindow().document.createTextNode(""+String.fromCharCode(160)+String.fromCharCode(160));C.parentNode.appendChild(I);H.setBaseAndExtent(I,0,I,0)}}}else{if((H.baseNode==H.extentNode)&&(H.baseOffset==0)&&(H.baseNode.tagName=="LI")){var C=contenteditable_focused_contentwindow().document.createTextNode(""+String.fromCharCode(160)+String.fromCharCode(160));H.baseNode.appendChild(C);H.setBaseAndExtent(C,1,C,1)}else{if((A.keyCode==webeditor_keyCode_enter)&&(webeditor.onEnter.toLowerCase()=="<br>")&&(H.baseNode==H.extentNode)&&(H.baseNode==contenteditable_focused_document().body.lastChild)&&(H.baseOffset==H.extentOffset)&&(H.baseOffset==H.baseNode.length)){contenteditable_pasteContent(webeditor.onEnter)}}}}}}}}}}}}}}else{if(A&&(A.type=="keydown")&&(A.keyCode==webeditor_keyCode_backspace)){var H=contenteditable_selection();if(H&&(H.baseNode.nodeType==3)&&(H.baseNode==H.extentNode)&&(H.baseOffset==H.extentOffset)&&(H.baseNode.parentNode.tagName=="LI")&&(H.baseNode.nodeValue.length==H.baseOffset)){if(H.baseOffset>1){H.baseNode.nodeValue=H.baseNode.nodeValue.substring(0,H.baseNode.nodeValue.length-1);H.setBaseAndExtent(H.baseNode,H.baseNode.nodeValue.length,H.baseNode,H.baseNode.nodeValue.length);contenteditable_event_stop(A)}else{if(H.baseNode.parentNode&&H.baseNode.parentNode.previousSibling){var E=H.baseNode.parentNode.previousSibling;if(E&&E.lastChild&&(E.lastChild.nodeType==3)){var B=H.baseNode.parentNode.parentNode;B.removeChild(H.baseNode.parentNode);var C=E.lastChild;H.setBaseAndExtent(C,C.nodeValue.length,C,C.nodeValue.length);contenteditable_event_stop(A)}}}}}}var D=contenteditable_selection();if((A.target.tagName=="IMG")||(A.target.tagName=="OBJECT")||(A.target.tagName=="INPUT")||(A.target.tagName=="SELECT")||(A.target.tagName=="TEXTAREA")){webeditor.contentSelectionFocused=contenteditable_focused;webeditor.contentSelectionBaseNode[contenteditable_focused]=A.target;webeditor.contentSelectionBaseOffset[contenteditable_focused]=0;webeditor.contentSelectionExtentNode[contenteditable_focused]=A.target;webeditor.contentSelectionExtentOffset[contenteditable_focused]=A.target.childNodes.length||1;contenteditable_selection().setBaseAndExtent(webeditor.contentSelectionBaseNode[contenteditable_focused],webeditor.contentSelectionBaseOffset[contenteditable_focused],webeditor.contentSelectionExtentNode[contenteditable_focused],webeditor.contentSelectionExtentOffset[contenteditable_focused])}else{if((webeditor.contentSelectionBaseNode[contenteditable_focused]==contenteditable_focused_document().body.firstChild)&&(webeditor.contentSelectionBaseOffset[contenteditable_focused]==0)&&(webeditor.contentSelectionExtentNode[contenteditable_focused]==contenteditable_focused_document().body.lastChild)&&((webeditor.contentSelectionExtentOffset[contenteditable_focused]==contenteditable_focused_document().body.lastChild.childNodes.length)||((webeditor.contentSelectionExtentOffset[contenteditable_focused]==1)&&(contenteditable_focused_document().body.lastChild.childNodes.length==0)))){}else{if(D&&D.baseNode&&D.extentNode){webeditor.contentSelectionFocused=contenteditable_focused;webeditor.contentSelectionBaseNode[contenteditable_focused]=D.baseNode;webeditor.contentSelectionBaseOffset[contenteditable_focused]=D.baseOffset;webeditor.contentSelectionExtentNode[contenteditable_focused]=D.extentNode;webeditor.contentSelectionExtentOffset[contenteditable_focused]=D.extentOffset;if((D.extentNode.tagName=="IMG")&&(D.baseNode==D.extentNode)&&(D.baseOffset==D.extentOffset)){webeditor.contentSelectionFocused=contenteditable_focused;webeditor.contentSelectionBaseOffset[contenteditable_focused]=0;webeditor.contentSelectionExtentOffset[contenteditable_focused]=1}}}}if(A&&((A.type=="mousedown")||(A.type=="mouseup"))){if(D&&D.baseNode&&D.extentNode&&(D.baseNode.nodeType==3)&&(D.baseNode==D.extentNode)&&(D.baseOffset==D.extentOffset)){setTimeout(contenteditable_event_selection_fix,100)}}if(A&&((A.type=="keydown")||(A.type=="keypress"))&&A.metaKey&&(A.keyCode==webeditor_keyCode_a)){contenteditable_event_stop(A);var H=contenteditable_selection();H.setBaseAndExtent(contenteditable_focused_document().body,0,contenteditable_focused_document().body,contenteditable_focused_document().body.childNodes.length)}webeditor_refreshToolbar(webeditor.refreshtoolbarOnAnyEvent);return webeditor_event(A)}function contenteditable_event_selection_fix(){var B=contenteditable_selection();if(B&&B.baseNode&&B.extentNode&&(B.baseNode.nodeType==3)&&(B.baseNode==B.extentNode)&&(B.baseOffset==B.extentOffset)){var A=B.baseOffset-(""+B).length;if(A<0){A=0}if(B.baseNode.nodeValue.substring(A).indexOf(B)>=0){webeditor.contentSelectionBaseNode[contenteditable_focused]=B.baseNode;webeditor.contentSelectionBaseOffset[contenteditable_focused]=A+B.baseNode.nodeValue.substring(A).indexOf(B);webeditor.contentSelectionExtentNode[contenteditable_focused]=B.extentNode;webeditor.contentSelectionExtentOffset[contenteditable_focused]=webeditor.contentSelectionBaseOffset[contenteditable_focused]+(""+B).length}}}function contenteditable_event_stop(A){A.preventDefault();A.stopPropagation()}function contenteditable_event_ctrlkey(A){}function contenteditable_event_key(A){}function contenteditable_event_delete(A){if(A&&A.keyCode&&(A.keyCode==webeditor_keyCode_delete)){if((webeditor.contentSelectionBaseNode[contenteditable_focused]==contenteditable_focused_document().body.firstChild)&&(webeditor.contentSelectionBaseOffset[contenteditable_focused]==0)&&(webeditor.contentSelectionExtentNode[contenteditable_focused]==contenteditable_focused_document().body.lastChild)&&((webeditor.contentSelectionExtentOffset[contenteditable_focused]==contenteditable_focused_document().body.lastChild.childNodes.length)||((webeditor.contentSelectionExtentOffset[contenteditable_focused]==1)&&(contenteditable_focused_document().body.lastChild.childNodes.length==0)))){contenteditable_focused_document().body.innerHTML="";var B=contenteditable_selection();B.setBaseAndExtent(contenteditable_focused_document().body,0,contenteditable_focused_document().body,0);return }}}function contenteditable_event_enter_p(B){contenteditable_event_stop(B);if(B.type!="keydown"){return }var F=contenteditable_selection_range();if((F.startContainer==F.endContainer)&&(F.startContainer.nodeName=="#text")){var I=F.startContainer.nodeValue.substring(0,F.startOffset)||"";var E=F.startContainer.nodeValue.substring(F.endOffset)||"";var C=F.startContainer;var A=C.parentNode;if(A.nodeName=="P"){if(A.firstChild==A.lastChild){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=I||"&nbsp;";if(E){C.nodeValue=E}else{A.innerHTML="&nbsp;"}A.parentNode.insertBefore(D,A);var G=contenteditable_selection();G.setBaseAndExtent(A,0,A,0)}else{if(C==A.lastChild){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=E||"&nbsp;";C.nodeValue=I;if(A.nextSibling){A.parentNode.insertBefore(D,A.nextSibling)}else{A.parentNode.appendChild(D)}var G=contenteditable_selection();G.setBaseAndExtent(D,0,D,0)}else{if(C==A.firstChild){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=I||"&nbsp;";C.nodeValue=E;A.parentNode.insertBefore(D,A);var G=contenteditable_selection();G.setBaseAndExtent(C,0,C,0)}else{var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=E||"&nbsp;";C.nodeValue=I;while(C.nextSibling){nextSibling=C.nextSibling;A.removeChild(nextSibling);D.appendChild(nextSibling)}if(A.nextSibling){A.parentNode.insertBefore(D,A.nextSibling)}else{A.parentNode.appendChild(D)}var G=contenteditable_selection();G.setBaseAndExtent(D,0,D,0)}}}}else{if(A.nodeName=="BODY"){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=I||"&nbsp;";var H=contenteditable_focused_contentwindow().document.createElement("P");H.innerHTML=E||"&nbsp;";A.insertBefore(D,C);A.insertBefore(H,C);A.removeChild(C);var G=contenteditable_selection();G.setBaseAndExtent(H,0,H,0)}else{var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=E||"&nbsp;";C.nodeValue=I;while(C.nextSibling){nextSibling=C.nextSibling;A.removeChild(nextSibling);D.appendChild(nextSibling)}while(A.nextSibling&&(A.nextSibling.nodeName!="P")){nextSibling=A.nextSibling;A.parentNode.removeChild(nextSibling);D.appendChild(nextSibling)}if(A.nextSibling){A.parentNode.insertBefore(D,A.nextSibling)}else{A.parentNode.appendChild(D)}var G=contenteditable_selection();G.setBaseAndExtent(D,0,D,0)}}}else{contenteditable_pasteContent("<p>")}}function contenteditable_event_enter_fix(A){if(A.type=="keypress"){var B=contenteditable_selection();if(B.baseNode&&B.baseNode.parentNode&&B.baseNode.parentNode.tagName=="FORM"){contenteditable_event_stop(A);var C=contenteditable_pasteContent("<br>");B.setBaseAndExtent(C,1,C,1)}}}function contenteditable_event_dragdrop(A){if(webeditor.fixExeccommand2DPosition){if(A&&(A.type=="mousedown")){contenteditable_event_drag_start(A)}else{if(A&&(A.type=="mouseup")){contenteditable_event_drag_end(A)}}}}var contenteditable_event_drag_node=false;var contenteditable_event_drag_top=0;var contenteditable_event_drag_left=0;var contenteditable_event_drag_x=0;var contenteditable_event_drag_y=0;function contenteditable_event_drag_start(A){if(A.target&&A.target.style&&(A.target.style.position=="absolute")){contenteditable_event_drag_node=A.target;contenteditable_event_drag_left=parseInt(contenteditable_event_drag_node.style.left+0);contenteditable_event_drag_top=parseInt(contenteditable_event_drag_node.style.top+0);contenteditable_event_drag_x=A.screenX;contenteditable_event_drag_y=A.screenY;contenteditable_event_stop(A)}else{contenteditable_event_drag_node=false}return false}function contenteditable_event_drag_move(C){if(C.target&&C.target.style&&(C.target.style.position=="absolute")&&(C.target==contenteditable_event_drag_node)){var E=C.screenX;var D=C.screenY;var A=contenteditable_event_drag_left+E-contenteditable_event_drag_x;var B=contenteditable_event_drag_top+D-contenteditable_event_drag_y;contenteditable_event_drag_x=E;contenteditable_event_drag_y=D;contenteditable_event_drag_left=A;contenteditable_event_drag_top=B;contenteditable_event_drag_node.style.left=A+"px";contenteditable_event_drag_node.style.top=B+"px";contenteditable_event_stop(C)}else{contenteditable_event_drag_node=false}return false}function contenteditable_event_drag_end(C){if(C.target&&C.target.style&&(C.target.style.position=="absolute")&&(C.target==contenteditable_event_drag_node)){var A=contenteditable_event_drag_left+C.screenX-contenteditable_event_drag_x;var B=contenteditable_event_drag_top+C.screenY-contenteditable_event_drag_y;contenteditable_event_drag_node.style.left=A+"px";contenteditable_event_drag_node.style.top=B+"px";contenteditable_event_stop(C)}contenteditable_event_drag_node=false;return false}function contenteditable_selection(A){if(!A){A=contenteditable_focused_contentwindow()}if(A&&A.getSelection){return A.getSelection()}}function contenteditable_selection_unselect(){var B=contenteditable_selection();B.setBaseAndExtent(contenteditable_focused_document().body,0,contenteditable_focused_document().body,0);var A=contenteditable_selection_range();webeditor.contentSelectionBaseNode[contenteditable_focused]=contenteditable_focused_document().body;webeditor.contentSelectionBaseOffset[contenteditable_focused]=0;webeditor.contentSelectionExtentNode[contenteditable_focused]=contenteditable_focused_document().body;webeditor.contentSelectionExtentOffset[contenteditable_focused]=0}function contenteditable_selection_text(D){if(!D){D=contenteditable_selection()}var E=contenteditable_selection_range(D);var C=false;if((webeditor.contentSelectionBaseNode[contenteditable_focused]==contenteditable_focused_document().body.firstChild)&&(webeditor.contentSelectionBaseOffset[contenteditable_focused]==0)&&(webeditor.contentSelectionExtentNode[contenteditable_focused]==contenteditable_focused_document().body.lastChild)&&((webeditor.contentSelectionExtentOffset[contenteditable_focused]==contenteditable_focused_document().body.lastChild.childNodes.length)||((webeditor.contentSelectionExtentOffset[contenteditable_focused]==1)&&(contenteditable_focused_document().body.lastChild.childNodes.length==0)))){C=true;D={baseNode:webeditor.contentSelectionBaseNode[contenteditable_focused],baseOffset:webeditor.contentSelectionBaseOffset[contenteditable_focused],extentNode:webeditor.contentSelectionExtentNode[contenteditable_focused],extentOffset:webeditor.contentSelectionExtentOffset[contenteditable_focused]}}if(C||(E&&D&&(E.startContainer==E.endContainer)&&(D.baseNode!=D.extentNode))){var B=D.baseNode;var I=D.baseOffset;var H=D.extentNode;var A=D.extentOffset;E=contenteditable_createrange();try{E.setStart(B,I)}catch(G){try{if(I){E.setStartAfter(B)}else{E.setStartBefore(B)}}catch(G){E=contenteditable_selection_range(D)}}try{E.setEnd(H,A)}catch(G){try{if(A){E.setEndAfter(H)}else{E.setEndBefore(H)}}catch(G){E=contenteditable_selection_range(D)}}}var F=getRangeHTML(E,D);return F}function contenteditable_selection_range_control(A){if(!A){A=contenteditable_selection()}if(A){return(A.type=="Control")}}function contenteditable_selection_range_parentNode(E){if(!E){E=contenteditable_selection_range()}if(E){if(contenteditable_selection_container("IMG")){return contenteditable_selection_container("IMG")}if(contenteditable_selection_container("IFRAME")){return contenteditable_selection_container("IFRAME")}if(contenteditable_selection_container("INPUT")){return contenteditable_selection_container("INPUT")}if(contenteditable_selection_container("SELECT")){return contenteditable_selection_container("SELECT")}if(contenteditable_selection_container("TEXTAREA")){return contenteditable_selection_container("TEXTAREA")}if(E.commonAncestorContainer.nodeName=="#text"){return E.commonAncestorContainer.parentNode}else{var C=E.startContainer;var D=E.endContainer;if((E.endOffset==0)&&(D.nodeName=="#text")&&(D.parentNode.nodeName=="TD")){D=D.parentNode.previousSibling;for(var B=C;B&&(B.tagName!="BODY");B=B.parentNode){for(var A=D;A&&(A.tagName!="BODY");A=A.parentNode){if(B==A){return B}}}}return E.commonAncestorContainer}}}function contenteditable_selection_range_startNode(A){}function contenteditable_selection_range_endNode(A){}function contenteditable_selection_range_contains(E,B,I){var G=0;var A=1;var F=2;var D=3;var C=false;var H=contenteditable_createrange();H.selectNode(B);if(E&&(E.compareBoundaryPoints(G,H)==-1)&&(E.compareBoundaryPoints(A,H)==1)&&(E.compareBoundaryPoints(D,H)==-1)&&(E.compareBoundaryPoints(F,H)==1)){C=true}else{if(I&&E&&(E.compareBoundaryPoints(A,H)==-1)&&(E.compareBoundaryPoints(D,H)==1)){C=true}else{if(I&&E&&(E.compareBoundaryPoints(A,H)==1)&&(E.compareBoundaryPoints(D,H)==-1)){C=true}}}return C}function contenteditable_selection_contains(E){var B=contenteditable_selection_range();var C=contenteditable_selection_range_parentNode(B);var A=C.getElementsByTagName(E);for(var D=0;D<A.length;D++){if(contenteditable_selection_range_contains(B,A[D],true)){return true}}return false}function contenteditable_selection_range(F){if(!F){F=contenteditable_selection()}if(!F){return }if(!F.setBaseAndExtent){return }var E;var M;var J;var C;if(F&&F.baseNode&&F.extentNode){E=F.baseNode;M=F.baseOffset;J=F.extentNode;C=F.extentOffset}else{if(F){E=webeditor.contentSelectionBaseNode[contenteditable_focused];M=webeditor.contentSelectionBaseOffset[contenteditable_focused];J=webeditor.contentSelectionExtentNode[contenteditable_focused];C=webeditor.contentSelectionExtentOffset[contenteditable_focused];try{F.setBaseAndExtent(E,M,J,C)}catch(L){F=false}}}if(F&&E&&J){if((E.nodeType!=3)&&(M>=E.childNodes.length)&&E.nextSibling&&(E.nextSibling==J)){E=E.nextSibling;M=0}if((E.nodeType==3)&&(M>=E.nodeValue.length)&&E.nextSibling&&(E.nextSibling==J)){E=E.nextSibling;M=0}if((J.nodeType!=3)&&(C>=J.childNodes.length)&&J.nextSibling&&(J.nextSibling==E)){var N=E;E=J.nextSibling;J=N;var N=M;M=0;C=N}if((J.nodeType==3)&&(C>=J.nodeValue.length)&&J.nextSibling&&(J.nextSibling==E)){var N=E;E=J.nextSibling;J=N;var N=M;M=0;C=N}if((E==J)&&(M>C)){var N=M;M=C;C=N}else{if(E!=J){try{var H=0;var B=1;var G=2;var D=3;var O=contenteditable_createrange();O.selectNode(E);var K=contenteditable_createrange();K.selectNode(J);if(O.compareBoundaryPoints(H,K)==1){var N=E;E=J;J=N;var N=M;M=C;C=N}}catch(L){}}}if((F!="")&&(F.baseNode==F.extentNode)&&(F.baseOffset==F.extentOffset)){var A=M-(""+F).length;if(A<0){A=0}M=F.baseNode.nodeValue.indexOf(F,A);C=M+(""+F).length}if((E==J)&&(M==C-1)&&(E.nodeType==1)){if(E.childNodes[M]&&(E.childNodes[M].nodeType==1)){E=E.childNodes[M];J=E;M=0;C=E.childNodes.length+1}}var I=contenteditable_createrange();if(I){if((E.nodeType!=3)&&(E==J)&&((M==0)||(M==1))&&((C==0)||(C==1))&&(M!=C)){try{I.setStartBefore(E);I.setEndAfter(E);return I}catch(L){}}if(F.type=="Range"){if((E.tagName=="IFRAME")||(J.tagName=="IFRAME")||(E.tagName=="INPUT")||(J.tagName=="INPUT")||(E.tagName=="TEXTAREA")||(J.tagName=="TEXTAREA")){try{I.setStart(E,M);I.setEnd(J,C)}catch(L){try{I.setStart(E,M);I.setEnd(E,M)}catch(L){try{I.setStart(J,C);I.setEnd(J,C)}catch(L){return false}}}return I}try{if((M==0)&&(C==1)){I.setStartBefore(E);I.setEndAfter(J)}else{I.setStart(E,M);I.setEnd(J,C)}}catch(L){try{I.setStart(E,M);I.setEnd(E,M)}catch(L){try{I.setStart(J,C);I.setEnd(J,C)}catch(L){return false}}}}else{if(F.type=="Caret"){try{I.setStart(E,M);I.setEnd(J,C)}catch(L){try{I.setStart(E,M);I.setEnd(E,M)}catch(L){try{I.setStart(J,C);I.setEnd(J,C)}catch(L){try{I.setStartBefore(E);I.setEndAfter(E)}catch(L){return false}}}}}}return I}}return false}function contenteditable_createrange(){return contenteditable_focused_contentwindow().document.createRange()}function contenteditable_selection_container(D){if(D){if((D.toUpperCase()=="IMG")||(D.toUpperCase()=="IFRAME")||(D.toUpperCase()=="INPUT")||(D.toUpperCase()=="SELECT")||(D.toUpperCase()=="TEXTAREA")){var A=contenteditable_selection();if(A&&A.baseNode&&A.extentNode){var S=contenteditable_nextnode(false,A.baseNode,true);if((A.baseNode==A.extentNode)&&(A.baseNode.tagName==D.toUpperCase())){return A.baseNode}else{if((A.baseNode==A.extentNode)&&(A.baseOffset==A.extentOffset-1)&&A.baseNode.childNodes[A.baseOffset]&&(A.baseNode.childNodes.length>A.baseOffset)&&(A.baseNode.childNodes[A.baseOffset].tagName==D.toUpperCase())){return A.baseNode.childNodes[A.baseOffset]}else{if((A.baseNode.nodeType==3)&&(A.baseNode.nodeValue.length==A.baseOffset)&&S&&(S.tagName==D.toUpperCase())&&(A.extentOffset>0)&&(A.extentNode.childNodes.length>=A.extentOffset)&&(A.extentNode.childNodes[A.extentOffset-1]==S)){return S}else{if((A.baseNode==A.extentNode)&&((!A.baseNode.parentNode)||(!A.baseNode.parentNode.parentNode)||(!A.baseNode.parentNode.parentNode.parentNode))&&webeditor.contentSelectionBaseNode[contenteditable_focused]&&(webeditor.contentSelectionBaseNode[contenteditable_focused].tagName==D.toUpperCase())){return webeditor.contentSelectionBaseNode[contenteditable_focused]}}}}}return false}}var P=0;var R=1;var T=2;var K=3;var J=contenteditable_selection_range();if(!J){return }var H=J.startContainer;var M=J.startOffset;var F=J.endContainer;var L=J.endOffset;if(D&&H&&F&&(H.nodeType==3)&&(F.nodeType==3)&&(H!=F)){if((M>=H.nodeValue.length)&&H.nextSibling&&F.parentNode&&(H.nextSibling==F.parentNode)&&(H.nextSibling.tagName==D.toUpperCase())){return H.nextSibling}}var I;var O=false;if(J&&(H==F)&&(!H.tagName)){I=contenteditable_selection_range_parentNode();if(I&&(!I.tagName)){I=I.parentNode}}else{if(J&&(H==F)&&(H.tagName=="BODY")&&(M==0)&&(L==H.childNodes.length)){I=contenteditable_selection_range_parentNode();if(I&&(!I.tagName)){I=I.parentNode}if(D&&I.firstChild&&(I.firstChild.tagName==D.toUpperCase())&&(I.firstChild==I.lastChild)){I=I.firstChild}}else{var N;var Q=false;var V=false;var U;if(false&&J&&(H==F)&&(M==0)&&(L==H.childNodes.length)){}else{if(true&&J&&(H==F)&&(M==L-1)){N=H.childNodes[M];U=N}else{if(true&&J&&(H==F)&&(M==L)){if(H.childNodes.length){N=H.childNodes[M]}else{N=H}U=N}else{if(true&&J&&H.tagName&&F.tagName){N=contenteditable_selection_range_parentNode();Q=H.childNodes[M];V=F.childNodes[L];U=Q}else{if(true&&J&&(H.tagName||F.tagName)){N=contenteditable_selection_range_parentNode();U=N}else{N=contenteditable_selection_range_parentNode();U=N;if(N&&N.lastChild){U=N.lastChild}}}}}}O=false;I=N;if(I&&(!I.tagName)){I=I.parentNode}var E=false;var C=0;while(U=contenteditable_nextnode(N,U,E)){var B=contenteditable_createrange();if(B.selectNode){B.selectNode(U);if(U.tagName&&J&&(J.compareBoundaryPoints(P,B)==0)&&(J.compareBoundaryPoints(T,B)==0)){O=U;if(O.nodeName==webeditor.selection_node){break}if(U.tagName=="TABLE"){E=true}else{E=false}}else{if(U.tagName&&J&&(J.compareBoundaryPoints(K,B)<=0)&&(J.compareBoundaryPoints(R,B)>=0)){if(I==U.parentNode){C=1}else{C++}I=U;if(U.tagName=="TABLE"){E=true}else{E=false}}else{E=true}}}if(U==V){break}}if(C>1){I=N}}}if(webeditor.selection_node&&I){var G=I;while(G&&(webeditor.selection_node!=G.nodeName)){G=G.parentNode}if(G){I=G}}if(D){var G=O||I||false;while(G&&(D.toUpperCase()!=G.tagName)){G=G.parentNode}return G}else{return O||I||(contenteditable_focused_document()?contenteditable_focused_document().body:false)}}function contenteditable_selection_all(){if(contenteditable_focused_document().body.firstChild){contenteditable_selection_node(contenteditable_focused_document().body.firstChild,contenteditable_focused_document().body.firstChild,0,0);if(contenteditable_focused_document().body.lastChild.nodeType==3){contenteditable_selection_node(contenteditable_focused_document().body.firstChild,contenteditable_focused_document().body.lastChild,0,contenteditable_focused_document().body.lastChild.nodeValue.length||1)}else{contenteditable_selection_node(contenteditable_focused_document().body.firstChild,contenteditable_focused_document().body.lastChild,0,contenteditable_focused_document().body.lastChild.childNodes.length||1)}var A=contenteditable_selection_range();webeditor.contentSelectionBaseNode[contenteditable_focused]=contenteditable_focused_document().body.firstChild;webeditor.contentSelectionBaseOffset[contenteditable_focused]=0;webeditor.contentSelectionExtentNode[contenteditable_focused]=contenteditable_focused_document().body.lastChild;webeditor.contentSelectionExtentOffset[contenteditable_focused]=contenteditable_focused_document().body.lastChild.childNodes.length||1}else{var B=contenteditable_selection();B.setBaseAndExtent(contenteditable_focused_document().body,0,contenteditable_focused_document().body,0);var A=contenteditable_selection_range();webeditor.contentSelectionBaseNode[contenteditable_focused]=contenteditable_focused_document().body;webeditor.contentSelectionBaseOffset[contenteditable_focused]=0;webeditor.contentSelectionExtentNode[contenteditable_focused]=contenteditable_focused_document().body;webeditor.contentSelectionExtentOffset[contenteditable_focused]=0}}function contenteditable_selection_node(D,B,A,C){webeditor.selection_node=D.nodeName;var F=contenteditable_selection();if(B){F.setBaseAndExtent(D,A,B,C)}else{if(D){if(D.childNodes&&D.childNodes.length){F.setBaseAndExtent(D,0,D,D.childNodes.length)}else{if(D.parentNode&&D.parentNode.childNodes&&D.parentNode.childNodes.length){for(var E=0;E<D.parentNode.childNodes.length;E++){if(D==D.parentNode.childNodes[E]){F.setBaseAndExtent(D.parentNode,E,D.parentNode,E+1)}}}else{F.setBaseAndExtent(D,0,D,1)}}}}}function contenteditable_selection_cells(B){var F=contenteditable_selection_range();var J=contenteditable_selection_range_parentNode();while((J.tagName=="THEAD")||(J.tagName=="TBODY")||(J.tagName=="TFOOT")||(J.tagName=="TR")||(J.tagName=="TD")){J=J.parentNode}var A=F.startContainer;while((A.tagName!="TH")&&(A.tagName!="TD")){A=A.parentNode}var H=F.endContainer;while((H.tagName!="TH")&&(H.tagName!="TD")){H=H.parentNode}if(J.tagName=="TABLE"){var G=-1;var C=-1;var L=-1;var K=-1;for(var E=0;E<J.rows.length;E++){for(var D=0;D<J.rows[E].cells.length;D++){if(A==J.rows[E].cells[D]){if(G==-1){G=D}if(C==-1){C=E}}if(H==J.rows[E].cells[D]){L=D;K=E}}}if((C>-1)&&(K>-1)&&(G>-1)&&(L>-1)){var I=new Array();for(var E=C;E<=K;E++){for(var D=G;D<=L;D++){if(!I[E-C]){I[E-C]=new Array()}I[E-C].push(J.rows[E].cells[D])}}if(I.length){return I}}}}function contenteditable_selection_bookmark(E){if(E){var J=contenteditable_focused_document().body;var F=E.startNode;var G=E.startOffset;var B=E.endNode;var H=E.endOffset;var A=contenteditable_selection_bookmark_path_node(J,E.startNodePath);var D=contenteditable_selection_bookmark_path_node(J,E.endNodePath);contenteditable_selection_node(A,D,G,H);if(A.tagName=="BODY"){if(contenteditable_focused_contentwindow().scrollTo){contenteditable_focused_contentwindow().scrollTo(0,0)}}else{if(contenteditable_selection_container().scrollIntoView){contenteditable_selection_container().scrollIntoView()}}contenteditable_focused_contentwindow().focus()}else{var I=contenteditable_selection();var C=contenteditable_selection_range();if(C&&C.startContainer&&C.endContainer){E=new Object();E.startNode=0;E.startOffset=C.startOffset;E.endNode=0;E.endOffset=C.endOffset;E.startNodePath=contenteditable_selection_bookmark_path(C.startContainer);E.endNodePath=contenteditable_selection_bookmark_path(C.endContainer)}else{if(I&&I.baseNode&&I.extentNode){E=new Object();E.startNode=0;E.startOffset=I.baseOffset;E.endNode=0;E.endOffset=I.extentOffset;E.startNodePath=contenteditable_selection_bookmark_path(I.baseNode);E.endNodePath=contenteditable_selection_bookmark_path(I.extentNode)}else{if(webeditor.contentSelectionBaseNode[contenteditable_focused]&&webeditor.contentSelectionExtentNode[contenteditable_focused]){E=new Object();E.startNode=0;E.startOffset=webeditor.contentSelectionBaseOffset[contenteditable_focused];E.endNode=0;E.endOffset=webeditor.contentSelectionExtentOffset[contenteditable_focused];E.startNodePath=contenteditable_selection_bookmark_path(webeditor.contentSelectionBaseNode[contenteditable_focused]);E.endNodePath=contenteditable_selection_bookmark_path(webeditor.contentSelectionExtentNode[contenteditable_focused])}else{if(contenteditable_focused_document()&&contenteditable_focused_document().body){E=new Object();E.startNode=0;E.startOffset=0;E.endNode=0;E.endOffset=0;E.startNodePath=contenteditable_selection_bookmark_path(contenteditable_focused_document().body);E.endNodePath=contenteditable_selection_bookmark_path(contenteditable_focused_document().body)}}}}}return E}function contenteditable_selection_bookmark_path(D){var C="";var A=1;var E=D.nodeName;var B=D;while(B=B.previousSibling){if(B.nodeName==E){A++}}C=A+"."+E;while((D=D.parentNode)&&(D.nodeName!="BODY")&&(D.nodeName!="HTML")&&(D.nodeName!="#document")){var A=1;var E=D.nodeName;var B=D;while(B=B.previousSibling){if(B.nodeName==E){A++}}C=A+"."+E+" "+C}return C}function contenteditable_selection_bookmark_path_node(F,D){var E=D.split(" ");for(var C=0;C<E.length;C++){var G=E[C].split(".");var A=parseInt(G[0]);var H=G[1];var B=F.firstChild;if(B.nodeName==H){A--}while(A&&(B=B.nextSibling)){if(B.nodeName==H){A--}}if(B){F=B}else{}}return F}function contenteditable_setContent_body(B,C,A){if(A&&A.contentWindow&&A.contentWindow.document&&A.contentWindow.document.body){A.contentWindow.document.body.innerHTML=B;contenteditable_setBody(A.contentWindow.document.body,A.id)}}function contenteditable_insertNodeAtSelection(L,E,B){var R=E;var W="";var b=contenteditable_selection(L);var Y;var N;var A;var D;if(false&&b.baseNode){Y=b.baseNode;N=b.baseOffset;A=b.extentNode;D=b.extentOffset}else{Y=webeditor.contentSelectionBaseNode[contenteditable_focused];N=webeditor.contentSelectionBaseOffset[contenteditable_focused];A=webeditor.contentSelectionExtentNode[contenteditable_focused];D=webeditor.contentSelectionExtentOffset[contenteditable_focused]}if((Y==A)&&(N>D)){var Z=N;N=D;D=Z}var M=contenteditable_selection_range(b);var M;try{}catch(X){}var C=contenteditable_selection_container();var F=C.parentNode;var U=0;var V=Y;var I=A;while(V&&(V.parentNode!=C)){V=V.parentNode}while(I&&(I.parentNode!=C)){I=I.parentNode}for(var T=0;T<C.childNodes.length;T++){if((C.childNodes[T]==V)||(C.childNodes[T]==I)){U=T;break}}if(b.type=="Range"){if((M.startContainer.nodeType==3)&&(M.startContainer==M.endContainer)&&M.startOffset&&(M.startContainer.nodeValue.charAt(M.startOffset-1)==" ")){W=" "}else{if((M.startContainer.nodeType==3)&&(M.startContainer==M.endContainer)&&M.endOffset&&(M.startContainer.nodeValue.charAt(M.endOffset)==" ")){W=" "}}if((Y!=A)||(N!=D)||(contenteditable_selection_text()!="")){try{contenteditable_focused_document().execCommand("insertText",false,"")}catch(X){}if(contenteditable_selection_text()!=""){try{contenteditable_focused_document().execCommand("paste",false,"")}catch(X){}}if(contenteditable_selection_text()!=""){try{contenteditable_focused_document().execCommand("cut",false,"")}catch(X){}}if(contenteditable_selection_text()!=""){try{contenteditable_focused_document().execCommand("delete",false,"")}catch(X){}}b=contenteditable_selection(L);if((b.baseNode==b.extentNode)&&(b.baseNode.nodeType==1)&&(b.baseNode.childNodes)&&(b.baseNode.childNodes[0])&&(b.baseNode.childNodes[0].tagName=="BR")){Y=b.baseNode;N=b.baseOffset;A=b.extentNode;D=b.extentOffset;b.baseNode.removeChild(b.baseNode.childNodes[0])}else{if((Y==A)&&(!Y.parentNode)&&(!C.parentNode)){C=F;Y=b.baseNode;N=b.baseOffset;A=b.extentNode;D=b.extentOffset}else{if((Y==A)&&(!Y.parentNode)){Y=C;N=0;A=C;D=0}else{if(true&&b.baseNode){Y=b.baseNode;N=b.baseOffset;A=b.extentNode;D=b.extentOffset}else{Y=webeditor.contentSelectionBaseNode[contenteditable_focused];N=webeditor.contentSelectionBaseOffset[contenteditable_focused];A=webeditor.contentSelectionExtentNode[contenteditable_focused];D=webeditor.contentSelectionExtentOffset[contenteditable_focused]}}}}if((Y==A)&&(N>D)){var Z=N;N=D;D=Z}}}var J=Y;var G=N;if((Y.nodeType!=3)&&Y.nextSibling&&(N>Y.childNodes.length)){J=Y.nextSibling;G=0}if(false&&C&&C.parentNode&&(Y==A)&&(N==0)&&(D==0)){J=Y.parentNode;for(var T=0;T<J.childNodes.length;T++){if(J.childNodes[T]==Y){G=T;break}}if((!J.childNodes[G])||(C.nodeName=="BODY")){J=C;G=U}}M=contenteditable_createrange();if((J.nodeType==3)&&(E.nodeType==3)){if(contenteditable_selection_text()!=""){J.replaceData(b.baseOffset,b.extentOffset-b.baseOffset,E.nodeValue)}else{J.insertData(G,E.nodeValue)}b.setBaseAndExtent(J,G+E.length,J,G+E.length);R=J;return R}else{var S;if(J.nodeType==3){var Q=J;J=Q.parentNode;var K=Q.nodeValue;var a=K.substr(0,G);var P=K.substr(G);if(!P){if(Q.nextSibling){S=Q.nextSibling;J.insertBefore(E,Q.nextSibling)}else{S=J.nextSibling;J.appendChild(E)}if(S){b.setBaseAndExtent(S,0,S,0)}}else{var O=L.document.createTextNode(a+W);S=L.document.createTextNode(P);J.insertBefore(O,Q);J.insertBefore(E,Q);Q.nodeValue=S.nodeValue;b.setBaseAndExtent(Q,0,Q,0)}R=E;return R}else{S=J.childNodes[G];if(S){J.insertBefore(E,S);R=E}else{try{if((J.tagName!="AREA")&&(J.tagName!="BGSOUND")&&(J.tagName!="BR")&&(J.tagName!="FRAME")&&(J.tagName!="HR")&&(J.tagName!="IMG")&&(J.tagName!="INPUT")&&(J.tagName!="SPACER")&&(J.tagName!="WBR")){J.appendChild(E);R=E}else{J.parentNode.insertBefore(E,J)}}catch(X){var H=J.parentNode;H.replaceChild(E,J);R=E}}return R}if(false&&S){b.setBaseAndExtent(S,0,S,0);if(R&&(!R.firstChild)&&S.nodeType==3){for(var T=0;T<R.parentNode.childNodes.length;T++){if(R==R.parentNode.childNodes[T]){b.setBaseAndExtent(R.parentNode,T+1,R.parentNode,T+1)}}}return R}}contenteditable_selection_node(R);return R}function contenteditable_insertNodeAroundSelection(I,F,B){var D=contenteditable_selection();if(typeof (D)=="object"){var H=contenteditable_selection_range(D);var A=H.startContainer;var G=H.startOffset;var K=H.endContainer;var J=H.endOffset;if((A.tagName=="BODY")&&(K.tagName=="BODY")){A=A.childNodes[G];G=0;if(K.childNodes[J]){K=K.childNodes[J]}else{K=K.childNodes[J-1]}J=K.childNodes.length||1}if((A==K)&&(G!=J)&&(A.nodeType==3)){if((G==0)&&(J==A.nodeValue.length)&&(A.parentNode.nodeName=="SPAN")&&(A.parentNode.childNodes.length==1)){F.appendChild(I.document.createTextNode(A.nodeValue.substring(G,J)));contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),F)}else{F.appendChild(I.document.createTextNode(A.nodeValue.substring(G,J)));contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),F)}}else{if(A!=K){if((A.nodeType==3)&&(G!=0)){var C=A.cloneNode(true);C.nodeValue=C.nodeValue.substring(0,G);A.parentNode.insertBefore(C,A)}if((K.nodeType==3)&&(J!=0)){var C=K.cloneNode(true);C.nodeValue=C.nodeValue.substring(J);if(K.nextSibling){K.parentNode.insertBefore(C,K.nextSibling)}else{K.parentNode.appendChild(C)}}A.parentNode.insertBefore(F,A);var L;for(var C=A;C&&(C!=K);C=L){L=C.nextSibling;F.appendChild(C)}F.appendChild(K);A.nodeValue=A.nodeValue.substring(G);K.nodeValue=K.nodeValue.substring(0,J)}else{if(G!=J){A.parentNode.insertBefore(F,A);for(var E=G;E<J;E++){var C=A.childNodes[G];F.appendChild(C)}}else{if(false){var C=H.commonAncestorContainer;C.parentNode.insertBefore(F,C);F.appendChild(C)}if(false){var C=contenteditable_focused_contentwindow().document.createTextNode(".....");F.appendChild(C);contenteditable_insertNodeAtSelection(I,F)}}}}}}function contenteditable_useCSS(){try{contenteditable_focused_document().execCommand("styleWithCSS",0,true)}catch(A){try{contenteditable_focused_document().execCommand("useCSS",false,false)}catch(A){}}}function contenteditable_BlockDirLTR(A){webeditor.direction="ltr";contenteditable_focused_contentwindow().document.dir="ltr"}function contenteditable_BlockDirRTL(A){webeditor.direction="rtl";contenteditable_focused_contentwindow().document.dir="rtl"}function contenteditable_formatblock_query(){var A=(""+contenteditable_focused_document().queryCommandValue("formatblock")).toLowerCase();if(A=="false"){A=contenteditable_selection_range_parentNode().nodeName}return A}function contenteditable_selection_container_list(){var A;if(A=contenteditable_selection_container("ul")){}else{if(A=contenteditable_selection_container("ol")){}else{if(A=contenteditable_selection_container("dir")){}else{if(A=contenteditable_selection_container("menu")){}else{if(A=contenteditable_selection_container("dl")){}}}}}return A}function contenteditable_selection_container_listitem(){var A;if(A=contenteditable_selection_container("li")){}else{if(A=contenteditable_selection_container("dt")){}else{if(A=contenteditable_selection_container("dd")){}}}return A}function contenteditable_formatblock(F,D){if(D=="<ol>"){var C=contenteditable_formatblock_list("ol");contenteditable_formatblock_listitems(C,"li")}else{if(D=="<ul>"){var C=contenteditable_formatblock_list("ul");contenteditable_formatblock_listitems(C,"li")}else{if(D=="<dir>"){var C=contenteditable_formatblock_list("dir");contenteditable_formatblock_listitems(C,"li")}else{if(D=="<menu>"){var C=contenteditable_formatblock_list("menu");contenteditable_formatblock_listitems(C,"li")}else{if(D=="<dt>"){var C=contenteditable_selection_container_list();if(C.nodeName=="dl"){contenteditable_formatblock_listitem("dt")}else{C=contenteditable_formatblock_list("dl");contenteditable_formatblock_listitems(C,"dt")}}else{if(D=="<dd>"){var C=contenteditable_selection_container_list();if(C.nodeName=="dl"){contenteditable_formatblock_listitem("dd")}else{C=contenteditable_formatblock_list("dl");contenteditable_formatblock_listitems(C,"dd")}}else{if(D=="<p>"){var C=contenteditable_selection_container_list();if(C){C=contenteditable_formatblock_list("")}else{contenteditable_execcommand(F,D)}}else{if(webeditor.fixExeccommandFormatblock_Paste){var E=contenteditable_selection_text();if(!E){var A=contenteditable_selection_range();var B=A.startContainer;while(B.firstChild){B=B.firstChild}contenteditable_selection_node(B);E=contenteditable_selection_text()}if(!E){E="&nbsp;"}contenteditable_event_paste_do_pre();contenteditable_pasteContent(D+E+"</"+D.substring(1));contenteditable_event_paste_do_post();contenteditable_event_paste_fix();if(webeditor.fixExeccommandFormatblock_Paste_DOM_fix){contenteditable_DOM_fix()}return }contenteditable_execcommand(F,D)}}}}}}}}function contenteditable_formatblock_list(G){var F=contenteditable_selection_container_list();if(!F){contenteditable_execcommand("insertunorderedlist");F=contenteditable_selection_container("ul")}if(F&&G){var A=contenteditable_focused_contentwindow().document.createElement(G);for(var D=F.firstChild;D;D=D.nextSibling){var C=D.cloneNode(true);A.appendChild(C)}F.parentNode.replaceChild(A,F);return A}else{if(F){var A=contenteditable_focused_contentwindow().document.createElement("p");for(var D=F.firstChild;D;D=D.nextSibling){for(var B=D.firstChild;B;B=B.nextSibling){var E=B.cloneNode(true);A.appendChild(E)}A.appendChild(contenteditable_focused_contentwindow().document.createElement("br"));A.appendChild(contenteditable_focused_contentwindow().document.createTextNode("\r\n"))}F.parentNode.replaceChild(A,F);return A}}}function contenteditable_formatblock_listitem(D){var E=contenteditable_selection_container_listitem();if(E){var C=contenteditable_focused_contentwindow().document.createElement(D);for(var B=E.firstChild;B;B=B.nextSibling){var A=B.cloneNode(true);C.appendChild(A)}E.parentNode.replaceChild(C,E);return C}}function contenteditable_formatblock_listitems(E,D){if(E){for(var F=E.firstChild;F;F=F.nextSibling){if((F.nodeName=="LI")||(F.nodeName=="DT")||(F.nodeName=="DD")){var C=contenteditable_focused_contentwindow().document.createElement(D);for(var B=F.firstChild;B;B=B.nextSibling){var A=B.cloneNode(true);C.appendChild(A)}E.replaceChild(C,F);F=C}}}}function contenteditable_formatclass(D,J){if(webeditor.fixFormatclass_Paste){var L=contenteditable_selection_text()||"&nbsp;";contenteditable_event_paste_do_pre();contenteditable_pasteContent('<span class="'+J+'">'+L+"</span>");contenteditable_event_paste_do_post();contenteditable_event_paste_fix();return }if(webeditor.fixFormatclass_DOM){var G=contenteditable_selection_range();var L=contenteditable_selection_text();if((G.startContainer==G.endContainer)&&(G.startOffset!=G.endOffset)&&(G.startContainer.nodeType==3)){var C=G.startContainer.cloneNode(true);C.nodeValue=C.nodeValue.substring(0,G.startOffset);G.startContainer.parentNode.insertBefore(C,G.startContainer);var B=contenteditable_focused_contentwindow().document.createElement("span");B.className=J;G.startContainer.parentNode.insertBefore(B,G.startContainer);var K=G.startContainer.cloneNode(true);K.nodeValue=K.nodeValue.substring(G.endOffset);G.startContainer.parentNode.insertBefore(K,G.startContainer);G.startContainer.nodeValue=G.startContainer.nodeValue.substring(G.startOffset,G.endOffset);B.appendChild(G.startContainer)}else{contenteditable_selection_range_parentNode().className=J}return }var E=contenteditable_selection();if(typeof (E)=="object"){var G=contenteditable_selection_range(E);if((G.startContainer==G.endContainer)&&(G.startOffset!=G.endOffset)&&(G.startContainer.nodeType==3)){if((G.startOffset==0)&&(G.endOffset==G.startContainer.nodeValue.length)&&(G.startContainer.parentNode.nodeName!="BODY")&&(G.startContainer.parentNode.childNodes.length==1)){contenteditable_formatclass_attribute(G.startContainer.parentNode,J)}else{var B=contenteditable_focused_contentwindow().document.createElement("span");contenteditable_formatclass_attribute(B,J);B.appendChild(contenteditable_focused_contentwindow().document.createTextNode(G.startContainer.nodeValue.substring(G.startOffset,G.endOffset)));contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),B)}}else{if(G.startContainer!=G.endContainer){var B=G.startContainer;var A=G.startContainer;if(A.nodeType==3){if(G.startOffset<A.nodeValue.length){A=A.parentNode}else{A=A.nextSibling}}var I=G.endContainer;if(I.nodeType==3){if(G.endOffset>0){I=I.parentNode}else{I=I.previousSibling}}for(var B=A;B!=null;B=B.nextSibling){contenteditable_formatclass_attribute(B,J);if(B==I){break}}}else{if(G.startContainer&&(G.startContainer.nodeName=="BODY")){var B=contenteditable_focused_contentwindow().document.createElement("span");contenteditable_formatclass_attribute(B,J);for(var F=G.startOffset;F<G.endOffset;F++){var H=G.startContainer.childNodes[G.startOffset];B.appendChild(H)}contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),B)}else{if(G.startOffset!=G.endOffset){for(var F=G.startOffset;F<G.endOffset;F++){var B=G.startContainer.childNodes[G.startOffset];if(B.nodeType==3){B=B.parentNode}contenteditable_formatclass_attribute(B,J)}}else{var B=G.commonAncestorContainer;if(B){while((B!=null)&&(B.nodeType==3)){B=B.parentNode}contenteditable_formatclass_attribute(B,J)}}}}}}}function contenteditable_execcommand(F,M){var J=contenteditable_selection_text()||"&nbsp;";var O="";switch(F){case"inserthorizontalrule":if(webeditor.fixExeccommandInserthorizontalrule_DOM){var N=contenteditable_focused_contentwindow().document.createElement("hr");contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),N);return }case"strikethrough":if(webeditor.fixExeccommandStrikethrough_DOM){J=contenteditable_selection_text();if(J){var N=contenteditable_focused_contentwindow().document.createElement("strike");contenteditable_insertNodeAroundSelection(contenteditable_focused_contentwindow(),N)}return }case"insertorderedlist":if(webeditor.fixExeccommandInsertorderedlist_DOM){var N=contenteditable_selection_container("ol");if(N&&(N.nodeName=="OL")){var H=new Array();for(var A=N.firstChild;A;A=A.nextSibling){if(A.nodeName=="LI"){H[H.length]=A}}for(var P=0;P<H.length;P++){var T=contenteditable_focused_contentwindow().document.createElement("br");if(H[P].nextSibling){H[P].parentNode.insertBefore(T,H[P].nextSibling)}else{H[P].parentNode.appendChild(T)}contenteditable_remove_parentnode(H[P])}contenteditable_remove_parentnode(N);return }else{J=contenteditable_selection_text()||"";var N=contenteditable_focused_contentwindow().document.createElement("ol");var B=contenteditable_focused_contentwindow().document.createElement("li");N.appendChild(B);if(J.match(/<div[^>]*>/gi)||J.match(/<br[^>]*>/gi)){J=J.replace(/<br[^>]*>/gi,"</li><li>");J=J.replace(/<font[^>]*><\/font>/gi,"");J=J.replace(/<font[^>]*>/gi,"");J=J.replace(/<\/font>/gi,"");J=J.replace(/<div[^>]*>/gi,"</li><li>");J=J.replace(/<\/div>/gi,"");if(!J.match(/^<li>/gi)){J="<li>"+J}if(!J.match(/<\/li>$/gi)){J=J+"</li>"}J=J.replace(/<\/li><\/li>/gi,"");J=J.replace(/<li><li>/gi,"");J=J.replace(/<li><\/li>/gi,"");N.innerHTML=J}else{B.innerHTML=J}N=contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),N);if(N&&N.firstChild){var U=contenteditable_selection();U.setBaseAndExtent(N.firstChild,0,N.firstChild,0)}return }}case"insertunorderedlist":if(webeditor.fixExeccommandInsertunorderedlist_DOM){var N=contenteditable_selection_container("ul");if(N&&(N.nodeName=="UL")){var H=new Array();for(var A=N.firstChild;A;A=A.nextSibling){if(A.nodeName=="LI"){H[H.length]=A}}for(var P=0;P<H.length;P++){var T=contenteditable_focused_contentwindow().document.createElement("br");if(H[P].nextSibling){H[P].parentNode.insertBefore(T,H[P].nextSibling)}else{H[P].parentNode.appendChild(T)}contenteditable_remove_parentnode(H[P])}contenteditable_remove_parentnode(N);return }else{J=contenteditable_selection_text()||"";var N=contenteditable_focused_contentwindow().document.createElement("ul");var B=contenteditable_focused_contentwindow().document.createElement("li");N.appendChild(B);if(J.match(/<div[^>]*>/gi)||J.match(/<br[^>]*>/gi)){J=J.replace(/<br[^>]*>/gi,"</li><li>");J=J.replace(/<font[^>]*><\/font>/gi,"");J=J.replace(/<font[^>]*>/gi,"");J=J.replace(/<\/font>/gi,"");J=J.replace(/<div[^>]*>/gi,"</li><li>");J=J.replace(/<\/div>/gi,"");if(!J.match(/^<li>/gi)){J="<li>"+J}if(!J.match(/<\/li>$/gi)){J=J+"</li>"}J=J.replace(/<\/li><\/li>/gi,"");J=J.replace(/<li><li>/gi,"");J=J.replace(/<li><\/li>/gi,"");N.innerHTML=J}else{B.innerHTML=J}N=contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),N);if(N&&N.firstChild){var U=contenteditable_selection();U.setBaseAndExtent(N.firstChild,0,N.firstChild,0)}return }}case"indent":if(webeditor.fixExeccommandIndent_DOM){var G=contenteditable_selection_container("li");if(G){var C=contenteditable_selection_container("menu");var I=contenteditable_selection_container("ol");var K=contenteditable_selection_container("ul");if(C){var N=contenteditable_focused_contentwindow().document.createElement("menu");G.parentNode.insertBefore(N,G);N.appendChild(G)}else{if(I){var N=contenteditable_focused_contentwindow().document.createElement("ol");G.parentNode.insertBefore(N,G);N.appendChild(G)}else{var N=contenteditable_focused_contentwindow().document.createElement("ul");G.parentNode.insertBefore(N,G);N.appendChild(G)}}}else{J=contenteditable_selection_text();if(!J){var L=contenteditable_selection_range();contenteditable_selection_node(L.startContainer);J=contenteditable_selection_text()}if(J){var N=contenteditable_focused_contentwindow().document.createElement("blockquote");contenteditable_insertNodeAroundSelection(contenteditable_focused_contentwindow(),N)}}return }case"outdent":if(webeditor.fixExeccommandOutdent_DOM){var D=contenteditable_selection_container("blockquote");var C=contenteditable_selection_container("menu");var I=contenteditable_selection_container("ol");var K=contenteditable_selection_container("ul");if(D){contenteditable_remove_parentnode(D)}else{if(C){contenteditable_remove_parentnode(C)}else{if(I){contenteditable_remove_parentnode(I)}else{if(K){contenteditable_remove_parentnode(K)}}}}return }case"unlink":if(webeditor.fixExeccommandUnlink_DOM){var S=contenteditable_selection_container("a");if(S){contenteditable_remove_parentnode(S)}else{var U=contenteditable_selection();if(U.baseNode!=U.extentNode){var R=new Array();var E=contenteditable_selection_range_parentNode();for(var N=U.baseNode;N&&(N!=E)&&(N!=U.extentNode);N=contenteditable_nextnode(E,N)){if(N.tagName=="A"){R[R.length]=N}}for(var P=0;P<R.length;P++){contenteditable_remove_parentnode(R[P])}}}return }case"find":if(webeditor.fixExeccommandFind_Alert){return false}case"cut":if(webeditor.fixExeccommandCut_Alert){return false}case"copy":if(webeditor.fixExeccommandCopy_Alert){return false}case"paste":if(webeditor.fixExeccommandPaste_Alert){return false}case"selectall":var U=contenteditable_selection();U.setBaseAndExtent(contenteditable_focused_document().body,0,contenteditable_focused_document().body,1);return ;case"delete":if((webeditor.contentSelectionBaseNode[contenteditable_focused]==contenteditable_focused_document().body.firstChild)&&(webeditor.contentSelectionBaseOffset[contenteditable_focused]==0)&&(webeditor.contentSelectionExtentNode[contenteditable_focused]==contenteditable_focused_document().body.lastChild)&&((webeditor.contentSelectionExtentOffset[contenteditable_focused]==contenteditable_focused_document().body.lastChild.childNodes.length)||((webeditor.contentSelectionExtentOffset[contenteditable_focused]==1)&&(contenteditable_focused_document().body.lastChild.childNodes.length==0)))){contenteditable_focused_document().body.innerHTML="";var U=contenteditable_selection();U.setBaseAndExtent(contenteditable_focused_document().body,0,contenteditable_focused_document().body,0);return }default:try{if(webeditor.useCSS){contenteditable_useCSS()}contenteditable_focused_document().execCommand(F,false,contenteditable_execcommand_value(F,M));if((F=="cut")&&(contenteditable_selection_text()!="")){return false}if(F=="removeformat"){if(webeditor.fixExeccommandRemoveformat_Fix){contenteditable_execcommand_fix(F,M)}}}catch(Q){return false}return true}contenteditable_event_paste_do_pre();contenteditable_pasteContent(O);contenteditable_event_paste_do_post();contenteditable_event_paste_fix();if(webeditor.fixExeccommand_Paste_Fix){contenteditable_execcommand_fix(F,M)}return true}function contenteditable_execcommand_value(B,A){if((B=="fontsize")&&(browserIs("Safari/31")||browserIs("Safari/41"))){switch(A){case"1":return"xx-small";case"2":return"x-small";case"3":return"small";case"4":return"medium";case"5":return"large";case"6":return"x-large";case"7":return"xx-large";default:return A}}else{if((B=="forecolor")&&((A=="")||(A=="inherit"))){return"inherit"}else{if((B=="backcolor")&&((A=="")||(A=="inherit"))){return"inherit"}else{return A}}}}function contenteditable_querycommand_value(B,A){if((B=="fontsize")&&(browserIs("Safari/31")||browserIs("Safari/41")||browserIs("Safari/5"))){switch(A){case"10px":return"1";case"13px":return"2";case"16px":return"3";case"18px":return"4";case"24px":return"5";case"32px":return"6";case"48px":return"7";default:return A}}else{if((B=="fontname")&&(browserIs("Safari"))){return A.replace(/'/g,"")}else{return A}}}function contenteditable_find(B){if(contenteditable_execcommand(B)){return true}else{try{webeditor.find_window=window.open(webeditor.rootpath+"find.html?editor=webeditor&find=","find_window",",width=400,height=150,scrollbars=yes,resizable=yes,status=yes",true);return true}catch(A){return false}}}function contenteditable_print(B){if(contenteditable_execcommand(B)){return true}else{try{contenteditable_focused_contentwindow().print();return true}catch(A){return false}}}function contenteditable_specialcharacter(E){var B=contenteditable_focused_contentwindow();if(E){var A=B.document.createTextNode(E);var D=contenteditable_selection();var C=contenteditable_selection_range(D);contenteditable_insertNodeAtSelection(B,A);contenteditable_selection().setBaseAndExtent(D.baseNode,D.baseOffset,D.extentNode,D.extentOffset);webeditor.contentSelectionBaseNode[contenteditable_focused]=D.baseNode;webeditor.contentSelectionBaseOffset[contenteditable_focused]=D.baseOffset;webeditor.contentSelectionExtentNode[contenteditable_focused]=D.extentNode;webeditor.contentSelectionExtentOffset[contenteditable_focused]=D.extentOffset}}function contenteditable_position(C){var B=contenteditable_positionable();if(C){}else{if(B){if(B.style.position=="absolute"){B.style.position="";B.style.top="";B.style.left="";B.style.zIndex=""}else{var E=contenteditable_position_offsetTop(B);var D=contenteditable_position_offsetLeft(B);if(!webeditor.fixExeccommand2DPosition){var A=prompt("The current version of the Safari web browser does not support Drag & Drop of absolute positioned content elements.\r\n\r\nTo position the content item, please enter the top/left coordinate for the content item:",E+","+D);var F=A.split(",");if(F.length==2){E=F[0];D=F[1]}}B.style.position="absolute";if(E){B.style.top=E+"px"}if(D){B.style.left=D+"px"}B.style.zIndex=1}if(B.getAttribute("STYLE")==""){B.removeAttribute("STYLE",0)}}}}function contenteditable_forwards(){var A=contenteditable_positionable();if(A){if(A.style&&A.style.zIndex&&(A.style.zIndex<1000000)){A.style.zIndex=parseInt(A.style.zIndex)+1}else{A.style.zIndex=1}}}function contenteditable_backwards(){var A=contenteditable_positionable();if(A){if(A.style&&A.style.zIndex&&(A.style.zIndex>-1000000)){A.style.zIndex=parseInt(A.style.zIndex)-1}else{A.style.zIndex=-1}}}function contenteditable_front(){var A=contenteditable_positionable();if(A){zIndex=contenteditable_positionable_front_max();if(zIndex<1000000){zIndex++}else{zIndex=1000000}A.style.zIndex=zIndex}}function contenteditable_back(){var A=contenteditable_positionable();if(A){zIndex=contenteditable_positionable_back_min();if(zIndex>-1000000){zIndex--}else{zIndex=-1000000}A.style.zIndex=zIndex}}function contenteditable_abovetext(){var A=contenteditable_positionable();if(A&&A.style){if(A.style.zIndex<0){A.style.zIndex=-A.style.zIndex}else{if(A.style.zIndex==0){A.style.zIndex=1}}}}function contenteditable_belowtext(){var A=contenteditable_positionable();if(A&&A.style){if(A.style.zIndex>0){A.style.zIndex=-A.style.zIndex}else{if(A.style.zIndex==0){A.style.zIndex=-1}}}}function contenteditable_viewsource_onfocus(A){A.removeEventListener("focus",contenteditable_onfocus[contenteditable_focused],true);A.addEventListener("focus",contenteditable_onfocus[contenteditable_focused],true);A.removeEventListener("blur",contenteditable_onblur[contenteditable_focused],true);A.addEventListener("blur",contenteditable_onblur[contenteditable_focused],true)}function contenteditable_viewsource_textarea2html(A,D){var E=A.value;E=contenteditable_split_content(D.id,E);try{if(webeditor_custom_encode){E=webeditor_custom_encode(E)}}catch(F){}try{if(webeditor_custom_initialize){E=webeditor_custom_initialize(E)}}catch(F){}E=contenteditable_encodeScriptTags(E);E=webeditor_empty_content_fix(E);D.contentWindow.document.body.innerHTML=E;contenteditable_setBody(D.contentWindow.document.body,D.id);D.contentWindow.document.removeEventListener("focus",contenteditable_onfocus[contenteditable_focused],true);D.contentWindow.document.addEventListener("focus",contenteditable_onfocus[contenteditable_focused],true);D.contentWindow.document.removeEventListener("blur",contenteditable_onblur[contenteditable_focused],true);D.contentWindow.document.addEventListener("blur",contenteditable_onblur[contenteditable_focused],true);if(webeditor.fixLinkOnUnload){D.contentWindow.removeEventListener("unload",contenteditable_onunload_handler,true);D.contentWindow.addEventListener("unload",contenteditable_onunload_handler,true);D.contentWindow.document.body.removeEventListener("unload",contenteditable_onunload_handler,true);D.contentWindow.document.body.addEventListener("unload",contenteditable_onunload_handler,true)}if(webeditor.fixLinkOnClick){D.contentWindow.document.removeEventListener("click",contenteditable_onclick_handler,true);D.contentWindow.document.addEventListener("click",contenteditable_onclick_handler,true)}D.contentWindow.document.removeEventListener("keydown",contenteditable_event,true);D.contentWindow.document.addEventListener("keydown",contenteditable_event,true);D.contentWindow.document.removeEventListener("keyup",contenteditable_event,true);D.contentWindow.document.addEventListener("keyup",contenteditable_event,true);D.contentWindow.document.removeEventListener("keypress",contenteditable_event,true);D.contentWindow.document.addEventListener("keypress",contenteditable_event,true);D.contentWindow.document.removeEventListener("mousedown",contenteditable_event,true);D.contentWindow.document.addEventListener("mousedown",contenteditable_event,true);D.contentWindow.document.removeEventListener("mouseup",contenteditable_event,true);D.contentWindow.document.addEventListener("mouseup",contenteditable_event,true);if(webeditor.fixExeccommand2DPosition){D.contentWindow.document.removeEventListener("mousemove",contenteditable_event_drag_move,true);D.contentWindow.document.addEventListener("mousemove",contenteditable_event_drag_move,true);D.contentWindow.document.removeEventListener("drag",contenteditable_event_false,true);D.contentWindow.document.addEventListener("drag",contenteditable_event_false,true);D.contentWindow.document.removeEventListener("dragstart",contenteditable_event_false,true);D.contentWindow.document.addEventListener("dragstart",contenteditable_event_false,true);D.contentWindow.document.removeEventListener("dragend",contenteditable_event_false,true);D.contentWindow.document.addEventListener("dragend",contenteditable_event_false,true);D.contentWindow.document.removeEventListener("drop",contenteditable_event_false,true);D.contentWindow.document.addEventListener("drop",contenteditable_event_false,true)}else{D.contentWindow.document.removeEventListener("drag",contenteditable_event,true);D.contentWindow.document.addEventListener("drag",contenteditable_event,true)}if(webeditor.contextmenus){D.contentWindow.document.removeEventListener("contextmenu",contenteditable_contextmenu,true);D.contentWindow.document.addEventListener("contextmenu",contenteditable_contextmenu,true)}if(webeditor.fixLinkOnClick_False_A_ONCLICK){var B=D.contentWindow.document.getElementsByTagName("a");for(var C=0;C<B.length;C++){B[C].setAttribute("onClick","return parent.contenteditable_false();"+(B[C].getAttribute("onClick")||""))}}if(webeditor.fixLinkOnClick_False_AREA_HREF){var B=D.contentWindow.document.getElementsByTagName("area");for(var C=0;C<B.length;C++){B[C].setAttribute("href","javascript:return parent.contenteditable_false();"+(B[C].getAttribute("href")||""))}}}function contenteditable_viewsource_show(){}function contenteditable_viewsource_hide(){}function contenteditable_iframe_hide(A){A.style.overflow="hidden";A.style.top="0px";A.style.left="0px";A.style.zIndex=-1;A.style.position="absolute";A.style.opacity="0"}function contenteditable_iframe_show(A){A.style.display="block";A.style.position="static";A.style.opacity="1"}function contenteditable_dropdown_hide(A){A.style.top="-1000px";A.style.left="-1000px";A.style.zIndex=-1;A.style.opacity="0"}function contenteditable_dropdown_show(A){A.style.overflow="hidden";A.style.opacity="1"}function contenteditable_dropdown_hidden(A){if(A.style.opacity=="0"){return true}else{return false}}function contenteditable_setAttribute(B,A,C){if(webeditor.fixLinkOnClick_False_A_ONCLICK&&(B.tagName.toUpperCase()=="A")&&(A=="onclick")){B.setAttribute("onClick","return parent.contenteditable_false();"+(C||""))}else{if(webeditor.fixLinkOnClick_False_AREA_HREF&&(B.tagName.toUpperCase()=="AREA")&&(A=="href")){B.setAttribute("href","javascript:return parent.contenteditable_false();"+(C||""))}else{B.setAttribute(A,C)}}}function contenteditable_removeAttribute(B,A){B.removeAttribute(A)}function contenteditable_getAttribute(F,E){var H="";if(typeof (F)=="string"){var B=F;RegExp.global=true;RegExp.multiline=true;var D=new RegExp("^[^>]*[ \t\r\n]"+E+'="([^"]*)"',"gi");var A=new RegExp("^[^>]*[ \t\r\n]"+E+"=([^ >]*)","gi");var C=new RegExp("^[^>]*[ \t\r\n]("+E+")[ \t\r\n>]","gi");var G;if(G=D.exec(B)){H=G[1]||""}else{if(G=A.exec(B)){H=G[1]||""}else{if(G=C.exec(B)){H=G[1]||""}}}}else{if(F){H=F.getAttribute(E)||"";if(webeditor.fixLinkOnClick_False_A_ONCLICK&&(F.tagName.toUpperCase()=="A")&&(E=="onclick")){H=H.replace(/return parent\.contenteditable_false\(\);/g,"")}else{if(webeditor.fixLinkOnClick_False_AREA_HREF&&(F.tagName.toUpperCase()=="AREA")&&(E=="href")){H=H.replace(/javascript:return parent\.contenteditable_false\(\);/g,"")}}}else{H=""}}return H}function contenteditable_cellRowSpan(A){return A.rowSpan||1}function contenteditable_cellColSpan(A){return A.colSpan||1}function contenteditable_cellIndex(B){var A=0;for(var C=0;C<B.parentNode.childNodes.length;C++){if(B.nodeName!=B.parentNode.childNodes[C].nodeName){A++}else{if(B==B.parentNode.childNodes[C]){return C-A}}}return B.cellIndex}function contenteditable_insertimage_fix(A,D,E,B,J,C,K,G,H,M,L,I,F){if(webeditor.fixInsertimage_DOM){contenteditable_DOM_fix()}}function contenteditable_insertmap_fix(B){if(B&&webeditor.fixLinkOnClick_False_AREA_HREF){for(var A=0;A<B.childNodes.length;A++){if(B.childNodes[A].tagName.toUpperCase()=="AREA"){contenteditable_setAttribute(B.childNodes[A],"href",contenteditable_getAttribute(B.childNodes[A],"href"))}}}}function contenteditable_insertlink_fix(C,A,E,G,D,H,B,F){if(C&&webeditor.fixLinkOnClick_False_A_ONCLICK){contenteditable_setAttribute(C,"onclick","return parent.contenteditable_false();"+(B||""))}if(webeditor.fixInsertlink_DOM){contenteditable_DOM_fix()}}function contenteditable_insertiframe_fix(B,A,F,D,G,C,E){}function contenteditable_execcommand_fix(B,A){if(webeditor.fixExeccommand_DOM){contenteditable_DOM_fix()}}function contenteditable_formatclass_fix(){if(webeditor.fixFormatclass_Paste_DOM){contenteditable_DOM_fix()}if(webeditor.fixFormatclass_ViewSource){var B=contenteditable_focused_iframe();var C=contenteditable_focused_form();var A=contenteditable_focused_textarea();contenteditable_viewsource(true);if(webeditor.refreshToolbarTimeout){clearTimeout(webeditor.refreshToolbarTimeout)}webeditor.refreshToolbarTimeout=setTimeout(webeditor_refreshToolbar,100);A.focus()}}function contenteditable_nobr_fix(){if(webeditor.fixNobr_DOM){contenteditable_DOM_fix()}}function contenteditable_box_fix(){if(webeditor.fixBox_DOM){contenteditable_DOM_fix()}}function contenteditable_mailto_fix(){if(webeditor.fixMailto_DOM){contenteditable_DOM_fix()}}function contenteditable_anchor_fix(){if(webeditor.fixAnchor_DOM){contenteditable_DOM_fix()}}function contenteditable_DOM_fix(){if(webeditor.fixDOM_ResetInnerHTML){contenteditable_focused_contentwindow().document.body.innerHTML=contenteditable_focused_contentwindow().document.body.innerHTML}}function contenteditable_cleanContent_fix(){var C=contenteditable_selection();var A=contenteditable_selection_range(C);if((A.startContainer==A.endContainer)&&(C.baseNode!=C.extentNode)){if((C.baseNode==contenteditable_focused_document().body.firstChild)&&(C.extentNode==contenteditable_focused_document().body.lastChild)){C.setBaseAndExtent(contenteditable_focused_document().body.firstChild,0,contenteditable_focused_document().body.firstChild,0)}}if((webeditor.contentSelectionBaseNode[contenteditable_focused]==contenteditable_focused_document().body.firstChild)&&(webeditor.contentSelectionBaseOffset[contenteditable_focused]==0)&&(webeditor.contentSelectionExtentNode[contenteditable_focused]==contenteditable_focused_document().body.lastChild)&&((webeditor.contentSelectionExtentOffset[contenteditable_focused]==contenteditable_focused_document().body.lastChild.childNodes.length)||((webeditor.contentSelectionExtentOffset[contenteditable_focused]==1)&&(contenteditable_focused_document().body.lastChild.childNodes.length==0)))){contenteditable_selection_unselect()}if(table=contenteditable_isTable()){var B=contenteditable_selection_range_parentNode();while(B&&(B.tagName!="TABLE")&&(B.tagName!="TR")&&(B.tagName!="TD")){B=B.parentNode}C.setBaseAndExtent(B,0,B,B.childNodes.length)}}function contenteditable_formatContent_fix(A){if(!A){return A}A=contenteditable_event_paste_fix_sub("A","href",A);A=contenteditable_event_paste_fix_sub("IMG","src",A);if(A=="<p>"){A="<p>&nbsp;</p>"}if(webeditor.fixLinkOnClick_False_AREA_HREF){A=A.replace(/javascript:return parent\.contenteditable_false\(\);/g,"");A=A.replace(/ onclick=""/g,"")}if(webeditor.fixLinkOnClick_False_A_ONCLICK){A=A.replace(/ onclick="return parent\.contenteditable_false\(\);"/g,"");A=A.replace(/return parent\.contenteditable_false\(\);/g,"");A=A.replace(/ onclick=""/g,"")}if(webeditor.fixImageStyleBorderDefaults){var B="";while(B!=A){B=A;A=A.replace(/(<img[^>]*[ \t\r\n]+style="[^"]*)[; \t\r\n]*(margin-top: 0px;|margin-right: 0px;|margin-bottom: 0px;|margin-left: 0px;|padding-top: 0px;|padding-right: 0px;|padding-bottom: 0px;|padding-left: 0px;|border-top-width: 0px;|border-right-width: 0px;|border-bottom-width: 0px;|border-left-width: 0px;|border-style: initial;|border-color: initial;|outline-width: 0px;|outline-style: initial;|outline-color: initial;|vertical-align: baseline;)([^"]*"[^>]*>)/gi,"$1$3");A=A.replace(/(<img[^>]*[ \t\r\n]+style=") +([^"]*"[^>]*>)/gi,"$1$2");A=A.replace(/(<img[^>]*[ \t\r\n]+style="[^"]*) +("[^>]*>)/gi,"$1$2");A=A.replace(/(<img[^>]*)[ \t\r\n]+style=" *"([^>]*>)/gi,"$1$2")}}return A}function contenteditable_node_attributes_fix(A,B){if((webeditor.fixLinkOnClick_False_A_ONCLICK)||(webeditor.fixLinkOnClick_False_AREA_HREF)){A=A.replace(/ onclick=""/g,"")}if(webeditor.fixImageStyleBorderDefaults&&B&&(B.tagName=="IMG")){var C="";while(C!=A){C=A;A=A.replace(/([^>]*[ \t\r\n]+style="[^"]*)[; \t\r\n]*(margin-top: 0px;|margin-right: 0px;|margin-bottom: 0px;|margin-left: 0px;|padding-top: 0px;|padding-right: 0px;|padding-bottom: 0px;|padding-left: 0px;|border-top-width: 0px;|border-right-width: 0px;|border-bottom-width: 0px;|border-left-width: 0px;|border-style: initial;|border-color: initial;|outline-width: 0px;|outline-style: initial;|outline-color: initial;|vertical-align: baseline;)([^"]*"[^>]*)/gi,"$1$3");A=A.replace(/([^>]*[ \t\r\n]+style=") +([^"]*"[^>]*)/gi,"$1$2");A=A.replace(/([^>]*[ \t\r\n]+style="[^"]*) +("[^>]*)/gi,"$1$2");A=A.replace(/([^>]*)[ \t\r\n]+style=" *"([^>]*)/gi,"$1$2")}}return A}var contenteditable_preview_window;var contenteditable_preview_head;var contenteditable_preview_body;var contenteditable_preview_content;var contenteditable_preview_direction;function contenteditable_preview_fix(D,B,C,A){contenteditable_preview_window=D;contenteditable_preview_head=B;contenteditable_preview_body=C;contenteditable_preview_content=A;contenteditable_preview_direction=webeditor.direction;D.document.location.href=webeditor.rootpath+"preview.html"}function contenteditable_pasteContent_node(){return contenteditable_focused_contentwindow().document.createElement("div")}function contenteditable_paste_fix_prepare(){}function contenteditable_paste_fix(){}function contenteditable_dragdrop_fix(A){if(A&&(A.nodeName=="IMG")){contenteditable_event_paste_fix_sub("IMG","src",A)}if(A&&(A.nodeName=="A")){contenteditable_event_paste_fix_sub("A","href",A)}}function contenteditable_formatContentNodeHTML_fix(A){return""}function contenteditable_formatContentNodeXHTML_fix(A){return""}function getRangeHTML(B,C){var A=contenteditable_selection_commonAncestorContainer(C);var E="";var D;if(A&&(A.nodeName=="BODY")&&(!A.firstChild)){}else{if((C=="")&&B&&B.startContainer&&(B.startContainer==B.endContainer)&&(B.startOffset==B.endOffset)){}else{if((C!="")&&B&&B.startContainer&&(B.startContainer==B.endContainer)&&(B.startOffset==B.endOffset)){D=C.extentNode;var F=contenteditable_selection_container();while(D){E+=getNodeHTML(D,false,C);if(D==C.baseNode){break}nextnode=contenteditable_nextnode(false,D,true);while(D=contenteditable_nextnode(false,D)){if(D==C.baseNode){E+=getNodeHTML(nextnode,false,C);D=false}else{if(D==nextnode){break}}}}if(!E){E=""+C}}else{if(B&&B.startContainer&&(B.startContainer==B.endContainer)&&(B.startOffset==B.endOffset-1)){E+=""+getNodeHTML(B.startContainer.childNodes[B.startOffset],B,C)}else{if(A&&(D=A.firstChild)){while(D){E+=""+getNodeHTML(D,B,C);D=D.nextSibling}}else{E+=""+getNodeHTML((C.baseNode||webeditor.contentSelectionBaseNode[contenteditable_focused]),B,C)}}}}}return E}function getNodeHTML(I,F,R){if(F&&(!nodeInRange(I,F))){return""}if((!I)||(!I.nodeType)){return""}var D;var E;var Q;var B;var J=0;var O=1;var P=2;var G=3;var C=contenteditable_createrange();C.selectNode(R.baseNode);var A=contenteditable_createrange();A.selectNode(R.extentNode);if(C.compareBoundaryPoints(J,A)==1){D=R.extentNode;Q=R.baseNode;E=R.extentOffset;B=R.baseOffset}else{D=R.baseNode;Q=R.extentNode;E=R.baseOffset;B=R.extentOffset}switch(I.nodeType){case 1:var H="";var E;var B;if((D==Q)&&(E>B)){E=B;B=E}else{E=E;B=B}if((I!=D)||(E==0)){H+="<"+I.nodeName;for(var K=0;K<I.attributes.length;K++){if(I.attributes.item(K)&&I.attributes.item(K).specified){H+=" "+I.attributes.item(K).name+'="'+I.attributes.item(K).value+'"'}}H+=">"}if(I.hasChildNodes()||(I.tagName=="TEXTAREA")){var N=I.firstChild;while(N){H+=getNodeHTML(N,F,R);N=N.nextSibling}if((I!=D)||(E==0)){H+="</"+I.nodeName+">"}}return H;case 2:var H="";if(I.specified&&(I.nodeName=="class")&&((I.nodeValue=="Apple-style-span")||(I.nodeValue=="khtml-block-placeholder")||(I.nodeValue=="webkit-block-placeholder"))){}else{if(I.specified){H+=I.nodeName+'="'+I.nodeValue+'"'}}return H;case 3:var H=I.data;if(F){var E;var B;if((D==Q)&&(E>B)){var M=E;E=B;B=M}if(I==Q){H=H.substring(0,B)}if(I==D){H=H.substring(E,H.length+1)}if((R!="")&&(I==D)&&(I==Q)&&(E==B)){H=""+R}}return H;case 4:var H=I.data;if(F){if(I==Q){H=H.substring(0,B)}if(I==D){H=H.substring(E,H.length+1)}}return"<![CDATA["+H+"]]>";case 5:return"&"+I.nodeName+";";case 6:var H="<!ENTITY "+I.nodeName;if(I.publicId){H+=' PUBLIC "'+I.publicId+'"';if(I.systemId){H+=' "'+I.systemId+'"'}if(I.notationName){H+=" NDATA "+I.notationName}}else{if(I.systemId){H+=' SYSTEM "'+I.systemId+'"';if(I.notationName){H+=" NDATA "+I.notationName}}else{H+='"';var N=I.firstChild;while(N){H+=getNodeHTML(N,F,R);N=N.nextSibling}H+='"'}}return H+">";case 7:var H="<?"+I.target+" "+I.data+"?>";return H;case 8:var H=I.data;if(F){if(I==Q){H=H.substring(0,B)}if(I==D){H=H.substring(E,H.length+1)}}H="<!--"+H+"-->";return H;case 9:var H="";var L=false;var N=I.firstChild;while(N){if(N.nodeType!=10){L=true}H+=getNodeHTML(N,F,R);N=N.nextSibling}if(!L&&I.doctype){H=getNodeHTML(I.doctype,F,R)+H}return H;case 10:var H="<!DOCTYPE "+I.nodeName;if(I.publicId){H+=' PUBLIC "'+I.publicId+'"';if(I.systemId){H+=' "'+I.systemId+'"'}}else{if(I.systemId){H+=' SYSTEM "'+I.systemId+'"'}}if(I.internalSubset){H+=" "+I.internalSubset}H+=">\n";return H;case 11:var H="";var N=I.firstChild;while(N){H+=getNodeHTML(N,F,R);N=N.nextSibling}return H;case 12:var H="<!NOTATION "+I.nodeName;if(I.publicId){H+=' PUBLIC "'+I.publicId+'"';if(I.systemId){H+=' "'+I.systemId+'"'}}else{if(I.systemId){H+=' SYSTEM "'+I.systemId+'"'}}H+=">";return H}}function nodeInRange(E,B){var A=0;var C=1;var H=2;var D=3;try{var G=contenteditable_createrange();G.selectNode(E);if((webeditor.type=="safari")&&(webeditor.majorVersion<5)){if((B.compareBoundaryPoints(D,G)==1)&&(B.compareBoundaryPoints(C,G)==-1)){return true}}else{if((B.compareBoundaryPoints(D,G)==-1)&&(B.compareBoundaryPoints(C,G)==1)){return true}}}catch(F){}return false}function contenteditable_selection_commonAncestorContainer(E){var B=contenteditable_selection_range(E);var D=new Array();var A;var G;if(E){A=E.baseNode||webeditor.contentSelectionBaseNode[contenteditable_focused];G=E.extentNode||webeditor.contentSelectionExtentNode[contenteditable_focused]}else{A=webeditor.contentSelectionBaseNode[contenteditable_focused];G=webeditor.contentSelectionExtentNode[contenteditable_focused]}if(A){for(var F=A;F&&(F.nodeName!="BODY");F=F.parentNode){D[D.length]=F.parentNode}}var H=false;if(G){for(var F=G;F&&(F.nodeName!="BODY");F=F.parentNode){for(var C=0;C<D.length;C++){if(F.parentNode==D[C]){H=F.parentNode;break}}if(H){break}}}return H}function contenteditable_contextmenu(A){var B=contenteditable_focused_iframe();webeditor_menu("context",false,getAbsoluteOffsetLeft(B)+A.clientX-B.contentDocument.body.scrollLeft,getAbsoluteOffsetTop(B)+A.clientY-B.contentDocument.body.scrollTop);contenteditable_event_stop(A);return false}webeditor.content2textareaOnBlur=true;function webeditor_iframe_fix(B){if(B.contentWindow.document.designMode=="off"){var C=B;while((C.tagName!="FORM")&&(C.tagName!="HTML")){C=C.parentNode}var A;if(C.tagName!="HTML"){A=C[B.id]}else{A=document.getElementById(B.id+"_textarea")}contenteditable_contents[B.id]=A.value;contenteditable_contents[B.id]=webeditor.textarea_content[B.id];contenteditable_inited[B.id]=false;contenteditable_init()}}function contenteditable_webeditor_clipboard_cut(){}function contenteditable_webeditor_clipboard_copy(){}function contenteditable_webeditor_clipboard(){return true}function contenteditable_webeditor_clipboard_paste(){if(webeditor.clipboardHTML!=""){return true}else{return false}};