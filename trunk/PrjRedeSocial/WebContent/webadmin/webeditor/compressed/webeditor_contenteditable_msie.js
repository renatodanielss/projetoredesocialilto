if(webeditor.majorVersion>=9){}if(webeditor.majorVersion>=8){webeditor.setcontentbodydocumentwrite=false;webeditor.setcontentbodyinnerhtml=true}if(webeditor.majorVersion==8){webeditor.setcontentbodydocumentwrite=false;webeditor.setcontentbodyinnerhtml=false}if(webeditor.majorVersion==7){webeditor.useCssStyleGetAttribute=false}if((webeditor.majorVersion==6)||(webeditor.majorVersion==7)){webeditor.getAttribute_attributes=false;webeditor.getAttribute_outerHTML=true}try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}function webeditor_empty_content_fix(A){return A}function webeditor_supported(A){return true}function webeditor_select_init(A){A.ondeactivate=webeditor_select_deactivate;A.onblur=webeditor_select_blur}function webeditor_select_focus(A){if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}return true}function contenteditable_onload(A){window.attachEvent("onload",A);WebEditorSkin()}function contenteditable_onload_remove(A){window.detachEvent("onload",A)}function contenteditable_attach_event_handler(C,B,A){C["on"+B]=A;C.attachEvent("on"+B,A)}function contenteditable_detach_event_handler(C,B,A){C.detachEvent("on"+B,A)}function contenteditable_reinit(){for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);try{if(B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document&&B.contentWindow.document.body){if(((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled"))){try{B.contentWindow.detachEvent("onfocus",contenteditable_onfocus[A])}catch(C){}try{B.contentWindow.detachEvent("onblur",contenteditable_onblur[A])}catch(C){}try{B.contentWindow.document.body.detachEvent("onfocus",contenteditable_onfocus[A])}catch(C){}try{B.contentWindow.document.body.detachEvent("onblur",contenteditable_onblur[A])}catch(C){}}}}catch(C){}}contenteditable_inited=new Array();contenteditable_onfocus=new Array();contenteditable_onblur=new Array();for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);try{if(B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document&&B.contentWindow.document.body){if(((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled"))&&(!contenteditable_inited[B.id])){try{if(!contenteditable_onfocus[A]){contenteditable_onfocus[A]=new Function("event","contenteditable_focused="+A+";webeditor_onfocus();webeditor_refreshToolbar(true);;")}if(!contenteditable_onblur[A]){contenteditable_onblur[A]=new Function("event","webeditor_onblur();")}B.contentWindow.attachEvent("onfocus",contenteditable_onfocus[A]);B.contentWindow.attachEvent("onblur",contenteditable_onblur[A]);B.contentWindow.document.body.attachEvent("onfocus",contenteditable_onfocus[A]);B.contentWindow.document.body.attachEvent("onblur",contenteditable_onblur[A])}catch(C){}contenteditable_inited[B.id]=true}}}catch(C){}}}function contenteditable_init(){webeditor.refreshToolbar=false;if(!webeditor.scrolledContentToTop){webeditor.scrolledContentToTop=new Object()}if(webeditor.first!=false){webeditor.first=true}var F=webeditor.first;for(var B=0;B<document.getElementsByTagName("iframe").length;B++){var C=document.getElementsByTagName("iframe").item(B);try{if(C&&C.contentWindow&&C.contentWindow.document&&C.contentWindow.document&&C.contentWindow.document.body){if(((C.className=="webeditor_contenteditable")||(C.className=="webeditor_contenteditable_disabled"))&&(!contenteditable_inited[C.id])){try{if(contenteditable_stylesheet[C.id]&&C&&C.contentWindow&&C.contentWindow.document&&C.contentWindow.document.getElementById("stylesheet")&&(!contenteditable_inited_stylesheet[C.id])){C.contentWindow.document.getElementById("stylesheet").href=contenteditable_stylesheet[C.id];contenteditable_inited_stylesheet[C.id]=true}}catch(E){alert(Text("webbrowser_unsupported_contenteditable")+"\r\n\r\n"+E+"\r\n\r\n"+E.message)}}}else{setTimeout(contenteditable_init,webeditor.initTimeout);webeditor.initTimeout=webeditor.initTimeout*webeditor.initTimeoutMultiplier;return }}catch(E){}}for(var B=0;B<document.getElementsByTagName("iframe").length;B++){var C=document.getElementsByTagName("iframe").item(B);try{if(C&&C.contentWindow&&C.contentWindow.document&&C.contentWindow.document&&C.contentWindow.document.body){if(((C.className=="webeditor_contenteditable")||(C.className=="webeditor_contenteditable_disabled"))&&(!contenteditable_inited[C.id])){try{if(webeditor.direction){C.contentWindow.document.dir=webeditor.direction}C.contentWindow.document.body.contentEditable=true;C.contentWindow.document.execCommand("redo",false,null);C.contentWindow.document.body.innerHTML="&nbsp;";if(!contenteditable_onfocus[B]){contenteditable_onfocus[B]=new Function("event","contenteditable_focused="+B+";webeditor_onfocus();webeditor_refreshToolbar(true);")}if(!contenteditable_onblur[B]){contenteditable_onblur[B]=new Function("event","webeditor_onblur();")}C.contentWindow.attachEvent("onfocus",contenteditable_onfocus[B]);C.contentWindow.attachEvent("onblur",contenteditable_onblur[B]);C.contentWindow.document.body.attachEvent("onfocus",contenteditable_onfocus[B]);C.contentWindow.document.body.attachEvent("onblur",contenteditable_onblur[B]);C.contentWindow.document.attachEvent("onkeydown",contenteditable_event);C.contentWindow.document.attachEvent("onkeyup",contenteditable_event);C.contentWindow.document.attachEvent("onkeypress",contenteditable_event);C.contentWindow.document.attachEvent("onmousedown",contenteditable_event);C.contentWindow.document.attachEvent("onmouseup",contenteditable_event);C.contentWindow.document.attachEvent("ondrag",contenteditable_event);C.contentWindow.document.attachEvent("ondragstart",contenteditable_event);C.contentWindow.document.attachEvent("ondragend",contenteditable_event);C.contentWindow.document.attachEvent("ondragenter",contenteditable_event);C.contentWindow.document.attachEvent("ondragover",contenteditable_event);C.contentWindow.document.attachEvent("ondragleave",contenteditable_event);C.contentWindow.document.attachEvent("ondrop",contenteditable_event);if(webeditor.contextmenus){C.contentWindow.document.attachEvent("oncontextmenu",contenteditable_contextmenu)}C.contentWindow.document.close();contenteditable_setContent(contenteditable_contents[C.id],C.id);var D=C;while((D.tagName!="FORM")&&(D.tagName!="HTML")){D=D.parentNode}if(D.tagName!="HTML"){D.attachEvent("onsubmit",contenteditable_onSubmit);D[C.id].value=contenteditable_contents[C.id]}}catch(E){alert(Text("webbrowser_unsupported_contenteditable")+"\r\n\r\n"+E+"\r\n\r\n"+E.message)}if(!contenteditable_inited[C.id]){webeditor.inited+=1}contenteditable_inited[C.id]=true;if(F){F=false;contenteditable_focused=B}try{}catch(E){}}if((C.className=="webeditor_contenteditable")||(C.className=="webeditor_contenteditable_disabled")){if((!webeditor.scrolledContentToTop[B])&&webeditor.scrollContentToTop&&C&&C.contentWindow&&C.contentWindow.document&&C.contentWindow.document.body){webeditor.scrolledContentToTop[B]=true;C.contentWindow.focus();if(C.contentWindow.document.body.firstChild){contenteditable_selection_node(C.contentWindow.document.body.firstChild)}else{contenteditable_selection_node(C.contentWindow.document.body)}var A=contenteditable_selection_range();if(A){A.collapse(true)}if(A){A.select()}}}webeditor.refreshToolbar=true}else{setTimeout(contenteditable_init,webeditor.initTimeout);webeditor.initTimeout=webeditor.initTimeout*webeditor.initTimeoutMultiplier}}catch(E){}scrollAllToTopLeft(C)}if(webeditor.scrollContentToTop&&(webeditor.inited==webeditor.count-1)){var C=document.getElementsByTagName("iframe").item(contenteditable_focused);try{if(C&&C.contentWindow&&C.contentWindow.document&&C.contentWindow.document.body){if(C.contentWindow.document.body.firstChild){contenteditable_selection_node(C.contentWindow.document.body.firstChild)}else{contenteditable_selection_node(C.contentWindow.document.body)}var A=contenteditable_selection_range();if(A){A.collapse(true)}if(A){A.select()}webeditor_onfocus();webeditor.refreshToolbar=true;webeditor_refreshToolbar(true);if(document.location.href.indexOf("#")<0){window.scrollTo(0,0)}}}catch(E){}}}function contenteditable_enable(D){for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);try{if(B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document&&B.contentWindow.document.body){if((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled")){if((B.id==D)||(!D)){try{if(B.className!="webeditor_contenteditable"){B.className="webeditor_contenteditable"}if(B.contentWindow.document.body.contentEditable!=true){B.contentWindow.document.body.contentEditable=true}if(webeditor.direction&&(B.contentWindow.document.dir!=webeditor.direction)){B.contentWindow.document.dir=webeditor.direction}}catch(C){}try{if(!contenteditable_onfocus[A]){contenteditable_onfocus[A]=new Function("event","contenteditable_focused="+A+";webeditor_onfocus();webeditor_refreshToolbar(true);;")}if(!contenteditable_onblur[A]){contenteditable_onblur[A]=new Function("event","webeditor_onblur();")}B.contentWindow.attachEvent("onfocus",contenteditable_onfocus[A]);B.contentWindow.attachEvent("onblur",contenteditable_onblur[A]);B.contentWindow.document.body.attachEvent("onfocus",contenteditable_onfocus[A]);B.contentWindow.document.body.attachEvent("onblur",contenteditable_onblur[A])}catch(C){}contenteditable_inited[B.id]=true}}}}catch(C){}}}function contenteditable_disable(D){for(var A=0;A<document.getElementsByTagName("iframe").length;A++){var B=document.getElementsByTagName("iframe").item(A);try{if(B&&B.contentWindow&&B.contentWindow.document&&B.contentWindow.document&&B.contentWindow.document.body){if((B.className=="webeditor_contenteditable")||(B.className=="webeditor_contenteditable_disabled")){if((B.id==D)||(!D)){try{if(B.className!="webeditor_contenteditable_disabled"){B.className="webeditor_contenteditable_disabled"}if(B.contentWindow.document.body.contentEditable!=false){B.contentWindow.document.body.contentEditable=false}if(webeditor.direction&&(B.contentWindow.document.dir!=webeditor.direction)){B.contentWindow.document.dir=webeditor.direction}}catch(C){}try{B.contentWindow.detachEvent("onfocus",contenteditable_onfocus[A])}catch(C){}try{B.contentWindow.detachEvent("onblur",contenteditable_onblur[A])}catch(C){}try{B.contentWindow.document.body.detachEvent("onfocus",contenteditable_onfocus[A])}catch(C){}try{B.contentWindow.document.body.detachEvent("onblur",contenteditable_onblur[A])}catch(C){}}}}}catch(C){}}}function contenteditable_toolbar(A){if(webeditor.toolbarid&&document.getElementById(webeditor.toolbarid)&&document.getElementById(webeditor.toolbarid).contentWindow&&document.getElementById(webeditor.toolbarid).contentWindow.document){return document.getElementById(webeditor.toolbarid).contentWindow.document}else{if(parent&&parent.document&&parent.document.getElementById(webeditor.toolbarid)&&parent.document.getElementById(webeditor.toolbarid).contentWindow&&parent.document.getElementById(webeditor.toolbarid).contentWindow.document){return parent.document.getElementById(webeditor.toolbarid).contentWindow.document}else{if(webeditor.toolbar&&webeditor.toolbar.contentWindow&&webeditor.toolbar.contentWindow.document&&webeditor.toolbar.contentWindow.document.body){return webeditor.toolbar.contentWindow.document}else{if(A&&contenteditable_focused_iframe()&&contenteditable_focused_iframe().id&&document.getElementById("webeditor_toolbar_"+contenteditable_focused_iframe().id)){return document.getElementById("webeditor_toolbar_"+contenteditable_focused_iframe().id)}else{return document}}}}}function contenteditable_document_stylesheets_cssrules(A){return A.rules}function contenteditable_selection_fix(){}function contenteditable_iframe_scrollTop(A){if(A.pageYOffset){return A.pageYOffset}else{if(A.contentWindow.document.documentElement&&A.contentWindow.document.documentElement.scrollTop){return A.contentWindow.document.documentElement.scrollTop}else{if(A.contentWindow.document.body){return A.contentWindow.document.body.scrollTop}else{return 0}}}}function contenteditable_iframe_scrollLeft(A){if(A.pageXOffset){return A.pageXOffset}else{if(A.contentWindow.document.documentElement&&A.contentWindow.document.documentElement.scrollLeft){return A.contentWindow.document.documentElement.scrollLeft}else{if(A.contentWindow.document.body){return A.contentWindow.document.body.scrollLeft}else{return 0}}}}function contenteditable_iframe_height(A){if(A.scrollHeight){return A.scrollHeight}else{return 0}}function contenteditable_iframe_width(A){if(A.scrollWidth){return A.scrollWidth}else{return 0}}function contenteditable_iframe_content_height(A){if(A.contentWindow.document.body.scrollHeight>A.contentWindow.document.body.offsetHeight){return A.contentWindow.document.body.scrollHeight}else{return A.contentWindow.document.body.offsetHeight}}function contenteditable_iframe_content_width(A){if(A.contentWindow.document.body.scrollWidth>A.contentWindow.document.body.offsetWidth){return A.contentWindow.document.body.scrollWidth}else{return A.contentWindow.document.body.offsetWidth}}var contenteditable_event_dragstart=false;function contenteditable_event(D){if(contenteditable_event_dragstart){contenteditable_event_dragstart=false;contenteditable_paste_fix()}if(D.type=="dragstart"){contenteditable_event_dragstart=true}if(D&&D.srcElement&&(D.srcElement.nodeName=="HTML")&&D.srcElement.document&&D.srcElement.document.body){for(var B=0;B<document.getElementsByTagName("iframe").length;B++){var C=document.getElementsByTagName("iframe").item(B);try{if(((C.className=="webeditor_contenteditable")||(C.className=="webeditor_contenteditable_disabled"))&&(C.contentWindow.document.body==D.srcElement.document.body)){if((contenteditable_iframe_height(C)>contenteditable_iframe_content_height(C))&&(contenteditable_iframe_width(C)>contenteditable_iframe_content_width(C))){contenteditable_focused=B;C.contentWindow.focus();if(C.contentWindow.document.body.lastChild){contenteditable_selection_node(C.contentWindow.document.body.lastChild)}else{contenteditable_selection_node(C.contentWindow.document.body)}var A=contenteditable_selection_range();if(A){A.collapse(false)}if(A){A.select()}}}}catch(E){}}}webeditor_refreshToolbar(webeditor.refreshtoolbarOnAnyEvent);if(contenteditable_focused_contentwindow()){return webeditor_event(contenteditable_focused_contentwindow().event)}}function contenteditable_event_stop(A){A.cancelBubble=true;A.returnValue=false}function contenteditable_event_ctrlkey(A){if(A.type=="keypress"){return A.ctrlKey}else{return A.ctrlKey}}function contenteditable_event_key(A){if((A.type=="keydown")&&((A.keyCode<16)||(A.keyCode>18))){return String.fromCharCode(A.keyCode).toLowerCase()}else{return false}}function contenteditable_event_delete(E){if(E&&E.keyCode&&(E.keyCode==webeditor_keyCode_backspace)){if((E.type=="keydown")||(E.type=="keypress")){var A=contenteditable_selection_container();var D=A.parentNode;if((A.nodeName=="TBODY")||(A.nodeName=="THEAD")||(A.nodeName=="TFOOT")){contenteditable_event_stop(E);contenteditable_undo_save();D.removeChild(A);if((D.nodeName=="TABLE")&&(D.childNodes&&D.childNodes.length==0)){D.parentNode.removeChild(D)}return }else{if(contenteditable_selection_range_control()&&((A.nodeName=="HR")||(A.nodeName=="IFRAME")||(A.nodeName=="DIV")||(A.nodeName=="IMG")||(A.nodeName=="TABLE")||(A.nodeName=="INPUT")||(A.nodeName=="TEXTAREA")||(A.nodeName=="SELECT"))){contenteditable_event_stop(E);contenteditable_undo_save();D.removeChild(A);return }else{if(contenteditable_selection_range_control()){contenteditable_event_stop(E);return }}}}}if(E&&E.keyCode&&((E.keyCode==webeditor_keyCode_backspace)||(E.keyCode==webeditor_keyCode_delete))){if((E.type=="keydown")||(E.type=="keypress")){if(contenteditable_selection_text()){var B=contenteditable_selection_range();var D=contenteditable_selection_range_parentNode(B);var F=contenteditable_selection_range_startNode(B);var C=contenteditable_selection_range_endNode(B);if(F&&(F==C)&&(F.nodeName=="#text")&&(F.parentNode.firstChild==F.parentNode.lastChild)&&(F.parentNode.nodeName!="BODY")&&(contenteditable_selection_text()==F.nodeValue)){F.parentNode.parentNode.removeChild(F.parentNode)}else{if(D&&(!F)&&(!C)){}else{if(contenteditable_selection_text().match(/^\r?\n?<.+>&nbsp;<\/.+>$/)){}else{if(contenteditable_selection_text().match(/^\r?\n?<.+><\/.+>$/)){}else{if(webeditor.pasteToDelete){contenteditable_event_stop(E);contenteditable_execcommand("paste","")}}}}}}}}}function contenteditable_event_enter_p(B){if(B.ctrlKey||B.shiftKey||B.altKey){contenteditable_event_stop(B);contenteditable_pasteContent("<p>")}return ;if(B.type!="keydown"){contenteditable_event_stop(B);return }var F=contenteditable_selection_range();if(F.text==F.htmlText){var G=contenteditable_selection_range_parentNode();var C=G.firstChild;var J="";var E="";var K=contenteditable_createrange();var H=contenteditable_createrange();if(K.moveToElementText){K.moveToElementText(G);while(F.compareEndPoints("StartToEnd",K)==-1){K.moveEnd("character",-1)}H.moveToElementText(G);while(F.compareEndPoints("EndToStart",H)==1){H.moveStart("character",1)}J=K.htmlText.replace(/<p>/gi,"").replace(/<\/p>/gi,"")||"";E=H.htmlText.replace(/<p>/gi,"").replace(/<\/p>/gi,"")||""}var A=C.parentNode;if(G.nodeName=="P"){if(A.firstChild==A.lastChild){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=J||"&nbsp;";if(E){C.nodeValue=E}else{A.innerHTML="&nbsp;"}A.parentNode.insertBefore(D,A);F=contenteditable_selection_range();F.moveToElementText(A);F.collapse(1);F.select()}else{if(C==A.lastChild){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=E||"&nbsp;";C.nodeValue=J;if(A.nextSibling){A.parentNode.insertBefore(D,A.nextSibling)}else{A.parentNode.appendChild(D)}F=contenteditable_selection_range();F.moveToElementText(D);F.collapse(1);F.select()}else{if(C==A.firstChild){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=J||"&nbsp;";C.nodeValue=E;A.parentNode.insertBefore(D,A);F=contenteditable_selection_range();F.moveToElementText(C);F.collapse(1);F.select()}else{var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=E||"&nbsp;";C.nodeValue=J;while(C.nextSibling){nextSibling=C.nextSibling;A.removeChild(nextSibling);D.appendChild(nextSibling)}if(A.nextSibling){A.parentNode.insertBefore(D,A.nextSibling)}else{A.parentNode.appendChild(D)}F=contenteditable_selection_range();F.moveToElementText(D);F.collapse(1);F.select()}}}}else{if(G.nodeName=="BODY"){var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=J||"&nbsp;";var I=contenteditable_focused_contentwindow().document.createElement("P");I.innerHTML=E||"&nbsp;";A.insertBefore(D,C);A.insertBefore(I,C);A.removeChild(C);F=contenteditable_selection_range();F.moveToElementText(I);F.collapse(1);F.select()}else{var D=contenteditable_focused_contentwindow().document.createElement("P");D.innerHTML=E||"&nbsp;";C.nodeValue=J;while(C.nextSibling){nextSibling=C.nextSibling;A.removeChild(nextSibling);D.appendChild(nextSibling)}while(A.nextSibling&&(A.nextSibling.nodeName!="P")){nextSibling=A.nextSibling;A.parentNode.removeChild(nextSibling);D.appendChild(nextSibling)}if(A.nextSibling){A.parentNode.insertBefore(D,A.nextSibling)}else{A.parentNode.appendChild(D)}F=contenteditable_selection_range();F.moveToElementText(D);F.collapse(1);F.select()}}}else{contenteditable_pasteContent("<p>")}}function contenteditable_event_enter_fix(E){if(E&&E.keyCode&&(E.keyCode==webeditor_keyCode_enter)){if(webeditor.onCtrlEnter&&E.ctrlKey){}else{if(webeditor.onShiftEnter&&E.shiftKey){}else{if(webeditor.onAltEnter&&E.altKey){}else{if(webeditor.onEnter&&contenteditable_selection_container("li")){}else{if(webeditor.onEnter&&(webeditor.onEnter.toLowerCase()!="<p>")){}else{var B=contenteditable_selection_range();var D=contenteditable_selection_range_parentNode(B);var H=contenteditable_selection_range_startNode(B);var C=contenteditable_selection_range_endNode(B);var A=contenteditable_selection_range_startOffset(B);var G=contenteditable_selection_range_endOffset(B);if(H&&C&&(H==C)&&(H.nodeName!="#text")){if(E.type=="keydown"){contenteditable_event_stop(E);contenteditable_pasteContent("<p>")}else{contenteditable_event_stop(E)}}else{if(H&&C&&(H==C)&&D&&(D.nodeName=="DIV")&&(A==G)&&(A==H.nodeValue.length)){if(E.type=="keydown"){contenteditable_event_stop(E);var F=contenteditable_focused_contentwindow().document.createElement("div");F.innerHTML="<br>";if(D.nextSibling){D.parentNode.insertBefore(F,D.nextSibling)}else{D.parentNode.appendChild(F)}contenteditable_selection_node(F.firstChild)}else{contenteditable_event_stop(E)}}else{if(H&&C&&(H==C)&&D&&(D.nodeName=="DIV")&&(A==G)&&(A==0)){if(E.type=="keydown"){contenteditable_event_stop(E);var F=contenteditable_focused_contentwindow().document.createElement("div");F.innerHTML="<br>";D.parentNode.insertBefore(F,D)}else{contenteditable_event_stop(E)}}}}}}}}}}}function contenteditable_event_dragdrop(A){if(A&&A.srcElement&&(A.srcElement.nodeName=="IMG")){contenteditable_event_paste_fix_sub("IMG","src",A.srcElement)}if(A&&A.srcElement&&(A.srcElement.nodeName=="A")){contenteditable_event_paste_fix_sub("A","href",A.srcElement)}}function contenteditable_selection(A){if(!A){A=contenteditable_focused_contentwindow()}if(A&&A.document){return A.document.selection}}function contenteditable_selection_text(A){if(!A){A=contenteditable_selection()}return contenteditable_selection_range(A).htmlText}function contenteditable_selection_range_control(A){if(!A){A=contenteditable_selection()}if(A){return(A.type=="Control")}}function contenteditable_selection_range_is_webeditor(B){var A=contenteditable_selection_range_body(B);if((!A)||(A.className!="WebEditor")){return false}else{return true}}function contenteditable_selection_range_body(B){var A=false;if(!B){B=contenteditable_selection_range()}if(B&&B.parentElement){A=B.parentElement();while(A&&(A.nodeName!="BODY")&&(A.nodeName!="HTML")){A=A.parentNode}if(A.nodeName!="BODY"){A=false}}return A}function contenteditable_selection_range_parentNode(C){if(!C){C=contenteditable_selection_range()}if(C&&C.parentElement){try{var A=C.parentElement();if(A.nodeName=="BODY"){}else{if(A.innerHTML.indexOf(C.htmlText)<0){A=A.parentNode}}return A}catch(B){return false}}else{return false}}function contenteditable_selection_range_startNode(F){if(!F){F=contenteditable_selection_range()}var C=false;var A=F.parentElement();if(A&&A.firstChild){C=A.firstChild;for(var D=A.firstChild;D;D=D.nextSibling){var B=false;try{B=contenteditable_createrange();B.moveToElementText(D)}catch(E){B=false}if(!B){try{B=contenteditable_createtextrange();B.moveToElementText(D)}catch(E){B=false}}if(D.nodeName!="#text"){B.moveToElementText(D);if((F.compareEndPoints("StartToStart",B)==1)&&(F.compareEndPoints("StartToEnd",B)==1)&&(F.compareEndPoints("EndToStart",B)==1)&&(F.compareEndPoints("EndToEnd",B)==1)){if(D.nextSibling){C=D.nextSibling}}if((F.compareEndPoints("StartToStart",B)==-1)&&(F.compareEndPoints("StartToEnd",B)==-1)&&(F.compareEndPoints("EndToStart",B)==-1)&&(F.compareEndPoints("EndToEnd",B)==-1)){break}}}}return C}function contenteditable_selection_range_endNode(E){if(!E){E=contenteditable_selection_range()}var B=false;var A=E.parentElement();if(A&&A.firstChild){B=A.firstChild;for(var D=A.firstChild;D;D=D.nextSibling){if(D.nodeName!="#text"){var C=contenteditable_createrange();C.moveToElementText(D);if((E.compareEndPoints("StartToStart",C)==-1)&&(E.compareEndPoints("StartToEnd",C)==-1)&&(E.compareEndPoints("EndToStart",C)==-1)&&(E.compareEndPoints("EndToEnd",C)==-1)){if(D.previousSibling){B=D.previousSibling}break}else{if(D.previousSibling){B=D.previousSibling}}}}}return B}function contenteditable_selection_range_startOffset(B){var A=0;var D=contenteditable_selection_range_startNode(B);if(D){var C=contenteditable_createrange();if(D.previousSibling){C.moveToElementText(D.previousSibling)}else{C.moveToElementText(D.parentNode)}for(var E=0;E<D.length;E++){if(B.compareEndPoints("StartToStart",C)==0){A=E;break}else{if(B.compareEndPoints("StartToStart",C)==1){A=E+1}}C.moveStart("character",1)}}return A}function contenteditable_selection_range_endOffset(B){var D=0;var A=contenteditable_selection_range_endNode(B);if(A){var C=contenteditable_createrange();if(A.nextSibling){try{C.moveToElementText(A.nextSibling)}catch(F){try{C=contenteditable_createtextrange();C.moveToElementText(A.nextSibling)}catch(F){}}}else{C.moveToElementText(A.parentNode);if(A.nodeName=="#text"){if((C.htmlText==C.text)&&(C.text==A.nodeValue)){}else{C.moveEnd("character",-1);if((C.htmlText==C.text)&&(C.text==A.nodeValue)){}else{C.moveEnd("character",1)}}}}for(var E=A.length;E>=0;E--){if(B.compareEndPoints("EndToEnd",C)==0){D=E;break}else{if(B.compareEndPoints("EndToEnd",C)==-1){D=E-1}}C.moveEnd("character",-1)}}return D}function contenteditable_selection_range_deletenodes(B){var E=contenteditable_selection_range_parentNode(B);var H=contenteditable_selection_range_startNode(B);var D=contenteditable_selection_range_endNode(B);var A=contenteditable_selection_range_startOffset(B);var G=contenteditable_selection_range_endOffset(B);var F=H;while(F){var C=F.nextSibling;if(contenteditable_selection_range_contains(B,F)){F.parentNode.removeChild(F)}if(C!=D){F=C}else{F=false}}if(B.htmlText.match(new RegExp("^"+H.outerHTML))){H.parentNode.removeChild(H)}if(B.htmlText.match(new RegExp(D.outerHTML+"$"))&&(H!=D)){D.parentNode.removeChild(D)}}function contenteditable_selection_range_contains(F,C,E){var B=false;if(C.nodeName=="#text"){C=C.parentNode}if(!F){F=contenteditable_selection_range()}var A=false;try{A=contenteditable_createrange();A.moveToElementText(C)}catch(D){A=false}if(!A){try{A=contenteditable_createtextrange();A.moveToElementText(C)}catch(D){A=false}}if(C.nodeName!="#text"){A.moveToElementText(C);if((F.compareEndPoints("StartToStart",A)==-1)&&(F.compareEndPoints("StartToEnd",A)==-1)&&(F.compareEndPoints("EndToStart",A)==1)&&(F.compareEndPoints("EndToEnd",A)==1)){B=true}else{if(E&&(F.compareEndPoints("StartToEnd",A)==-1)&&(F.compareEndPoints("EndToStart",A)==1)){B=true}}}return B}function contenteditable_selection_contains(E){var B=contenteditable_selection_range();var C=contenteditable_selection_range_parentNode(B);var A=C.getElementsByTagName(E);for(var D=0;D<A.length;D++){if(contenteditable_selection_range_contains(B,A[D],true)){return true}}return false}function contenteditable_selection_range(C){if(!C){C=contenteditable_selection()}if(C){if(C.type=="Control"){var A=contenteditable_createrange();try{A.moveToElementText(C.createRange()(0))}catch(B){try{A.moveToElementText(C.createRange().item(0))}catch(B){A=contenteditable_createtextrange();try{A.moveToElementText(C.createRange()(0))}catch(B){try{A.moveToElementText(C.createRange().item(0))}catch(B){}}}}return A}else{var A;try{A=C.createRange();return A}catch(B){return false}}}}function contenteditable_createrange(){try{return document.selection.createRange()}catch(A){try{return contenteditable_focused_contentwindow().document.selection.createRange()}catch(A){return }}}function contenteditable_createtextrange(){return contenteditable_focused_contentwindow().document.body.createTextRange()}function contenteditable_createcontrolrange(){return contenteditable_focused_contentwindow().document.body.createControlRange()}function contenteditable_selection_container(C){var D=false;var B=contenteditable_selection_range();var H=false;var A=false;if(B&&B.parentElement&&C&&(B.parentElement().tagName==C.toUpperCase())){A=B.parentElement()}else{if(contenteditable_selection_range_control()){try{A=contenteditable_selection().createRange()(0)}catch(G){try{A=contenteditable_selection().createRange().item(0)}catch(G){}}}else{A=contenteditable_selection_range_parentNode();if(C&&A&&A.firstChild&&A.lastChild&&(A.firstChild==A.lastChild)&&(A.firstChild.nodeName!="#text#")){A=A.firstChild}}}if((C=="object")&&A){for(var F=A.firstChild;F;F=F.nextSibling){if(F.tagName=="OBJECT"){A=F}}}if(!A.tagName){A=A.parentNode}if(webeditor.selection_node&&A){var E=A;while(E&&(webeditor.selection_node!=E.nodeName)){E=E.parentNode}if(E){A=E}}if(C){var E=H||A||false;while(E&&(C.toUpperCase()!=E.tagName)){E=E.parentNode}D=E}else{if(contenteditable_focused_document()){D=H||A||contenteditable_focused_document().body}else{D=H||A}}if(D&&D.ownerDocument&&D.ownerDocument.body&&(D.ownerDocument.body.className=="WebEditor")){return D}else{if((!C)&&contenteditable_focused_document()){return contenteditable_focused_document().body}else{return false}}}function contenteditable_selection_all(){contenteditable_selection_node(contenteditable_focused_document().body)}function contenteditable_selection_node(B){webeditor.selection_node=B.nodeName;if((B.nodeName=="TABLE")||(B.nodeName=="IMG")||(B.nodeName=="INPUT")||(B.nodeName=="SELECT")||(B.nodeName=="TEXTAREA")||(B.nodeName=="VIDEO")||(B.nodeName=="AUDIO")){try{var A=contenteditable_createcontrolrange();A.addElement(B);A.select()}catch(C){}}else{var A=contenteditable_createrange();if(A){A.collapse();if(A.moveToElementText){try{A.moveToElementText(B);A.select()}catch(C){try{A=contenteditable_createtextrange();A.moveToElementText(B);A.select()}catch(C){}}}else{try{A=contenteditable_createtextrange();A.moveToElementText(B);A.select()}catch(C){}}}}}function contenteditable_selection_cells(A){var F=contenteditable_selection_range();var I=contenteditable_selection_range_parentNode();while((I.tagName=="THEAD")||(I.tagName=="TBODY")||(I.tagName=="TFOOT")||(I.tagName=="TR")||(I.tagName=="TD")){I=I.parentNode}if(I.tagName=="TABLE"){var G=-1;var B=-1;var K=-1;var J=-1;for(var E=0;E<I.rows.length;E++){for(var C=0;C<I.rows[E].cells.length;C++){var D=contenteditable_createrange();if(D.moveToElementText){D.moveToElementText(I.rows[E].cells[C]);if((F.compareEndPoints("EndToStart",D)==1)&&(F.compareEndPoints("StartToEnd",D)==-1)){if(G==-1){G=C}if(B==-1){B=E}K=C;J=E}}}}if((B>-1)&&(J>-1)&&(G>-1)&&(K>-1)){var H=new Array();for(var E=B;E<=J;E++){for(var C=G;C<=K;C++){if(!H[E-B]){H[E-B]=new Array()}H[E-B].push(I.rows[E].cells[C])}}if(H.length){return H}}}}function contenteditable_selection_bookmark(B){if(B){var A;if(A=contenteditable_selection_range()){try{A.moveToBookmark(B);A.select();A.scrollIntoView()}catch(C){}}if(contenteditable_focused_contentwindow()){contenteditable_focused_contentwindow().focus()}}else{var A;if(A=contenteditable_selection_range()){B=A.getBookmark()}}return B}function contenteditable_expanded_node(A){var B=false;try{var C=A.parentElement();var D=contenteditable_createrange();D.moveToElementText(C);while((C.nodeName!="BODY")&&(A.compareEndPoints("StartToStart",D)==0)&&(A.compareEndPoints("EndToEnd",D)==0)){B=C;C=C.parentNode;D.moveToElementText(C)}}catch(E){}return B}function contenteditable_collapsed_node(A){while(A&&A.childNodes&&(A.childNodes.length==1)){A=A.firstChild}var B=contenteditable_createrange();B.moveToElementText(A);return A}function contenteditable_setContent_body(D,E,C){if(C&&C.contentWindow&&C.contentWindow.document&&C.contentWindow.document.body){C.contentWindow.document.body.innerHTML="";contenteditable_selection_node(C.contentWindow.document.body);if(webeditor.setcontentbodydocumentwrite){var B=C.contentWindow.document.documentElement.innerHTML;B=B.replace(new RegExp("<body([^>]*)>(.*)</body>","i"),"<body$1>"+D.replace(/\$/g,"$$$$")+"</body>");C.contentWindow.document.open();C.contentWindow.document.write(B);C.contentWindow.document.close();for(var A=0;A<document.getElementsByTagName("iframe").length;A++){if(C==document.getElementsByTagName("iframe").item(A)){C.contentWindow.attachEvent("onfocus",contenteditable_onfocus[A]);C.contentWindow.attachEvent("onblur",contenteditable_onblur[A]);C.contentWindow.document.body.attachEvent("onfocus",contenteditable_onfocus[A]);C.contentWindow.document.body.attachEvent("onblur",contenteditable_onblur[A]);C.contentWindow.document.attachEvent("onkeydown",contenteditable_event);C.contentWindow.document.attachEvent("onkeyup",contenteditable_event);C.contentWindow.document.attachEvent("onkeypress",contenteditable_event);C.contentWindow.document.attachEvent("onmousedown",contenteditable_event);C.contentWindow.document.attachEvent("onmouseup",contenteditable_event);C.contentWindow.document.attachEvent("ondrag",contenteditable_event);C.contentWindow.document.attachEvent("ondragstart",contenteditable_event);C.contentWindow.document.attachEvent("ondragend",contenteditable_event);C.contentWindow.document.attachEvent("ondragenter",contenteditable_event);C.contentWindow.document.attachEvent("ondragover",contenteditable_event);C.contentWindow.document.attachEvent("ondragleave",contenteditable_event);C.contentWindow.document.attachEvent("ondrop",contenteditable_event);if(webeditor.contextmenus){C.contentWindow.document.attachEvent("oncontextmenu",contenteditable_contextmenu)}}}contenteditable_event_paste_fix(C.contentWindow.document.body)}else{if(webeditor.setcontentbodyinnerhtml){C.contentWindow.document.body.innerHTML=D;contenteditable_event_paste_fix(C.contentWindow.document.body)}else{contenteditable_pasteContent(D,E)}}contenteditable_setBody(C.contentWindow.document.body,C.id)}}function contenteditable_insertNodeAtSelection(G,B,A,J){var C=B;if(G&&((!contenteditable_selection())||(contenteditable_selection().type=="None"))){G.focus()}var K=contenteditable_selection(G);try{var E=contenteditable_selection_range(K);if(!contenteditable_selection_range_is_webeditor(E)){return }if(B.outerHTML){if((typeof (K)=="object")&&(K.type=="Control")){var I=null;try{I=K.createRange()(0)}catch(H){try{I=K.createRange().item(0)}catch(H){}}var D=I.parentNode;D.replaceChild(B,I)}else{C=contenteditable_insertNodeAtSelection_outerHTML(E,B,A,J);contenteditable_event_paste_fix(C);E=contenteditable_selection_range();E.moveToElementText(C);E.collapse(false);E.select()}}else{var L=contenteditable_expanded_node(E);if(L){var F=G.document.createTextNode(B.nodeValue);var M=L.parentNode;M.replaceChild(F,L);C=F}else{contenteditable_selection_range_deletenodes(E);E.pasteHTML(contenteditable_encodeScriptTags(B.nodeValue))}}}catch(H){try{var E=null;try{E=contenteditable_selection().createRange()(0)}catch(H){try{E=contenteditable_selection().createRange().item(0)}catch(H){}}if(!contenteditable_selection_range_is_webeditor(E)){return }if(B.outerHTML){C=contenteditable_insertNodeAtSelection_outerHTML(E,B,A,J);contenteditable_event_paste_fix(C);E=contenteditable_selection_range();E.moveToElementText(C);E.collapse(false);E.select()}else{E.outerHTML=contenteditable_encodeScriptTags(B.nodeValue)}}catch(H){}}return C}function contenteditable_insertNodeAtSelection_outerHTML(H,E,C,J){var K=false;var F=E;if((!E.childNodes)||(!E.childNodes.length)){if(E.outerHTML){if(!E.id){E.id="HardCoreWebContentEditorInsertNodeAtSelectionDummy"}contenteditable_selection_range_deletenodes(H);H.pasteHTML(E.outerHTML);F=contenteditable_focused_document().getElementById("HardCoreWebContentEditorInsertNodeAtSelectionDummy");if(!F){if(H&&H.parentElement()&&(H.parentElement().id=="HardCoreWebContentEditorInsertNodeAtSelectionDummy")){F=H.parentElement()}if(H&&H.parentElement()&&H.parentElement().firstChild&&(H.parentElement().firstChild.id=="HardCoreWebContentEditorInsertNodeAtSelectionDummy")){F=H.parentElement().firstChild}}if(F&&(F.id=="HardCoreWebContentEditorInsertNodeAtSelectionDummy")){contenteditable_removeAttribute(F,"id")}}else{H.pasteHTML(E.nodeValue)}}else{try{var M=contenteditable_expanded_node(H);if(J){M=contenteditable_collapsed_node(M)}if(M){if(M.nodeName=="BODY"){M.innerHTML='<div id="HardCoreWebContentEditorInsertNodeAtSelectionDummy">&nbsp;</div>'}else{M.outerHTML='<div id="HardCoreWebContentEditorInsertNodeAtSelectionDummy">&nbsp;</div>'}}else{if((H.text==H.htmlText)&&(E.nodeName!="DIV")){H.pasteHTML('<span id="HardCoreWebContentEditorInsertNodeAtSelectionDummy">&nbsp;</span>')}else{var B=H.parentElement();while((B.nodeName!="SPAN")&&(B.nodeName!="DIV")&&(B.nodeName!="P")&&(B.nodeName!="BODY")&&(B.nodeName!="HTML")){B=B.parentNode}if(B.nodeName=="SPAN"){contenteditable_selection_range_deletenodes(H);H.pasteHTML('<span id="HardCoreWebContentEditorInsertNodeAtSelectionDummy">&nbsp;</span>')}else{contenteditable_selection_range_deletenodes(H);if(((B.nodeName=="DIV")||(B.nodeName=="P"))&&(E.nodeName!="DIV")){H.pasteHTML('<span id="HardCoreWebContentEditorInsertNodeAtSelectionDummy">&nbsp;</span>')}else{H.pasteHTML('<div id="HardCoreWebContentEditorInsertNodeAtSelectionDummy">&nbsp;</div>')}K=true}}}}catch(I){try{contenteditable_selection_range_deletenodes(H);var B=H.parentElement();while((B.nodeName!="SPAN")&&(B.nodeName!="DIV")&&(B.nodeName!="P")&&(B.nodeName!="BODY")&&(B.nodeName!="HTML")){B=B.parentNode}if(B.nodeName=="SPAN"){contenteditable_selection_range_deletenodes(H);H.pasteHTML('<span id="HardCoreWebContentEditorInsertNodeAtSelectionDummy">&nbsp;</span>')}else{contenteditable_selection_range_deletenodes(H);if(((B.nodeName=="DIV")||(B.nodeName=="P"))&&(E.nodeName!="DIV")){H.pasteHTML('<span id="HardCoreWebContentEditorInsertNodeAtSelectionDummy">&nbsp;</span>')}else{H.pasteHTML('<div id="HardCoreWebContentEditorInsertNodeAtSelectionDummy">&nbsp;</div>')}K=true}}catch(I){contenteditable_selection_range_deletenodes(H);H.pasteHTML('<div id="HardCoreWebContentEditorInsertNodeAtSelectionDummy">&nbsp;</div>')}}var L=contenteditable_focused_document().getElementById("HardCoreWebContentEditorInsertNodeAtSelectionDummy");if(!L){if(H&&H.parentElement()&&(H.parentElement().id=="HardCoreWebContentEditorInsertNodeAtSelectionDummy")){L=H.parentElement()}if(H&&H.parentElement()&&H.parentElement().firstChild&&(H.parentElement().firstChild.id=="HardCoreWebContentEditorInsertNodeAtSelectionDummy")){L=H.parentElement().firstChild}}if(L){var A=L.previousSibling;var D=L.nextSibling;var G=L.parentNode;if(false&&C){contenteditable_selection_node(L);var H=contenteditable_selection_range();H.pasteHTML(C)}else{try{L.outerHTML=E.outerHTML}catch(I){try{contenteditable_selection_node(L);var H=contenteditable_selection_range();contenteditable_selection_range_deletenodes(H);H.pasteHTML(E.outerHTML);F=contenteditable_focused_document().getElementById("HardCoreWebContentEditorInsertNodeAtSelectionDummy");if(!F){if(H&&H.parentElement()&&(H.parentElement().id=="HardCoreWebContentEditorInsertNodeAtSelectionDummy")){F=H.parentElement()}if(H&&H.parentElement()&&H.parentElement().firstChild&&(H.parentElement().firstChild.id=="HardCoreWebContentEditorInsertNodeAtSelectionDummy")){F=H.parentElement().firstChild}}if(F&&(F.id=="HardCoreWebContentEditorInsertNodeAtSelectionDummy")){contenteditable_removeAttribute(F,"id")}}catch(I){alert("ERROR:contenteditable_insertNodeAtSelection_outerHTML:"+E.nodeName)}}}if(A){F=A.nextSibling}else{F=G.firstChild}if(K&&D){}contenteditable_fix_copied_node(E,F,"IMG","src");contenteditable_fix_copied_node(E,F,"A","href")}}return F}function contenteditable_fix_copied_node(A,F,E,D){var G=A.getElementsByTagName(E);var C=F.getElementsByTagName(E);if(G.length==C.length){for(var B=0;B<G.length;B++){if(contenteditable_getAttribute(G[B],D)!=contenteditable_getAttribute(C[B],D)){contenteditable_setAttribute(C[B],D,contenteditable_getAttribute(G[B],D))}}}}function contenteditable_useCSS(){try{contenteditable_focused_document().execCommand("styleWithCSS",0,true)}catch(A){try{contenteditable_focused_document().execCommand("useCSS",false,false)}catch(A){}}}function contenteditable_BlockDirLTR(A){webeditor.direction="ltr";contenteditable_focused_contentwindow().document.dir="ltr"}function contenteditable_BlockDirRTL(A){webeditor.direction="rtl";contenteditable_focused_contentwindow().document.dir="rtl"}function contenteditable_formatblock_query(){return(""+contenteditable_focused_document().queryCommandValue("formatblock")).toLowerCase()}function contenteditable_formatblock(B,A){if(A=="<p>"){A="normal"}return contenteditable_execcommand(B,A)}function contenteditable_formatclass(D,C){var B=contenteditable_selection_range();var A=contenteditable_selection_range_parentNode();if((B.text==B.htmlText)&&(B.text!="")){B.pasteHTML('<span class="'+C+'">'+B.text+"</span>")}else{if(A.outerHTML.indexOf(B.htmlText)<0){B.pasteHTML('<div class="'+C+'">'+B.htmlText+"</div>")}else{if((A.childNodes.length==1)&&(A.childNodes[0].nodeType==3)){contenteditable_formatclass_attribute(A,C)}else{if(A.nodeName=="BODY"){B.pasteHTML('<div class="'+C+'">'+B.htmlText+"</div>")}else{contenteditable_formatclass_range(D,C,A,B)}}}}}function contenteditable_formatclass_range(G,F,A,B){var D;D=B.duplicate();if((D.moveToElementText)&&(A.nodeType!=3)){D.moveToElementText(A);if((B.compareEndPoints("StartToStart",D)==0)&&(B.compareEndPoints("EndToEnd",D)==0)){if(A.nodeName=="BODY"){var E=contenteditable_focused_contentwindow().document.createElement("span");contenteditable_formatclass_attribute(E,F);while(A.childNodes[0]){E.appendChild(A.childNodes[0])}contenteditable_insertNodeAtSelection(contenteditable_focused_contentwindow(),E)}else{contenteditable_formatclass_attribute(A,F)}}else{for(var C=0;C<A.childNodes.length;C++){var E=A.childNodes[C];if(E.nodeType==3){contenteditable_formatclass_attribute(E.parentNode,F)}else{var D;D=B.duplicate();if(D.moveToElementText){D.moveToElementText(E);if((B.compareEndPoints("EndToStart",D)==1)&&(B.compareEndPoints("StartToEnd",D)==-1)){if((B.compareEndPoints("StartToStart",D)==1)&&(B.compareEndPoints("EndToEnd",D)==1)){contenteditable_formatclass_range(G,F,E,B)}else{if((B.compareEndPoints("StartToStart",D)==-1)&&(B.compareEndPoints("EndToEnd",D)==-1)){contenteditable_formatclass_range(G,F,E,B)}else{if((B.compareEndPoints("StartToStart",D)!=1)&&(B.compareEndPoints("EndToEnd",D)!=-1)){contenteditable_formatclass_attribute(E,F)}}}}}}}}}}function contenteditable_execcommand(F,L){try{if(F=="indent"){var I=contenteditable_selection_range();var C=contenteditable_selection_range_parentNode(I);var M=contenteditable_selection_range_startNode(I);var D=contenteditable_selection_range_endNode(I);var E=contenteditable_selection_container();if(E&&M&&D&&(M==D)&&((M.tagName=="P")||(M.tagName=="DIV"))){E=M}else{if(E&&M&&D&&(M==D)&&M.parentNode&&((M.parentNode.tagName=="P")||(M.parentNode.tagName=="DIV"))){E=M.parentNode}else{E=false}}if(E||(E=contenteditable_selection_container("p"))||(E=contenteditable_selection_container("div"))){var G=parseInt(webeditor.cssIndent);var K=""+webeditor.cssIndent.replace(/^[0-9]+([a-zA-Z]*)[^a-zA-Z]*$/gi,"$1");if(E.style.marginLeft){G=parseInt(E.style.marginLeft)+G}if((!G)||(G<=0)){G=parseInt(webeditor.cssIndent)}if(G>0){E.style.marginLeft=""+G+K}else{E.style.marginLeft=""}return true}else{if(E=contenteditable_selection_container()){while(M.parentNode!=C){M=M.parentNode}while(D.parentNode!=C){D=D.parentNode}while(M&&(!M.parentNode.tagName.match(new RegExp("^(TEXTAREA|PRE|TABLE|THEAD|TBODY|TFOOT|TR|TD|DIR|MENU|DL|OL|UL|FORM|SELECT|H1|H2|H3|H4|H5|H6|OBJECT|EMBED|NOEMBED|MAP|IFRAME|DIV|P|BR|BODY)$")))){M=M.parentNode}while(D&&(!D.parentNode.tagName.match(new RegExp("^(TEXTAREA|PRE|TABLE|THEAD|TBODY|TFOOT|TR|TD|DIR|MENU|DL|OL|UL|FORM|SELECT|H1|H2|H3|H4|H5|H6|OBJECT|EMBED|NOEMBED|MAP|IFRAME|DIV|P|BR|BODY)$")))){D=D.parentNode}while(M&&M.previousSibling&&((M.previousSibling.nodeType==3)||(M.previousSibling.tagName&&(!M.previousSibling.tagName.match(new RegExp("^(TEXTAREA|PRE|TABLE|THEAD|TBODY|TFOOT|TR|TD|DIR|MENU|DL|OL|UL|FORM|SELECT|H1|H2|H3|H4|H5|H6|OBJECT|EMBED|NOEMBED|MAP|IFRAME|DIV|P|BR|BODY)$")))))){M=M.previousSibling}while(D&&D.nextSibling&&((D.previousSibling.nodeType==3)||(D.nextSibling.tagName&&(!D.nextSibling.tagName.match(new RegExp("^(TEXTAREA|PRE|TABLE|THEAD|TBODY|TFOOT|TR|TD|DIR|MENU|DL|OL|UL|FORM|SELECT|H1|H2|H3|H4|H5|H6|OBJECT|EMBED|NOEMBED|MAP|IFRAME|DIV|P|BR|BODY)$")))))){D=D.nextSibling}var B=new Array();B[B.length]=M;for(E=M.nextSibling;(E&&(E!=D.nextSibling));E=E.nextSibling){if(E){B[B.length]=E}}var A=contenteditable_focused_document().createElement("div");A.style.marginLeft=webeditor.cssIndent;M.parentNode.insertBefore(A,M);for(var H=0;H<B.length;H++){A.appendChild(B[H])}if((A.childNodes.length>=1)&&(A.childNodes[0].nodeType==3)){A.childNodes[0].nodeValue=A.childNodes[0].nodeValue.replace(/^[\r\n\t ]/gi,"")}if((A.childNodes.length>=1)&&(A.childNodes[A.childNodes.length-1].nodeType==3)){A.childNodes[A.childNodes.length-1].nodeValue=A.childNodes[A.childNodes.length-1].nodeValue.replace(/[\r\n\t ]$/gi,"")}if(A.previousSibling&&(A.previousSibling.tagName=="BR")){A.parentNode.removeChild(A.previousSibling)}if(A.nextSibling&&(A.nextSibling.tagName=="BR")){A.parentNode.removeChild(A.nextSibling)}return true}}}else{if(F=="outdent"){var I=contenteditable_selection_range();var C=contenteditable_selection_range_parentNode(I);var M=contenteditable_selection_range_startNode(I);var D=contenteditable_selection_range_endNode(I);var E=contenteditable_selection_container();if(E&&M&&D&&(M==D)&&((M.tagName=="P")||(M.tagName=="DIV"))){E=M}else{if(E&&M&&D&&(M==D)&&M.parentNode&&((M.parentNode.tagName=="P")||(M.parentNode.tagName=="DIV"))){E=M.parentNode}else{E=false}}if(E||(E=contenteditable_selection_container("p"))||(E=contenteditable_selection_container("div"))){var G=parseInt(webeditor.cssIndent);var K=""+webeditor.cssIndent.replace(/^[0-9]+([a-zA-Z]*)[^a-zA-Z]*$/gi,"$1");if(E.style.marginLeft){G=parseInt(E.style.marginLeft)-G}if((!G)||(G<=0)){G=0}if(G>0){E.style.marginLeft=""+G+K}else{E.style.marginLeft=""}return true}}}contenteditable_focused_document().body.focus();if(webeditor.useCSS){contenteditable_useCSS()}return contenteditable_focused_document().execCommand(F,false,contenteditable_execcommand_value(F,L))}catch(J){return false}return true}function contenteditable_execcommand_value(B,A){if((B=="forecolor")&&((A=="")||(A=="inherit"))){return""}else{if((B=="backcolor")&&((A=="")||(A=="inherit"))){return""}}return A}function contenteditable_querycommand_value(B,A){return A}function contenteditable_find(B){if(contenteditable_execcommand(B)){return true}else{try{contenteditable_focused_contentwindow().find();return true}catch(A){webeditor.find_window=window.open(webeditor.rootpath+"find.html?editor=webeditor&find=","find_window",",width=400,height=150,scrollbars=yes,resizable=yes,status=yes",true);return true}}}function contenteditable_print(B){if(contenteditable_execcommand(B)){return true}else{try{contenteditable_focused_contentwindow().print();return true}catch(A){return false}}}function contenteditable_specialcharacter(B){if(B){var A=contenteditable_selection();if(A.type.toLowerCase()!="none"){A.clear()}A.createRange().pasteHTML(B)}}function contenteditable_position(B){var A=contenteditable_positionable();if(B){contenteditable_execcommand("2D-Position",true)}else{if(A){if(A.style.position=="absolute"){contenteditable_execcommand("2D-Position",false);A.style.position="";A.style.top="";A.style.left="";A.style.zIndex=""}else{A.style.position="absolute";contenteditable_execcommand("2D-Position",true)}if(contenteditable_getAttribute(A,"style")==""){contenteditable_removeAttribute(A,"style")}}}}function contenteditable_forwards(){var A=contenteditable_positionable();if(A){if(A.style&&A.style.zIndex&&(A.style.zIndex<1000000)){A.style.zIndex=parseInt(A.style.zIndex)+1}else{A.style.zIndex=1}}}function contenteditable_backwards(){var A=contenteditable_positionable();if(A){if(A.style&&A.style.zIndex&&(A.style.zIndex>-1000000)){A.style.zIndex=parseInt(A.style.zIndex)-1}else{A.style.zIndex=-1}}}function contenteditable_front(){var A=contenteditable_positionable();if(A){zIndex=contenteditable_positionable_front_max();if(zIndex<1000000){zIndex++}else{zIndex=1000000}A.style.zIndex=zIndex}}function contenteditable_back(){var A=contenteditable_positionable();if(A){zIndex=contenteditable_positionable_back_min();if(zIndex>-1000000){zIndex--}else{zIndex=-1000000}A.style.zIndex=zIndex}}function contenteditable_abovetext(){var A=contenteditable_positionable();if(A&&A.style){if(A.style.zIndex<0){A.style.zIndex=-A.style.zIndex}else{if(A.style.zIndex==0){A.style.zIndex=1}}}}function contenteditable_belowtext(){var A=contenteditable_positionable();if(A&&A.style){if(A.style.zIndex>0){A.style.zIndex=-A.style.zIndex}else{if(A.style.zIndex==0){A.style.zIndex=-1}}}}function contenteditable_viewsource_onfocus(A){A.detachEvent("onfocus",contenteditable_onfocus[contenteditable_focused]);A.attachEvent("onfocus",contenteditable_onfocus[contenteditable_focused]);A.onfocus=contenteditable_onfocus[contenteditable_focused];A.detachEvent("onblur",contenteditable_onblur[contenteditable_focused]);A.attachEvent("onblur",contenteditable_onblur[contenteditable_focused]);A.onblur=contenteditable_onblur[contenteditable_focused]}function contenteditable_viewsource_textarea2html(A,B){var C=A.value;C=contenteditable_split_content(B.id,C);try{if(webeditor_custom_encode){C=webeditor_custom_encode(C)}}catch(D){}try{if(webeditor_custom_initialize){C=webeditor_custom_initialize(C)}}catch(D){}C=contenteditable_encodeScriptTags(C);C=webeditor_empty_content_fix(C);B.contentWindow.document.body.innerHTML="&nbsp;";B.contentWindow.detachEvent("onfocus",contenteditable_onfocus[contenteditable_focused]);B.contentWindow.attachEvent("onfocus",contenteditable_onfocus[contenteditable_focused]);B.contentWindow.document.body.detachEvent("onfocus",contenteditable_onfocus[contenteditable_focused]);B.contentWindow.document.body.attachEvent("onfocus",contenteditable_onfocus[contenteditable_focused]);B.contentWindow.detachEvent("onblur",contenteditable_onblur[contenteditable_focused]);B.contentWindow.attachEvent("onblur",contenteditable_onblur[contenteditable_focused]);B.contentWindow.document.body.detachEvent("onblur",contenteditable_onblur[contenteditable_focused]);B.contentWindow.document.body.attachEvent("onblur",contenteditable_onblur[contenteditable_focused]);B.contentWindow.document.detachEvent("onkeydown",contenteditable_event);B.contentWindow.document.attachEvent("onkeydown",contenteditable_event);B.contentWindow.document.detachEvent("onkeyup",contenteditable_event);B.contentWindow.document.attachEvent("onkeyup",contenteditable_event);B.contentWindow.document.detachEvent("onkeypress",contenteditable_event);B.contentWindow.document.attachEvent("onkeypress",contenteditable_event);B.contentWindow.document.detachEvent("onmousedown",contenteditable_event);B.contentWindow.document.attachEvent("onmousedown",contenteditable_event);B.contentWindow.document.detachEvent("onmouseup",contenteditable_event);B.contentWindow.document.attachEvent("onmouseup",contenteditable_event);B.contentWindow.document.detachEvent("ondrag",contenteditable_event);B.contentWindow.document.attachEvent("ondrag",contenteditable_event);B.contentWindow.document.detachEvent("ondragstart",contenteditable_event);B.contentWindow.document.attachEvent("ondragstart",contenteditable_event);B.contentWindow.document.detachEvent("ondragend",contenteditable_event);B.contentWindow.document.attachEvent("ondragend",contenteditable_event);B.contentWindow.document.detachEvent("ondragenter",contenteditable_event);B.contentWindow.document.attachEvent("ondragenter",contenteditable_event);B.contentWindow.document.detachEvent("ondragover",contenteditable_event);B.contentWindow.document.attachEvent("ondragover",contenteditable_event);B.contentWindow.document.detachEvent("ondragleave",contenteditable_event);B.contentWindow.document.attachEvent("ondragleave",contenteditable_event);B.contentWindow.document.detachEvent("ondrop",contenteditable_event);B.contentWindow.document.attachEvent("ondrop",contenteditable_event);B.contentWindow.document.close();contenteditable_setContent(C,B.id)}function contenteditable_viewsource_show(){var A=document.createTextNode(document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document.body.innerHTML);document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document.body.innerText=A.toString()}function contenteditable_viewsource_hide(){var A=document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document.body.innerText;document.getElementsByTagName("iframe").item(contenteditable_focused).contentWindow.document.body.innerHTML=A.toString()}function contenteditable_iframe_hide(A){A.style.display="none"}function contenteditable_iframe_show(A){A.style.display="block"}function contenteditable_dropdown_hide(A){A.style.display="none"}function contenteditable_dropdown_show(A){A.style.display="block"}function contenteditable_dropdown_hidden(A){return(A.style.display=="none")}function contenteditable_setAttribute(B,A,C){if((B.nodeName=="IMG")&&((A=="width")||(A=="height"))&&(contenteditable_getAttribute(B,A)==C)){}else{contenteditable_removeAttribute(B,A);try{B.setAttribute(A,C)}catch(D){}}if((B.nodeName=="INPUT")&&(A=="type")&&(contenteditable_getAttribute(B,A)!=C)){RegExp.global=true;RegExp.multiline=true;if(B.outerHTML.match(/^(<INPUT[^>]+type=)("[a-z]*")([^>]*>)$/gi)){B.outerHTML=B.outerHTML.replace(/^(<INPUT[^>]+type=)("[a-z]*")([^>]*>)$/gi,"$1"+C.replace(/\$/g,"$$$$")+"$3")}else{if(B.outerHTML.match(/^(<INPUT[^>]+type=)([a-z]+)([^>]*>)$/gi)){B.outerHTML=B.outerHTML.replace(/^(<INPUT[^>]+type=)([a-z]+)([^>]*>)$/gi,"$1"+C.replace(/\$/g,"$$$$")+"$3")}else{B.outerHTML=B.outerHTML.replace(/^(<INPUT[^>]+)([^>]*>)$/gi,"$1 type="+C.replace(/\$/g,"$$$$")+" $2")}}}if((B.nodeName=="A")&&(A=="name")&&(contenteditable_getAttribute(B,A)!=C)){B.removeAttribute("NAME");B.setAttribute("NAME",C)}if((B.nodeName=="INPUT")&&(A=="name")&&(contenteditable_getAttribute(B,A)!=C)){B.removeAttribute("NAME");B.setAttribute("NAME",C)}if((B.nodeName=="TEXTAREA")&&(A=="name")&&(contenteditable_getAttribute(B,A)!=C)){B.removeAttribute("NAME");B.setAttribute("NAME",C)}if((B.nodeName=="SELECT")&&(A=="name")&&(contenteditable_getAttribute(B,A)!=C)){B.removeAttribute("NAME");B.setAttribute("NAME",C)}if((B.nodeName=="MAP")&&(A=="name")&&(contenteditable_getAttribute(B,A)!=C)){B.removeAttribute("NAME");B.setAttribute("NAME",C)}}function contenteditable_removeAttribute(B,A){try{B.setAttribute(A,"");B.removeAttribute(A)}catch(C){}if(A=="class"){B.removeAttribute("className")}if((B.nodeName=="A")&&(A=="name")){B.removeAttribute("NAME")}if((B.nodeName=="INPUT")&&(A=="name")){B.removeAttribute("NAME")}if((B.nodeName=="TEXTAREA")&&(A=="name")){B.removeAttribute("NAME")}if((B.nodeName=="SELECT")&&(A=="name")){B.removeAttribute("NAME")}}var contenteditable_getAttribute=false;if(webeditor.getAttribute_attributes&&webeditor.getAttribute_amp){contenteditable_getAttribute=function(B,A){var C="";if(B&&B.attributes&&B.attributes[A]){C=B.attributes[A].nodeValue}else{if(B&&B.getAttribute){C=B.getAttribute(A,2)}}if(C==null){C=""}C=(""+C).replace(/&amp;/gi,"&");if(B&&(B.nodeName=="TD")&&(A=="align")&&(C=="middle")){C="center"}if(B&&(B.nodeName=="TD")&&(A=="vAlign")&&(C=="center")){C="middle"}return""+C}}else{if(webeditor.getAttribute_attributes){contenteditable_getAttribute=function(B,A){var C="";if(B&&B.attributes&&B.attributes[A]){C=B.attributes[A].nodeValue}else{if(B&&B.getAttribute){C=B.getAttribute(A,2)}}if(C==null){C=""}if(B&&(B.nodeName=="TD")&&(A=="align")&&(C=="middle")){C="center"}if(B&&(B.nodeName=="TD")&&(A=="vAlign")&&(C=="center")){C="middle"}return""+C}}else{if((!webeditor.getAttribute_outerHTML)&&webeditor.getAttribute_amp){contenteditable_getAttribute=function(B,A){var C="";if(B&&B.getAttribute){C=B.getAttribute(A,2)}if(C==null){C=""}C=(""+C).replace(/&amp;/gi,"&");if(B&&(B.nodeName=="TD")&&(A=="align")&&(C=="middle")){C="center"}if(B&&(B.nodeName=="TD")&&(A=="vAlign")&&(C=="center")){C="middle"}return""+C}}else{if(!webeditor.getAttribute_outerHTML){contenteditable_getAttribute=function(B,A){var C="";if(B&&B.getAttribute){C=B.getAttribute(A,2)}if(C==null){C=""}if(B&&(B.nodeName=="TD")&&(A=="align")&&(C=="middle")){C="center"}if(B&&(B.nodeName=="TD")&&(A=="vAlign")&&(C=="center")){C="middle"}return""+C}}else{contenteditable_getAttribute=function(F,E){var H="";if(F&&((F.outerHTML)||(typeof (F)=="string"))){var B;if(F.outerHTML){B=F.outerHTML}else{B=F}RegExp.global=true;RegExp.multiline=true;var D=new RegExp("^[^>]*[ \t\r\n]"+E+'="([^"]*)"',"gi");var A=new RegExp("^[^>]*[ \t\r\n]"+E+"=([^ >]*)","gi");var C=new RegExp("^[^>]*[ \t\r\n]("+E+")[ \t\r\n>]","gi");var G;if(G=D.exec(B)){H=G[1]||""}else{if(G=A.exec(B)){H=G[1]||""}else{if(G=C.exec(B)){H=G[1]||""}}}}else{if(F&&F.getAttribute){H=F.getAttribute(E,2)}}if(H==null){H=""}if(webeditor.getAttribute_amp){H=(""+H).replace(/&amp;/gi,"&")}if(F&&(F.nodeName=="TD")&&(E=="align")&&(H=="middle")){H="center"}if(F&&(F.nodeName=="TD")&&(E=="vAlign")&&(H=="center")){H="middle"}return""+H}}}}}function contenteditable_cellRowSpan(A){return A.rowSpan}function contenteditable_cellColSpan(A){return A.colSpan}function contenteditable_cellIndex(A){return A.cellIndex}function contenteditable_insertimage_fix(E,M,R,L,J,F,I,N,K,Q,C,B,D){var S=null;var H=contenteditable_selection_range();H.moveStart("character",-1);var G=contenteditable_focused_document().getElementsByTagName("img");for(var O=0;O<G.length;O++){try{var A=contenteditable_createrange();A.moveToElementText(G[O]);if((H.compareEndPoints("EndToStart",A)==1)&&(H.compareEndPoints("StartToEnd",A)==-1)&&(H.compareEndPoints("StartToStart",A)!=-1)&&(H.compareEndPoints("EndToEnd",A)!=1)){S=G[O]}else{if((H.compareEndPoints("EndToStart",A)==1)&&(H.compareEndPoints("StartToEnd",A)==0)&&(H.compareEndPoints("StartToStart",A)==0)&&(H.compareEndPoints("EndToEnd",A)==1)){S=G[O]}}}catch(P){}}if(S){contenteditable_setAttribute(S,"src",E);if(M){contenteditable_setAttribute(S,"border",M)}else{contenteditable_removeAttribute(S,"border")}if(R){contenteditable_setAttribute(S,"alt",R)}else{contenteditable_removeAttribute(S,"alt")}if(L){contenteditable_setAttribute(S,"width",L)}else{contenteditable_removeAttribute(S,"width")}if(J){contenteditable_setAttribute(S,"height",J)}else{contenteditable_removeAttribute(S,"height")}if(F){contenteditable_setAttribute(S,"vspace",F)}else{contenteditable_removeAttribute(S,"vspace")}if(I){contenteditable_setAttribute(S,"hspace",I)}else{contenteditable_removeAttribute(S,"hspace")}if(N){contenteditable_setAttribute(S,"align",N)}else{contenteditable_removeAttribute(S,"align")}if(C){contenteditable_setAttribute(S,"onMouseOver",C)}else{contenteditable_removeAttribute(S,"onMouseOver")}if(B){contenteditable_setAttribute(S,"onMouseOut",B)}else{contenteditable_removeAttribute(S,"onMouseOut")}if(D){contenteditable_setAttribute(S,"usemap",D)}else{contenteditable_removeAttribute(S,"usemap")}if(K){contenteditable_setAttribute(S,"class",K)}else{contenteditable_removeAttribute(S,"class")}if(Q){contenteditable_setAttribute(S,"id",Q)}else{contenteditable_removeAttribute(S,"id")}if(contenteditable_getAttribute(S,"href")=="/"){contenteditable_removeAttribute(S,"href")}if(contenteditable_getAttribute(S,"background")=="/"){contenteditable_removeAttribute(S,"background")}}}function contenteditable_insertmap_fix(C,A,E,F,D,G,B){}function contenteditable_insertlink_fix(B,A,G,K,J,N,L,I){var H=null;var E=contenteditable_selection_range();E.moveStart("character",-1);var M=contenteditable_focused_document().getElementsByTagName("a");for(var D=0;D<M.length;D++){try{var C=contenteditable_createrange();C.moveToElementText(M[D]);if((E.compareEndPoints("EndToStart",C)==1)&&(E.compareEndPoints("StartToEnd",C)==-1)&&(E.compareEndPoints("StartToStart",C)!=-1)&&(E.compareEndPoints("EndToEnd",C)!=1)){H=M[D]}}catch(F){}}if(H){contenteditable_setAttribute(H,"href",A);if(G){contenteditable_setAttribute(H,"target",G)}else{contenteditable_removeAttribute(H,"target")}if(J){contenteditable_setAttribute(H,"class",J)}else{contenteditable_removeAttribute(H,"class")}if(N){contenteditable_setAttribute(H,"id",N)}else{contenteditable_removeAttribute(H,"id")}if(L){contenteditable_setAttribute(H,"onclick",L)}else{contenteditable_removeAttribute(H,"onclick")}if(I){contenteditable_setAttribute(H,"title",I)}else{contenteditable_removeAttribute(H,"title")}}}function contenteditable_insertiframe_fix(B,K,A,J,M,D,C){var E=null;var H=contenteditable_selection_range();H.moveStart("character",-1);var L=contenteditable_focused_document().getElementsByTagName("iframe");for(var G=0;G<L.length;G++){try{var F=contenteditable_createrange();F.moveToElementText(L[G]);if((H.compareEndPoints("EndToStart",F)==1)&&(H.compareEndPoints("StartToEnd",F)==-1)&&(H.compareEndPoints("StartToStart",F)!=-1)&&(H.compareEndPoints("EndToEnd",F)!=1)){E=L[G]}else{if((H.compareEndPoints("EndToStart",F)==1)&&(H.compareEndPoints("StartToEnd",F)==0)&&(H.compareEndPoints("StartToStart",F)==1)&&(H.compareEndPoints("EndToEnd",F)==1)){E=L[G]}}}catch(I){}}if(E){if(contenteditable_getAttribute(E,"href")=="/"){contenteditable_removeAttribute(E,"href")}if(contenteditable_getAttribute(E,"background")=="/"){contenteditable_removeAttribute(E,"background")}}}function contenteditable_execcommand_fix(B,A){}function contenteditable_formatclass_fix(B,A){}function contenteditable_nobr_fix(){}function contenteditable_box_fix(){contenteditable_focused_contentwindow().document.body.innerHTML=contenteditable_focused_contentwindow().document.body.innerHTML;contenteditable_event_paste_fix(contenteditable_focused_contentwindow().document.body)}function contenteditable_mailto_fix(){contenteditable_focused_contentwindow().document.body.innerHTML=contenteditable_focused_contentwindow().document.body.innerHTML;contenteditable_event_paste_fix(contenteditable_focused_contentwindow().document.body)}function contenteditable_anchor_fix(){contenteditable_focused_contentwindow().document.body.innerHTML=contenteditable_focused_contentwindow().document.body.innerHTML;contenteditable_event_paste_fix(contenteditable_focused_contentwindow().document.body)}function contenteditable_cleanContent_fix(){}function contenteditable_formatContent_fix(A){if(!A){return A}A=contenteditable_event_paste_fix_sub("A","href",A);A=contenteditable_event_paste_fix_sub("IMG","src",A);A=A.replace(/ href="\/" src="\/" background="\/">/gi,">");A=A.replace(/(<a[^>]* href=")\/([a-z]+\:[^>]*>)/gi,"$1$2");A=A.replace(/(<a[^>]*) background="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<a[^>]*) background=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<a[^>]*) background=\/(>)/gi,"$1$2");A=A.replace(/(<a[^>]*) src="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<a[^>]*) src=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<a[^>]*) src=\/(>)/gi,"$1$2");A=A.replace(/(<a[^>]*) href="\/"( name=[^>]*>)/gi,"$1$2");A=A.replace(/(<a[^>]*) href=\/( name=[^>]*>)/gi,"$1$2");A=A.replace(/(<div[^>]*) background="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<div[^>]*) background=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<div[^>]*) background=\/(>)/gi,"$1$2");A=A.replace(/(<div[^>]*) href="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<div[^>]*) href=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<div[^>]*) href=\/(>)/gi,"$1$2");A=A.replace(/(<div[^>]*) src="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<div[^>]*) src=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<div[^>]*) src=\/(>)/gi,"$1$2");A=A.replace(/(<p[^>]*) background="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<p[^>]*) background=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<p[^>]*) background=\/(>)/gi,"$1$2");A=A.replace(/(<p[^>]*) href="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<p[^>]*) href=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<p[^>]*) href=\/(>)/gi,"$1$2");A=A.replace(/(<p[^>]*) src="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<p[^>]*) src=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<p[^>]*) src=\/(>)/gi,"$1$2");A=A.replace(/(<br[^>]*) background="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<br[^>]*) background=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<br[^>]*) background=\/(>)/gi,"$1$2");A=A.replace(/(<br[^>]*) href="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<br[^>]*) href=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<br[^>]*) href=\/(>)/gi,"$1$2");A=A.replace(/(<br[^>]*) src="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<br[^>]*) src=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<br[^>]*) src=\/(>)/gi,"$1$2");A=A.replace(/(<table[^>]*) background="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<table[^>]*) background=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<table[^>]*) background=\/(>)/gi,"$1$2");A=A.replace(/(<table[^>]*) href="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<table[^>]*) href=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<table[^>]*) href=\/(>)/gi,"$1$2");A=A.replace(/(<table[^>]*) src="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<table[^>]*) src=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<table[^>]*) src=\/(>)/gi,"$1$2");A=A.replace(/(<tr[^>]*) background="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<tr[^>]*) background=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<tr[^>]*) background=\/(>)/gi,"$1$2");A=A.replace(/(<tr[^>]*) href="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<tr[^>]*) href=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<tr[^>]*) href=\/(>)/gi,"$1$2");A=A.replace(/(<tr[^>]*) src="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<tr[^>]*) src=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<tr[^>]*) src=\/(>)/gi,"$1$2");A=A.replace(/(<td[^>]*) background="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<td[^>]*) background=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<td[^>]*) background=\/(>)/gi,"$1$2");A=A.replace(/(<td[^>]*) href="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<td[^>]*) href=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<td[^>]*) href=\/(>)/gi,"$1$2");A=A.replace(/(<td[^>]*) src="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<td[^>]*) src=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<td[^>]*) src=\/(>)/gi,"$1$2");A=A.replace(/(<input[^>]*) background="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<input[^>]*) background=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<input[^>]*) background=\/(>)/gi,"$1$2");A=A.replace(/(<input[^>]*) href="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<input[^>]*) href=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<input[^>]*) href=\/(>)/gi,"$1$2");A=A.replace(/(<input[^>]*) src="\/"([^>]*>)/gi,"$1$2");A=A.replace(/(<input[^>]*) src=\/( [^>]*>)/gi,"$1$2");A=A.replace(/(<input[^>]*) src=\/(>)/gi,"$1$2");return A}function contenteditable_node_attributes_fix(A,B){return A}function contenteditable_pasteContent_node(A){if(A){return A.createElement("div")}else{return document.createElement("div")}}function contenteditable_paste_fix_prepare(){}function contenteditable_paste_fix(){contenteditable_event_paste_fix_sub("A","href");contenteditable_event_paste_fix_sub("IMG","src");contenteditable_event_paste_fix_sub("INPUT","src");contenteditable_event_paste_fix_sub("TABLE","background");contenteditable_event_paste_fix_sub("TR","background");contenteditable_event_paste_fix_sub("TD","background");contenteditable_event_paste_fix_sub("IFRAME","src");contenteditable_event_paste_fix_sub("AREA","href")}function contenteditable_dragdrop_fix(B){tags=B.getElementsByTagName("IMG");if(B.nodeName=="IMG"){tags[tags.length]=B}if(!tags.length){tags=B.parentNode.getElementsByTagName("IMG")}for(var A=0;A<tags.length;A++){contenteditable_event_paste_fix_sub("IMG","src",tags[A])}tags=B.getElementsByTagName("A");if(B.nodeName=="A"){tags[tags.length]=B}if(!tags.length){tags=B.parentNode.getElementsByTagName("A")}for(var A=0;A<tags.length;A++){contenteditable_event_paste_fix_sub("A","href",tags[A])}}function contenteditable_formatContentNodeHTML_fix(B){var A="";if(B.nodeName=="OBJECT"){A=B.innerHTML;A=A.replace(new RegExp("^.*(<embed [^>]*>.*</embed>).*$","gi"),"$1");A=A.replace(new RegExp("^.*(<embed [^>]* ?/ ?>).*$","gi"),"$1")}return A}function contenteditable_formatContentNodeXHTML_fix(B){var A="";if(B.nodeName=="OBJECT"){A=B.innerHTML;A=A.replace(new RegExp("^.*(<embed [^>]*>.*</embed>).*$","gi"),"$1");A=A.replace(new RegExp("^.*(<embed [^>]* ?/ ?>).*$","gi"),"$1")}return A}function contenteditable_contextmenu(A){var B=contenteditable_focused_iframe();webeditor_menu("context",false,getAbsoluteOffsetLeft(B)+A.clientX,getAbsoluteOffsetTop(B)+A.clientY);contenteditable_event_stop(A);return }function contenteditable_webeditor_clipboard_cut(){try{if(webeditor.clipboard&&window.clipboardData&&window.clipboardData.getData){webeditor.clipboardText=window.clipboardData.getData("Text")}}catch(A){webeditor.clipboardText="";webeditor.clipboard=false}}function contenteditable_webeditor_clipboard_copy(){try{if(webeditor.clipboard&&window.clipboardData&&window.clipboardData.getData){webeditor.clipboardText=window.clipboardData.getData("Text")}}catch(A){webeditor.clipboardText="";webeditor.clipboard=false}}function contenteditable_webeditor_clipboard(){try{if(webeditor.clipboard&&webeditor.clipboardHTML&&webeditor.clipboardText&&window.clipboardData&&window.clipboardData.getData){return true}}catch(A){}return false}function contenteditable_webeditor_clipboard_paste(){try{if(webeditor.clipboard&&webeditor.clipboardHTML&&webeditor.clipboardText&&window.clipboardData&&window.clipboardData.getData&&(webeditor.clipboardText==window.clipboardData.getData("Text"))){return true}}catch(A){}return false};